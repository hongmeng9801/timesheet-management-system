import{r as e,a as r}from"./vendor-CXpINTJd.js";import{r as t,u as s,N as n,b as i,L as a,R as o,c as l,d as c,B as m,e as u,f as d}from"./router-wINVZMR0.js";import{c as f,_ as h}from"./supabase-DZY_Yzln.js";import{P as p,L as g,E as b,a as v,X as N,U as x,C as y,B as E,b as w,S as D,A as _,c as H,d as T,e as S,f as j,K as k,g as V,h as C,i as R,j as A,k as M,l as I,m as O,n as P,T as L,o as F,G as U,p as B,t as W,q as z,D as G,F as q,r as X,R as Y,s as K,u as J,v as Q,M as Z,w as ee,x as re,y as te,z as se,H as ne,I as ie,J as ae,N as oe,O as le}from"./ui-CSLY6kJH.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)}).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();var ce,me,ue={exports:{}},de={};function fe(){return ce||(ce=1,function(){var r=e(),t=Symbol.for("react.element"),s=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.for("react.offscreen"),p=Symbol.iterator;var g=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function b(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),s=1;s<r;s++)t[s-1]=arguments[s];!function(e,r,t){var s=g.ReactDebugCurrentFrame.getStackAddendum();""!==s&&(r+="%s",t=t.concat([s]));var n=t.map(function(e){return String(e)});n.unshift("Warning: "+r),Function.prototype.apply.call(console[e],console,n)}("error",e,t)}var v;function N(e){return e.displayName||"Context"}function x(e){if(null==e)return null;if("number"==typeof e.tag&&b("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),"function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case n:return"Fragment";case s:return"Portal";case a:return"Profiler";case i:return"StrictMode";case m:return"Suspense";case u:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case l:return N(e)+".Consumer";case o:return N(e._context)+".Provider";case c:return function(e,r,t){var s=e.displayName;if(s)return s;var n=r.displayName||r.name||"";return""!==n?t+"("+n+")":t}(e,e.render,"ForwardRef");case d:var r=e.displayName||null;return null!==r?r:x(e.type)||"Memo";case f:var t=e,h=t._payload,p=t._init;try{return x(p(h))}catch(g){return null}}return null}v=Symbol.for("react.module.reference");var y,E,w,D,_,H,T,S=Object.assign,j=0;function k(){}k.__reactDisabledLog=!0;var V,C=g.ReactCurrentDispatcher;function R(e,r,t){if(void 0===V)try{throw Error()}catch(n){var s=n.stack.trim().match(/\n( *(at )?)/);V=s&&s[1]||""}return"\n"+V+e}var A,M=!1,I="function"==typeof WeakMap?WeakMap:Map;function O(e,r){if(!e||M)return"";var t,s=A.get(e);if(void 0!==s)return s;M=!0;var n,i=Error.prepareStackTrace;Error.prepareStackTrace=void 0,n=C.current,C.current=null,function(){if(0===j){y=console.log,E=console.info,w=console.warn,D=console.error,_=console.group,H=console.groupCollapsed,T=console.groupEnd;var e={configurable:!0,enumerable:!0,value:k,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}j++}();try{if(r){var a=function(){throw Error()};if(Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(a,[])}catch(h){t=h}Reflect.construct(e,[],a)}else{try{a.call()}catch(h){t=h}e.call(a.prototype)}}else{try{throw Error()}catch(h){t=h}e()}}catch(p){if(p&&t&&"string"==typeof p.stack){for(var o=p.stack.split("\n"),l=t.stack.split("\n"),c=o.length-1,m=l.length-1;c>=1&&m>=0&&o[c]!==l[m];)m--;for(;c>=1&&m>=0;c--,m--)if(o[c]!==l[m]){if(1!==c||1!==m)do{if(c--,--m<0||o[c]!==l[m]){var u="\n"+o[c].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),"function"==typeof e&&A.set(e,u),u}}while(c>=1&&m>=0);break}}}finally{M=!1,C.current=n,function(){if(0===--j){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:S({},e,{value:y}),info:S({},e,{value:E}),warn:S({},e,{value:w}),error:S({},e,{value:D}),group:S({},e,{value:_}),groupCollapsed:S({},e,{value:H}),groupEnd:S({},e,{value:T})})}j<0&&b("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}(),Error.prepareStackTrace=i}var d=e?e.displayName||e.name:"",f=d?R(d):"";return"function"==typeof e&&A.set(e,f),f}function P(e,r,t){if(null==e)return"";if("function"==typeof e)return O(e,!(!(s=e.prototype)||!s.isReactComponent));var s;if("string"==typeof e)return R(e);switch(e){case m:return R("Suspense");case u:return R("SuspenseList")}if("object"==typeof e)switch(e.$$typeof){case c:return O(e.render,!1);case d:return P(e.type,r,t);case f:var n=e,i=n._payload,a=n._init;try{return P(a(i),r,t)}catch(o){}}return""}A=new I;var L=Object.prototype.hasOwnProperty,F={},U=g.ReactDebugCurrentFrame;function B(e){if(e){var r=e._owner,t=P(e.type,e._source,r?r.type:null);U.setExtraStackFrame(t)}else U.setExtraStackFrame(null)}var W=Array.isArray;function z(e){return W(e)}function $(e){return""+e}function G(e){if(function(e){try{return $(e),!1}catch(r){return!0}}(e))return b("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",function(e){return"function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object"}(e)),$(e)}var q,X,Y,K=g.ReactCurrentOwner,J={key:!0,ref:!0,__self:!0,__source:!0};Y={};function Q(e,r,s,n,i){var a,o={},l=null,c=null;for(a in void 0!==s&&(G(s),l=""+s),function(e){if(L.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return void 0!==e.key}(r)&&(G(r.key),l=""+r.key),function(e){if(L.call(e,"ref")){var r=Object.getOwnPropertyDescriptor(e,"ref").get;if(r&&r.isReactWarning)return!1}return void 0!==e.ref}(r)&&(c=r.ref,function(e,r){if("string"==typeof e.ref&&K.current&&r&&K.current.stateNode!==r){var t=x(K.current.type);Y[t]||(b('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',x(K.current.type),e.ref),Y[t]=!0)}}(r,i)),r)L.call(r,a)&&!J.hasOwnProperty(a)&&(o[a]=r[a]);if(e&&e.defaultProps){var m=e.defaultProps;for(a in m)void 0===o[a]&&(o[a]=m[a])}if(l||c){var u="function"==typeof e?e.displayName||e.name||"Unknown":e;l&&function(e,r){var t=function(){q||(q=!0,b("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};t.isReactWarning=!0,Object.defineProperty(e,"key",{get:t,configurable:!0})}(o,u),c&&function(e,r){var t=function(){X||(X=!0,b("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",r))};t.isReactWarning=!0,Object.defineProperty(e,"ref",{get:t,configurable:!0})}(o,u)}return function(e,r,s,n,i,a,o){var l={$$typeof:t,type:e,key:r,ref:s,props:o,_owner:a,_store:{}};return Object.defineProperty(l._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(l,"_self",{configurable:!1,enumerable:!1,writable:!1,value:n}),Object.defineProperty(l,"_source",{configurable:!1,enumerable:!1,writable:!1,value:i}),Object.freeze&&(Object.freeze(l.props),Object.freeze(l)),l}(e,l,c,i,n,K.current,o)}var Z,ee=g.ReactCurrentOwner,re=g.ReactDebugCurrentFrame;function te(e){if(e){var r=e._owner,t=P(e.type,e._source,r?r.type:null);re.setExtraStackFrame(t)}else re.setExtraStackFrame(null)}function se(e){return"object"==typeof e&&null!==e&&e.$$typeof===t}function ne(){if(ee.current){var e=x(ee.current.type);if(e)return"\n\nCheck the render method of `"+e+"`."}return""}Z=!1;var ie={};function ae(e,r){if(e._store&&!e._store.validated&&null==e.key){e._store.validated=!0;var t=function(e){var r=ne();if(!r){var t="string"==typeof e?e:e.displayName||e.name;t&&(r="\n\nCheck the top-level render call using <"+t+">.")}return r}(r);if(!ie[t]){ie[t]=!0;var s="";e&&e._owner&&e._owner!==ee.current&&(s=" It was passed a child from "+x(e._owner.type)+"."),te(e),b('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',t,s),te(null)}}}function oe(e,r){if("object"==typeof e)if(z(e))for(var t=0;t<e.length;t++){var s=e[t];se(s)&&ae(s,r)}else if(se(e))e._store&&(e._store.validated=!0);else if(e){var n=function(e){if(null===e||"object"!=typeof e)return null;var r=p&&e[p]||e["@@iterator"];return"function"==typeof r?r:null}(e);if("function"==typeof n&&n!==e.entries)for(var i,a=n.call(e);!(i=a.next()).done;)se(i.value)&&ae(i.value,r)}}function le(e){var r,t=e.type;if(null!=t&&"string"!=typeof t){if("function"==typeof t)r=t.propTypes;else{if("object"!=typeof t||t.$$typeof!==c&&t.$$typeof!==d)return;r=t.propTypes}if(r){var s=x(t);!function(e,r,t,s,n){var i=Function.call.bind(L);for(var a in e)if(i(e,a)){var o=void 0;try{if("function"!=typeof e[a]){var l=Error((s||"React class")+": "+t+" type `"+a+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[a]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw l.name="Invariant Violation",l}o=e[a](r,a,s,t,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(c){o=c}!o||o instanceof Error||(B(n),b("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",s||"React class",t,a,typeof o),B(null)),o instanceof Error&&!(o.message in F)&&(F[o.message]=!0,B(n),b("Failed %s type: %s",t,o.message),B(null))}}(r,e.props,"prop",s,e)}else if(void 0!==t.PropTypes&&!Z){Z=!0,b("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",x(t)||"Unknown")}"function"!=typeof t.getDefaultProps||t.getDefaultProps.isReactClassApproved||b("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}var ce={};var me=function(e,r,s,p,g,N){var y=function(e){return"string"==typeof e||"function"==typeof e||e===n||e===a||e===i||e===m||e===u||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===d||e.$$typeof===o||e.$$typeof===l||e.$$typeof===c||e.$$typeof===v||void 0!==e.getModuleId)}(e);if(!y){var E="";(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(E+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var w,D=function(e){return void 0!==e?"\n\nCheck your code at "+e.fileName.replace(/^.*[\\\/]/,"")+":"+e.lineNumber+".":""}(g);E+=D||ne(),null===e?w="null":z(e)?w="array":void 0!==e&&e.$$typeof===t?(w="<"+(x(e.type)||"Unknown")+" />",E=" Did you accidentally export a JSX literal instead of a component?"):w=typeof e,b("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",w,E)}var _=Q(e,r,s,g,N);if(null==_)return _;if(y){var H=r.children;if(void 0!==H)if(p)if(z(H)){for(var T=0;T<H.length;T++)oe(H[T],e);Object.freeze&&Object.freeze(H)}else b("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else oe(H,e)}if(L.call(r,"key")){var S=x(e),j=Object.keys(r).filter(function(e){return"key"!==e}),k=j.length>0?"{key: someKey, "+j.join(": ..., ")+": ...}":"{key: someKey}";if(!ce[S+k])b('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',k,S,j.length>0?"{"+j.join(": ..., ")+": ...}":"{}",S),ce[S+k]=!0}return e===n?function(e){for(var r=Object.keys(e.props),t=0;t<r.length;t++){var s=r[t];if("children"!==s&&"key"!==s){te(e),b("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",s),te(null);break}}null!==e.ref&&(te(e),b("Invalid attribute `ref` supplied to `React.Fragment`."),te(null))}(_):le(_),_};de.Fragment=n,de.jsxDEV=me}()),de}var he,pe=(me||(me=1,ue.exports=fe()),ue.exports),ge={};var be=function(){if(he)return ge;he=1;var e=r(),t=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;return ge.createRoot=function(r,s){t.usingClientEntryPoint=!0;try{return e.createRoot(r,s)}finally{t.usingClientEntryPoint=!1}},ge.hydrateRoot=function(r,s,n){t.usingClientEntryPoint=!0;try{return e.hydrateRoot(r,s,n)}finally{t.usingClientEntryPoint=!1}},ge}();const ve=f("https://agesdprmugyybtqrvqks.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFnZXNkcHJtdWd5eWJ0cXJ2cWtzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNDY0OTIsImV4cCI6MjA3MDcyMjQ5Mn0.bfo_xb818yMd7-u6cJhDoJrqmDwcGY1nBDJIesFSfWk",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{"X-Client-Info":"supabase-js-web"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}});async function Ne(e){try{return await async function(e,r=3,t=1e3){let s;for(let i=1;i<=r;i++)try{return await e()}catch(n){if(s=n,i===r)break;const e=t*Math.pow(2,i-1);await new Promise(r=>setTimeout(r,e))}throw s}(e,2,500)}catch(r){return{data:null,error:{message:"网络连接异常，请检查网络设置或稍后重试",code:"NETWORK_ERROR",details:r}}}}const xe={USER_READ:"user:read",USER_MANAGE:"user:manage",USER_CREATE:"user:create",USER_DELETE:"user:delete",COMPANY_READ:"company:read",COMPANY_MANAGE:"company:manage",COMPANY_CREATE:"company:create",COMPANY_DELETE:"company:delete",PROCESS_READ:"process:read",PROCESS_MANAGE:"process:manage",PROCESS_CREATE:"process:create",PROCESS_DELETE:"process:delete",ROLE_MANAGE:"role:manage",SYSTEM_CONFIG:"system:config",TIME_RECORD:"time_record",REPORTS:"reports",HISTORY:"history",PROCESS_MANAGEMENT:"process_management",USER_MANAGEMENT:"user_management",COMPANY_MANAGEMENT:"company_management",SUPERVISOR_REVIEW:"supervisor_review",MANAGER_REVIEW:"manager_review",PERMISSION_MANAGEMENT:"permission_management"},ye="超级管理员",Ee=[{id:"time_record",name:"记录工时",description:"记录和管理工作时间",icon:"Clock",path:"/timesheet-record",permission:xe.TIME_RECORD,color:"from-green-400 to-green-600"},{id:"reports",name:"查看报表",description:"查看工时统计和分析报表",icon:"BarChart3",path:"/reports",permission:xe.REPORTS,color:"from-blue-400 to-blue-600"},{id:"history",name:"历史记录",description:"查看个人工时历史记录",icon:"Activity",path:"/history",permission:xe.HISTORY,color:"from-cyan-400 to-cyan-600"},{id:"process_management",name:"工序管理",description:"管理生产工序和流程",icon:"Settings",path:"/process-management",permission:xe.PROCESS_MANAGEMENT,color:"from-purple-400 to-purple-600"},{id:"user_management",name:"用户管理",description:"管理系统用户和权限",icon:"Users",path:"/user-management",permission:xe.USER_MANAGEMENT,color:"from-orange-400 to-orange-600"},{id:"company_management",name:"公司管理",description:"管理公司信息和部门",icon:"Building2",path:"/company-management",permission:xe.COMPANY_MANAGEMENT,color:"from-teal-400 to-teal-600"},{id:"supervisor_review",name:"班长审核",description:"班长审核工时记录",icon:"CheckCircle",path:"/supervisor-approval",permission:xe.SUPERVISOR_REVIEW,color:"from-indigo-400 to-indigo-600"},{id:"section_chief_review",name:"段长审核",description:"段长审核工时记录",icon:"Shield",path:"/section-chief-approval",permission:xe.MANAGER_REVIEW,color:"from-pink-400 to-pink-600"},{id:"permission_management",name:"权限管理",description:"管理用户角色和权限",icon:"Key",path:"/role-permissions",permission:xe.PERMISSION_MANAGEMENT,color:"from-red-400 to-red-600"}];let we=null;const De=6e5;async function _e(e){try{if(we&&we.userId===e&&Date.now()-we.timestamp<De)return we.permissions;const{data:r,error:t}=await Ne(async()=>await ve.from("users").select("\n          id,\n          role_id,\n          user_roles (\n            id,\n            name,\n            permissions\n          )\n        ").eq("id",e).single());if(t||!r)return[];let s=[];return r.user_roles&&He(r.user_roles.name)?s=Se():r.user_roles&&r.user_roles.permissions&&(s=r.user_roles.permissions),we={permissions:s,timestamp:Date.now(),userId:e},s}catch(r){return[]}}function He(e){return"object"==typeof e&&null!==e?"超级管理员"===e.name:"超级管理员"===e}const Te=(e,r)=>{if(!e)return!1;if(He(e.role||e.user_roles))return!0;const t=e.role||e.user_roles;return!(!t||!t.permissions)&&t.permissions.includes(r)},Se=()=>Object.values(xe),je=t.createContext(void 0);function ke({children:e}){const[r,s]=t.useState(null),[n,i]=t.useState(!0);t.useEffect(()=>{(async()=>{try{const r=localStorage.getItem("auth_user"),t=localStorage.getItem("last_login_time");if(r&&t){const n=JSON.parse(r),a=parseInt(t),o=Date.now();if(o-a>864e5)return localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"),s(null),void i(!1);if(!navigator.onLine)return s(n),void i(!1);try{const{data:e,error:r}=await Promise.race([ve.from("users").select("\n                  *,\n                  company:companies(*),\n                  role:user_roles(*)\n                ").eq("id",n.id).eq("is_active",!0).single(),new Promise((e,r)=>setTimeout(()=>r(new Error("验证超时")),8e3))]);if(e&&!r){const r=await _e(e.id),t={id:e.id,phone:e.phone,name:e.name,id_card:e.id_card,company:e.company,role:e.role,department_id:e.department_id,is_active:e.is_active,permissions:r};s(t),localStorage.setItem("auth_user",JSON.stringify(t)),localStorage.setItem("last_login_time",o.toString())}else localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"),s(null)}catch(e){s(n)}}else s(null)}catch(r){localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"),s(null)}finally{i(!1)}})();const e=setInterval(()=>{const e=localStorage.getItem("last_login_time");if(e){const r=parseInt(e);Date.now()-r>864e5&&(localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"),s(null),window.location.href="/login")}},6e4),{data:{subscription:r}}=ve.auth.onAuthStateChange(async(e,r)=>{"SIGNED_OUT"===e&&(s(null),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time"))});return()=>{r.unsubscribe(),clearInterval(e)}},[]);const a=async(e,r,t=0)=>{var n,i,o,l,c,m,u,d;try{if(!navigator.onLine)return{success:!1,error:"网络连接已断开，请检查网络后重试"};const{data:t,error:n}=await Promise.race([ve.from("users").select("\n            *,\n            company:companies(*),\n            role:user_roles(*)\n          ").eq("phone",e).eq("is_active",!0).single(),new Promise((e,r)=>setTimeout(()=>r(new Error("请求超时")),1e4))]);if(n){if("PGRST116"===n.code)return{success:!1,error:"用户不存在或已被禁用"};throw n}if(!t)return{success:!1,error:"用户不存在或已被禁用"};if(t.password_hash!==r)return{success:!1,error:"密码错误"};let i=[];t.role&&"超级管理员"===t.role.name?i=Object.values(xe):setTimeout(async()=>{try{const e=await _e(t.id),r=JSON.parse(localStorage.getItem("auth_user")||"{}");r.id===t.id&&(r.permissions=e,localStorage.setItem("auth_user",JSON.stringify(r)),s(r))}catch(e){}},100);const a={id:t.id,phone:t.phone,name:t.name,id_card:t.id_card,company:t.company,role:t.role,department_id:t.department_id,is_active:t.is_active,permissions:i};return s(a),localStorage.setItem("auth_user",JSON.stringify(a)),localStorage.setItem("last_login_time",Date.now().toString()),{success:!0}}catch(f){const s=(null==(n=f.message)?void 0:n.includes("fetch"))||(null==(i=f.message)?void 0:i.includes("network"))||(null==(o=f.message)?void 0:o.includes("CONNECTION_CLOSED"))||(null==(l=f.message)?void 0:l.includes("ERR_NETWORK_CHANGED"))||(null==(c=f.message)?void 0:c.includes("ERR_ABORTED"))||(null==(m=f.message)?void 0:m.includes("ERR_CONNECTION_CLOSED"))||(null==(u=f.message)?void 0:u.includes("请求超时"))||(null==(d=f.message)?void 0:d.includes("Failed to fetch"))||"NETWORK_ERROR"===f.code||"TypeError"===f.name||!navigator.onLine;return t<5&&s?(await new Promise(e=>setTimeout(e,1e3*Math.pow(2,t))),a(e,r,t+1)):s?{success:!1,error:`网络连接不稳定，已重试${t}次，请检查网络后重试`}:{success:!1,error:f.message||"登录失败，请稍后重试"}}},o={user:r,loading:n,login:a,register:async e=>{try{const{data:r,error:t}=await ve.from("users").select("id").eq("id_card",e.id_card).maybeSingle();if(t&&"PGRST116"!==t.code)return{success:!1,error:"系统错误，请稍后重试"};const{data:n,error:i}=await ve.from("users").select("id").eq("phone",e.phone).maybeSingle();if(i&&"PGRST116"!==i.code)return{success:!1,error:"系统错误，请稍后重试"};if(r||n){if(r)return{success:!1,error:"该身份证号已被注册"};if(n)return{success:!1,error:"该手机号已被注册"}}const a=crypto.randomUUID(),{error:o}=await ve.from("users").insert({id:a,phone:e.phone,id_card:e.id_card,name:e.name,company_id:e.company_id,role_id:e.role_id,password_hash:e.password,production_line:e.production_line,is_active:!0});if(o)return{success:!1,error:"用户信息创建失败"};const{data:l}=await ve.from("users").select("\n          *,\n          company:companies(*),\n          role:user_roles(*)\n        ").eq("id",a).single();if(l){const e=await _e(l.id),r={id:l.id,phone:l.phone,name:l.name,id_card:l.id_card,company:l.company,role:l.role,department_id:l.department_id,is_active:l.is_active,permissions:e};s(r),localStorage.setItem("auth_user",JSON.stringify(r))}return{success:!0}}catch(r){return{success:!1,error:r.message||"注册失败，请重试"}}},logout:async()=>{try{s(null),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time")}catch(e){s(null),localStorage.removeItem("auth_user"),localStorage.removeItem("last_login_time")}},resetPassword:async(e,r)=>{var t;try{const{data:t,error:s}=await Promise.race([ve.from("users").select("id, phone, name").eq("id_card",e).eq("is_active",!0).single(),new Promise((e,r)=>setTimeout(()=>r(new Error("查询超时")),8e3))]);if(s)return"PGRST116"===s.code?{success:!1,error:"未找到该身份证号对应的用户"}:{success:!1,error:"查询用户失败，请重试"};if(!t)return{success:!1,error:"未找到该身份证号对应的用户"};if(!r)return{success:!0,user:{id:t.id,phone:t.phone,name:t.name}};const{error:n}=await Promise.race([ve.from("users").update({password_hash:r}).eq("id",t.id),new Promise((e,r)=>setTimeout(()=>r(new Error("更新超时")),8e3))]);return n?{success:!1,error:"密码重置失败，请重试"}:{success:!0}}catch(s){return(null==(t=s.message)?void 0:t.includes("超时"))?{success:!1,error:"网络超时，请检查网络连接后重试"}:{success:!1,error:s.message||"密码重置失败"}}},refreshUser:async()=>{if(null==r?void 0:r.id)try{const{data:e,error:t}=await ve.from("users").select("\n          *,\n          company:companies(*),\n          role:user_roles(*)\n        ").eq("id",r.id).eq("is_active",!0).single();if(e&&!t){const r=await _e(e.id),t={id:e.id,phone:e.phone,name:e.name,id_card:e.id_card,company:e.company,role:e.role,department_id:e.department_id,is_active:e.is_active,permissions:r};s(t),localStorage.setItem("auth_user",JSON.stringify(t))}}catch(e){}},isAuthenticated:()=>!!(r&&r.id&&r.is_active)};return pe.jsxDEV(je.Provider,{value:o,children:e},void 0,!1,{fileName:"H:/工时管理/src/contexts/AuthContext.tsx",lineNumber:515,columnNumber:10},this)}function Ve(){const e=t.useContext(je);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}function Ce({children:e,requireAuth:r=!0}){const{user:t,loading:i,isAuthenticated:a}=Ve(),o=s();return i?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/components/ProtectedRoute.tsx",lineNumber:17,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/components/ProtectedRoute.tsx",lineNumber:16,columnNumber:7},this):r&&!a()?pe.jsxDEV(n,{to:"/login",state:{from:o},replace:!0},void 0,!1,{fileName:"H:/工时管理/src/components/ProtectedRoute.tsx",lineNumber:26,columnNumber:12},this):!r&&a()?pe.jsxDEV(n,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"H:/工时管理/src/components/ProtectedRoute.tsx",lineNumber:31,columnNumber:12},this):pe.jsxDEV(pe.Fragment,{children:e},void 0,!1,{fileName:"H:/工时管理/src/components/ProtectedRoute.tsx",lineNumber:34,columnNumber:10},this)}function Re({children:e,allowedRoles:r,fallbackPath:t="/dashboard"}){var i;const{user:a,loading:o}=Ve(),l=s();if(o)return pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:22,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:21,columnNumber:7},this);if(!a)return pe.jsxDEV(n,{to:"/login",state:{from:l},replace:!0},void 0,!1,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:31,columnNumber:12},this);const c=null==(i=a.role)?void 0:i.name;return r.some(e=>c===e||(null==c?void 0:c.toLowerCase())===e.toLowerCase())?pe.jsxDEV(pe.Fragment,{children:e},void 0,!1,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:70,columnNumber:10},this):pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("div",{className:"text-red-400 text-6xl mb-4",children:"🚫"},void 0,!1,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:54,columnNumber:11},this),pe.jsxDEV("h1",{className:"text-2xl font-bold text-red-400 mb-2 font-mono",children:"访问被拒绝"},void 0,!1,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:55,columnNumber:11},this),pe.jsxDEV("p",{className:"text-green-300 mb-6 font-mono",children:["您没有权限访问此页面。需要角色: ",r.join(", ")]},void 0,!0,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:56,columnNumber:11},this),pe.jsxDEV("button",{onClick:()=>window.history.back(),className:"px-6 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded font-mono transition-colors",children:"返回上一页"},void 0,!1,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:59,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:53,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/components/RoleProtectedRoute.tsx",lineNumber:52,columnNumber:7},this)}function Ae(){var e,r;const[n,o]=t.useState({phone:"",password:""}),[l,c]=t.useState(!1),[m,u]=t.useState(!1),[d,f]=t.useState(""),[h,y]=t.useState(!1),[E,w]=t.useState(!1),[D,_]=t.useState([]),{login:H}=Ve(),T=i(),S=(null==(r=null==(e=s().state)?void 0:e.from)?void 0:r.pathname)||"/dashboard",j=e=>{try{return atob(e)}catch{return""}};t.useEffect(()=>{const e=localStorage.getItem("savedUsers"),r=localStorage.getItem("savedCredentials");if(e){const r=JSON.parse(e);_(r),r.length>0&&(o(e=>({...e,phone:r[0].phone})),y(!0))}if(r)try{const e=JSON.parse(r);e.phone&&e.password&&(o({phone:e.phone,password:j(e.password)}),w(!0),y(!0))}catch(t){}},[]);const k=e=>{o({...n,[e.target.name]:e.target.value})};return pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center px-4",children:pe.jsxDEV("div",{className:"max-w-md w-full space-y-8",children:[pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("div",{className:"flex items-center justify-center mb-2",children:[pe.jsxDEV("svg",{className:"w-16 h-16 mr-4",viewBox:"0 0 80 80",xmlns:"http://www.w3.org/2000/svg",children:[pe.jsxDEV("ellipse",{cx:"40",cy:"40",rx:"38",ry:"30",fill:"black",stroke:"#22c55e",strokeWidth:"3"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:163,columnNumber:15},this),pe.jsxDEV("text",{x:"40",y:"50",textAnchor:"middle",fill:"#22c55e",fontSize:"28",fontWeight:"bold",fontFamily:"Arial, sans-serif",children:"JT"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:164,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:162,columnNumber:13},this),pe.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 font-mono",children:"工时管理系统"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:166,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:161,columnNumber:11},this),pe.jsxDEV("div",{className:"mt-4 h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:170,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:160,columnNumber:9},this),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-8 shadow-lg shadow-green-400/20",children:[pe.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 mb-6 text-center font-mono",children:"用户登录"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:175,columnNumber:11},this),d&&pe.jsxDEV("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-400 rounded text-red-300 text-sm",children:d},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:180,columnNumber:13},this),pe.jsxDEV("form",{onSubmit:async e=>{if(e.preventDefault(),u(!0),f(""),!n.phone||!n.password)return f("请填写所有必填字段"),void u(!1);const r=await H(n.phone,n.password);if(r.success){if(h){const e=JSON.parse(localStorage.getItem("savedUsers")||"[]");if(e.find(e=>e.phone===n.phone)){const r=e.filter(e=>e.phone!==n.phone),t=[{phone:n.phone},...r];localStorage.setItem("savedUsers",JSON.stringify(t))}else{const r=[{phone:n.phone},...e.slice(0,4)];localStorage.setItem("savedUsers",JSON.stringify(r))}}if(E){const e={phone:n.phone,password:(t=n.password,btoa(t))};localStorage.setItem("savedCredentials",JSON.stringify(e))}else localStorage.removeItem("savedCredentials");T(S,{replace:!0})}else f(r.error||"登录失败");var t;u(!1)},className:"space-y-6",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"手机号码"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:188,columnNumber:15},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:192,columnNumber:17},this),pe.jsxDEV("input",{type:"tel",name:"phone",value:n.phone,onChange:k,className:"w-full pl-12 pr-4 py-3 bg-black border border-green-400 rounded-lg text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono",placeholder:"请输入手机号码",maxLength:11},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:193,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:191,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:187,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"登录密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:207,columnNumber:15},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:211,columnNumber:17},this),pe.jsxDEV("input",{type:l?"text":"password",name:"password",value:n.password,onChange:k,className:"w-full pl-12 pr-12 py-3 bg-black border border-green-400 rounded-lg text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono",placeholder:"请输入密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:212,columnNumber:17},this),pe.jsxDEV("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:l?pe.jsxDEV(b,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:225,columnNumber:35},this):pe.jsxDEV(v,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:225,columnNumber:68},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:220,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:210,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:206,columnNumber:13},this),pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV("input",{type:"checkbox",id:"rememberMe",checked:h,onChange:e=>y(e.target.checked),className:"w-4 h-4 text-green-600 bg-black border-green-400 rounded focus:ring-green-500 focus:ring-2"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:233,columnNumber:17},this),pe.jsxDEV("label",{htmlFor:"rememberMe",className:"ml-2 text-sm text-green-300 font-mono",children:"记住账号"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:240,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:232,columnNumber:15},this),pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV("input",{type:"checkbox",id:"rememberPassword",checked:E,onChange:e=>w(e.target.checked),className:"w-4 h-4 text-green-600 bg-black border-green-400 rounded focus:ring-green-500 focus:ring-2"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:246,columnNumber:17},this),pe.jsxDEV("label",{htmlFor:"rememberPassword",className:"ml-2 text-sm text-green-300 font-mono",children:"记住密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:253,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:245,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:231,columnNumber:13},this),pe.jsxDEV("button",{type:"submit",disabled:m,className:"w-full py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded-lg transition-colors duration-200 font-mono text-lg",children:m?"登录中...":"登录"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:260,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:185,columnNumber:11},this),D.length>0&&pe.jsxDEV("div",{className:"mt-6",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-3",children:[pe.jsxDEV("h3",{className:"text-green-300 text-sm font-mono",children:"快速登录"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:273,columnNumber:17},this),pe.jsxDEV("button",{type:"button",onClick:()=>{localStorage.removeItem("savedUsers"),localStorage.removeItem("savedCredentials"),_([]),o({phone:"",password:""}),y(!1),w(!1)},className:"text-red-400 hover:text-red-300 text-xs font-mono flex items-center",title:"清除所有保存的登录信息",children:[pe.jsxDEV(N,{className:"w-3 h-3 mr-1"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:280,columnNumber:19},this),"清除"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:274,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:272,columnNumber:15},this),pe.jsxDEV("div",{className:"space-y-2",children:D.slice(0,3).map((e,r)=>pe.jsxDEV("button",{type:"button",onClick:()=>(e=>{o(r=>({...r,phone:e}));const r=localStorage.getItem("savedCredentials");if(r)try{const t=JSON.parse(r);t.phone===e&&t.password&&(o({phone:e,password:j(t.password)}),w(!0))}catch(t){}})(e.phone),className:"w-full flex items-center p-2 bg-gray-800 hover:bg-gray-700 border border-green-400/30 rounded-lg transition-colors duration-200",children:[pe.jsxDEV(x,{className:"w-4 h-4 text-green-400 mr-2"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:292,columnNumber:21},this),pe.jsxDEV("span",{className:"text-green-300 font-mono text-sm",children:e.phone},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:293,columnNumber:21},this),n.phone===e.phone&&pe.jsxDEV("span",{className:"ml-auto text-green-400 text-xs font-mono",children:"当前"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:295,columnNumber:23},this)]},e.phone,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:286,columnNumber:19},this))},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:284,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:271,columnNumber:13},this),pe.jsxDEV("div",{className:"mt-6 text-center space-y-2",children:[pe.jsxDEV(a,{to:"/register",className:"block text-green-400 hover:text-green-300 text-sm font-mono transition-colors",children:"还没有账号？立即注册"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:305,columnNumber:13},this),pe.jsxDEV(a,{to:"/reset-password",className:"block text-green-400 hover:text-green-300 text-sm font-mono transition-colors",children:"忘记密码？重置密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:311,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:304,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:174,columnNumber:9},this),pe.jsxDEV("div",{className:"text-center text-green-600 text-xs font-mono",children:[pe.jsxDEV("p",{children:"© 吉林省通用机械（集团）有限责任公司."},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:322,columnNumber:11},this),pe.jsxDEV("div",{className:"mt-2 flex justify-center space-x-2",children:[pe.jsxDEV("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:324,columnNumber:13},this),pe.jsxDEV("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:325,columnNumber:13},this),pe.jsxDEV("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse",style:{animationDelay:"0.4s"}},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:326,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:323,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:321,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:158,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Login.tsx",lineNumber:157,columnNumber:5},this)}function Me(){const[e,r]=t.useState({phone:"",password:"",confirmPassword:"",id_card:"",name:"",company_id:"",role_id:"",production_line:""}),[s,n]=t.useState(!1),[o,l]=t.useState(!1),[c,m]=t.useState(!1),[u,d]=t.useState(""),[f,h]=t.useState([]),[N,_]=t.useState([]),[H,T]=t.useState(""),[S,j]=t.useState(!0),[k,V]=t.useState([]),[C,R]=t.useState(!1),[A,M]=t.useState(null),{register:I}=Ve(),O=i();t.useEffect(()=>{(async()=>{try{const{data:e,error:r}=await ve.from("companies").select("*").order("name");if(r)throw r;const{data:t,error:s}=await ve.from("user_roles").select("*").neq("name","超级管理员").order("name");if(s)throw s;h(e||[]),_(t||[])}catch(e){d("获取数据失败，请重试")}finally{j(!1)}})()},[]);const P=async e=>{try{const{data:r,error:t}=await ve.from("processes").select("production_line").eq("company_id",e).eq("is_active",!0);if(t)throw t;const s=[...new Set((null==r?void 0:r.map(e=>e.production_line))||[])];V(s)}catch(r){V([])}},L=async t=>{const{name:s,value:n}=t.target;if(r(e=>({...e,[s]:n})),"role_id"===s){const t=N.find(e=>e.id===n);M(t||null);const s=t&&("班长"===t.name||"段长"===t.name);R(s||!1),s&&e.company_id&&await P(e.company_id),s||r(e=>({...e,production_line:""}))}if("company_id"===s&&C&&(await P(n),r(e=>({...e,production_line:""}))),"confirmPassword"===s||"password"===s){const r="password"===s?n:e.password,t="confirmPassword"===s?n:e.confirmPassword;T(t&&r!==t?"两次输入的密码不一致":"")}};return S?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:199,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:198,columnNumber:7},this):pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center px-4 py-8",children:pe.jsxDEV("div",{className:"max-w-md w-full space-y-8",children:[pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 mb-2 font-mono",children:"工时管理系统"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:211,columnNumber:11},this),pe.jsxDEV("p",{className:"text-green-300 text-lg font-mono",children:"TIMETRACK SYSTEM"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:214,columnNumber:11},this),pe.jsxDEV("div",{className:"mt-4 h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:217,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:210,columnNumber:9},this),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-8 shadow-lg shadow-green-400/20",children:[pe.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 mb-6 text-center font-mono",children:"用户注册"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:222,columnNumber:11},this),u&&pe.jsxDEV("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-400 rounded text-red-300 text-sm",children:u},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:227,columnNumber:13},this),pe.jsxDEV("form",{onSubmit:async r=>{if(r.preventDefault(),m(!0),d(""),!(e.phone&&e.password&&e.id_card&&e.name&&e.company_id&&e.role_id))return d("请填写所有必填字段"),void m(!1);if(C&&!e.production_line)return d("请选择生产线"),void m(!1);if(e.password!==e.confirmPassword)return d("两次输入的密码不一致"),T("两次输入的密码不一致"),void m(!1);if(e.password.length<6)return d("密码长度至少6位"),void m(!1);if(!/^1[3-9]\d{9}$/.test(e.phone))return d("请输入正确的手机号码"),void m(!1);if(!/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/.test(e.id_card))return d("请输入正确的身份证号码"),void m(!1);const t=await I({phone:e.phone,password:e.password,id_card:e.id_card,name:e.name,company_id:e.company_id,role_id:e.role_id,production_line:C?e.production_line:null});t.success?O("/dashboard"):d(t.error||"注册失败"),m(!1)},className:"space-y-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"手机号码 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:235,columnNumber:15},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:239,columnNumber:17},this),pe.jsxDEV("input",{type:"tel",name:"phone",value:e.phone,onChange:L,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入手机号码",maxLength:11},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:240,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:238,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:234,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"身份证号 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:254,columnNumber:15},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:258,columnNumber:17},this),pe.jsxDEV("input",{type:"text",name:"id_card",value:e.id_card,onChange:L,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入身份证号码",maxLength:18},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:259,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:257,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:253,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"姓名 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:273,columnNumber:15},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:277,columnNumber:17},this),pe.jsxDEV("input",{type:"text",name:"name",value:e.name,onChange:L,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入真实姓名"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:278,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:276,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:272,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"所属公司 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:293,columnNumber:15},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:297,columnNumber:17},this),pe.jsxDEV("select",{name:"company_id",value:e.company_id,onChange:L,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",children:[pe.jsxDEV("option",{value:"",children:"请选择公司"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:304,columnNumber:19},this),f.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:306,columnNumber:21},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:298,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:296,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:292,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"用户角色 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:316,columnNumber:15},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:320,columnNumber:17},this),pe.jsxDEV("select",{name:"role_id",value:e.role_id,onChange:L,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",children:[pe.jsxDEV("option",{value:"",children:"请选择角色"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:327,columnNumber:19},this),N.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:329,columnNumber:21},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:321,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:319,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:315,columnNumber:13},this),C&&pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"生产线 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:340,columnNumber:17},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:344,columnNumber:19},this),pe.jsxDEV("select",{name:"production_line",value:e.production_line,onChange:L,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",children:[pe.jsxDEV("option",{value:"",children:"请选择生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:351,columnNumber:21},this),k.map(e=>pe.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:353,columnNumber:23},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:345,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:343,columnNumber:17},this),0===k.length&&e.company_id&&pe.jsxDEV("div",{className:"mt-1 text-yellow-400 text-xs font-mono",children:"该公司暂无可用生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:360,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:339,columnNumber:15},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"登录密码 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:369,columnNumber:15},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:373,columnNumber:17},this),pe.jsxDEV("input",{type:s?"text":"password",name:"password",value:e.password,onChange:L,className:"w-full pl-10 pr-10 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入密码（至少6位）"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:374,columnNumber:17},this),pe.jsxDEV("button",{type:"button",onClick:()=>n(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:s?pe.jsxDEV(b,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:387,columnNumber:35},this):pe.jsxDEV(v,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:387,columnNumber:68},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:382,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:372,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:368,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"确认密码 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:394,columnNumber:15},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:398,columnNumber:17},this),pe.jsxDEV("input",{type:o?"text":"password",name:"confirmPassword",value:e.confirmPassword,onChange:L,className:"w-full pl-10 pr-10 py-2 bg-black border rounded text-green-300 placeholder-green-600 focus:outline-none focus:ring-1 font-mono text-sm "+(H?"border-red-400 focus:border-red-300 focus:ring-red-300":"border-green-400 focus:border-green-300 focus:ring-green-300"),placeholder:"请再次输入密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:399,columnNumber:17},this),pe.jsxDEV("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:o?pe.jsxDEV(b,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:414,columnNumber:42},this):pe.jsxDEV(v,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:414,columnNumber:75},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:409,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:397,columnNumber:15},this),H&&pe.jsxDEV("div",{className:"mt-1 text-red-400 text-xs font-mono",children:H},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:418,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:393,columnNumber:13},this),pe.jsxDEV("button",{type:"submit",disabled:c,className:"w-full py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded-lg transition-colors duration-200 font-mono text-lg mt-6",children:c?"注册中...":"注册"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:425,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:232,columnNumber:11},this),pe.jsxDEV("div",{className:"mt-6 text-center",children:pe.jsxDEV(a,{to:"/login",className:"text-green-400 hover:text-green-300 text-sm font-mono transition-colors",children:"已有账号？立即登录"},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:436,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:435,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:221,columnNumber:9},this),pe.jsxDEV("div",{className:"text-center text-green-600 text-xs font-mono",children:pe.jsxDEV("p",{children:"© 2024 工时管理系统. All rights reserved."},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:447,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:446,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:208,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Register.tsx",lineNumber:207,columnNumber:5},this)}function Ie(){const[e,r]=t.useState("verify"),[s,n]=t.useState({id_card:"",newPassword:"",confirmPassword:""}),[o,l]=t.useState(!1),[c,m]=t.useState(!1),[u,d]=t.useState(!1),[f,h]=t.useState(""),[p,N]=t.useState(""),[x,E]=t.useState(null),{resetPassword:w}=Ve(),D=i(),H=e=>{const{name:r,value:t}=e.target;if(n(e=>({...e,[r]:t})),"confirmPassword"===r||"newPassword"===r){const e="newPassword"===r?t:s.newPassword,n="confirmPassword"===r?t:s.confirmPassword;N(n&&e!==n?"两次输入的密码不一致":"")}};return pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center px-4",children:pe.jsxDEV("div",{className:"max-w-md w-full space-y-8",children:[pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 mb-2 font-mono",children:"工时管理系统"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:124,columnNumber:11},this),pe.jsxDEV("p",{className:"text-green-300 text-lg font-mono",children:"TIMETRACK SYSTEM"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:127,columnNumber:11},this),pe.jsxDEV("div",{className:"mt-4 h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:130,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:123,columnNumber:9},this),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-8 shadow-lg shadow-green-400/20",children:[pe.jsxDEV("div",{className:"flex items-center mb-6",children:[pe.jsxDEV("button",{onClick:()=>{"reset"===e?(r("verify"),E(null),h("")):D("/login")},className:"text-green-400 hover:text-green-300 mr-3 transition-colors",children:pe.jsxDEV(_,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:140,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:136,columnNumber:13},this),pe.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 font-mono",children:"verify"===e?"身份验证":"重置密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:142,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:135,columnNumber:11},this),f&&pe.jsxDEV("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-400 rounded text-red-300 text-sm",children:f},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:148,columnNumber:13},this),"verify"===e?pe.jsxDEV("form",{onSubmit:async e=>{if(e.preventDefault(),d(!0),h(""),!s.id_card)return h("请输入身份证号码"),void d(!1);if(!/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/.test(s.id_card))return h("请输入正确的身份证号码"),void d(!1);const t=await w(s.id_card);t.success&&t.user?(E(t.user),r("reset"),h("")):h(t.error||"身份证号码验证失败，请检查后重试"),d(!1)},className:"space-y-6",children:[pe.jsxDEV("div",{className:"text-center mb-6",children:pe.jsxDEV("p",{className:"text-green-300 text-sm font-mono",children:"请输入您的身份证号码进行身份验证"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:156,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:155,columnNumber:15},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"身份证号码"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:163,columnNumber:17},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:167,columnNumber:19},this),pe.jsxDEV("input",{type:"text",name:"id_card",value:s.id_card,onChange:H,className:"w-full pl-12 pr-4 py-3 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono",placeholder:"请输入身份证号码",maxLength:18},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:168,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:166,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:162,columnNumber:15},this),pe.jsxDEV("button",{type:"submit",disabled:u,className:"w-full py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded-lg transition-colors duration-200 font-mono text-lg",children:u?"验证中...":"验证身份"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:181,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:154,columnNumber:13},this):pe.jsxDEV("form",{onSubmit:async e=>{if(e.preventDefault(),d(!0),h(""),!s.newPassword||!s.confirmPassword)return h("请填写新密码和确认密码"),void d(!1);if(s.newPassword!==s.confirmPassword)return h("两次输入的密码不一致"),N("两次输入的密码不一致"),void d(!1);if(s.newPassword.length<6)return h("密码长度至少6位"),void d(!1);const r=await w(s.id_card,s.newPassword);r.success?(alert("密码重置成功，请使用新密码登录"),D("/login")):h(r.error||"密码重置失败"),d(!1)},className:"space-y-6",children:[x&&pe.jsxDEV("div",{className:"bg-green-900/30 border border-green-400 rounded p-4 mb-6",children:[pe.jsxDEV("p",{className:"text-green-300 text-sm font-mono",children:["验证成功！正在为用户 ",pe.jsxDEV("span",{className:"text-green-400 font-bold",children:x.name},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:194,columnNumber:32},this)," 重置密码"]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:193,columnNumber:19},this),pe.jsxDEV("p",{className:"text-green-400 text-xs font-mono mt-1",children:["手机号: ",x.phone]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:196,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:192,columnNumber:17},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"新密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:204,columnNumber:17},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:208,columnNumber:19},this),pe.jsxDEV("input",{type:o?"text":"password",name:"newPassword",value:s.newPassword,onChange:H,className:"w-full pl-12 pr-12 py-3 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono",placeholder:"请输入新密码（至少6位）"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:209,columnNumber:19},this),pe.jsxDEV("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:o?pe.jsxDEV(b,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:222,columnNumber:37},this):pe.jsxDEV(v,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:222,columnNumber:70},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:217,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:207,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:203,columnNumber:15},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"确认新密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:229,columnNumber:17},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:233,columnNumber:19},this),pe.jsxDEV("input",{type:c?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:H,className:"w-full pl-12 pr-12 py-3 bg-black border rounded text-green-300 placeholder-green-600 focus:outline-none focus:ring-1 font-mono "+(p?"border-red-400 focus:border-red-300 focus:ring-red-300":"border-green-400 focus:border-green-300 focus:ring-green-300"),placeholder:"请再次输入新密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:234,columnNumber:19},this),pe.jsxDEV("button",{type:"button",onClick:()=>m(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-400 hover:text-green-300",children:c?pe.jsxDEV(b,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:249,columnNumber:44},this):pe.jsxDEV(v,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:249,columnNumber:77},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:244,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:232,columnNumber:17},this),p&&pe.jsxDEV("div",{className:"mt-1 text-red-400 text-xs font-mono",children:p},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:253,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:228,columnNumber:15},this),pe.jsxDEV("button",{type:"submit",disabled:u,className:"w-full py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded-lg transition-colors duration-200 font-mono text-lg",children:u?"重置中...":"重置密码"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:260,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:190,columnNumber:13},this),pe.jsxDEV("div",{className:"mt-6 text-center",children:pe.jsxDEV(a,{to:"/login",className:"text-green-400 hover:text-green-300 text-sm font-mono transition-colors",children:"返回登录"},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:272,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:271,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:134,columnNumber:9},this),pe.jsxDEV("div",{className:"text-center text-green-600 text-xs font-mono",children:pe.jsxDEV("p",{children:"© 2024 工时管理系统. All rights reserved."},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:283,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:282,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:121,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/ResetPassword.tsx",lineNumber:120,columnNumber:5},this)}const Oe="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function Pe(e){const r=Object.prototype.toString.call(e);return"[object Window]"===r||"[object global]"===r}function Le(e){return"nodeType"in e}function Fe(e){var r,t;return e?Pe(e)?e:Le(e)&&null!=(r=null==(t=e.ownerDocument)?void 0:t.defaultView)?r:window:window}function Ue(e){const{Document:r}=Fe(e);return e instanceof r}function Be(e){return!Pe(e)&&e instanceof Fe(e).HTMLElement}function We(e){return e instanceof Fe(e).SVGElement}function ze(e){return e?Pe(e)?e.document:Le(e)?Ue(e)?e:Be(e)||We(e)?e.ownerDocument:document:document:document}const $e=Oe?t.useLayoutEffect:t.useEffect;function Ge(e){const r=t.useRef(e);return $e(()=>{r.current=e}),t.useCallback(function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return null==r.current?void 0:r.current(...t)},[])}function qe(e,r){void 0===r&&(r=[e]);const s=t.useRef(e);return $e(()=>{s.current!==e&&(s.current=e)},r),s}function Xe(e,r){const s=t.useRef();return t.useMemo(()=>{const r=e(s.current);return s.current=r,r},[...r])}function Ye(e){const r=Ge(e),s=t.useRef(null),n=t.useCallback(e=>{e!==s.current&&(null==r||r(e,s.current)),s.current=e},[]);return[s,n]}function Ke(e){const r=t.useRef();return t.useEffect(()=>{r.current=e},[e]),r.current}let Je={};function Qe(e,r){return t.useMemo(()=>{if(r)return r;const t=null==Je[e]?0:Je[e]+1;return Je[e]=t,e+"-"+t},[e,r])}function Ze(e){return function(r){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];return s.reduce((r,t)=>{const s=Object.entries(t);for(const[n,i]of s){const t=r[n];null!=t&&(r[n]=t+e*i)}return r},{...r})}}const er=Ze(1),rr=Ze(-1);function tr(e){if(!e)return!1;const{KeyboardEvent:r}=Fe(e.target);return r&&e instanceof r}function sr(e){if(function(e){if(!e)return!1;const{TouchEvent:r}=Fe(e.target);return r&&e instanceof r}(e)){if(e.touches&&e.touches.length){const{clientX:r,clientY:t}=e.touches[0];return{x:r,y:t}}if(e.changedTouches&&e.changedTouches.length){const{clientX:r,clientY:t}=e.changedTouches[0];return{x:r,y:t}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const nr=Object.freeze({Translate:{toString(e){if(!e)return;const{x:r,y:t}=e;return"translate3d("+(r?Math.round(r):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:r,scaleY:t}=e;return"scaleX("+r+") scaleY("+t+")"}},Transform:{toString(e){if(e)return[nr.Translate.toString(e),nr.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:r,duration:t,easing:s}=e;return r+" "+t+"ms "+s}}}),ir="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ar(e){return e.matches(ir)?e:e.querySelector(ir)}const or={display:"none"};function lr(e){let{id:r,value:t}=e;return o.createElement("div",{id:r,style:or},t)}function cr(e){let{id:r,announcement:t,ariaLiveType:s="assertive"}=e;return o.createElement("div",{id:r,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":s,"aria-atomic":!0},t)}const mr=t.createContext(null);const ur={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},dr={onDragStart(e){let{active:r}=e;return"Picked up draggable item "+r.id+"."},onDragOver(e){let{active:r,over:t}=e;return t?"Draggable item "+r.id+" was moved over droppable area "+t.id+".":"Draggable item "+r.id+" is no longer over a droppable area."},onDragEnd(e){let{active:r,over:t}=e;return t?"Draggable item "+r.id+" was dropped over droppable area "+t.id:"Draggable item "+r.id+" was dropped."},onDragCancel(e){let{active:r}=e;return"Dragging was cancelled. Draggable item "+r.id+" was dropped."}};function fr(e){let{announcements:r=dr,container:s,hiddenTextDescribedById:n,screenReaderInstructions:i=ur}=e;const{announce:a,announcement:c}=function(){const[e,r]=t.useState("");return{announce:t.useCallback(e=>{null!=e&&r(e)},[]),announcement:e}}(),m=Qe("DndLiveRegion"),[u,d]=t.useState(!1);if(t.useEffect(()=>{d(!0)},[]),function(e){const r=t.useContext(mr);t.useEffect(()=>{if(!r)throw new Error("useDndMonitor must be used within a children of <DndContext>");return r(e)},[e,r])}(t.useMemo(()=>({onDragStart(e){let{active:t}=e;a(r.onDragStart({active:t}))},onDragMove(e){let{active:t,over:s}=e;r.onDragMove&&a(r.onDragMove({active:t,over:s}))},onDragOver(e){let{active:t,over:s}=e;a(r.onDragOver({active:t,over:s}))},onDragEnd(e){let{active:t,over:s}=e;a(r.onDragEnd({active:t,over:s}))},onDragCancel(e){let{active:t,over:s}=e;a(r.onDragCancel({active:t,over:s}))}}),[a,r])),!u)return null;const f=o.createElement(o.Fragment,null,o.createElement(lr,{id:n,value:i.draggable}),o.createElement(cr,{id:m,announcement:c}));return s?l.createPortal(f,s):f}var hr,pr;function gr(){}function br(e,r){return t.useMemo(()=>({sensor:e,options:null!=r?r:{}}),[e,r])}function vr(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return t.useMemo(()=>[...r].filter(e=>null!=e),[...r])}(pr=hr||(hr={})).DragStart="dragStart",pr.DragMove="dragMove",pr.DragEnd="dragEnd",pr.DragCancel="dragCancel",pr.DragOver="dragOver",pr.RegisterDroppable="registerDroppable",pr.SetDroppableDisabled="setDroppableDisabled",pr.UnregisterDroppable="unregisterDroppable";const Nr=Object.freeze({x:0,y:0});function xr(e,r){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))}function yr(e,r){let{data:{value:t}}=e,{data:{value:s}}=r;return t-s}function Er(e,r){let{data:{value:t}}=e,{data:{value:s}}=r;return s-t}function wr(e){let{left:r,top:t,height:s,width:n}=e;return[{x:r,y:t},{x:r+n,y:t},{x:r,y:t+s},{x:r+n,y:t+s}]}function Dr(e,r){if(!e||0===e.length)return null;const[t]=e;return t[r]}function _r(e,r,t){return void 0===r&&(r=e.left),void 0===t&&(t=e.top),{x:r+.5*e.width,y:t+.5*e.height}}const Hr=e=>{let{collisionRect:r,droppableRects:t,droppableContainers:s}=e;const n=_r(r,r.left,r.top),i=[];for(const a of s){const{id:e}=a,r=t.get(e);if(r){const t=xr(_r(r),n);i.push({id:e,data:{droppableContainer:a,value:t}})}}return i.sort(yr)};function Tr(e,r){const t=Math.max(r.top,e.top),s=Math.max(r.left,e.left),n=Math.min(r.left+r.width,e.left+e.width),i=Math.min(r.top+r.height,e.top+e.height),a=n-s,o=i-t;if(s<n&&t<i){const t=r.width*r.height,s=e.width*e.height,n=a*o;return Number((n/(t+s-n)).toFixed(4))}return 0}const Sr=e=>{let{collisionRect:r,droppableRects:t,droppableContainers:s}=e;const n=[];for(const i of s){const{id:e}=i,s=t.get(e);if(s){const t=Tr(s,r);t>0&&n.push({id:e,data:{droppableContainer:i,value:t}})}}return n.sort(Er)};function jr(e,r){return e&&r?{x:e.left-r.left,y:e.top-r.top}:Nr}function kr(e){return function(r){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];return s.reduce((r,t)=>({...r,top:r.top+e*t.y,bottom:r.bottom+e*t.y,left:r.left+e*t.x,right:r.right+e*t.x}),{...r})}}const Vr=kr(1);const Cr={ignoreTransform:!1};function Rr(e,r){void 0===r&&(r=Cr);let t=e.getBoundingClientRect();if(r.ignoreTransform){const{transform:r,transformOrigin:s}=Fe(e).getComputedStyle(e);r&&(t=function(e,r,t){const s=function(e){if(e.startsWith("matrix3d(")){const r=e.slice(9,-1).split(/, /);return{x:+r[12],y:+r[13],scaleX:+r[0],scaleY:+r[5]}}if(e.startsWith("matrix(")){const r=e.slice(7,-1).split(/, /);return{x:+r[4],y:+r[5],scaleX:+r[0],scaleY:+r[3]}}return null}(r);if(!s)return e;const{scaleX:n,scaleY:i,x:a,y:o}=s,l=e.left-a-(1-n)*parseFloat(t),c=e.top-o-(1-i)*parseFloat(t.slice(t.indexOf(" ")+1)),m=n?e.width/n:e.width,u=i?e.height/i:e.height;return{width:m,height:u,top:c,right:l+m,bottom:c+u,left:l}}(t,r,s))}const{top:s,left:n,width:i,height:a,bottom:o,right:l}=t;return{top:s,left:n,width:i,height:a,bottom:o,right:l}}function Ar(e){return Rr(e,{ignoreTransform:!0})}function Mr(e,r){const t=[];return e?function s(n){if(null!=r&&t.length>=r)return t;if(!n)return t;if(Ue(n)&&null!=n.scrollingElement&&!t.includes(n.scrollingElement))return t.push(n.scrollingElement),t;if(!Be(n)||We(n))return t;if(t.includes(n))return t;const i=Fe(e).getComputedStyle(n);return n!==e&&function(e,r){void 0===r&&(r=Fe(e).getComputedStyle(e));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(e=>{const s=r[e];return"string"==typeof s&&t.test(s)})}(n,i)&&t.push(n),function(e,r){return void 0===r&&(r=Fe(e).getComputedStyle(e)),"fixed"===r.position}(n,i)?t:s(n.parentNode)}(e):t}function Ir(e){const[r]=Mr(e,1);return null!=r?r:null}function Or(e){return Oe&&e?Pe(e)?e:Le(e)?Ue(e)||e===ze(e).scrollingElement?window:Be(e)?e:null:null:null}function Pr(e){return Pe(e)?e.scrollX:e.scrollLeft}function Lr(e){return Pe(e)?e.scrollY:e.scrollTop}function Fr(e){return{x:Pr(e),y:Lr(e)}}var Ur,Br;function Wr(e){return!(!Oe||!e)&&e===document.scrollingElement}function zr(e){const r={x:0,y:0},t=Wr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-t.width,y:e.scrollHeight-t.height};return{isTop:e.scrollTop<=r.y,isLeft:e.scrollLeft<=r.x,isBottom:e.scrollTop>=s.y,isRight:e.scrollLeft>=s.x,maxScroll:s,minScroll:r}}(Br=Ur||(Ur={}))[Br.Forward=1]="Forward",Br[Br.Backward=-1]="Backward";const $r={x:.2,y:.2};function Gr(e,r,t,s,n){let{top:i,left:a,right:o,bottom:l}=t;void 0===s&&(s=10),void 0===n&&(n=$r);const{isTop:c,isBottom:m,isLeft:u,isRight:d}=zr(e),f={x:0,y:0},h={x:0,y:0},p=r.height*n.y,g=r.width*n.x;return!c&&i<=r.top+p?(f.y=Ur.Backward,h.y=s*Math.abs((r.top+p-i)/p)):!m&&l>=r.bottom-p&&(f.y=Ur.Forward,h.y=s*Math.abs((r.bottom-p-l)/p)),!d&&o>=r.right-g?(f.x=Ur.Forward,h.x=s*Math.abs((r.right-g-o)/g)):!u&&a<=r.left+g&&(f.x=Ur.Backward,h.x=s*Math.abs((r.left+g-a)/g)),{direction:f,speed:h}}function qr(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:r}=window;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}const{top:r,left:t,right:s,bottom:n}=e.getBoundingClientRect();return{top:r,left:t,right:s,bottom:n,width:e.clientWidth,height:e.clientHeight}}function Xr(e){return e.reduce((e,r)=>er(e,Fr(r)),Nr)}const Yr=[["x",["left","right"],function(e){return e.reduce((e,r)=>e+Pr(r),0)}],["y",["top","bottom"],function(e){return e.reduce((e,r)=>e+Lr(r),0)}]];class Kr{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const t=Mr(r),s=Xr(t);this.rect={...e},this.width=e.width,this.height=e.height;for(const[n,i,a]of Yr)for(const e of i)Object.defineProperty(this,e,{get:()=>{const r=a(t),i=s[n]-r;return this.rect[e]+i},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Jr{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var r;return null==(r=this.target)?void 0:r.removeEventListener(...e)})},this.target=e}add(e,r,t){var s;null==(s=this.target)||s.addEventListener(e,r,t),this.listeners.push([e,r,t])}}function Qr(e,r){const t=Math.abs(e.x),s=Math.abs(e.y);return"number"==typeof r?Math.sqrt(t**2+s**2)>r:"x"in r&&"y"in r?t>r.x&&s>r.y:"x"in r?t>r.x:"y"in r&&s>r.y}var Zr,et,rt,tt;function st(e){e.preventDefault()}function nt(e){e.stopPropagation()}(et=Zr||(Zr={})).Click="click",et.DragStart="dragstart",et.Keydown="keydown",et.ContextMenu="contextmenu",et.Resize="resize",et.SelectionChange="selectionchange",et.VisibilityChange="visibilitychange",(tt=rt||(rt={})).Space="Space",tt.Down="ArrowDown",tt.Right="ArrowRight",tt.Left="ArrowLeft",tt.Up="ArrowUp",tt.Esc="Escape",tt.Enter="Enter",tt.Tab="Tab";const it={start:[rt.Space,rt.Enter],cancel:[rt.Esc],end:[rt.Space,rt.Enter,rt.Tab]},at=(e,r)=>{let{currentCoordinates:t}=r;switch(e.code){case rt.Right:return{...t,x:t.x+25};case rt.Left:return{...t,x:t.x-25};case rt.Down:return{...t,y:t.y+25};case rt.Up:return{...t,y:t.y-25}}};class ot{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new Jr(ze(r)),this.windowListeners=new Jr(Fe(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Zr.Resize,this.handleCancel),this.windowListeners.add(Zr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Zr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,t=e.node.current;t&&function(e,r){if(void 0===r&&(r=Rr),!e)return;const{top:t,left:s,bottom:n,right:i}=r(e);Ir(e)&&(n<=0||i<=0||t>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}(t),r(Nr)}handleKeyDown(e){if(tr(e)){const{active:r,context:t,options:s}=this.props,{keyboardCodes:n=it,coordinateGetter:i=at,scrollBehavior:a="smooth"}=s,{code:o}=e;if(n.end.includes(o))return void this.handleEnd(e);if(n.cancel.includes(o))return void this.handleCancel(e);const{collisionRect:l}=t.current,c=l?{x:l.left,y:l.top}:Nr;this.referenceCoordinates||(this.referenceCoordinates=c);const m=i(e,{active:r,context:t.current,currentCoordinates:c});if(m){const r=rr(m,c),s={x:0,y:0},{scrollableAncestors:n}=t.current;for(const t of n){const n=e.code,{isTop:i,isRight:o,isLeft:l,isBottom:c,maxScroll:u,minScroll:d}=zr(t),f=qr(t),h={x:Math.min(n===rt.Right?f.right-f.width/2:f.right,Math.max(n===rt.Right?f.left:f.left+f.width/2,m.x)),y:Math.min(n===rt.Down?f.bottom-f.height/2:f.bottom,Math.max(n===rt.Down?f.top:f.top+f.height/2,m.y))},p=n===rt.Right&&!o||n===rt.Left&&!l,g=n===rt.Down&&!c||n===rt.Up&&!i;if(p&&h.x!==m.x){const e=t.scrollLeft+r.x,i=n===rt.Right&&e<=u.x||n===rt.Left&&e>=d.x;if(i&&!r.y)return void t.scrollTo({left:e,behavior:a});s.x=i?t.scrollLeft-e:n===rt.Right?t.scrollLeft-u.x:t.scrollLeft-d.x,s.x&&t.scrollBy({left:-s.x,behavior:a});break}if(g&&h.y!==m.y){const e=t.scrollTop+r.y,i=n===rt.Down&&e<=u.y||n===rt.Up&&e>=d.y;if(i&&!r.x)return void t.scrollTo({top:e,behavior:a});s.y=i?t.scrollTop-e:n===rt.Down?t.scrollTop-u.y:t.scrollTop-d.y,s.y&&t.scrollBy({top:-s.y,behavior:a});break}}this.handleMove(e,er(rr(m,this.referenceCoordinates),s))}}}handleMove(e,r){const{onMove:t}=this.props;e.preventDefault(),t(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function lt(e){return Boolean(e&&"distance"in e)}function ct(e){return Boolean(e&&"delay"in e)}ot.activators=[{eventName:"onKeyDown",handler:(e,r,t)=>{let{keyboardCodes:s=it,onActivation:n}=r,{active:i}=t;const{code:a}=e.nativeEvent;if(s.start.includes(a)){const r=i.activatorNode.current;return(!r||e.target===r)&&(e.preventDefault(),null==n||n({event:e.nativeEvent}),!0)}return!1}}];class mt{constructor(e,r,t){var s;void 0===t&&(t=function(e){const{EventTarget:r}=Fe(e);return e instanceof r?e:ze(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:n}=e,{target:i}=n;this.props=e,this.events=r,this.document=ze(i),this.documentListeners=new Jr(this.document),this.listeners=new Jr(t),this.windowListeners=new Jr(Fe(i)),this.initialCoordinates=null!=(s=sr(n))?s:Nr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:t}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Zr.Resize,this.handleCancel),this.windowListeners.add(Zr.DragStart,st),this.windowListeners.add(Zr.VisibilityChange,this.handleCancel),this.windowListeners.add(Zr.ContextMenu,st),this.documentListeners.add(Zr.Keydown,this.handleKeydown),r){if(null!=t&&t({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ct(r))return this.timeoutId=setTimeout(this.handleStart,r.delay),void this.handlePending(r);if(lt(r))return void this.handlePending(r)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:t,onPending:s}=this.props;s(t,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(Zr.Click,nt,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Zr.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:t,initialCoordinates:s,props:n}=this,{onMove:i,options:{activationConstraint:a}}=n;if(!s)return;const o=null!=(r=sr(e))?r:Nr,l=rr(s,o);if(!t&&a){if(lt(a)){if(null!=a.tolerance&&Qr(l,a.tolerance))return this.handleCancel();if(Qr(l,a.distance))return this.handleStart()}return ct(a)&&Qr(l,a.tolerance)?this.handleCancel():void this.handlePending(a,l)}e.cancelable&&e.preventDefault(),i(o)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===rt.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const ut={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class dt extends mt{constructor(e){const{event:r}=e,t=ze(r.target);super(e,ut,t)}}dt.activators=[{eventName:"onPointerDown",handler:(e,r)=>{let{nativeEvent:t}=e,{onActivation:s}=r;return!(!t.isPrimary||0!==t.button)&&(null==s||s({event:t}),!0)}}];const ft={move:{name:"mousemove"},end:{name:"mouseup"}};var ht,pt;(pt=ht||(ht={}))[pt.RightClick=2]="RightClick";(class extends mt{constructor(e){super(e,ft,ze(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:(e,r)=>{let{nativeEvent:t}=e,{onActivation:s}=r;return t.button!==ht.RightClick&&(null==s||s({event:t}),!0)}}];const gt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var bt,vt,Nt,xt;function yt(e){let{acceleration:r,activator:s=bt.Pointer,canScroll:n,draggingRect:i,enabled:a,interval:o=5,order:l=Nt.TreeOrder,pointerCoordinates:c,scrollableAncestors:m,scrollableAncestorRects:u,delta:d,threshold:f}=e;const h=function(e){let{delta:r,disabled:t}=e;const s=Ke(r);return Xe(e=>{if(t||!s||!e)return Et;const n={x:Math.sign(r.x-s.x),y:Math.sign(r.y-s.y)};return{x:{[Ur.Backward]:e.x[Ur.Backward]||-1===n.x,[Ur.Forward]:e.x[Ur.Forward]||1===n.x},y:{[Ur.Backward]:e.y[Ur.Backward]||-1===n.y,[Ur.Forward]:e.y[Ur.Forward]||1===n.y}}},[t,r,s])}({delta:d,disabled:!a}),[p,g]=function(){const e=t.useRef(null);return[t.useCallback((r,t)=>{e.current=setInterval(r,t)},[]),t.useCallback(()=>{null!==e.current&&(clearInterval(e.current),e.current=null)},[])]}(),b=t.useRef({x:0,y:0}),v=t.useRef({x:0,y:0}),N=t.useMemo(()=>{switch(s){case bt.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case bt.DraggableRect:return i}},[s,i,c]),x=t.useRef(null),y=t.useCallback(()=>{const e=x.current;if(!e)return;const r=b.current.x*v.current.x,t=b.current.y*v.current.y;e.scrollBy(r,t)},[]),E=t.useMemo(()=>l===Nt.TreeOrder?[...m].reverse():m,[l,m]);t.useEffect(()=>{if(a&&m.length&&N){for(const e of E){if(!1===(null==n?void 0:n(e)))continue;const t=m.indexOf(e),s=u[t];if(!s)continue;const{direction:i,speed:a}=Gr(e,s,N,r,f);for(const e of["x","y"])h[e][i[e]]||(a[e]=0,i[e]=0);if(a.x>0||a.y>0)return g(),x.current=e,p(y,o),b.current=a,void(v.current=i)}b.current={x:0,y:0},v.current={x:0,y:0},g()}else g()},[r,y,n,g,a,o,JSON.stringify(N),JSON.stringify(h),p,m,E,u,JSON.stringify(f)])}(class extends mt{constructor(e){super(e,gt)}static setup(){return window.addEventListener(gt.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(gt.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,r)=>{let{nativeEvent:t}=e,{onActivation:s}=r;const{touches:n}=t;return!(n.length>1)&&(null==s||s({event:t}),!0)}}],(vt=bt||(bt={}))[vt.Pointer=0]="Pointer",vt[vt.DraggableRect=1]="DraggableRect",(xt=Nt||(Nt={}))[xt.TreeOrder=0]="TreeOrder",xt[xt.ReversedTreeOrder=1]="ReversedTreeOrder";const Et={x:{[Ur.Backward]:!1,[Ur.Forward]:!1},y:{[Ur.Backward]:!1,[Ur.Forward]:!1}};var wt,Dt,_t;(Dt=wt||(wt={}))[Dt.Always=0]="Always",Dt[Dt.BeforeDragging=1]="BeforeDragging",Dt[Dt.WhileDragging=2]="WhileDragging",(_t||(_t={})).Optimized="optimized";const Ht=new Map;function Tt(e,r){return Xe(t=>e?t||("function"==typeof r?r(e):e):null,[r,e])}function St(e){let{callback:r,disabled:s}=e;const n=Ge(r),i=t.useMemo(()=>{if(s||"undefined"==typeof window||void 0===window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(n)},[s]);return t.useEffect(()=>()=>null==i?void 0:i.disconnect(),[i]),i}function jt(e){return new Kr(Rr(e),e)}function kt(e,r,s){void 0===r&&(r=jt);const[n,i]=t.useState(null);function a(){i(t=>{if(!e)return null;var n;if(!1===e.isConnected)return null!=(n=null!=t?t:s)?n:null;const i=r(e);return JSON.stringify(t)===JSON.stringify(i)?t:i})}const o=function(e){let{callback:r,disabled:s}=e;const n=Ge(r),i=t.useMemo(()=>{if(s||"undefined"==typeof window||void 0===window.MutationObserver)return;const{MutationObserver:e}=window;return new e(n)},[n,s]);return t.useEffect(()=>()=>null==i?void 0:i.disconnect(),[i]),i}({callback(r){if(e)for(const t of r){const{type:r,target:s}=t;if("childList"===r&&s instanceof HTMLElement&&s.contains(e)){a();break}}}}),l=St({callback:a});return $e(()=>{a(),e?(null==l||l.observe(e),null==o||o.observe(document.body,{childList:!0,subtree:!0})):(null==l||l.disconnect(),null==o||o.disconnect())},[e]),n}const Vt=[];function Ct(e,r){void 0===r&&(r=[]);const s=t.useRef(null);return t.useEffect(()=>{s.current=null},r),t.useEffect(()=>{const r=e!==Nr;r&&!s.current&&(s.current=e),!r&&s.current&&(s.current=null)},[e]),s.current?rr(e,s.current):Nr}function Rt(e){return t.useMemo(()=>e?function(e){const r=e.innerWidth,t=e.innerHeight;return{top:0,left:0,right:r,bottom:t,width:r,height:t}}(e):null,[e])}const At=[];function Mt(e){let{measure:r}=e;const[s,n]=t.useState(null),i=St({callback:t.useCallback(e=>{for(const{target:t}of e)if(Be(t)){n(e=>{const s=r(t);return e?{...e,width:s.width,height:s.height}:s});break}},[r])}),a=t.useCallback(e=>{const t=function(e){if(!e)return null;if(e.children.length>1)return e;const r=e.children[0];return Be(r)?r:e}(e);null==i||i.disconnect(),t&&(null==i||i.observe(t)),n(t?r(t):null)},[r,i]),[o,l]=Ye(a);return t.useMemo(()=>({nodeRef:o,rect:s,setRef:l}),[s,o,l])}const It=[{sensor:dt,options:{}},{sensor:ot,options:{}}],Ot={current:{}},Pt={draggable:{measure:Ar},droppable:{measure:Ar,strategy:wt.WhileDragging,frequency:_t.Optimized},dragOverlay:{measure:Rr}};class Lt extends Map{get(e){var r;return null!=e&&null!=(r=super.get(e))?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,t;return null!=(r=null==(t=this.get(e))?void 0:t.node.current)?r:void 0}}const Ft={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Lt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:gr},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Pt,measureDroppableContainers:gr,windowRect:null,measuringScheduled:!1},Ut={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:gr,draggableNodes:new Map,over:null,measureDroppableContainers:gr},Bt=t.createContext(Ut),Wt=t.createContext(Ft);function zt(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Lt}}}function $t(e,r){switch(r.type){case hr.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:r.initialCoordinates,active:r.active}};case hr.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:r.coordinates.x-e.draggable.initialCoordinates.x,y:r.coordinates.y-e.draggable.initialCoordinates.y}}};case hr.DragEnd:case hr.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case hr.RegisterDroppable:{const{element:t}=r,{id:s}=t,n=new Lt(e.droppable.containers);return n.set(s,t),{...e,droppable:{...e.droppable,containers:n}}}case hr.SetDroppableDisabled:{const{id:t,key:s,disabled:n}=r,i=e.droppable.containers.get(t);if(!i||s!==i.key)return e;const a=new Lt(e.droppable.containers);return a.set(t,{...i,disabled:n}),{...e,droppable:{...e.droppable,containers:a}}}case hr.UnregisterDroppable:{const{id:t,key:s}=r,n=e.droppable.containers.get(t);if(!n||s!==n.key)return e;const i=new Lt(e.droppable.containers);return i.delete(t),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Gt(e){let{disabled:r}=e;const{active:s,activatorEvent:n,draggableNodes:i}=t.useContext(Bt),a=Ke(n),o=Ke(null==s?void 0:s.id);return t.useEffect(()=>{if(!r&&!n&&a&&null!=o){if(!tr(a))return;if(document.activeElement===a.target)return;const e=i.get(o);if(!e)return;const{activatorNode:r,node:t}=e;if(!r.current&&!t.current)return;requestAnimationFrame(()=>{for(const e of[r.current,t.current]){if(!e)continue;const r=ar(e);if(r){r.focus();break}}})}},[n,r,i,o,a]),null}const qt=t.createContext({...Nr,scaleX:1,scaleY:1});var Xt,Yt;(Yt=Xt||(Xt={}))[Yt.Uninitialized=0]="Uninitialized",Yt[Yt.Initializing=1]="Initializing",Yt[Yt.Initialized=2]="Initialized";const Kt=t.memo(function(e){var r,s,n,i;let{id:a,accessibility:c,autoScroll:m=!0,children:u,sensors:d=It,collisionDetection:f=Sr,measuring:h,modifiers:p,...g}=e;const b=t.useReducer($t,void 0,zt),[v,N]=b,[x,y]=function(){const[e]=t.useState(()=>new Set),r=t.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[t.useCallback(r=>{let{type:t,event:s}=r;e.forEach(e=>{var r;return null==(r=e[t])?void 0:r.call(e,s)})},[e]),r]}(),[E,w]=t.useState(Xt.Uninitialized),D=E===Xt.Initialized,{draggable:{active:_,nodes:H,translate:T},droppable:{containers:S}}=v,j=null!=_?H.get(_):null,k=t.useRef({initial:null,translated:null}),V=t.useMemo(()=>{var e;return null!=_?{id:_,data:null!=(e=null==j?void 0:j.data)?e:Ot,rect:k}:null},[_,j]),C=t.useRef(null),[R,A]=t.useState(null),[M,I]=t.useState(null),O=qe(g,Object.values(g)),P=Qe("DndDescribedBy",a),L=t.useMemo(()=>S.getEnabled(),[S]),F=(U=h,t.useMemo(()=>({draggable:{...Pt.draggable,...null==U?void 0:U.draggable},droppable:{...Pt.droppable,...null==U?void 0:U.droppable},dragOverlay:{...Pt.dragOverlay,...null==U?void 0:U.dragOverlay}}),[null==U?void 0:U.draggable,null==U?void 0:U.droppable,null==U?void 0:U.dragOverlay]));var U;const{droppableRects:B,measureDroppableContainers:W,measuringScheduled:z}=function(e,r){let{dragging:s,dependencies:n,config:i}=r;const[a,o]=t.useState(null),{frequency:l,measure:c,strategy:m}=i,u=t.useRef(e),d=function(){switch(m){case wt.Always:return!1;case wt.BeforeDragging:return s;default:return!s}}(),f=qe(d),h=t.useCallback(function(e){void 0===e&&(e=[]),f.current||o(r=>null===r?e:r.concat(e.filter(e=>!r.includes(e))))},[f]),p=t.useRef(null),g=Xe(r=>{if(d&&!s)return Ht;if(!r||r===Ht||u.current!==e||null!=a){const r=new Map;for(let t of e){if(!t)continue;if(a&&a.length>0&&!a.includes(t.id)&&t.rect.current){r.set(t.id,t.rect.current);continue}const e=t.node.current,s=e?new Kr(c(e),e):null;t.rect.current=s,s&&r.set(t.id,s)}return r}return r},[e,a,s,d,c]);return t.useEffect(()=>{u.current=e},[e]),t.useEffect(()=>{d||h()},[s,d]),t.useEffect(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),t.useEffect(()=>{d||"number"!=typeof l||null!==p.current||(p.current=setTimeout(()=>{h(),p.current=null},l))},[l,d,h,...n]),{droppableRects:g,measureDroppableContainers:h,measuringScheduled:null!=a}}(L,{dragging:D,dependencies:[T.x,T.y],config:F.droppable}),$=function(e,r){const t=null!=r?e.get(r):void 0,s=t?t.node.current:null;return Xe(e=>{var t;return null==r?null:null!=(t=null!=s?s:e)?t:null},[s,r])}(H,_),G=t.useMemo(()=>M?sr(M):null,[M]),q=function(){const e=!1===(null==R?void 0:R.autoScrollEnabled),r="object"==typeof m?!1===m.enabled:!1===m,t=D&&!e&&!r;if("object"==typeof m)return{...m,enabled:t};return{enabled:t}}(),X=function(e,r){return Tt(e,r)}($,F.draggable.measure);!function(e){let{activeNode:r,measure:s,initialRect:n,config:i=!0}=e;const a=t.useRef(!1),{x:o,y:l}="boolean"==typeof i?{x:i,y:i}:i;$e(()=>{if(!o&&!l||!r)return void(a.current=!1);if(a.current||!n)return;const e=null==r?void 0:r.node.current;if(!e||!1===e.isConnected)return;const t=jr(s(e),n);if(o||(t.x=0),l||(t.y=0),a.current=!0,Math.abs(t.x)>0||Math.abs(t.y)>0){const r=Ir(e);r&&r.scrollBy({top:t.y,left:t.x})}},[r,o,l,n,s])}({activeNode:null!=_?H.get(_):null,config:q.layoutShiftCompensation,initialRect:X,measure:F.draggable.measure});const Y=kt($,F.draggable.measure,X),K=kt($?$.parentElement:null),J=t.useRef({activatorEvent:null,active:null,activeNode:$,collisionRect:null,collisions:null,droppableRects:B,draggableNodes:H,draggingNode:null,draggingNodeRect:null,droppableContainers:S,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Q=S.getNodeFor(null==(r=J.current.over)?void 0:r.id),Z=Mt({measure:F.dragOverlay.measure}),ee=null!=(s=Z.nodeRef.current)?s:$,re=D?null!=(n=Z.rect)?n:Y:null,te=Boolean(Z.nodeRef.current&&Z.rect),se=jr(ne=te?null:Y,Tt(ne));var ne;const ie=Rt(ee?Fe(ee):null),ae=function(e){const r=t.useRef(e),s=Xe(t=>e?t&&t!==Vt&&e&&r.current&&e.parentNode===r.current.parentNode?t:Mr(e):Vt,[e]);return t.useEffect(()=>{r.current=e},[e]),s}(D?null!=Q?Q:$:null),oe=function(e,r){void 0===r&&(r=Rr);const[s]=e,n=Rt(s?Fe(s):null),[i,a]=t.useState(At);function o(){a(()=>e.length?e.map(e=>Wr(e)?n:new Kr(r(e),e)):At)}const l=St({callback:o});return $e(()=>{null==l||l.disconnect(),o(),e.forEach(e=>null==l?void 0:l.observe(e))},[e]),i}(ae),le=function(e,r){let{transform:t,...s}=r;return null!=e&&e.length?e.reduce((e,r)=>r({transform:e,...s}),t):t}(p,{transform:{x:T.x-se.x,y:T.y-se.y,scaleX:1,scaleY:1},activatorEvent:M,active:V,activeNodeRect:Y,containerNodeRect:K,draggingNodeRect:re,over:J.current.over,overlayNodeRect:Z.rect,scrollableAncestors:ae,scrollableAncestorRects:oe,windowRect:ie}),ce=G?er(G,T):null,me=function(e){const[r,s]=t.useState(null),n=t.useRef(e),i=t.useCallback(e=>{const r=Or(e.target);r&&s(e=>e?(e.set(r,Fr(r)),new Map(e)):null)},[]);return t.useEffect(()=>{const r=n.current;if(e!==r){t(r);const a=e.map(e=>{const r=Or(e);return r?(r.addEventListener("scroll",i,{passive:!0}),[r,Fr(r)]):null}).filter(e=>null!=e);s(a.length?new Map(a):null),n.current=e}return()=>{t(e),t(r)};function t(e){e.forEach(e=>{const r=Or(e);null==r||r.removeEventListener("scroll",i)})}},[i,e]),t.useMemo(()=>e.length?r?Array.from(r.values()).reduce((e,r)=>er(e,r),Nr):Xr(e):Nr,[e,r])}(ae),ue=Ct(me),de=Ct(me,[Y]),fe=er(le,ue),he=re?Vr(re,le):null,pe=V&&he?f({active:V,collisionRect:he,droppableRects:B,droppableContainers:L,pointerCoordinates:ce}):null,ge=Dr(pe,"id"),[be,ve]=t.useState(null),Ne=function(e,r,t){return{...e,scaleX:r&&t?r.width/t.width:1,scaleY:r&&t?r.height/t.height:1}}(te?le:er(le,de),null!=(i=null==be?void 0:be.rect)?i:null,Y),xe=t.useRef(null),ye=t.useCallback((e,r)=>{let{sensor:t,options:s}=r;if(null==C.current)return;const n=H.get(C.current);if(!n)return;const i=e.nativeEvent,a=new t({active:C.current,activeNode:n,event:i,options:s,context:J,onAbort(e){if(!H.get(e))return;const{onDragAbort:r}=O.current,t={id:e};null==r||r(t),x({type:"onDragAbort",event:t})},onPending(e,r,t,s){if(!H.get(e))return;const{onDragPending:n}=O.current,i={id:e,constraint:r,initialCoordinates:t,offset:s};null==n||n(i),x({type:"onDragPending",event:i})},onStart(e){const r=C.current;if(null==r)return;const t=H.get(r);if(!t)return;const{onDragStart:s}=O.current,n={activatorEvent:i,active:{id:r,data:t.data,rect:k}};l.unstable_batchedUpdates(()=>{null==s||s(n),w(Xt.Initializing),N({type:hr.DragStart,initialCoordinates:e,active:r}),x({type:"onDragStart",event:n}),A(xe.current),I(i)})},onMove(e){N({type:hr.DragMove,coordinates:e})},onEnd:o(hr.DragEnd),onCancel:o(hr.DragCancel)});function o(e){return async function(){const{active:r,collisions:t,over:s,scrollAdjustedTranslate:n}=J.current;let a=null;if(r&&n){const{cancelDrop:o}=O.current;if(a={activatorEvent:i,active:r,collisions:t,delta:n,over:s},e===hr.DragEnd&&"function"==typeof o){await Promise.resolve(o(a))&&(e=hr.DragCancel)}}C.current=null,l.unstable_batchedUpdates(()=>{N({type:e}),w(Xt.Uninitialized),ve(null),A(null),I(null),xe.current=null;const r=e===hr.DragEnd?"onDragEnd":"onDragCancel";if(a){const e=O.current[r];null==e||e(a),x({type:r,event:a})}})}}xe.current=a},[H]),Ee=function(e,r){return t.useMemo(()=>e.reduce((e,t)=>{const{sensor:s}=t;return[...e,...s.activators.map(e=>({eventName:e.eventName,handler:r(e.handler,t)}))]},[]),[e,r])}(d,t.useCallback((e,r)=>(t,s)=>{const n=t.nativeEvent,i=H.get(s);if(null!==C.current||!i||n.dndKit||n.defaultPrevented)return;const a={active:i};!0===e(t,r.options,a)&&(n.dndKit={capturedBy:r.sensor},C.current=s,ye(t,r))},[H,ye]));!function(e){t.useEffect(()=>{if(!Oe)return;const r=e.map(e=>{let{sensor:r}=e;return null==r.setup?void 0:r.setup()});return()=>{for(const e of r)null==e||e()}},e.map(e=>{let{sensor:r}=e;return r}))}(d),$e(()=>{Y&&E===Xt.Initializing&&w(Xt.Initialized)},[Y,E]),t.useEffect(()=>{const{onDragMove:e}=O.current,{active:r,activatorEvent:t,collisions:s,over:n}=J.current;if(!r||!t)return;const i={active:r,activatorEvent:t,collisions:s,delta:{x:fe.x,y:fe.y},over:n};l.unstable_batchedUpdates(()=>{null==e||e(i),x({type:"onDragMove",event:i})})},[fe.x,fe.y]),t.useEffect(()=>{const{active:e,activatorEvent:r,collisions:t,droppableContainers:s,scrollAdjustedTranslate:n}=J.current;if(!e||null==C.current||!r||!n)return;const{onDragOver:i}=O.current,a=s.get(ge),o=a&&a.rect.current?{id:a.id,rect:a.rect.current,data:a.data,disabled:a.disabled}:null,c={active:e,activatorEvent:r,collisions:t,delta:{x:n.x,y:n.y},over:o};l.unstable_batchedUpdates(()=>{ve(o),null==i||i(c),x({type:"onDragOver",event:c})})},[ge]),$e(()=>{J.current={activatorEvent:M,active:V,activeNode:$,collisionRect:he,collisions:pe,droppableRects:B,draggableNodes:H,draggingNode:ee,draggingNodeRect:re,droppableContainers:S,over:be,scrollableAncestors:ae,scrollAdjustedTranslate:fe},k.current={initial:re,translated:he}},[V,$,pe,he,H,ee,re,B,S,be,ae,fe]),yt({...q,delta:T,draggingRect:he,pointerCoordinates:ce,scrollableAncestors:ae,scrollableAncestorRects:oe});const we=t.useMemo(()=>({active:V,activeNode:$,activeNodeRect:Y,activatorEvent:M,collisions:pe,containerNodeRect:K,dragOverlay:Z,draggableNodes:H,droppableContainers:S,droppableRects:B,over:be,measureDroppableContainers:W,scrollableAncestors:ae,scrollableAncestorRects:oe,measuringConfiguration:F,measuringScheduled:z,windowRect:ie}),[V,$,Y,M,pe,K,Z,H,S,B,be,W,ae,oe,F,z,ie]),De=t.useMemo(()=>({activatorEvent:M,activators:Ee,active:V,activeNodeRect:Y,ariaDescribedById:{draggable:P},dispatch:N,draggableNodes:H,over:be,measureDroppableContainers:W}),[M,Ee,V,Y,N,P,H,be,W]);return o.createElement(mr.Provider,{value:y},o.createElement(Bt.Provider,{value:De},o.createElement(Wt.Provider,{value:we},o.createElement(qt.Provider,{value:Ne},u)),o.createElement(Gt,{disabled:!1===(null==c?void 0:c.restoreFocus)})),o.createElement(fr,{...c,hiddenTextDescribedById:P}))}),Jt=t.createContext(null),Qt="button";function Zt(e){let{id:r,data:s,disabled:n=!1,attributes:i}=e;const a=Qe("Draggable"),{activators:o,activatorEvent:l,active:c,activeNodeRect:m,ariaDescribedById:u,draggableNodes:d,over:f}=t.useContext(Bt),{role:h=Qt,roleDescription:p="draggable",tabIndex:g=0}=null!=i?i:{},b=(null==c?void 0:c.id)===r,v=t.useContext(b?qt:Jt),[N,x]=Ye(),[y,E]=Ye(),w=function(e,r){return t.useMemo(()=>e.reduce((e,t)=>{let{eventName:s,handler:n}=t;return e[s]=e=>{n(e,r)},e},{}),[e,r])}(o,r),D=qe(s);$e(()=>(d.set(r,{id:r,key:a,node:N,activatorNode:y,data:D}),()=>{const e=d.get(r);e&&e.key===a&&d.delete(r)}),[d,r]);return{active:c,activatorEvent:l,activeNodeRect:m,attributes:t.useMemo(()=>({role:h,tabIndex:g,"aria-disabled":n,"aria-pressed":!(!b||h!==Qt)||void 0,"aria-roledescription":p,"aria-describedby":u.draggable}),[n,h,g,b,p,u.draggable]),isDragging:b,listeners:n?void 0:w,node:N,over:f,setNodeRef:x,setActivatorNodeRef:E,transform:v}}const es={timeout:25};function rs(e,r,t){const s=e.slice();return s.splice(t<0?s.length+t:t,0,s.splice(r,1)[0]),s}function ts(e,r){return e.reduce((e,t,s)=>{const n=r.get(t);return n&&(e[s]=n),e},Array(e.length))}function ss(e){return null!==e&&e>=0}const ns=e=>{let{rects:r,activeIndex:t,overIndex:s,index:n}=e;const i=rs(r,s,t),a=r[n],o=i[n];return o&&a?{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}:null},is={scaleX:1,scaleY:1},as=e=>{var r;let{activeIndex:t,activeNodeRect:s,index:n,rects:i,overIndex:a}=e;const o=null!=(r=i[t])?r:s;if(!o)return null;if(n===t){const e=i[a];return e?{x:0,y:t<a?e.top+e.height-(o.top+o.height):e.top-o.top,...is}:null}const l=function(e,r,t){const s=e[r],n=e[r-1],i=e[r+1];if(!s)return 0;if(t<r)return n?s.top-(n.top+n.height):i?i.top-(s.top+s.height):0;return i?i.top-(s.top+s.height):n?s.top-(n.top+n.height):0}(i,n,t);return n>t&&n<=a?{x:0,y:-o.height-l,...is}:n<t&&n>=a?{x:0,y:o.height+l,...is}:{x:0,y:0,...is}};const os="Sortable",ls=o.createContext({activeIndex:-1,containerId:os,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:ns,disabled:{draggable:!1,droppable:!1}});function cs(e){let{children:r,id:s,items:n,strategy:i=ns,disabled:a=!1}=e;const{active:l,dragOverlay:c,droppableRects:m,over:u,measureDroppableContainers:d}=t.useContext(Wt),f=Qe(os,s),h=Boolean(null!==c.rect),p=t.useMemo(()=>n.map(e=>"object"==typeof e&&"id"in e?e.id:e),[n]),g=null!=l,b=l?p.indexOf(l.id):-1,v=u?p.indexOf(u.id):-1,N=t.useRef(p),x=!function(e,r){if(e===r)return!0;if(e.length!==r.length)return!1;for(let t=0;t<e.length;t++)if(e[t]!==r[t])return!1;return!0}(p,N.current),y=-1!==v&&-1===b||x,E=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(a);$e(()=>{x&&g&&d(p)},[x,p,g,d]),t.useEffect(()=>{N.current=p},[p]);const w=t.useMemo(()=>({activeIndex:b,containerId:f,disabled:E,disableTransforms:y,items:p,overIndex:v,useDragOverlay:h,sortedRects:ts(p,m),strategy:i}),[b,f,E.draggable,E.droppable,y,p,v,m,h,i]);return o.createElement(ls.Provider,{value:w},r)}const ms=e=>{let{id:r,items:t,activeIndex:s,overIndex:n}=e;return rs(t,s,n).indexOf(r)},us=e=>{let{containerId:r,isSorting:t,wasDragging:s,index:n,items:i,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!(!c||!s)&&((o===i||n!==a)&&(!!t||a!==n&&r===l))},ds={duration:200,easing:"ease"},fs="transform",hs=nr.Transition.toString({property:fs,duration:0,easing:"linear"}),ps={roleDescription:"sortable"};function gs(e){let{animateLayoutChanges:r=us,attributes:s,disabled:n,data:i,getNewIndex:a=ms,id:o,strategy:l,resizeObserverConfig:c,transition:m=ds}=e;const{items:u,containerId:d,activeIndex:f,disabled:h,disableTransforms:p,sortedRects:g,overIndex:b,useDragOverlay:v,strategy:N}=t.useContext(ls),x=function(e,r){var t,s;if("boolean"==typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(t=null==e?void 0:e.draggable)?t:r.draggable,droppable:null!=(s=null==e?void 0:e.droppable)?s:r.droppable}}(n,h),y=u.indexOf(o),E=t.useMemo(()=>({sortable:{containerId:d,index:y,items:u},...i}),[d,i,y,u]),w=t.useMemo(()=>u.slice(u.indexOf(o)),[u,o]),{rect:D,node:_,isOver:H,setNodeRef:T}=function(e){let{data:r,disabled:s=!1,id:n,resizeObserverConfig:i}=e;const a=Qe("Droppable"),{active:o,dispatch:l,over:c,measureDroppableContainers:m}=t.useContext(Bt),u=t.useRef({disabled:s}),d=t.useRef(!1),f=t.useRef(null),h=t.useRef(null),{disabled:p,updateMeasurementsFor:g,timeout:b}={...es,...i},v=qe(null!=g?g:n),N=St({callback:t.useCallback(()=>{d.current?(null!=h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{m(Array.isArray(v.current)?v.current:[v.current]),h.current=null},b)):d.current=!0},[b]),disabled:p||!o}),x=t.useCallback((e,r)=>{N&&(r&&(N.unobserve(r),d.current=!1),e&&N.observe(e))},[N]),[y,E]=Ye(x),w=qe(r);return t.useEffect(()=>{N&&y.current&&(N.disconnect(),d.current=!1,N.observe(y.current))},[y,N]),t.useEffect(()=>(l({type:hr.RegisterDroppable,element:{id:n,key:a,disabled:s,node:y,rect:f,data:w}}),()=>l({type:hr.UnregisterDroppable,key:a,id:n})),[n]),t.useEffect(()=>{s!==u.current.disabled&&(l({type:hr.SetDroppableDisabled,id:n,key:a,disabled:s}),u.current.disabled=s)},[n,a,s,l]),{active:o,rect:f,isOver:(null==c?void 0:c.id)===n,node:y,over:c,setNodeRef:E}}({id:o,data:E,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:w,...c}}),{active:S,activatorEvent:j,activeNodeRect:k,attributes:V,setNodeRef:C,listeners:R,isDragging:A,over:M,setActivatorNodeRef:I,transform:O}=Zt({id:o,data:E,attributes:{...ps,...s},disabled:x.draggable}),P=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return t.useMemo(()=>e=>{r.forEach(r=>r(e))},r)}(T,C),L=Boolean(S),F=L&&!p&&ss(f)&&ss(b),U=!v&&A,B=U&&F?O:null,W=F?null!=B?B:(null!=l?l:N)({rects:g,activeNodeRect:k,activeIndex:f,overIndex:b,index:y}):null,z=ss(f)&&ss(b)?a({id:o,items:u,activeIndex:f,overIndex:b}):y,$=null==S?void 0:S.id,G=t.useRef({activeId:$,items:u,newIndex:z,containerId:d}),q=u!==G.current.items,X=r({active:S,containerId:d,isDragging:A,isSorting:L,id:o,index:y,items:u,newIndex:G.current.newIndex,previousItems:G.current.items,previousContainerId:G.current.containerId,transition:m,wasDragging:null!=G.current.activeId}),Y=function(e){let{disabled:r,index:s,node:n,rect:i}=e;const[a,o]=t.useState(null),l=t.useRef(s);return $e(()=>{if(!r&&s!==l.current&&n.current){const e=i.current;if(e){const r=Rr(n.current,{ignoreTransform:!0}),t={x:e.left-r.left,y:e.top-r.top,scaleX:e.width/r.width,scaleY:e.height/r.height};(t.x||t.y)&&o(t)}}s!==l.current&&(l.current=s)},[r,s,n,i]),t.useEffect(()=>{a&&o(null)},[a]),a}({disabled:!X,index:y,node:_,rect:D});return t.useEffect(()=>{L&&G.current.newIndex!==z&&(G.current.newIndex=z),d!==G.current.containerId&&(G.current.containerId=d),u!==G.current.items&&(G.current.items=u)},[L,z,d,u]),t.useEffect(()=>{if($===G.current.activeId)return;if(null!=$&&null==G.current.activeId)return void(G.current.activeId=$);const e=setTimeout(()=>{G.current.activeId=$},50);return()=>clearTimeout(e)},[$]),{active:S,activeIndex:f,attributes:V,data:E,rect:D,index:y,newIndex:z,items:u,isOver:H,isSorting:L,isDragging:A,listeners:R,node:_,overIndex:b,over:M,setNodeRef:P,setActivatorNodeRef:I,setDroppableNodeRef:T,setDraggableNodeRef:C,transform:null!=Y?Y:W,transition:function(){if(Y||q&&G.current.newIndex===y)return hs;if(U&&!tr(j)||!m)return;if(L||X)return nr.Transition.toString({...m,property:fs});return}()}}function bs(e){if(!e)return!1;const r=e.data.current;return!!(r&&"sortable"in r&&"object"==typeof r.sortable&&"containerId"in r.sortable&&"items"in r.sortable&&"index"in r.sortable)}const vs=[rt.Down,rt.Right,rt.Up,rt.Left],Ns=(e,r)=>{let{context:{active:t,collisionRect:s,droppableRects:n,droppableContainers:i,over:a,scrollableAncestors:o}}=r;if(vs.includes(e.code)){if(e.preventDefault(),!t||!s)return;const r=[];i.getEnabled().forEach(t=>{if(!t||null!=t&&t.disabled)return;const i=n.get(t.id);if(i)switch(e.code){case rt.Down:s.top<i.top&&r.push(t);break;case rt.Up:s.top>i.top&&r.push(t);break;case rt.Left:s.left>i.left&&r.push(t);break;case rt.Right:s.left<i.left&&r.push(t)}});const l=(e=>{let{collisionRect:r,droppableRects:t,droppableContainers:s}=e;const n=wr(r),i=[];for(const a of s){const{id:e}=a,r=t.get(e);if(r){const t=wr(r),s=n.reduce((e,r,s)=>e+xr(t[s],r),0),o=Number((s/4).toFixed(4));i.push({id:e,data:{droppableContainer:a,value:o}})}}return i.sort(yr)})({collisionRect:s,droppableRects:n,droppableContainers:r});let c=Dr(l,"id");if(c===(null==a?void 0:a.id)&&l.length>1&&(c=l[1].id),null!=c){const e=i.get(t.id),r=i.get(c),a=r?n.get(r.id):null,l=null==r?void 0:r.node.current;if(l&&a&&e&&r){const t=Mr(l).some((e,r)=>o[r]!==e),n=xs(e,r),i=function(e,r){if(!bs(e)||!bs(r))return!1;if(!xs(e,r))return!1;return e.data.current.sortable.index<r.data.current.sortable.index}(e,r),c=t||!n?{x:0,y:0}:{x:i?s.width-a.width:0,y:i?s.height-a.height:0},m={x:a.left,y:a.top};return c.x&&c.y?m:rr(m,c)}}}};function xs(e,r){return!(!bs(e)||!bs(r))&&e.data.current.sortable.containerId===r.data.current.sortable.containerId}const ys={Clock:M,BarChart3:A,Settings:D,Users:R,Building2:C,CheckCircle:V,Shield:T,Key:k,User:x,Building:E,Cog:j,Activity:S};function Es({module:e,index:r,isDragMode:t}){const{attributes:s,listeners:n,setNodeRef:i,transform:o,transition:l,isDragging:c}=gs({id:e.id}),m={transform:nr.Transform.toString(o),transition:l},u=ys[e.icon];return e.isPlaceholder?null:pe.jsxDEV("div",{ref:i,style:m,className:`transition-all duration-200 ${c?"transform rotate-3 scale-105 shadow-2xl shadow-green-500/20 opacity-50 z-50":""} ${t?"cursor-grabbing":""}`,children:pe.jsxDEV("div",{...s,...n,className:""+(t?"cursor-grabbing":"cursor-pointer"),children:pe.jsxDEV(a,{to:e.path,className:"group block",onClick:e=>{t&&(e.preventDefault(),e.stopPropagation())},children:pe.jsxDEV("div",{className:"relative bg-gray-800 rounded-xl border border-gray-700 hover:border-green-400/60 transition-all duration-300 hover:transform hover:scale-[1.02] hover:shadow-xl hover:shadow-green-500/10 min-h-[140px] backdrop-blur-sm "+(t?"pointer-events-none":""),children:[pe.jsxDEV("div",{className:"bg-gray-800 border-b border-green-600 p-4 rounded-t-xl",children:pe.jsxDEV("div",{className:"flex items-center justify-between",children:[pe.jsxDEV("div",{className:"flex items-center space-x-3",children:[pe.jsxDEV("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center group-hover:from-green-400 group-hover:to-green-500 transition-all duration-300",children:pe.jsxDEV(u,{className:"w-5 h-5 text-white"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:119,columnNumber:21},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:118,columnNumber:19},this),pe.jsxDEV("h3",{className:"text-white font-bold text-lg group-hover:text-green-100 transition-colors",children:e.name},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:121,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:117,columnNumber:17},this),pe.jsxDEV("div",{className:"transition-opacity "+(t?"opacity-100":"opacity-0 group-hover:opacity-100"),children:pe.jsxDEV("div",{className:"flex flex-col gap-1",children:[pe.jsxDEV("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:128,columnNumber:21},this),pe.jsxDEV("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:129,columnNumber:21},this),pe.jsxDEV("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:130,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:127,columnNumber:19},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:124,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:116,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:115,columnNumber:13},this),pe.jsxDEV("div",{className:"p-6 flex flex-col items-center justify-center",children:pe.jsxDEV("p",{className:"text-gray-400 text-sm text-center leading-relaxed group-hover:text-gray-300 transition-colors",children:e.description},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:139,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:137,columnNumber:13},this),t&&pe.jsxDEV("div",{className:"absolute inset-0 bg-green-500/10 rounded-xl border-2 border-green-400/50 flex items-center justify-center backdrop-blur-sm",children:pe.jsxDEV("div",{className:"text-green-400 font-mono text-sm font-bold",children:"拖拽模式"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:145,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:144,columnNumber:15},this),pe.jsxDEV("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-green-500/0 via-green-500/0 to-green-500/0 group-hover:from-green-500/5 group-hover:via-transparent group-hover:to-green-500/5 transition-all duration-300"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:150,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:111,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:106,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:97,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:86,columnNumber:5},this)}function ws(){var e;const{user:r,logout:s}=Ve(),[n,i]=t.useState(!0),[a,o]=t.useState(new Date),[l,c]=t.useState([]),[m,u]=t.useState([]),[d,f]=t.useState(!1);t.useEffect(()=>{h();const e=setInterval(()=>{o(new Date)},1e3);return()=>clearInterval(e)},[]),t.useEffect(()=>{if(r){let e=[];if(He(r.role.name))e=Ee;else{const t=r.permissions||[];e=function(e){return Ee.filter(r=>e.includes(r.permission))}(t)}c(e);const t=localStorage.getItem(`dashboard-order-${r.id}`);if(t)try{const r=JSON.parse(t),s=r.map(r=>e.find(e=>e.id===r)).filter(Boolean),n=e.filter(e=>!r.includes(e.id));u([...s,...n])}catch{u(e)}else u(e)}},[r]);const h=async()=>{i(!1)},p=vr(br(dt,{activationConstraint:{distance:5,delay:100,tolerance:3}}),br(ot,{coordinateGetter:Ns})),g=()=>m;return n?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:284,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:283,columnNumber:7},this):pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-300",children:[pe.jsxDEV("header",{className:"bg-gray-900 border-b border-green-400 px-4 sm:px-6 py-4",children:pe.jsxDEV("div",{className:"max-w-7xl mx-auto",children:pe.jsxDEV("div",{className:"flex justify-between items-center",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("h1",{className:"text-xl sm:text-2xl font-bold text-green-400 font-mono",children:"工时管理系统"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:298,columnNumber:15},this),pe.jsxDEV("div",{className:"mt-2 flex items-center gap-2",children:[pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:(null==r?void 0:r.name)||"未知用户"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:303,columnNumber:17},this),pe.jsxDEV("span",{className:"text-green-600",children:"•"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:306,columnNumber:17},this),pe.jsxDEV("div",{className:"text-green-600 font-mono text-sm",children:(null==(e=null==r?void 0:r.role)?void 0:e.name)||"未分配角色"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:307,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:302,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:297,columnNumber:13},this),pe.jsxDEV("button",{onClick:async()=>{try{await s()}catch(e){}},className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-medium rounded-lg transition-all duration-200 font-mono text-sm shadow-lg hover:shadow-xl transform hover:scale-105",children:[pe.jsxDEV(H,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:318,columnNumber:15},this),pe.jsxDEV("span",{className:"hidden sm:inline",children:"退出系统"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:319,columnNumber:15},this),pe.jsxDEV("span",{className:"sm:hidden",children:"退出"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:320,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:314,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:296,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:295,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:294,columnNumber:7},this),pe.jsxDEV("div",{className:"max-w-7xl mx-auto p-6",children:[pe.jsxDEV("div",{className:"mb-8",children:pe.jsxDEV("div",{className:"mt-4 h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:329,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:328,columnNumber:9},this),pe.jsxDEV("div",{className:"mb-8",children:[pe.jsxDEV(Kt,{sensors:p,collisionDetection:Hr,onDragStart:e=>{f(!0)},onDragEnd:e=>{const{active:t,over:s}=e;if(f(!1),!s||!r||t.id===s.id)return;const n=m.findIndex(e=>e.id===t.id),i=m.findIndex(e=>e.id===s.id);if(-1!==n&&-1!==i){const e=rs(m,n,i);u(e);const t=e.map(e=>e.id);localStorage.setItem(`dashboard-order-${r.id}`,JSON.stringify(t))}},children:pe.jsxDEV(cs,{items:g().map(e=>e.id),strategy:ns,children:pe.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 transition-colors duration-200 "+(d?"select-none":""),children:g().map((e,r)=>pe.jsxDEV(Es,{module:e,index:r,isDragMode:d},e.id,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:351,columnNumber:19},this))},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:347,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:343,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:337,columnNumber:11},this),0===l.length&&pe.jsxDEV("div",{className:"text-center py-12",children:[pe.jsxDEV("div",{className:"text-green-600 mb-4",children:pe.jsxDEV(T,{className:"h-16 w-16 mx-auto"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:366,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:365,columnNumber:15},this),pe.jsxDEV("h3",{className:"text-lg font-medium text-green-400 mb-2 font-mono",children:"暂无可访问的模块"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:368,columnNumber:15},this),pe.jsxDEV("p",{className:"text-green-600 font-mono",children:"请联系管理员为您分配相应的权限"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:369,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:364,columnNumber:13},this),l.length>0&&pe.jsxDEV("div",{className:"mt-6 text-center",children:d?pe.jsxDEV("div",{className:"bg-green-900/30 border border-green-500 rounded-lg p-3",children:pe.jsxDEV("p",{className:"text-green-400 text-sm font-mono font-bold",children:"🎯 拖拽模式已激活 - 松开鼠标完成排序"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:378,columnNumber:19},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:377,columnNumber:17},this):pe.jsxDEV("p",{className:"text-green-600 text-sm font-mono",children:"💡 提示：长按模块或拖拽一定距离来重新排列顺序"},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:383,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:375,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:335,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:326,columnNumber:7},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Dashboard.tsx",lineNumber:292,columnNumber:5},this)}function Ds({company:e,index:r,onEdit:t,onDelete:s}){const{attributes:n,listeners:i,setNodeRef:a,transform:o,transition:l,isDragging:c}=gs({id:e.id}),m={transform:nr.Transform.toString(o),transition:l,opacity:c?.5:1};return pe.jsxDEV("div",{ref:a,style:m,className:"px-6 py-4 hover:bg-green-900/10 transition-colors "+(c?"bg-gray-800/70 shadow-lg":""),children:pe.jsxDEV("div",{className:"grid grid-cols-12 gap-4 items-center",children:[pe.jsxDEV("div",{className:"col-span-1 flex items-center gap-2",children:[pe.jsxDEV("div",{...n,...i,className:"cursor-grab active:cursor-grabbing text-green-400 hover:text-green-300 p-1",title:"拖拽排序",children:pe.jsxDEV(U,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:69,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:63,columnNumber:11},this),pe.jsxDEV("span",{className:"text-green-400 font-bold font-mono text-lg",children:r+1},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:71,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:62,columnNumber:9},this),pe.jsxDEV("div",{className:"col-span-6",children:pe.jsxDEV("h3",{className:"text-green-400 font-bold font-mono text-lg",children:e.name},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:76,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:75,columnNumber:9},this),pe.jsxDEV("div",{className:"col-span-3",children:pe.jsxDEV("span",{className:"text-green-600 font-mono text-sm",children:new Date(e.created_at).toLocaleString()},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:81,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:80,columnNumber:9},this),pe.jsxDEV("div",{className:"col-span-2",children:pe.jsxDEV("div",{className:"flex gap-2",children:[pe.jsxDEV("button",{onClick:()=>t(e),className:"text-green-400 hover:text-green-300 transition-colors p-1",title:"编辑",children:pe.jsxDEV(B,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:92,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:87,columnNumber:13},this),pe.jsxDEV("button",{onClick:()=>s(e),className:"text-red-400 hover:text-red-300 transition-colors p-1",title:"删除",children:pe.jsxDEV(F,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:99,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:94,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:86,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:85,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:61,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:54,columnNumber:5},this)}function _s(){const[e,r]=t.useState([]),[s,n]=t.useState(!0),[o,l]=t.useState(!1),[c,m]=t.useState(null),[u,d]=t.useState({name:""}),[f,h]=t.useState(!1),[p,g]=t.useState(!1),[b,v]=t.useState(null),[x,y]=t.useState(""),[w,D]=t.useState(""),{user:H,loading:T}=Ve(),S=i(),j=vr(br(dt),br(ot,{coordinateGetter:Ns}));if(t.useEffect(()=>{T||H||S("/login")},[H,T,S]),T)return pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("div",{className:"text-green-400 text-2xl font-mono mb-4",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:147,columnNumber:11},this),pe.jsxDEV("div",{className:"text-green-600 font-mono",children:"正在验证用户身份"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:148,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:146,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:145,columnNumber:7},this);t.useEffect(()=>{k()},[]);const k=async()=>{n(!0),y("");try{if(!H)return void y("用户未登录，请重新登录");const{data:e,error:t}=await ve.from("companies").select("*").order("order_index",{ascending:!0});if(t)throw t;r(e||[])}catch(e){y("获取公司列表失败，请重试")}finally{n(!1)}},V=e=>{m(e),d({name:e.name}),l(!0)},C=e=>{v(e),g(!0)},R=()=>{d({name:""}),m(null),l(!1),y("")};return s?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:340,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:339,columnNumber:7},this):pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-300 p-6",children:pe.jsxDEV("div",{className:"max-w-7xl mx-auto",children:[pe.jsxDEV("div",{className:"mb-8",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV(E,{className:"w-8 h-8 text-green-400 mr-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:355,columnNumber:15},this),pe.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 font-mono",children:"公司管理"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:356,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:354,columnNumber:13},this),pe.jsxDEV(a,{to:"/dashboard",className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-green-300 hover:text-green-200 rounded-lg font-mono transition-all duration-200 shadow-md hover:shadow-lg border border-gray-600 hover:border-green-500/50",children:[pe.jsxDEV(_,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:362,columnNumber:15},this),pe.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:363,columnNumber:15},this),pe.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:364,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:358,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:353,columnNumber:11},this),pe.jsxDEV("div",{className:"h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:367,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:352,columnNumber:9},this),pe.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[pe.jsxDEV("div",{className:"flex-1",children:pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-green-400/60"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:374,columnNumber:15},this),pe.jsxDEV("input",{type:"text",placeholder:"搜索公司名称...",className:"w-full bg-black border border-green-400/30 rounded px-10 py-2 text-green-400 placeholder-green-400/60 focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:375,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:373,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:372,columnNumber:11},this),pe.jsxDEV("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(O,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:386,columnNumber:13},this),"新增公司"]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:382,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:371,columnNumber:9},this),x&&pe.jsxDEV("div",{className:"mb-6 p-4 bg-red-900/50 border border-red-400 rounded text-red-300",children:x},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:392,columnNumber:11},this),o&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[pe.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 font-mono",children:c?"编辑公司":"新增公司"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:404,columnNumber:17},this),pe.jsxDEV("button",{onClick:R,className:"text-green-400 hover:text-green-300",children:pe.jsxDEV(N,{className:"w-6 h-6"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:411,columnNumber:19},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:407,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:403,columnNumber:15},this),pe.jsxDEV("form",{onSubmit:async e=>{e.preventDefault(),h(!0),y("");let t="";try{if(c){const{data:e,error:s}=await ve.from("companies").update({name:u.name,updated_at:(new Date).toISOString()}).eq("id",c.id).select();if(s)throw new Error(s.message);if(!e||0===e.length)throw new Error("更新失败：权限不足或记录不存在");const n=e[0];r(e=>e.map(e=>e.id===n.id?n:e)),t=`公司 "${n.name}" 更新成功`}else{const{data:e,error:s}=await ve.from("companies").insert([u]).select();if(s)throw new Error(s.message);const n=e[0];r(e=>[...e,n]),t=`公司 "${n.name}" 创建成功`}y(""),D(t),await k(),R()}catch(s){y(s.message||"保存失败")}finally{h(!1)}},className:"space-y-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"公司名称 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:417,columnNumber:19},this),pe.jsxDEV("input",{type:"text",name:"name",value:u.name,onChange:e=>{d({...u,[e.target.name]:e.target.value})},required:!0,className:"w-full px-3 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入公司名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:420,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:416,columnNumber:17},this),pe.jsxDEV("div",{className:"flex gap-3 pt-4",children:[pe.jsxDEV("button",{type:"submit",disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(P,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:439,columnNumber:21},this),f?"保存中...":"保存"]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:434,columnNumber:19},this),pe.jsxDEV("button",{type:"button",onClick:R,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:442,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:433,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:415,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:402,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:401,columnNumber:11},this),p&&b&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-red-400 rounded-lg p-6 w-full max-w-md",children:[pe.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[pe.jsxDEV(L,{className:"text-red-400 w-8 h-8"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:460,columnNumber:17},this),pe.jsxDEV("h2",{className:"text-xl font-bold text-red-400 font-mono",children:"确认删除"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:461,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:459,columnNumber:15},this),pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("p",{className:"text-green-300 font-mono mb-2",children:"您确定要删除以下公司吗？"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:467,columnNumber:17},this),pe.jsxDEV("div",{className:"bg-black border border-green-400 rounded p-3 mb-3",children:pe.jsxDEV("p",{className:"text-green-400 font-mono font-bold",children:b.name},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:471,columnNumber:19},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:470,columnNumber:17},this),pe.jsxDEV("p",{className:"text-red-300 text-sm font-mono",children:"⚠️ 此操作不可恢复，请谨慎操作！"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:475,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:466,columnNumber:15},this),pe.jsxDEV("div",{className:"flex gap-3",children:[pe.jsxDEV("button",{onClick:async()=>{if(b)try{const{error:e}=await ve.from("companies").delete().eq("id",b.id);if(e)throw e;await k(),g(!1),v(null)}catch(e){y(e.message||"删除失败")}},className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(F,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:485,columnNumber:19},this),"确认删除"]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:481,columnNumber:17},this),pe.jsxDEV("button",{onClick:()=>{g(!1),v(null)},className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:488,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:480,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:458,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:457,columnNumber:11},this),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:[pe.jsxDEV("div",{className:"bg-green-900/30 border-b border-green-400 px-6 py-4",children:pe.jsxDEV("div",{className:"grid grid-cols-12 gap-4 items-center",children:[pe.jsxDEV("div",{className:"col-span-1",children:pe.jsxDEV("span",{className:"text-green-400 font-bold font-mono text-sm",children:"排序"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:505,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:504,columnNumber:15},this),pe.jsxDEV("div",{className:"col-span-6",children:pe.jsxDEV("span",{className:"text-green-400 font-bold font-mono text-sm",children:"公司名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:508,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:507,columnNumber:15},this),pe.jsxDEV("div",{className:"col-span-3",children:pe.jsxDEV("span",{className:"text-green-400 font-bold font-mono text-sm",children:"创建时间"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:511,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:510,columnNumber:15},this),pe.jsxDEV("div",{className:"col-span-2",children:pe.jsxDEV("span",{className:"text-green-400 font-bold font-mono text-sm",children:"操作"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:514,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:513,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:503,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:502,columnNumber:11},this),pe.jsxDEV(Kt,{sensors:j,collisionDetection:Hr,onDragEnd:async t=>{const{active:s,over:n}=t;if(s.id!==(null==n?void 0:n.id)){const t=e.findIndex(e=>e.id===s.id),a=e.findIndex(e=>e.id===(null==n?void 0:n.id)),o=rs(e,t,a);r(o);try{const e=o.map((e,r)=>({id:e.id,order_index:r+1}));for(const r of e)await ve.from("companies").update({order_index:r.order_index}).eq("id",r.id)}catch(i){await k()}}},children:pe.jsxDEV(cs,{items:e.map(e=>e.id),strategy:as,children:pe.jsxDEV("div",{className:"divide-y divide-green-800",children:e.map((e,r)=>pe.jsxDEV(Ds,{company:e,index:r,onEdit:V,onDelete:C},e.id,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:531,columnNumber:19},this))},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:529,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:525,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:520,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:500,columnNumber:9},this),0===e.length&&pe.jsxDEV("div",{className:"text-center py-12",children:[pe.jsxDEV(E,{className:"w-16 h-16 text-green-600 mx-auto mb-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:546,columnNumber:13},this),pe.jsxDEV("p",{className:"text-green-400 text-lg font-mono",children:"暂无公司数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:547,columnNumber:13},this),pe.jsxDEV("p",{className:"text-green-600 text-sm font-mono mt-2",children:"点击上方按钮添加第一家公司"},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:550,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:545,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:349,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/CompanyManagement.tsx",lineNumber:348,columnNumber:5},this)}function Hs(){var e,r,s,n,o,l,c,m,u,d,f,h,g,b,v,D,H,S,j,k,V,C;const[R,A]=t.useState([]),[M,U]=t.useState([]),[z,$]=t.useState([]),[G,q]=t.useState([]),[X,Y]=t.useState(!1),[K,J]=t.useState(!0),[Q,Z]=t.useState(""),[ee,re]=t.useState(!1),[te,se]=t.useState(null),[ne,ie]=t.useState({phone:"",id_card:"",name:"",company_id:"",role_id:"",production_line:"",is_active:!1}),[ae,oe]=t.useState(!1),[le,ce]=t.useState(!1),[me,ue]=t.useState(null),[de,fe]=t.useState(!1),[he,ge]=t.useState({user:null,oldRole:null,newRole:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),[be,Ne]=t.useState(""),[xe,ye]=t.useState(!1),[Ee,we]=t.useState({user:null,oldProductionLine:"",newProductionLine:"",role:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),[De,_e]=t.useState(""),[Te,Se]=t.useState(""),{user:je,loading:ke}=Ve(),Ce=i();if(t.useEffect(()=>{ke||je||Ce("/login")},[je,ke,Ce]),ke)return pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("div",{className:"text-green-400 text-2xl font-mono mb-4",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:101,columnNumber:11},this),pe.jsxDEV("div",{className:"text-green-600 font-mono",children:"正在验证用户身份"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:102,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:100,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:99,columnNumber:7},this);t.useEffect(()=>{Re()},[]);const Re=async()=>{var e,r,t;try{if(!je)return void W.error("用户信息不存在");let s=ve.from("users").select("\n          *,\n          company:companies(name),\n          role:user_roles(name, permissions)\n        ");if(!He(je.role)){if(!(null==(e=je.company)?void 0:e.id))return void W.error("用户没有关联的公司，请联系管理员");s=s.eq("company_id",je.company.id)}const{data:n,error:i}=await s.order("created_at",{ascending:!1});if(i)throw i;let a=ve.from("companies").select("*");He(je.role)||(a=a.eq("id",null==(r=je.company)?void 0:r.id));const{data:o,error:l}=await a.order("name");if(l)throw l;const{data:c,error:m}=await ve.from("user_roles").select("*").order("name");if(m)throw m;A(n||[]),U(o||[]),$(c||[]),!He(je.role)&&(null==(t=je.company)?void 0:t.id)&&ie(e=>({...e,company_id:je.company.id}))}catch(s){Se("获取数据失败")}finally{J(!1)}},[Ae,Me]=t.useState(""),Ie=async e=>{try{const{data:r,error:t}=await ve.from("processes").select("production_line").eq("company_id",e).not("production_line","is",null);if(t)throw t;const s=[...new Set((null==r?void 0:r.map(e=>e.production_line).filter(Boolean))||[])];q(s)}catch(r){q([])}},Oe=()=>{var e;const r={phone:"",id_card:"",name:"",company_id:"",role_id:"",production_line:"",is_active:!1};!He(je.role)&&(null==(e=je.company)?void 0:e.id)&&(r.company_id=je.company.id),ie(r),se(null),re(!1),Y(!1),q([]),Se("")},Pe=e=>{const{name:r,value:t}=e.target;if(ie({...ne,[r]:t}),"role_id"===r){const e=z.find(e=>e.id===t),r="班长"===(null==e?void 0:e.name)||"段长"===(null==e?void 0:e.name);Y(r),r&&ne.company_id?Ie(ne.company_id):(q([]),ie(e=>({...e,production_line:""})))}"company_id"===r&&(X&&t?Ie(t):q([]),ie(e=>({...e,production_line:""})))},Le=R.filter(e=>{var r;return e.name.toLowerCase().includes(Q.toLowerCase())||e.phone.includes(Q)||e.id_card.includes(Q)||(null==(r=e.company)?void 0:r.name)&&e.company.name.toLowerCase().includes(Q.toLowerCase())});return K?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1276,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1275,columnNumber:7},this):pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-300 p-6",children:pe.jsxDEV("div",{className:"max-w-7xl mx-auto",children:[pe.jsxDEV("div",{className:"mb-8",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV(x,{className:"w-8 h-8 text-green-400 mr-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1290,columnNumber:15},this),pe.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 font-mono",children:"用户管理"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1291,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1289,columnNumber:13},this),pe.jsxDEV(a,{to:"/dashboard",className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-green-300 hover:text-green-200 rounded-lg font-mono transition-all duration-200 shadow-md hover:shadow-lg border border-gray-600 hover:border-green-500/50",children:[pe.jsxDEV(_,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1297,columnNumber:15},this),pe.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1298,columnNumber:15},this),pe.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1299,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1293,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1288,columnNumber:11},this),pe.jsxDEV("div",{className:"h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1302,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1287,columnNumber:9},this),Te&&pe.jsxDEV("div",{className:"mb-6 p-4 bg-red-900/50 border border-red-400 rounded text-red-300",children:Te},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1306,columnNumber:11},this),pe.jsxDEV("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[pe.jsxDEV("div",{className:"relative flex-1 max-w-md",children:[pe.jsxDEV(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1315,columnNumber:13},this),pe.jsxDEV("input",{type:"text",value:Q,onChange:e=>Z(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-900 border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"搜索用户姓名、手机号、身份证号或公司..."},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1316,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1314,columnNumber:11},this),pe.jsxDEV("button",{onClick:()=>{Oe(),re(!0)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(O,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1333,columnNumber:13},this),"新增用户"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1326,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1312,columnNumber:9},this),ee&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[pe.jsxDEV("h2",{className:"text-2xl font-bold text-green-400 font-mono",children:te?"编辑用户":"新增用户"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1343,columnNumber:17},this),pe.jsxDEV("button",{onClick:Oe,className:"text-green-400 hover:text-green-300",children:pe.jsxDEV(N,{className:"w-6 h-6"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1350,columnNumber:19},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1346,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1342,columnNumber:15},this),pe.jsxDEV("form",{onSubmit:async e=>{var r,t;e.preventDefault(),oe(!0),Se("");try{if(!He(je.role)){if(ne.company_id!==(null==(r=je.company)?void 0:r.id))return W.error("您只能操作自己公司的用户"),void oe(!1);if(te&&te.company_id!==(null==(t=je.company)?void 0:t.id))return W.error("您只能编辑自己公司的用户"),void oe(!1)}if(te){const e=z.find(e=>e.id===te.role_id),r=z.find(e=>e.id===ne.role_id),t=te.production_line!==ne.production_line;if(("班长"===(null==e?void 0:e.name)||"段长"===(null==e?void 0:e.name))&&e.id!==(null==r?void 0:r.id)){let t=ve.from("timesheet_records").select("id, user_id, status").in("status",["pending","待审核","submitted","已提交"]);"班长"===e.name?t=t.eq("supervisor_id",te.id):"段长"===e.name&&(t=t.eq("section_chief_id",te.id));const{data:s,error:n}=await t;if(n)throw new Error("检查待审核数据失败，请稍后重试");if(s&&s.length>0){const{data:t}=await ve.from("timesheet_records").select("\n                id, user_id, status, work_date,\n                user:users!user_id(id, name, is_active)\n              ").in("id",s.map(e=>e.id)),n=(null==t?void 0:t.filter(e=>{const r=e.user,t=null==r?void 0:r.is_active,s=e.work_date&&new Date(e.work_date)<=new Date;return t&&s}))||[];if(n.length>0){const{data:t}=await ve.from("users").select("id, name, phone").eq("company_id",te.company_id).eq("production_line",te.production_line).eq("role_id",te.role_id).eq("is_active",!0).neq("id",te.id);if(!t||0===t.length){const r=[...new Set(n.map(e=>{var r;return null==(r=e.user)?void 0:r.name}))].join("、"),t=`无法修改${e.name}角色：还有${n.length}条待审核的工时记录需要处理，但该生产线没有其他激活的${e.name}可以接收这些数据。涉及员工：${r}。请先在该生产线添加其他${e.name}或手动处理这些待审核数据。`;return W.error(t),void oe(!1)}const s=[...new Set(n.map(e=>{var r;return null==(r=e.user)?void 0:r.name}))];return ge({user:te,oldRole:e,newRole:r,pendingRecords:n,sameRoleUsers:t||[],userNames:s}),fe(!0),void oe(!1)}}}if(("班长"===(null==e?void 0:e.name)||"段长"===(null==e?void 0:e.name))&&t){let r=ve.from("timesheet_records").select("id, user_id, status");"班长"===e.name?r=r.eq("supervisor_id",te.id).in("status",["pending","待审核","submitted","已提交"]):"段长"===e.name&&(r=r.eq("section_chief_id",te.id).in("status",["approved"]));const{data:t,error:s}=await r;if(s)throw new Error("检查待审核数据失败，请稍后重试");if(t&&t.length>0){const{data:r}=await ve.from("timesheet_records").select("\n                id, user_id, status, work_date,\n                user:users!user_id(id, name, is_active)\n              ").in("id",t.map(e=>e.id)),s=(null==r?void 0:r.filter(e=>{const r=e.user,t=null==r?void 0:r.is_active,s=e.work_date&&new Date(e.work_date)<=new Date;return t&&s}))||[];if(s.length>0){const{data:r,error:t}=await ve.from("users").select("id, name, phone").eq("company_id",te.company_id).eq("production_line",te.production_line).eq("role_id",te.role_id).eq("is_active",!0).neq("id",te.id);if(!r||0===r.length){const r=[...new Set(s.map(e=>{var r;return null==(r=e.user)?void 0:r.name}))].join("、"),t=`无法更换生产线：还有${s.length}条待审核的工时记录需要处理，但原生产线(${te.production_line})没有其他激活的${e.name}可以接收这些数据。涉及员工：${r}。请先在原生产线添加其他${e.name}或手动处理这些待审核数据。`;return W.error(t),void oe(!1)}const n=[...new Set(s.map(e=>{var r;return null==(r=e.user)?void 0:r.name}))];return we({user:te,oldProductionLine:te.production_line,newProductionLine:ne.production_line,role:e,pendingRecords:s,sameRoleUsers:r||[],userNames:n}),ye(!0),void oe(!1)}}}const{data:s,error:n}=await ve.from("users").update({phone:ne.phone,id_card:ne.id_card,name:ne.name,company_id:ne.company_id,role_id:ne.role_id,production_line:ne.production_line||null,is_active:ne.is_active,updated_at:(new Date).toISOString()}).eq("id",te.id).select("*");if(n)throw n;if(!s||0===s.length)throw new Error("更新失败：无法获取更新后的数据，请检查权限设置")}else{const{data:e}=await ve.from("users").select("id").or(`phone.eq.${ne.phone},id_card.eq.${ne.id_card}`).single();if(e)throw new Error("手机号或身份证号已存在");const r="123456",{data:t,error:s}=await ve.from("users").insert([{phone:ne.phone,password_hash:r,id_card:ne.id_card,name:ne.name,company_id:ne.company_id,role_id:ne.role_id,production_line:ne.production_line||null,is_active:ne.is_active}]).select("*");if(s)throw s;if(!t||0===t.length)throw new Error("创建失败：无法获取创建后的数据，请检查权限设置")}await Re(),Oe()}catch(s){Se(s.message||"保存失败")}finally{oe(!1)}},className:"space-y-4",children:[pe.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"姓名 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1357,columnNumber:21},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1361,columnNumber:23},this),pe.jsxDEV("input",{type:"text",name:"name",value:ne.name,onChange:Pe,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入姓名"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1362,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1360,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1356,columnNumber:19},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"手机号 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1375,columnNumber:21},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1379,columnNumber:23},this),pe.jsxDEV("input",{type:"tel",name:"phone",value:ne.phone,onChange:Pe,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入手机号",maxLength:11},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1380,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1378,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1374,columnNumber:19},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"身份证号 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1394,columnNumber:21},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1398,columnNumber:23},this),pe.jsxDEV("input",{type:"text",name:"id_card",value:ne.id_card,onChange:Pe,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 placeholder-green-600 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",placeholder:"请输入身份证号",maxLength:18},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1399,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1397,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1393,columnNumber:19},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"所属公司 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1415,columnNumber:21},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1419,columnNumber:23},this),He(je.role)&&!te?pe.jsxDEV("select",{name:"company_id",value:ne.company_id,onChange:Pe,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",children:[pe.jsxDEV("option",{value:"",children:"请选择公司"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1428,columnNumber:27},this),M.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1430,columnNumber:29},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1421,columnNumber:25},this):pe.jsxDEV("div",{className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-green-400 rounded text-green-300 font-mono text-sm",children:[(null==(e=M.find(e=>e.id===ne.company_id))?void 0:e.name)||(null==(r=je.company)?void 0:r.name)||"当前公司",te&&pe.jsxDEV("span",{className:"ml-2 text-yellow-400 text-xs",children:"(编辑时不可修改)"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1439,columnNumber:29},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1436,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1418,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1414,columnNumber:19},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"用户角色 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1447,columnNumber:21},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1451,columnNumber:23},this),pe.jsxDEV("select",{name:"role_id",value:ne.role_id,onChange:Pe,required:!0,className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",children:[pe.jsxDEV("option",{value:"",children:"请选择角色"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1459,columnNumber:25},this),z.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1461,columnNumber:27},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1452,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1450,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1446,columnNumber:19},this),X&&pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"生产线 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1472,columnNumber:23},this),pe.jsxDEV("select",{name:"production_line",value:ne.production_line||"",onChange:Pe,className:"w-full px-3 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",required:!0,children:[pe.jsxDEV("option",{value:"",children:"请选择生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1482,columnNumber:25},this),G.map(e=>pe.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1484,columnNumber:27},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1475,columnNumber:23},this),0===G.length&&ne.company_id&&pe.jsxDEV("div",{className:"mt-1 text-yellow-400 text-xs font-mono",children:"该公司暂无可用生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1490,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1471,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1355,columnNumber:17},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-1",children:"用户状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1499,columnNumber:19},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1503,columnNumber:21},this),pe.jsxDEV("select",{name:"is_active",value:ne.is_active.toString(),onChange:e=>ie({...ne,is_active:"true"===e.target.value}),className:"w-full pl-10 pr-4 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",children:[pe.jsxDEV("option",{value:"true",children:"激活"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1510,columnNumber:23},this),pe.jsxDEV("option",{value:"false",children:"禁用"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1511,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1504,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1502,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1498,columnNumber:17},this),pe.jsxDEV("div",{className:"flex gap-3 pt-4",children:[pe.jsxDEV("button",{type:"submit",disabled:ae,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-green-800 text-black font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(P,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1522,columnNumber:21},this),ae?"保存中...":"保存"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1517,columnNumber:19},this),pe.jsxDEV("button",{type:"button",onClick:Oe,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1525,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1516,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1354,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1341,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1340,columnNumber:11},this),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full",children:[pe.jsxDEV("thead",{className:"bg-green-900/30",children:pe.jsxDEV("tr",{children:[pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"姓名"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1544,columnNumber:19},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"手机号"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1545,columnNumber:17},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"身份证号"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1548,columnNumber:17},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"公司"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1551,columnNumber:17},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"角色"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1554,columnNumber:17},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1557,columnNumber:17},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1560,columnNumber:17},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"操作"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1563,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1543,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1542,columnNumber:15},this),pe.jsxDEV("tbody",{className:"divide-y divide-green-800",children:Le.map(e=>{var r,t;return pe.jsxDEV("tr",{className:"hover:bg-green-900/10",children:[pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV(x,{className:"w-4 h-4 text-green-400 mr-2"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1573,columnNumber:25},this),pe.jsxDEV("span",{className:"text-sm font-mono font-medium text-green-300",children:e.name},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1574,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1572,columnNumber:23},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1571,columnNumber:21},this),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:e.phone},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1580,columnNumber:23},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1579,columnNumber:21},this),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:e.id_card},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1585,columnNumber:23},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1584,columnNumber:21},this),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:(null==(r=e.company)?void 0:r.name)||"未分配"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1590,columnNumber:23},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1589,columnNumber:21},this),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:(null==(t=e.role)?void 0:t.name)||"未分配"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1595,columnNumber:23},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1594,columnNumber:21},this),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",children:e.production_line||"-"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1600,columnNumber:23},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1599,columnNumber:21},this),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("button",{onClick:()=>(async e=>{var r;const t=!e.is_active;try{if(!He(je.role)&&e.company_id!==(null==(r=je.company)?void 0:r.id))return void W.error("您只能修改自己公司用户的状态");const{data:s,error:n}=await ve.from("users").update({is_active:t,updated_at:(new Date).toISOString()}).eq("id",e.id).select("*");if(n)throw n;if(!s||0===s.length)throw new Error("状态更新失败：无法获取更新后的数据，请检查权限设置");W.success("用户状态更新成功"),await Re()}catch(s){Se(s.message||"更新状态失败"),W.error("更新用户状态失败")}})(e),className:"inline-flex px-2 py-1 text-xs font-mono font-semibold rounded-full "+(e.is_active?"bg-green-900/50 text-green-300 border border-green-400":"bg-red-900/50 text-red-300 border border-red-400"),children:e.is_active?"激活":"禁用"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1605,columnNumber:23},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1604,columnNumber:21},this),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:pe.jsxDEV("div",{className:"flex gap-2",children:[pe.jsxDEV("button",{onClick:()=>(e=>{var r;if(!He(je.role)&&e.company_id!==(null==(r=je.company)?void 0:r.id))return void W.error("您只能编辑自己公司的用户");se(e),ie({phone:e.phone,id_card:e.id_card,name:e.name,company_id:e.company_id,role_id:e.role_id,production_line:e.production_line||"",is_active:e.is_active});const t=z.find(r=>r.id===e.role_id),s="班长"===(null==t?void 0:t.name)||"段长"===(null==t?void 0:t.name);Y(s),s&&e.company_id&&Ie(e.company_id),re(!0)})(e),className:"text-green-400 hover:text-green-300 transition-colors",title:"编辑",children:pe.jsxDEV(B,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1623,columnNumber:27},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1618,columnNumber:25},this),pe.jsxDEV("button",{onClick:()=>(async e=>{var r;try{if(!He(je.role)&&e.company_id!==(null==(r=je.company)?void 0:r.id))return void W.error("您只能删除自己公司的用户");const s=z.find(r=>r.id===e.role_id);if(s&&"超级管理员"===s.name)return void W.error("超级管理员角色不能被删除，这是系统保护机制");if(s&&("班长"===s.name||"段长"===s.name))try{let r=ve.from("timesheet_records").select("id, user_id, status");"班长"===s.name?r=r.eq("supervisor_id",e.id):"段长"===s.name&&(r=r.eq("section_chief_id",e.id));const{data:t,error:n}=await r;t&&t.length>0&&t.reduce((e,r)=>(e[r.status]=(e[r.status]||0)+1,e),{});let i=ve.from("timesheet_records").select("id, user_id, status");if("班长"===s.name)i=i.in("status",["pending","待审核","submitted","已提交"]).eq("supervisor_id",e.id);else if("段长"===s.name){const{data:r,error:t}=await ve.from("timesheet_records").select("id, user_id, status, section_chief_id, supervisor_id, work_date, created_at").eq("section_chief_id",e.id);r&&(r.reduce((e,r)=>(e[r.status]=(e[r.status]||0)+1,e),{}),r.forEach(e=>{})),i=i.eq("status","approved").eq("section_chief_id",e.id)}const{data:a,error:o}=await i;if("段长"===s.name&&a&&a.length>0&&a.forEach(e=>{}),o)return void W.error("检查待审核数据失败，请稍后重试");if(a&&a.length>0){const{data:r,error:t}=await ve.from("timesheet_records").select("\n              id, user_id, status, work_date, created_at, updated_at,\n              user:users!user_id(id, name, is_active)\n            ").in("id",a.map(e=>e.id)),n=(null==r?void 0:r.filter(e=>{const r=e.user,t=null==r?void 0:r.is_active,s=e.work_date&&new Date(e.work_date)<=new Date;return t&&s}))||[];if(0!==n.length){const r=n,t=[...new Set(r.map(e=>e.user_id))],{data:i}=await ve.from("users").select("name").in("id",t),a=i?i.map(e=>e.name):[],{data:o,error:l}=await ve.from("users").select("id, name, phone").eq("company_id",e.company_id).eq("production_line",e.production_line).eq("role_id",e.role_id).eq("is_active",!0).neq("id",e.id);if(l)return void W.error("查找接收人失败，请稍后重试");if(!o||0===o.length){const e=`无法删除${s.name}：还有${r.length}条待审核的工时记录需要处理，但该生产线没有其他激活的${s.name}可以接收这些数据。涉及员工：${a.join("、")}。请先在该生产线添加其他${s.name}或手动处理这些待审核数据。`;return void W.error(e)}return ue({...e,role:s,pendingRecords:r,sameRoleUsers:o,userNames:a}),void ce(!0)}a.filter(e=>!n.find(r=>r.id===e.id)).map(e=>e.id).length}}catch(t){return void W.error("检查待审核数据时出错，请稍后重试")}ue({...e,role:s}),ce(!0)}catch(t){W.error("操作失败："+(t.message||"未知错误"))}})(e),className:"text-red-400 hover:text-red-300 transition-colors",title:"删除",children:pe.jsxDEV(F,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1630,columnNumber:27},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1625,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1617,columnNumber:23},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1616,columnNumber:21},this)]},e.id,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1570,columnNumber:19},this)})},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1568,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1541,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1540,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1539,columnNumber:9},this),0===Le.length&&pe.jsxDEV("div",{className:"text-center py-12",children:[pe.jsxDEV(x,{className:"w-16 h-16 text-green-600 mx-auto mb-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1643,columnNumber:13},this),pe.jsxDEV("p",{className:"text-green-400 text-lg font-mono",children:Q?"未找到匹配的用户":"暂无用户数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1644,columnNumber:13},this),pe.jsxDEV("p",{className:"text-green-600 text-sm font-mono mt-2",children:Q?"请尝试其他搜索关键词":"点击上方按钮添加第一个用户"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1647,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1642,columnNumber:11},this),de&&he&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-yellow-400 rounded-lg p-6 w-full max-w-md",children:[pe.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[pe.jsxDEV(L,{className:"text-yellow-400 w-8 h-8"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1658,columnNumber:17},this),pe.jsxDEV("h2",{className:"text-xl font-bold text-yellow-400 font-mono",children:"确认角色修改"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1659,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1657,columnNumber:15},this),pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("p",{className:"text-green-300 font-mono mb-2",children:["确定要将用户 ",pe.jsxDEV("span",{className:"text-green-400 font-bold",children:['"',he.user.name,'"']},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1666,columnNumber:26},this)," 的角色从",pe.jsxDEV("span",{className:"text-blue-400 font-bold",children:['"',he.oldRole.name,'"']},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1667,columnNumber:19},this)," 修改为",pe.jsxDEV("span",{className:"text-purple-400 font-bold",children:['"',he.newRole.name,'"']},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1668,columnNumber:19},this)," 吗？"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1665,columnNumber:17},this),he.pendingRecords&&he.pendingRecords.length>0?pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"text-yellow-300 font-mono text-sm p-3 bg-yellow-900/20 border border-yellow-600 rounded",children:[pe.jsxDEV("p",{className:"mb-1",children:"⚠️ 数据转移："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1674,columnNumber:23},this),pe.jsxDEV("p",{className:"text-xs mb-2",children:["检测到",he.pendingRecords.length,"条待审核工时记录需要转移。"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1675,columnNumber:23},this),pe.jsxDEV("p",{className:"text-yellow-200 text-xs",children:["涉及员工：",null==(s=he.userNames)?void 0:s.join("、")]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1676,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1673,columnNumber:21},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"选择数据接收人："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1681,columnNumber:23},this),pe.jsxDEV("select",{value:be,onChange:e=>Ne(e.target.value),className:"w-full px-3 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",required:!0,children:[pe.jsxDEV("option",{value:"",children:"请选择接收人"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1690,columnNumber:25},this),null==(n=he.sameRoleUsers)?void 0:n.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1692,columnNumber:27},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1684,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1680,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1672,columnNumber:19},this):pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm mb-2 p-3 bg-green-900/20 border border-green-600 rounded",children:[pe.jsxDEV("p",{className:"mb-1",children:"✅ 安全修改："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1701,columnNumber:21},this),pe.jsxDEV("p",{className:"text-xs",children:["该",he.oldRole.name,"没有待审核的工时记录，可以安全修改角色。"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1702,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1700,columnNumber:19},this),pe.jsxDEV("p",{className:"text-yellow-300 font-mono text-sm mt-2",children:"角色修改后将影响用户的权限和功能访问。"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1706,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1664,columnNumber:15},this),pe.jsxDEV("div",{className:"flex gap-3",children:[pe.jsxDEV("button",{onClick:async()=>{var e,r;if(he.user&&be)try{const t="班长"===(null==(e=he.oldRole)?void 0:e.name)?"supervisor_id":"section_chief_id",{error:s}=await ve.from("timesheet_records").update({[t]:be}).in("id",he.pendingRecords.map(e=>e.id));if(s)throw new Error("数据转移失败，请稍后重试");const{error:n}=await ve.from("users").update({phone:ne.phone,id_card:ne.id_card,name:ne.name,company_id:ne.company_id,role_id:ne.role_id,production_line:ne.production_line||null,is_active:ne.is_active,updated_at:(new Date).toISOString()}).eq("id",he.user.id);if(n)throw n;const i=null==(r=he.sameRoleUsers.find(e=>e.id===be))?void 0:r.name;W.success(`角色修改成功！已将${he.pendingRecords.length}条待审核数据转移给${i}`),fe(!1),ge({user:null,oldRole:null,newRole:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),Ne(""),Oe(),await Re()}catch(t){W.error(t.message||"角色修改失败")}else W.error("请选择数据接收人")},disabled:(null==(o=he.pendingRecords)?void 0:o.length)>0&&!be,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-yellow-600 hover:bg-yellow-500 disabled:bg-yellow-800 disabled:cursor-not-allowed text-white font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(B,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1717,columnNumber:19},this),"确认修改"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1712,columnNumber:17},this),pe.jsxDEV("button",{onClick:()=>{fe(!1),ge({user:null,oldRole:null,newRole:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),Ne(""),oe(!1)},className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1720,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1711,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1656,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1655,columnNumber:11},this),le&&me&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-red-400 rounded-lg p-6 w-full max-w-md",children:[pe.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[pe.jsxDEV(L,{className:"text-red-400 w-8 h-8"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1736,columnNumber:17},this),pe.jsxDEV("h2",{className:"text-xl font-bold text-red-400 font-mono",children:"确认删除"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1737,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1735,columnNumber:15},this),pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("p",{className:"text-green-300 font-mono mb-2",children:["确定要删除用户 ",pe.jsxDEV("span",{className:"text-green-400 font-bold",children:['"',me.name,'"']},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1744,columnNumber:27},this)," 吗？"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1743,columnNumber:17},this),"员工"===(null==(l=me.role)?void 0:l.name)?pe.jsxDEV("div",{className:"text-blue-300 font-mono text-sm mb-2 p-3 bg-blue-900/20 border border-blue-600 rounded",children:[pe.jsxDEV("p",{className:"mb-1",children:"ℹ️ 员工处理影响："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1750,columnNumber:21},this),pe.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[pe.jsxDEV("li",{children:"保留历史工时记录和审批历史记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1752,columnNumber:23},this),pe.jsxDEV("li",{children:"断开数据关联，账户设为非激活状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1753,columnNumber:23},this),pe.jsxDEV("li",{children:"重新申请时不关联旧数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1754,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1751,columnNumber:21},this),pe.jsxDEV("p",{className:"text-blue-200 text-xs mt-2",children:"员工处理对系统数据影响较小，数据完整性得到保护"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1756,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1749,columnNumber:19},this):"班长"===(null==(c=me.role)?void 0:c.name)||"段长"===(null==(m=me.role)?void 0:m.name)?me.pendingRecords&&me.pendingRecords.length>0?pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"text-yellow-300 font-mono text-sm p-3 bg-yellow-900/20 border border-yellow-600 rounded",children:[pe.jsxDEV("p",{className:"mb-1",children:"⚠️ 数据转移："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1762,columnNumber:25},this),pe.jsxDEV("p",{className:"text-xs mb-2",children:["检测到",me.pendingRecords.length,"条待审核工时记录需要转移。"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1763,columnNumber:25},this),pe.jsxDEV("p",{className:"text-yellow-200 text-xs",children:["涉及员工：",null==(u=me.userNames)?void 0:u.join("、")]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1764,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1761,columnNumber:23},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"选择数据接收人："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1769,columnNumber:25},this),pe.jsxDEV("select",{value:Ae,onChange:e=>Me(e.target.value),className:"w-full px-3 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",required:!0,children:[pe.jsxDEV("option",{value:"",children:"请选择接收人"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1778,columnNumber:27},this),null==(d=me.sameRoleUsers)?void 0:d.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1780,columnNumber:29},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1772,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1768,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1760,columnNumber:21},this):pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm mb-2 p-3 bg-green-900/20 border border-green-600 rounded",children:[pe.jsxDEV("p",{className:"mb-1",children:"✅ 安全删除："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1789,columnNumber:23},this),pe.jsxDEV("p",{className:"text-xs",children:["该",null==(f=me.role)?void 0:f.name,"没有待审核的工时记录，可以安全删除。"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1790,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1788,columnNumber:21},this):"生产经理"===(null==(h=me.role)?void 0:h.name)||"财务"===(null==(g=me.role)?void 0:g.name)?pe.jsxDEV("div",{className:"text-purple-300 font-mono text-sm mb-2 p-3 bg-purple-900/20 border border-purple-600 rounded",children:[pe.jsxDEV("p",{className:"mb-1",children:["ℹ️ ",null==(b=me.role)?void 0:b.name,"删除影响："]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1795,columnNumber:21},this),pe.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[pe.jsxDEV("li",{children:"直接删除用户账户，不影响工时数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1797,columnNumber:23},this),pe.jsxDEV("li",{children:"清理相关的审批历史记录引用"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1798,columnNumber:23},this),pe.jsxDEV("li",{children:"不需要数据转移或特殊处理"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1799,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1796,columnNumber:21},this),pe.jsxDEV("p",{className:"text-purple-200 text-xs mt-2",children:[null==(v=me.role)?void 0:v.name,"删除对工时管理系统影响较小"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1801,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1794,columnNumber:19},this):pe.jsxDEV("div",{className:"text-yellow-300 font-mono text-sm mb-2 p-3 bg-yellow-900/20 border border-yellow-600 rounded",children:[pe.jsxDEV("p",{className:"mb-1",children:"⚠️ 删除操作将会："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1805,columnNumber:21},this),pe.jsxDEV("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[pe.jsxDEV("li",{children:"清理该用户在工时记录中的相关引用"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1807,columnNumber:23},this),pe.jsxDEV("li",{children:"删除该用户的审批历史记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1808,columnNumber:23},this),pe.jsxDEV("li",{children:"永久删除用户账户信息"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1809,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1806,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1804,columnNumber:19},this),pe.jsxDEV("p",{className:"text-red-300 font-mono text-sm mt-2",children:"此操作不可恢复，请谨慎操作。"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1814,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1742,columnNumber:15},this),pe.jsxDEV("div",{className:"flex gap-3",children:[pe.jsxDEV("button",{onClick:async()=>{var e,r,t,s;if(me)try{const n=me.role;if(me.pendingRecords&&me.pendingRecords.length>0){if(!Ae)return void W.error("请选择数据接收人");const t="班长"===(null==n?void 0:n.name)?"supervisor_id":"section_chief_id",s="班长"===(null==n?void 0:n.name)?["pending","待审核","submitted","已提交"]:["approved"],{error:i}=await ve.from("timesheet_records").update({[t]:Ae}).eq(t,me.id).in("status",s);if(i)return void W.error("数据转移失败，请稍后重试");null==(r=null==(e=me.sameRoleUsers)?void 0:e.find(e=>e.id===Ae))||r.name}if("员工"===(null==n?void 0:n.name)){const{error:e}=await ve.from("timesheet_records").update({user_id:null}).eq("user_id",me.id);if(e)throw new Error("断开工时记录关联失败："+e.message);const{error:r}=await ve.from("approval_history").update({approver_id:null}).eq("approver_id",me.id);if(r)throw new Error("断开审批历史关联失败："+r.message)}else{const{error:e}=await ve.from("timesheet_records").update({supervisor_id:null}).eq("supervisor_id",me.id);if(e)throw new Error("清理工时记录引用失败："+e.message);const{error:r}=await ve.from("timesheet_records").update({section_chief_id:null}).eq("section_chief_id",me.id);if(r)throw new Error("清理工时记录引用失败："+r.message);const{error:t}=await ve.from("approval_history").update({approver_id:null}).eq("approver_id",me.id);if(t)throw new Error("清理审核历史引用失败："+t.message)}const{error:i}=await ve.rpc("update_user_names_before_delete",{user_id_to_delete:me.id});if(i)throw new Error("更新历史记录姓名字段失败："+i.message);const{data:a,error:o}=await ve.from("users").delete().eq("id",me.id).select("*");if(o)throw o;if(me.pendingRecords&&me.pendingRecords.length>0){const e=null==(s=null==(t=me.sameRoleUsers)?void 0:t.find(e=>e.id===Ae))?void 0:s.name;W.success(`用户删除成功，已将${me.pendingRecords.length}条待审核工时记录转移给${e}，历史记录已保留姓名信息`)}else W.success(`${(null==n?void 0:n.name)||"用户"} ${me.name} 删除成功：用户账户已永久删除，历史记录已保留姓名信息`);ce(!1),ue(null),Me(""),await Re()}catch(n){let e="删除用户失败";n.message&&(e=n.message.includes("foreign key constraint")?"删除失败：该用户仍有关联的数据记录，请联系系统管理员":n.message.includes("permission denied")?"删除失败：权限不足，请检查您的操作权限":n.message.includes("清理工时记录引用失败")?"删除失败：清理工时记录关联数据时出错":n.message.includes("清理审核历史引用失败")?"删除失败：清理审核历史数据时出错":`删除失败：${n.message}`),Se(e),W.error(e),ce(!1),ue(null)}},disabled:(null==(D=me.pendingRecords)?void 0:D.length)>0&&!Ae,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 disabled:bg-red-800 disabled:cursor-not-allowed text-white font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(F,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1825,columnNumber:19},this),"员工"===(null==(H=me.role)?void 0:H.name)?"确认处理":"确认删除"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1820,columnNumber:17},this),pe.jsxDEV("button",{onClick:()=>{ce(!1),ue(null)},className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1828,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1819,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1734,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1733,columnNumber:11},this),xe&&Ee&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-blue-400 rounded-lg p-6 w-full max-w-md",children:[pe.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[pe.jsxDEV(L,{className:"text-blue-400 w-8 h-8"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1844,columnNumber:17},this),pe.jsxDEV("h2",{className:"text-xl font-bold text-blue-400 font-mono",children:"确认生产线变更"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1845,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1843,columnNumber:15},this),pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("p",{className:"text-green-300 font-mono mb-2",children:["确定要将用户 ",pe.jsxDEV("span",{className:"text-green-400 font-bold",children:['"',Ee.user.name,'"']},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1852,columnNumber:26},this)," 的生产线从",pe.jsxDEV("span",{className:"text-blue-400 font-bold",children:['"',Ee.oldProductionLine,'"']},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1853,columnNumber:19},this)," 变更为",pe.jsxDEV("span",{className:"text-purple-400 font-bold",children:['"',Ee.newProductionLine,'"']},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1854,columnNumber:19},this)," 吗？"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1851,columnNumber:17},this),Ee.pendingRecords&&Ee.pendingRecords.length>0?pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"text-yellow-300 font-mono text-sm p-3 bg-yellow-900/20 border border-yellow-600 rounded",children:[pe.jsxDEV("p",{className:"mb-1",children:"⚠️ 数据转移："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1860,columnNumber:23},this),pe.jsxDEV("p",{className:"text-xs mb-2",children:["检测到",Ee.pendingRecords.length,"条待审核工时记录需要转移到原生产线(",Ee.oldProductionLine,")的相同角色下。"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1861,columnNumber:23},this),pe.jsxDEV("p",{className:"text-yellow-200 text-xs",children:["涉及员工：",null==(S=Ee.userNames)?void 0:S.join("、")]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1862,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1859,columnNumber:21},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:["选择原生产线的",null==(j=Ee.role)?void 0:j.name,"作为数据接收人："]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1867,columnNumber:23},this),pe.jsxDEV("select",{value:De,onChange:e=>_e(e.target.value),className:"w-full px-3 py-2 bg-black border border-green-400 rounded text-green-300 focus:outline-none focus:border-green-300 focus:ring-1 focus:ring-green-300 font-mono text-sm",required:!0,children:[pe.jsxDEV("option",{value:"",children:"请选择接收人"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1876,columnNumber:25},this),null==(k=Ee.sameRoleUsers)?void 0:k.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1878,columnNumber:27},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1870,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1866,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1858,columnNumber:19},this):pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm mb-2 p-3 bg-green-900/20 border border-green-600 rounded",children:[pe.jsxDEV("p",{className:"mb-1",children:"✅ 安全变更："},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1887,columnNumber:21},this),pe.jsxDEV("p",{className:"text-xs",children:["该",null==(V=Ee.role)?void 0:V.name,"没有待审核的工时记录，可以安全变更生产线。"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1888,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1886,columnNumber:19},this),pe.jsxDEV("p",{className:"text-blue-300 font-mono text-sm mt-2",children:"生产线变更后将影响用户的工作范围和审批权限。"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1892,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1850,columnNumber:15},this),pe.jsxDEV("div",{className:"flex gap-3",children:[pe.jsxDEV("button",{onClick:async()=>{var e,r,t,s;if(Ee.user&&De)try{if(Ee.pendingRecords&&Ee.pendingRecords.length>0){const s="班长"===(null==(e=Ee.role)?void 0:e.name)?"supervisor_id":"section_chief_id",n="班长"===(null==(r=Ee.role)?void 0:r.name)?["pending","待审核","submitted","已提交"]:["approved"],{error:i}=await ve.from("timesheet_records").update({[s]:De}).eq(s,Ee.user.id).in("status",n);if(i)throw new Error("数据转移失败，请稍后重试");const a=null==(t=Ee.sameRoleUsers.find(e=>e.id===De))?void 0:t.name;for(const e of Ee.pendingRecords){const{error:r}=await ve.from("approval_history").insert({timesheet_record_id:e.id,approver_id:je.id,approver_name:je.name,action:"transfer",comment:`生产线变更：将审核权限从 ${Ee.user.name}(${Ee.oldProductionLine}) 转移给 ${a}(${Ee.oldProductionLine})`,created_at:(new Date).toISOString()})}}const{error:n}=await ve.from("users").update({phone:ne.phone,id_card:ne.id_card,name:ne.name,company_id:ne.company_id,role_id:ne.role_id,production_line:ne.production_line||null,is_active:ne.is_active,updated_at:(new Date).toISOString()}).eq("id",Ee.user.id);if(n)throw n;if(Ee.pendingRecords&&Ee.pendingRecords.length>0){const e=null==(s=Ee.sameRoleUsers.find(e=>e.id===De))?void 0:s.name;W.success(`生产线变更成功！已将${Ee.pendingRecords.length}条待审核数据转移给${e}`)}else W.success("生产线变更成功！");ye(!1),we({user:null,oldProductionLine:"",newProductionLine:"",role:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),_e(""),Oe(),await Re()}catch(n){W.error(n.message||"生产线变更失败")}else W.error("请选择数据接收人")},disabled:(null==(C=Ee.pendingRecords)?void 0:C.length)>0&&!De,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 disabled:bg-blue-800 disabled:cursor-not-allowed text-white font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(B,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1903,columnNumber:19},this),"确认变更"]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1898,columnNumber:17},this),pe.jsxDEV("button",{onClick:()=>{ye(!1),we({user:null,oldProductionLine:"",newProductionLine:"",role:null,pendingRecords:[],sameRoleUsers:[],userNames:[]}),_e(""),oe(!1)},className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1906,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1897,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1842,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1841,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1285,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/UserManagement.tsx",lineNumber:1284,columnNumber:5},this)}const Ts=()=>{const{user:e}=Ve(),[r,s]=t.useState([]),[n,i]=t.useState(!0),[o,l]=t.useState(""),[c,m]=t.useState({show:!1,role:null}),[u,d]=t.useState(!1);t.useEffect(()=>{var r;if(document.title="权限管理 - 工时管理系统",e&&(null==(r=e.role)?void 0:r.permissions)){if(!Te(e,xe.ROLE_MANAGE))return l("您没有权限访问角色管理页面"),void i(!1);f()}},[e]);const f=async()=>{try{const{data:e,error:r}=await ve.from("user_roles").select("*").order("created_at",{ascending:!1});if(r)throw r;const{data:t,error:n}=await ve.from("users").select("role_id");if(n){const r=(e||[]).map(e=>({...e,user_count:0}));return void s(r)}const i=new Map;null==t||t.forEach(e=>{const r=i.get(e.role_id)||0;i.set(e.role_id,r+1)});const a=(e||[]).map(e=>({...e,user_count:i.get(e.id)||0}));s(a)}catch(e){l("获取角色列表失败，请重试")}finally{i(!1)}},h=()=>{m({show:!1,role:null})};return n?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:131,columnNumber:9},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:130,columnNumber:7},void 0):o?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV(L,{className:"w-16 h-16 text-red-400 mx-auto mb-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:142,columnNumber:11},void 0),pe.jsxDEV("div",{className:"text-red-400 text-xl font-mono mb-4",children:o},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:143,columnNumber:11},void 0),pe.jsxDEV(a,{to:"/dashboard",className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono",children:"返回首页"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:144,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:141,columnNumber:9},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:140,columnNumber:7},void 0):pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-400 p-6",children:pe.jsxDEV("div",{className:"max-w-7xl mx-auto",children:[pe.jsxDEV("div",{className:"mb-8",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV(T,{className:"w-8 h-8 text-green-400 mr-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:162,columnNumber:15},void 0),pe.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 font-mono",children:"权限管理"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:163,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:161,columnNumber:13},void 0),pe.jsxDEV(a,{to:"/dashboard",className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-green-300 hover:text-green-200 rounded-lg font-mono transition-all duration-200 shadow-md hover:shadow-lg border border-gray-600 hover:border-green-500/50",children:[pe.jsxDEV(_,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:169,columnNumber:15},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:170,columnNumber:15},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:171,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:165,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:160,columnNumber:11},void 0),pe.jsxDEV("div",{className:"h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:174,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:159,columnNumber:9},void 0),pe.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[pe.jsxDEV("div",{className:"flex-1",children:pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-green-400/60"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:181,columnNumber:15},void 0),pe.jsxDEV("input",{type:"text",placeholder:"搜索角色名称...",className:"w-full bg-black border border-green-400/30 rounded px-10 py-2 text-green-400 placeholder-green-400/60 focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:182,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:180,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:179,columnNumber:11},void 0),pe.jsxDEV(a,{to:"/role-permissions/create",className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(O,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:193,columnNumber:13},void 0),"创建角色"]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:189,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:178,columnNumber:9},void 0),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:0===r.length?pe.jsxDEV("div",{className:"p-8 text-center",children:[pe.jsxDEV(T,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:205,columnNumber:15},void 0),pe.jsxDEV("p",{className:"text-gray-400 font-mono",children:"暂无角色数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:206,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:204,columnNumber:13},void 0):pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full",children:[pe.jsxDEV("thead",{className:"bg-green-900/30",children:pe.jsxDEV("tr",{children:[pe.jsxDEV("th",{className:"px-6 py-3 text-left text-sm font-medium text-green-400 uppercase tracking-wider font-mono",children:"角色名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:213,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-6 py-3 text-left text-sm font-medium text-green-400 uppercase tracking-wider font-mono",children:"用户数量"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:216,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-6 py-3 text-left text-sm font-medium text-green-400 uppercase tracking-wider font-mono",children:"创建时间"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:219,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-6 py-3 text-left text-sm font-medium text-green-400 uppercase tracking-wider font-mono",children:"操作"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:222,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:212,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:211,columnNumber:17},void 0),pe.jsxDEV("tbody",{className:"divide-y divide-green-800",children:r.map(e=>{return pe.jsxDEV("tr",{className:"hover:bg-green-900/10 transition-colors",children:[pe.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV(T,{className:"w-4 h-4 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:232,columnNumber:27},void 0),pe.jsxDEV("span",{className:"text-green-400 font-mono font-medium",children:e.name},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:233,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:231,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:230,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:pe.jsxDEV("div",{className:"flex items-center gap-1",children:[pe.jsxDEV(R,{className:"w-4 h-4 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:238,columnNumber:27},void 0),pe.jsxDEV("span",{className:"text-green-400 font-mono",children:e.user_count},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:239,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:237,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:236,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-green-300 font-mono text-sm",children:(r=e.created_at,new Date(r).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}))},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:243,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:242,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-6 py-4 whitespace-nowrap",children:pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV(a,{to:`/role-permissions/edit/${e.id}`,className:"p-2 text-blue-400 hover:text-blue-300 hover:bg-gray-700 rounded transition-colors",title:"编辑角色",children:pe.jsxDEV(B,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:254,columnNumber:29},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:249,columnNumber:27},void 0),pe.jsxDEV("button",{onClick:()=>(e=>{m({show:!0,role:e})})(e),className:"p-2 text-red-400 hover:text-red-300 hover:bg-gray-700 rounded transition-colors",title:"删除角色",children:pe.jsxDEV(F,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:261,columnNumber:29},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:256,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:248,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:247,columnNumber:23},void 0)]},e.id,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:229,columnNumber:21},void 0);var r})},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:227,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:210,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:209,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:201,columnNumber:9},void 0),c.show&&c.role&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-red-400 rounded-lg p-6 max-w-md w-full mx-4",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[pe.jsxDEV("h3",{className:"text-xl font-bold text-red-400 font-mono",children:"确认删除角色"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:278,columnNumber:17},void 0),pe.jsxDEV("button",{onClick:h,className:"text-gray-400 hover:text-gray-300 transition-colors",children:pe.jsxDEV(N,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:283,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:279,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:277,columnNumber:15},void 0),pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("p",{className:"text-green-300 font-mono mb-2",children:["您确定要删除角色 ",pe.jsxDEV("span",{className:"text-red-400 font-bold",children:['"',c.role.name,'"']},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:289,columnNumber:28},void 0)," 吗？"]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:288,columnNumber:17},void 0),pe.jsxDEV("div",{className:"bg-gray-800 border border-gray-600 rounded p-3 mb-3",children:pe.jsxDEV("p",{className:"text-green-300 font-mono text-sm",children:["使用用户数：",c.role.user_count]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:292,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:291,columnNumber:17},void 0),c.role.user_count>0&&pe.jsxDEV("div",{className:"bg-red-900 border border-red-400 rounded p-3 mb-3",children:pe.jsxDEV("p",{className:"text-red-300 font-mono text-sm",children:["⚠️ 该角色正被 ",c.role.user_count," 个用户使用，无法删除！"]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:298,columnNumber:21},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:297,columnNumber:19},void 0),pe.jsxDEV("p",{className:"text-gray-400 font-mono text-sm",children:"此操作不可撤销，请谨慎操作。"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:303,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:287,columnNumber:15},void 0),pe.jsxDEV("div",{className:"flex gap-3 justify-end",children:[pe.jsxDEV("button",{onClick:h,className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",disabled:u,children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:309,columnNumber:17},void 0),pe.jsxDEV("button",{onClick:async()=>{if(!c.role)return;const e=c.role;if(e.user_count>0)return l(`无法删除角色 "${e.name}"，该角色正被 ${e.user_count} 个用户使用`),void m({show:!1,role:null});d(!0);try{const{error:r}=await ve.from("user_roles").delete().eq("id",e.id);if(r)throw r;await f(),m({show:!1,role:null}),l("")}catch(r){l("删除角色失败，请重试")}finally{d(!1)}},disabled:u||c.role.user_count>0,className:"px-4 py-2 bg-red-600 hover:bg-red-500 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-bold rounded transition-colors font-mono",children:u?"删除中...":"确认删除"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:316,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:308,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:276,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:275,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:157,columnNumber:7},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleList.tsx",lineNumber:156,columnNumber:5},void 0)},Ss=({isOpen:e,title:r,message:t,onConfirm:s,onCancel:n,confirmText:i="确定",cancelText:a="取消",type:o="warning"})=>{if(!e)return null;const l=(()=>{switch(o){case"danger":return{confirmButton:"bg-red-600 hover:bg-red-700 text-white",icon:"text-red-400"};case"warning":return{confirmButton:"bg-yellow-600 hover:bg-yellow-700 text-white",icon:"text-yellow-400"};default:return{confirmButton:"bg-green-600 hover:bg-green-700 text-white",icon:"text-green-400"}}})();return pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-green-500 rounded-lg shadow-xl max-w-md w-full mx-4",children:[pe.jsxDEV("div",{className:"flex items-center justify-between p-6 border-b border-green-500",children:[pe.jsxDEV("h3",{className:"text-lg font-semibold text-green-400",children:r},void 0,!1,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:54,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:n,className:"text-green-400 hover:text-green-300 transition-colors",children:pe.jsxDEV(N,{size:20},void 0,!1,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:59,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:55,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:53,columnNumber:9},void 0),pe.jsxDEV("div",{className:"p-6",children:pe.jsxDEV("p",{className:"text-green-300 leading-relaxed",children:t},void 0,!1,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:65,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:64,columnNumber:9},void 0),pe.jsxDEV("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-green-500 bg-gray-800",children:[pe.jsxDEV("button",{onClick:n,className:"px-4 py-2 text-green-400 bg-gray-700 border border-green-500 rounded-md hover:bg-gray-600 transition-colors",children:a},void 0,!1,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:70,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:s,className:`px-4 py-2 rounded-md transition-colors ${l.confirmButton}`,children:i},void 0,!1,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:76,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:69,columnNumber:9},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:51,columnNumber:7},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/ConfirmDialog.tsx",lineNumber:50,columnNumber:5},void 0)};
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */
var js={version:"0.18.5"},ks=1200,Vs=1252,Cs=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Rs={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},As=function(e){-1!=Cs.indexOf(e)&&(Vs=Rs[0]=e)};var Ms=function(e){ks=e,As(e)};function Is(){Ms(1200),As(1252)}function Os(e){for(var r=[],t=0,s=e.length;t<s;++t)r[t]=e.charCodeAt(t);return r}function Ps(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Ls,Fs=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return 255==r&&254==t?function(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}(e.slice(2)):254==r&&255==t?Ps(e.slice(2)):65279==r?e.slice(1):e},Us=function(e){return String.fromCharCode(e)},Bs=function(e){return String.fromCharCode(e)};var Ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zs(e){for(var r="",t=0,s=0,n=0,i=0,a=0,o=0,l=0,c=0;c<e.length;)i=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(s=e.charCodeAt(c++))>>4,o=(15&s)<<2|(n=e.charCodeAt(c++))>>6,l=63&n,isNaN(s)?o=l=64:isNaN(n)&&(l=64),r+=Ws.charAt(i)+Ws.charAt(a)+Ws.charAt(o)+Ws.charAt(l);return r}function $s(e){var r="",t=0,s=0,n=0,i=0,a=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)t=Ws.indexOf(e.charAt(l++))<<2|(i=Ws.indexOf(e.charAt(l++)))>>4,r+=String.fromCharCode(t),s=(15&i)<<4|(a=Ws.indexOf(e.charAt(l++)))>>2,64!==a&&(r+=String.fromCharCode(s)),n=(3&a)<<6|(o=Ws.indexOf(e.charAt(l++))),64!==o&&(r+=String.fromCharCode(n));return r}var Gs=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),qs=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(r){e=!0}return e?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Xs(e){return Gs?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Ys(e){return Gs?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Ks=function(e){return Gs?qs(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Js(e){if("undefined"==typeof ArrayBuffer)return Ks(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),s=0;s!=e.length;++s)t[s]=255&e.charCodeAt(s);return r}function Qs(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Zs(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Zs(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var en=Gs?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:qs(e)}))}:function(e){if("undefined"!=typeof Uint8Array){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var s=new Uint8Array(t),n=0;for(r=0,t=0;r<e.length;t+=n,++r)if(n=e[r].length,e[r]instanceof Uint8Array)s.set(e[r],t);else{if("string"==typeof e[r])throw"wtf";s.set(new Uint8Array(e[r]),t)}return s}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var rn=/\u0000/g,tn=/[\u0001-\u0006]/g;function sn(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function nn(e,r){var t=""+e;return t.length>=r?t:xi("0",r-t.length)+t}function an(e,r){var t=""+e;return t.length>=r?t:xi(" ",r-t.length)+t}function on(e,r){var t=""+e;return t.length>=r?t:t+xi(" ",r-t.length)}var ln=Math.pow(2,32);function cn(e,r){return e>ln||e<-ln?function(e,r){var t=""+Math.round(e);return t.length>=r?t:xi("0",r-t.length)+t}(e,r):function(e,r){var t=""+e;return t.length>=r?t:xi("0",r-t.length)+t}(Math.round(e),r)}function mn(e,r){return r=r||0,e.length>=7+r&&103==(32|e.charCodeAt(r))&&101==(32|e.charCodeAt(r+1))&&110==(32|e.charCodeAt(r+2))&&101==(32|e.charCodeAt(r+3))&&114==(32|e.charCodeAt(r+4))&&97==(32|e.charCodeAt(r+5))&&108==(32|e.charCodeAt(r+6))}var un=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],dn=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var fn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},hn={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},pn={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gn(e,r,t){for(var s=e<0?-1:1,n=e*s,i=0,a=1,o=0,l=1,c=0,m=0,u=Math.floor(n);c<r&&(o=(u=Math.floor(n))*a+i,m=u*c+l,!(n-u<5e-8));)n=1/(n-u),i=a,a=o,l=c,c=m;if(m>r&&(c>r?(m=l,o=i):(m=c,o=a)),!t)return[0,s*o,m];var d=Math.floor(s*o/m);return[d,s*o-d*m,m]}function bn(e,r,t){if(e>2958465||e<0)return null;var s=0|e,n=Math.floor(86400*(e-s)),i=0,a=[],o={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(s+=1462),o.u>.9999&&(o.u=0,86400==++n&&(o.T=n=0,++s,++o.D)),60===s)a=t?[1317,10,29]:[1900,2,29],i=3;else if(0===s)a=t?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var l=new Date(1900,0,1);l.setDate(l.getDate()+s-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),s<60&&(i=(i+6)%7),t&&(i=function(e,r){r[0]-=581;var t=e.getDay();e<60&&(t=(t+6)%7);return t}(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var vn=new Date(1899,11,31,0,0,0),Nn=vn.getTime(),xn=new Date(1900,2,1,0,0,0);function yn(e,r){var t=e.getTime();return r?t-=1262304e5:e>=xn&&(t+=864e5),(t-(Nn+6e4*(e.getTimezoneOffset()-vn.getTimezoneOffset())))/864e5}function En(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function wn(e){var r,t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return r=t>=-4&&t<=-1?e.toPrecision(10+t):Math.abs(t)<=9?function(e){var r=e<0?12:11,t=En(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10)).length<=r?t:e.toExponential(5)}(e):10===t?e.toFixed(10).substr(0,12):function(e){var r=En(e.toFixed(11));return r.length>(e<0?12:11)||"0"===r||"-0"===r?e.toPrecision(6):r}(e),En(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(r.toUpperCase()))}function Dn(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):wn(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return $n(14,yn(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function _n(e,r,t,s){var n,i="",a=0,o=0,l=t.y,c=0;switch(e){case 98:l=t.y+543;case 121:switch(r.length){case 1:case 2:n=l%100,c=2;break;default:n=l%1e4,c=4}break;case 109:switch(r.length){case 1:case 2:n=t.m,c=r.length;break;case 3:return dn[t.m-1][1];case 5:return dn[t.m-1][0];default:return dn[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:n=t.d,c=r.length;break;case 3:return un[t.q][0];default:return un[t.q][1]}break;case 104:switch(r.length){case 1:case 2:n=1+(t.H+11)%12,c=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:n=t.H,c=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:n=t.M,c=r.length;break;default:throw"bad minute format: "+r}break;case 115:if("s"!=r&&"ss"!=r&&".0"!=r&&".00"!=r&&".000"!=r)throw"bad second format: "+r;return 0!==t.u||"s"!=r&&"ss"!=r?(o=s>=2?3===s?1e3:100:1===s?10:1,(a=Math.round(o*(t.S+t.u)))>=60*o&&(a=0),"s"===r?0===a?"0":""+a/o:(i=nn(a,2+s),"ss"===r?i.substr(0,2):"."+i.substr(2,r.length-1))):nn(t.S,r.length);case 90:switch(r){case"[h]":case"[hh]":n=24*t.D+t.H;break;case"[m]":case"[mm]":n=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":n=60*(60*(24*t.D+t.H)+t.M)+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}c=3===r.length?1:2;break;case 101:n=l,c=1}return c>0?nn(n,c):""}function Hn(e){if(e.length<=3)return e;for(var r=e.length%3,t=e.substr(0,r);r!=e.length;r+=3)t+=(t.length>0?",":"")+e.substr(r,3);return t}var Tn=/%/g;function Sn(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+Sn(e,-r);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),-1===(t=(r/Math.pow(10,i)).toPrecision(s+1+(n+i)%n)).indexOf("e")){var a=Math.floor(Math.log(r)*Math.LOG10E);for(-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+i):t+="E+"+(a-i);"0."===t.substr(0,2);)t=(t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,r,t,s){return r+t+s.substr(0,(n+i)%n)+"."+s.substr(i)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var jn=/# (\?+)( ?)\/( ?)(\d+)/;var kn=/^#*0*\.([0#]+)/,Vn=/\).*[0#]/,Cn=/\(###\) ###\\?-####/;function Rn(e){for(var r,t="",s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function An(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Mn(e,r){var t=e-Math.floor(e),s=Math.pow(10,r);return r<(""+Math.round(t*s)).length?0:Math.round(t*s)}function In(e,r,t){if(40===e.charCodeAt(0)&&!r.match(Vn)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?In("n",s,t):"("+In("n",s,-t)+")"}if(44===r.charCodeAt(r.length-1))return function(e,r,t){for(var s=r.length-1;44===r.charCodeAt(s-1);)--s;return Ln(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}(e,r,t);if(-1!==r.indexOf("%"))return function(e,r,t){var s=r.replace(Tn,""),n=r.length-s.length;return Ln(e,s,t*Math.pow(10,2*n))+xi("%",n)}(e,r,t);if(-1!==r.indexOf("E"))return Sn(r,t);if(36===r.charCodeAt(0))return"$"+In(e,r.substr(" "==r.charAt(1)?2:1),t);var n,i,a,o,l=Math.abs(t),c=t<0?"-":"";if(r.match(/^00+$/))return c+cn(l,r.length);if(r.match(/^[#?]+$/))return"0"===(n=cn(t,0))&&(n=""),n.length>r.length?n:Rn(r.substr(0,r.length-n.length))+n;if(i=r.match(jn))return function(e,r,t){var s=parseInt(e[4],10),n=Math.round(r*s),i=Math.floor(n/s),a=n-i*s,o=s;return t+(0===i?"":""+i)+" "+(0===a?xi(" ",e[1].length+1+e[4].length):an(a,e[1].length)+e[2]+"/"+e[3]+nn(o,e[4].length))}(i,l,c);if(r.match(/^#+0+$/))return c+cn(l,r.length-r.indexOf("0"));if(i=r.match(kn))return n=An(t,i[1].length).replace(/^([^\.]+)$/,"$1."+Rn(i[1])).replace(/\.$/,"."+Rn(i[1])).replace(/\.(\d*)$/,function(e,r){return"."+r+xi("0",Rn(i[1]).length-r.length)}),-1!==r.indexOf("0.")?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return c+An(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return c+Hn(cn(l,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+In(e,r,-t):Hn(""+(Math.floor(t)+function(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}(t,i[1].length)))+"."+nn(Mn(t,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return In(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=sn(In(e,r.replace(/[\\-]/g,""),t)),a=0,sn(sn(r.replace(/\\/g,"")).replace(/[0#]/g,function(e){return a<n.length?n.charAt(a++):"0"===e?"0":""}));if(r.match(Cn))return"("+(n=In(e,"##########",t)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=gn(l,Math.pow(10,a)-1,!1),n=""+c," "==(m=Ln("n",i[1],o[1])).charAt(m.length-1)&&(m=m.substr(0,m.length-1)+"0"),n+=m+i[2]+"/"+i[3],(m=on(o[2],a)).length<i[4].length&&(m=Rn(i[4].substr(i[4].length-m.length))+m),n+=m;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=gn(l,Math.pow(10,a)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?an(o[1],a)+i[2]+"/"+i[3]+on(o[2],a):xi(" ",2*a+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=cn(t,0),r.length<=n.length?n:Rn(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var u=r.indexOf(".")-a,d=r.length-n.length-u;return Rn(r.substr(0,u)+n+r.substr(r.length-d))}if(i=r.match(/^00,000\.([#0]*0)$/))return a=Mn(t,i[1].length),t<0?"-"+In(e,r,-t):Hn(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?nn(0,3-e.length):"")+e})+"."+nn(a,i[1].length);switch(r){case"###,##0.00":return In(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var f=Hn(cn(l,0));return"0"!==f?c+f:"";case"###,###.00":return In(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return In(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function On(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+On(e,-r);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),!(t=(r/Math.pow(10,i)).toPrecision(s+1+(n+i)%n)).match(/[Ee]/)){var a=Math.floor(Math.log(r)*Math.LOG10E);-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+i):t+="E+"+(a-i),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,r,t,s){return r+t+s.substr(0,(n+i)%n)+"."+s.substr(i)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Pn(e,r,t){if(40===e.charCodeAt(0)&&!r.match(Vn)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Pn("n",s,t):"("+Pn("n",s,-t)+")"}if(44===r.charCodeAt(r.length-1))return function(e,r,t){for(var s=r.length-1;44===r.charCodeAt(s-1);)--s;return Ln(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}(e,r,t);if(-1!==r.indexOf("%"))return function(e,r,t){var s=r.replace(Tn,""),n=r.length-s.length;return Ln(e,s,t*Math.pow(10,2*n))+xi("%",n)}(e,r,t);if(-1!==r.indexOf("E"))return On(r,t);if(36===r.charCodeAt(0))return"$"+Pn(e,r.substr(" "==r.charAt(1)?2:1),t);var n,i,a,o,l=Math.abs(t),c=t<0?"-":"";if(r.match(/^00+$/))return c+nn(l,r.length);if(r.match(/^[#?]+$/))return n=""+t,0===t&&(n=""),n.length>r.length?n:Rn(r.substr(0,r.length-n.length))+n;if(i=r.match(jn))return function(e,r,t){return t+(0===r?"":""+r)+xi(" ",e[1].length+2+e[4].length)}(i,l,c);if(r.match(/^#+0+$/))return c+nn(l,r.length-r.indexOf("0"));if(i=r.match(kn))return n=(n=(""+t).replace(/^([^\.]+)$/,"$1."+Rn(i[1])).replace(/\.$/,"."+Rn(i[1]))).replace(/\.(\d*)$/,function(e,r){return"."+r+xi("0",Rn(i[1]).length-r.length)}),-1!==r.indexOf("0.")?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return c+Hn(""+l);if(i=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Pn(e,r,-t):Hn(""+t)+"."+xi("0",i[1].length);if(i=r.match(/^#,#*,#0/))return Pn(e,r.replace(/^#,#*,/,""),t);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=sn(Pn(e,r.replace(/[\\-]/g,""),t)),a=0,sn(sn(r.replace(/\\/g,"")).replace(/[0#]/g,function(e){return a<n.length?n.charAt(a++):"0"===e?"0":""}));if(r.match(Cn))return"("+(n=Pn(e,"##########",t)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var m="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=gn(l,Math.pow(10,a)-1,!1),n=""+c," "==(m=Ln("n",i[1],o[1])).charAt(m.length-1)&&(m=m.substr(0,m.length-1)+"0"),n+=m+i[2]+"/"+i[3],(m=on(o[2],a)).length<i[4].length&&(m=Rn(i[4].substr(i[4].length-m.length))+m),n+=m;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=gn(l,Math.pow(10,a)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?an(o[1],a)+i[2]+"/"+i[3]+on(o[2],a):xi(" ",2*a+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=""+t,r.length<=n.length?n:Rn(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var u=r.indexOf(".")-a,d=r.length-n.length-u;return Rn(r.substr(0,u)+n+r.substr(r.length-d))}if(i=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Pn(e,r,-t):Hn(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?nn(0,3-e.length):"")+e})+"."+nn(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var f=Hn(""+l);return"0"!==f?c+f:"";default:if(r.match(/\.[0#?]*$/))return Pn(e,r.slice(0,r.lastIndexOf(".")),t)+Rn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Ln(e,r,t){return(0|t)===t?Pn(e,r,t):In(e,r,t)}var Fn=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Un(e){for(var r=0,t="",s="";r<e.length;)switch(t=e.charAt(r)){case"G":mn(e,r)&&(r+=6),r++;break;case'"':for(;34!==e.charCodeAt(++r)&&r<e.length;);++r;break;case"\\":case"_":r+=2;break;case"@":++r;break;case"B":case"b":if("1"===e.charAt(r+1)||"2"===e.charAt(r+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(r,3).toUpperCase())return!0;if("AM/PM"===e.substr(r,5).toUpperCase())return!0;if("上午/下午"===e.substr(r,5).toUpperCase())return!0;++r;break;case"[":for(s=t;"]"!==e.charAt(r++)&&r<e.length;)s+=e.charAt(r);if(s.match(Fn))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||"\\"==t&&"-"==e.charAt(r+1)&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r," "!=e.charAt(r)&&"*"!=e.charAt(r)||++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;default:++r}return!1}var Bn=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Wn(e,r){if(null==r)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0}return!1}function zn(e,r){var t=function(e){for(var r=[],t=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:t=!t;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=e.substr(n,s-n),n=s+1}if(r[r.length]=e.substr(n),!0===t)throw new Error("Format |"+e+"| unterminated string ");return r}(e),s=t.length,n=t[s-1].indexOf("@");if(s<4&&n>-1&&--s,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof r)return[4,4===t.length||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var i=r>0?t[0]:r<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[s,i];if(null!=t[0].match(/\[[=<>]/)||null!=t[1].match(/\[[=<>]/)){var a=t[0].match(Bn),o=t[1].match(Bn);return Wn(r,a)?[s,t[0]]:Wn(r,o)?[s,t[1]]:[s,t[null!=a&&null!=o?2:1]]}return[s,i]}function $n(e,r,t){null==t&&(t={});var s="";switch(typeof e){case"string":s="m/d/yy"==e&&t.dateNF?t.dateNF:e;break;case"number":null==(s=14==e&&t.dateNF?t.dateNF:(null!=t.table?t.table:fn)[e])&&(s=t.table&&t.table[hn[e]]||fn[hn[e]]),null==s&&(s=pn[e]||"General")}if(mn(s,0))return Dn(r,t);r instanceof Date&&(r=yn(r,t.date1904));var n=zn(s,r);if(mn(n[1]))return Dn(r,t);if(!0===r)r="TRUE";else if(!1===r)r="FALSE";else if(""===r||null==r)return"";return function(e,r,t,s){for(var n,i,a,o=[],l="",c=0,m="",u="t",d="H";c<e.length;)switch(m=e.charAt(c)){case"G":if(!mn(e,c))throw new Error("unrecognized character "+m+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(a=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(a);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),h="("===f||")"===f?f:"t";o[o.length]={t:h,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:r},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==n&&null==(n=bn(r,t,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},u=m,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":m=m.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0)return"";if(null==n&&null==(n=bn(r,t)))return"";for(l=m;++c<e.length&&e.charAt(c).toLowerCase()===m;)l+=m;"m"===m&&"h"===u.toLowerCase()&&(m="M"),"h"===m&&(m=d),o[o.length]={t:m,v:l},u=m;break;case"A":case"a":case"上":var p={t:m,v:m};if(null==n&&(n=bn(r,t)),"A/P"===e.substr(c,3).toUpperCase()?(null!=n&&(p.v=n.H>=12?"P":"A"),p.t="T",d="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=n&&(p.v=n.H>=12?"PM":"AM"),p.t="T",c+=5,d="h"):"上午/下午"===e.substr(c,5).toUpperCase()?(null!=n&&(p.v=n.H>=12?"下午":"上午"),p.t="T",c+=5,d="h"):(p.t="t",++c),null==n&&"T"===p.t)return"";o[o.length]=p,u=m;break;case"[":for(l=m;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Fn)){if(null==n&&null==(n=bn(r,t)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Un(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=n){for(l=m;++c<e.length&&"0"===(m=e.charAt(c));)l+=m;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=m;++c<e.length&&"0#?.,E+-%".indexOf(m=e.charAt(c))>-1;)l+=m;o[o.length]={t:"n",v:l};break;case"?":for(l=m;e.charAt(++c)===m;)l+=m;o[o.length]={t:m,v:l},u=m;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===s?"t":m,v:m},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=m;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:m,v:m},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(m))throw new Error("unrecognized character "+m+" in "+e);o[o.length]={t:"t",v:m},++c}var g,b=0,v=0;for(c=o.length-1,u="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=d,u="h",b<1&&(b=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(v=Math.max(v,g[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":u=o[c].t;break;case"m":"s"===u&&(o[c].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&o[c].v.match(/[Hh]/)&&(b=1),b<2&&o[c].v.match(/[Mm]/)&&(b=2),b<3&&o[c].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M),n.M>=60&&(n.M=0,++n.H);break;case 2:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M)}var N,x="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=_n(o[c].t.charCodeAt(0),o[c].v,n,v),o[c].t="t";break;case"n":case"?":for(N=c+1;null!=o[N]&&("?"===(m=o[N].t)||"D"===m||(" "===m||"t"===m)&&null!=o[N+1]&&("?"===o[N+1].t||"t"===o[N+1].t&&"/"===o[N+1].v)||"("===o[c].t&&(" "===m||"n"===m||")"===m)||"t"===m&&("/"===o[N].v||" "===o[N].v&&null!=o[N+1]&&"?"==o[N+1].t));)o[c].v+=o[N].v,o[N]={v:"",t:";"},++N;x+=o[c].v,c=N-1;break;case"G":o[c].t="t",o[c].v=Dn(r,t)}var y,E,w="";if(x.length>0){40==x.charCodeAt(0)?(y=r<0&&45===x.charCodeAt(0)?-r:r,E=Ln("n",x,y)):(E=Ln("n",x,y=r<0&&s>1?-r:r),y<0&&o[0]&&"t"==o[0].t&&(E=E.substr(1),o[0].v="-"+o[0].v)),N=E.length-1;var D=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){D=c;break}var _=o.length;if(D===o.length&&-1===E.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(N>=o[c].v.length-1?(N-=o[c].v.length,o[c].v=E.substr(N+1,o[c].v.length)):N<0?o[c].v="":(o[c].v=E.substr(0,N+1),N=-1),o[c].t="t",_=c);N>=0&&_<o.length&&(o[_].v=E.substr(0,N+1)+o[_].v)}else if(D!==o.length&&-1===E.indexOf("E")){for(N=E.indexOf(".")-1,c=D;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(i=o[c].v.indexOf(".")>-1&&c===D?o[c].v.indexOf(".")-1:o[c].v.length-1,w=o[c].v.substr(i+1);i>=0;--i)N>=0&&("0"===o[c].v.charAt(i)||"#"===o[c].v.charAt(i))&&(w=E.charAt(N--)+w);o[c].v=w,o[c].t="t",_=c}for(N>=0&&_<o.length&&(o[_].v=E.substr(0,N+1)+o[_].v),N=E.indexOf(".")+1,c=D;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===D)){for(i=o[c].v.indexOf(".")>-1&&c===D?o[c].v.indexOf(".")+1:0,w=o[c].v.substr(0,i);i<o[c].v.length;++i)N<E.length&&(w+=E.charAt(N++));o[c].v=w,o[c].t="t",_=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(y=s>1&&r<0&&c>0&&"-"===o[c-1].v?-r:r,o[c].v=Ln(o[c].t,o[c].v,y),o[c].t="t");var H="";for(c=0;c!==o.length;++c)null!=o[c]&&(H+=o[c].v);return H}(n[1],r,t,n[0])}function Gn(e,r){if("number"!=typeof r){r=+r||-1;for(var t=0;t<392;++t)if(null!=fn[t]){if(fn[t]==e){r=t;break}}else r<0&&(r=t);r<0&&(r=391)}return fn[r]=e,r}function qn(e){for(var r=0;392!=r;++r)void 0!==e[r]&&Gn(e[r],r)}function Xn(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',fn=e}var Yn={format:$n,load:Gn,_table:fn,load_table:qn,parse_date_code:bn,is_date:Un,get_table:function(){return Yn._table=fn}},Kn={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Jn=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Qn=function(){var e={};e.version="1.2.0";var r=function(){for(var e=0,r=new Array(256),t=0;256!=t;++t)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=t)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,r[t]=e;return"undefined"!=typeof Int32Array?new Int32Array(r):r}();var t=function(e){var r=0,t=0,s=0,n="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(s=0;256!=s;++s)n[s]=e[s];for(s=0;256!=s;++s)for(t=e[s],r=256+s;r<4096;r+=256)t=n[r]=t>>>8^e[255&t];var i=[];for(s=1;16!=s;++s)i[s-1]="undefined"!=typeof Int32Array?n.subarray(256*s,256*s+256):n.slice(256*s,256*s+256);return i}(r),s=t[0],n=t[1],i=t[2],a=t[3],o=t[4],l=t[5],c=t[6],m=t[7],u=t[8],d=t[9],f=t[10],h=t[11],p=t[12],g=t[13],b=t[14];return e.table=r,e.bstr=function(e,t){for(var s=-1^t,n=0,i=e.length;n<i;)s=s>>>8^r[255&(s^e.charCodeAt(n++))];return~s},e.buf=function(e,t){for(var v=-1^t,N=e.length-15,x=0;x<N;)v=b[e[x++]^255&v]^g[e[x++]^v>>8&255]^p[e[x++]^v>>16&255]^h[e[x++]^v>>>24]^f[e[x++]]^d[e[x++]]^u[e[x++]]^m[e[x++]]^c[e[x++]]^l[e[x++]]^o[e[x++]]^a[e[x++]]^i[e[x++]]^n[e[x++]]^s[e[x++]]^r[e[x++]];for(N+=15;x<N;)v=v>>>8^r[255&(v^e[x++])];return~v},e.str=function(e,t){for(var s=-1^t,n=0,i=e.length,a=0,o=0;n<i;)(a=e.charCodeAt(n++))<128?s=s>>>8^r[255&(s^a)]:a<2048?s=(s=s>>>8^r[255&(s^(192|a>>6&31))])>>>8^r[255&(s^(128|63&a))]:a>=55296&&a<57344?(a=64+(1023&a),o=1023&e.charCodeAt(n++),s=(s=(s=(s=s>>>8^r[255&(s^(240|a>>8&7))])>>>8^r[255&(s^(128|a>>2&63))])>>>8^r[255&(s^(128|o>>6&15|(3&a)<<4))])>>>8^r[255&(s^(128|63&o))]):s=(s=(s=s>>>8^r[255&(s^(224|a>>12&15))])>>>8^r[255&(s^(128|a>>6&63))])>>>8^r[255&(s^(128|63&a))];return~s},e}(),Zn=function(){var e,r={};function t(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:t(e.slice(0,-1));var r=e.lastIndexOf("/");return-1===r?e:e.slice(0,r+1)}function s(e){if("/"==e.charAt(e.length-1))return s(e.slice(0,-1));var r=e.lastIndexOf("/");return-1===r?e:e.slice(r+1)}function n(e,r){"string"==typeof r&&(r=new Date(r));var t=r.getHours();t=(t=t<<6|r.getMinutes())<<5|r.getSeconds()>>>1,e.write_shift(2,t);var s=r.getFullYear()-1980;s=(s=s<<4|r.getMonth()+1)<<5|r.getDate(),e.write_shift(2,s)}function i(e){Eo(e,0);for(var r={},t=0;e.l<=e.length-4;){var s=e.read_shift(2),n=e.read_shift(2),i=e.l+n,a={};if(21589===s)1&(t=e.read_shift(1))&&(a.mtime=e.read_shift(4)),n>5&&(2&t&&(a.atime=e.read_shift(4)),4&t&&(a.ctime=e.read_shift(4))),a.mtime&&(a.mt=new Date(1e3*a.mtime));e.l=i,r[s]=a}return r}function a(){return e||(e={})}function o(e,r){if(80==e[0]&&75==e[1])return se(e,r);if(109==(32|e[0])&&105==(32|e[1]))return function(e,r){if("mime-version:"!=E(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var t=r&&r.root||"",s=(Gs&&Buffer.isBuffer(e)?e.toString("binary"):E(e)).split("\r\n"),n=0,i="";for(n=0;n<s.length;++n)if(i=s[n],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),t||(t=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,t.length)!=t))for(;t.length>0&&(t=(t=t.slice(0,t.length-1)).slice(0,t.lastIndexOf("/")+1),i.slice(0,t.length)!=t););var a=(s[1]||"").match(/boundary="(.*?)"/);if(!a)throw new Error("MAD cannot find boundary");var o="--"+(a[1]||""),l=[],c=[],m={FileIndex:l,FullPaths:c};d(m);var u,f=0;for(n=0;n<s.length;++n){var h=s[n];h!==o&&h!==o+"--"||(f++&&ce(m,s.slice(u,n),t),u=n)}return m}(e,r);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var t,s,n,i,a,o,f=512,h=[],p=e.slice(0,512);Eo(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(v,"Header Signature: "),e.l+=16;var r=e.read_shift(2,"u");return[e.read_shift(2,"u"),r]}(p);switch(t=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return se(e,r);default:throw new Error("Major Version: Expected 3 or 4 saw "+t)}512!==f&&Eo(p=e.slice(0,f),28);var N=e.slice(0,f);!function(e,r){var t=9;switch(e.l+=2,t=e.read_shift(2)){case 9:if(3!=r)throw new Error("Sector Shift: Expected 9 saw "+t);break;case 12:if(4!=r)throw new Error("Sector Shift: Expected 12 saw "+t);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+t)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,t);var x=p.read_shift(4,"i");if(3===t&&0!==x)throw new Error("# Directory Sectors: Expected 0 saw "+x);p.l+=4,i=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),a=p.read_shift(4,"i"),s=p.read_shift(4,"i"),o=p.read_shift(4,"i"),n=p.read_shift(4,"i");for(var y=-1,w=0;w<109&&!((y=p.read_shift(4,"i"))<0);++w)h[w]=y;var D=function(e,r){for(var t=Math.ceil(e.length/r)-1,s=[],n=1;n<t;++n)s[n-1]=e.slice(n*r,(n+1)*r);return s[t-1]=e.slice(t*r),s}(e,f);c(o,n,D,f,h);var _=function(e,r,t,s){var n=e.length,i=[],a=[],o=[],l=[],c=s-1,m=0,u=0,d=0,f=0;for(m=0;m<n;++m)if(o=[],(d=m+r)>=n&&(d-=n),!a[d]){l=[];var h=[];for(u=d;u>=0;){h[u]=!0,a[u]=!0,o[o.length]=u,l.push(e[u]);var p=t[Math.floor(4*u/s)];if(s<4+(f=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+s);if(!e[p])break;if(h[u=ho(e[p],f)])break}i[d]={nodes:o,data:Ba([l])}}return i}(D,i,h,f);_[i].name="!Directory",s>0&&a!==b&&(_[a].name="!MiniFAT"),_[h[0]].name="!FAT",_.fat_addrs=h,_.ssz=f;var H=[],T=[],S=[];!function(e,r,t,s,n,i,a,o){for(var c,d=0,f=s.length?2:0,h=r[e].data,p=0,g=0;p<h.length;p+=128){var v=h.slice(p,p+128);Eo(v,64),g=v.read_shift(2),c=za(v,0,g-f),s.push(c);var N={name:c,type:v.read_shift(1),color:v.read_shift(1),L:v.read_shift(4,"i"),R:v.read_shift(4,"i"),C:v.read_shift(4,"i"),clsid:v.read_shift(16),state:v.read_shift(4,"i"),start:0,size:0};0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(N.ct=u(v,v.l-8)),0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(N.mt=u(v,v.l-8)),N.start=v.read_shift(4,"i"),N.size=v.read_shift(4,"i"),N.size<0&&N.start<0&&(N.size=N.type=0,N.start=b,N.name=""),5===N.type?(d=N.start,n>0&&d!==b&&(r[d].name="!StreamData")):N.size>=4096?(N.storage="fat",void 0===r[N.start]&&(r[N.start]=m(t,N.start,r.fat_addrs,r.ssz)),r[N.start].name=N.name,N.content=r[N.start].data.slice(0,N.size)):(N.storage="minifat",N.size<0?N.size=0:d!==b&&N.start!==b&&r[d]&&(N.content=l(N,r[d].data,(r[o]||{}).data))),N.content&&Eo(N.content,0),i[c]=N,a.push(N)}}(i,_,D,H,s,{},T,a),function(e,r,t){for(var s=0,n=0,i=0,a=0,o=0,l=t.length,c=[],m=[];s<l;++s)c[s]=m[s]=s,r[s]=t[s];for(;o<m.length;++o)n=e[s=m[o]].L,i=e[s].R,a=e[s].C,c[s]===s&&(-1!==n&&c[n]!==n&&(c[s]=c[n]),-1!==i&&c[i]!==i&&(c[s]=c[i])),-1!==a&&(c[a]=s),-1!==n&&s!=c[s]&&(c[n]=c[s],m.lastIndexOf(n)<o&&m.push(n)),-1!==i&&s!=c[s]&&(c[i]=c[s],m.lastIndexOf(i)<o&&m.push(i));for(s=1;s<l;++s)c[s]===s&&(-1!==i&&c[i]!==i?c[s]=c[i]:-1!==n&&c[n]!==n&&(c[s]=c[n]));for(s=1;s<l;++s)if(0!==e[s].type){if((o=s)!=c[o])do{o=c[o],r[s]=r[o]+"/"+r[s]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[s]=-1}for(r[0]+="/",s=1;s<l;++s)2!==e[s].type&&(r[s]+="/")}(T,S,H),H.shift();var j={FileIndex:T,FullPaths:S};return r&&r.raw&&(j.raw={header:N,sectors:D}),j}function l(e,r,t){for(var s=e.start,n=e.size,i=[],a=s;t&&n>0&&a>=0;)i.push(r.slice(a*g,a*g+g)),n-=g,a=ho(t,4*a);return 0===i.length?Do(0):en(i).slice(0,e.size)}function c(e,r,t,s,n){var i=b;if(e===b){if(0!==r)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var a=t[e],o=(s>>>2)-1;if(!a)return;for(var l=0;l<o&&(i=ho(a,4*l))!==b;++l)n.push(i);c(ho(a,s-4),r-1,t,s,n)}}function m(e,r,t,s,n){var i=[],a=[];n||(n=[]);var o=s-1,l=0,c=0;for(l=r;l>=0;){n[l]=!0,i[i.length]=l,a.push(e[l]);var m=t[Math.floor(4*l/s)];if(s<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+s);if(!e[m])break;l=ho(e[m],c)}return{nodes:i,data:Ba([a])}}function u(e,r){return new Date(1e3*(fo(e,r+4)/1e7*Math.pow(2,32)+fo(e,r)/1e7-11644473600))}function d(e,r){var t=r||{},s=t.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=s+"/",e.FileIndex[0]={name:s,type:5}),t.CLSID&&(e.FileIndex[0].clsid=t.CLSID),function(e){var r="Sh33tJ5";if(Zn.find(e,"/"+r))return;var t=Do(4);t[0]=55,t[1]=t[3]=50,t[2]=54,e.FileIndex.push({name:r,type:2,content:t,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+r),f(e)}(e)}function f(e,r){d(e);for(var n=!1,i=!1,a=e.FullPaths.length-1;a>=0;--a){var o=e.FileIndex[a];switch(o.type){case 0:i?n=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(o.R*o.L*o.C)&&(n=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(n=!0);break;default:n=!0}}if(n||r){var l=new Date(1987,1,19),c=0,m=Object.create?Object.create(null):{},u=[];for(a=0;a<e.FullPaths.length;++a)m[e.FullPaths[a]]=!0,0!==e.FileIndex[a].type&&u.push([e.FullPaths[a],e.FileIndex[a]]);for(a=0;a<u.length;++a){var f=t(u[a][0]);(i=m[f])||(u.push([f,{name:s(f).replace("/",""),type:1,clsid:x,ct:l,mt:l,content:null}]),m[f]=!0)}for(u.sort(function(e,r){return function(e,r){for(var t=e.split("/"),s=r.split("/"),n=0,i=0,a=Math.min(t.length,s.length);n<a;++n){if(i=t[n].length-s[n].length)return i;if(t[n]!=s[n])return t[n]<s[n]?-1:1}return t.length-s.length}(e[0],r[0])}),e.FullPaths=[],e.FileIndex=[],a=0;a<u.length;++a)e.FullPaths[a]=u[a][0],e.FileIndex[a]=u[a][1];for(a=0;a<u.length;++a){var h=e.FileIndex[a],p=e.FullPaths[a];if(h.name=s(p).replace("/",""),h.L=h.R=h.C=-(h.color=1),h.size=h.content?h.content.length:0,h.start=0,h.clsid=h.clsid||x,0===a)h.C=u.length>1?1:-1,h.size=0,h.type=5;else if("/"==p.slice(-1)){for(c=a+1;c<u.length&&t(e.FullPaths[c])!=p;++c);for(h.C=c>=u.length?-1:c,c=a+1;c<u.length&&t(e.FullPaths[c])!=t(p);++c);h.R=c>=u.length?-1:c,h.type=1}else t(e.FullPaths[a+1]||"")==t(p)&&(h.R=a+1),h.type=2}}}function h(e,r){var t=r||{};if("mad"==t.fileType)return function(e,r){for(var t=r||{},s=t.boundary||"SheetJS",n=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(s="------="+s).slice(2)+'"',"","",""],i=e.FullPaths[0],a=i,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(a=e.FullPaths[l].slice(i.length),(o=e.FileIndex[l]).size&&o.content&&"Sh33tJ5"!=a){a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,m=Gs&&Buffer.isBuffer(c)?c.toString("binary"):E(c),u=0,d=Math.min(1024,m.length),f=0,h=0;h<=d;++h)(f=m.charCodeAt(h))>=32&&f<128&&++u;var p=u>=4*d/5;n.push(s),n.push("Content-Location: "+(t.root||"file:///C:/SheetJS/")+a),n.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),n.push("Content-Type: "+ae(o,a)),n.push(""),n.push(p?le(m):oe(m))}return n.push(s+"--\r\n"),n.join("\r\n")}(e,t);if(f(e),"zip"===t.fileType)return function(e,r){var t=r||{},s=[],i=[],a=Do(1),o=t.compression?8:0,l=0,c=0,m=0,u=0,d=0,f=e.FullPaths[0],h=f,p=e.FileIndex[0],g=[],b=0;for(c=1;c<e.FullPaths.length;++c)if(h=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"Sh33tJ5"!=h){var v=u,N=Do(h.length);for(m=0;m<h.length;++m)N.write_shift(1,127&h.charCodeAt(m));N=N.slice(0,N.l),g[d]=Qn.buf(p.content,0);var x=p.content;8==o&&(x=w(x)),(a=Do(30)).write_shift(4,67324752),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,o),p.mt?n(a,p.mt):a.write_shift(4,0),a.write_shift(-4,g[d]),a.write_shift(4,x.length),a.write_shift(4,p.content.length),a.write_shift(2,N.length),a.write_shift(2,0),u+=a.length,s.push(a),u+=N.length,s.push(N),u+=x.length,s.push(x),(a=Do(46)).write_shift(4,33639248),a.write_shift(2,0),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,o),a.write_shift(4,0),a.write_shift(-4,g[d]),a.write_shift(4,x.length),a.write_shift(4,p.content.length),a.write_shift(2,N.length),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a.write_shift(4,v),b+=a.l,i.push(a),b+=N.length,i.push(N),++d}return a=Do(22),a.write_shift(4,101010256),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,d),a.write_shift(2,d),a.write_shift(4,b),a.write_shift(4,u),a.write_shift(2,0),en([en(s),en(i),a])}(e,t);var s=function(e){for(var r=0,t=0,s=0;s<e.FileIndex.length;++s){var n=e.FileIndex[s];if(n.content){var i=n.content.length;i>0&&(i<4096?r+=i+63>>6:t+=i+511>>9)}}for(var a=e.FullPaths.length+3>>2,o=r+127>>7,l=(r+7>>3)+t+a+o,c=l+127>>7,m=c<=109?0:Math.ceil((c-109)/127);l+c+m+127>>7>c;)m=++c<=109?0:Math.ceil((c-109)/127);var u=[1,m,c,o,a,t,r,0];return e.FileIndex[0].size=r<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),i=Do(s[7]<<9),a=0,o=0;for(a=0;a<8;++a)i.write_shift(1,N[a]);for(a=0;a<8;++a)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),a=0;a<3;++a)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,s[2]),i.write_shift(4,s[0]+s[1]+s[2]+s[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,s[3]?s[0]+s[1]+s[2]-1:b),i.write_shift(4,s[3]),i.write_shift(-4,s[1]?s[0]-1:b),i.write_shift(4,s[1]),a=0;a<109;++a)i.write_shift(-4,a<s[2]?s[1]+a:-1);if(s[1])for(o=0;o<s[1];++o){for(;a<236+127*o;++a)i.write_shift(-4,a<s[2]?s[1]+a:-1);i.write_shift(-4,o===s[1]-1?b:o+1)}var l=function(e){for(o+=e;a<o-1;++a)i.write_shift(-4,a+1);e&&(++a,i.write_shift(-4,b))};for(o=a=0,o+=s[1];a<o;++a)i.write_shift(-4,y.DIFSECT);for(o+=s[2];a<o;++a)i.write_shift(-4,y.FATSECT);l(s[3]),l(s[4]);for(var c=0,m=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((m=u.content.length)<4096||(u.start=o,l(m+511>>9)));for(l(s[6]+7>>3);511&i.l;)i.write_shift(-4,y.ENDOFCHAIN);for(o=a=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(m=u.content.length)||m>=4096||(u.start=o,l(m+63>>6)));for(;511&i.l;)i.write_shift(-4,y.ENDOFCHAIN);for(a=0;a<s[4]<<2;++a){var d=e.FullPaths[a];if(d&&0!==d.length){u=e.FileIndex[a],0===a&&(u.start=u.size?u.start-1:b);var h=0===a&&t.root||u.name;if(m=2*(h.length+1),i.write_shift(64,h,"utf16le"),i.write_shift(2,m),i.write_shift(1,u.type),i.write_shift(1,u.color),i.write_shift(-4,u.L),i.write_shift(-4,u.R),i.write_shift(-4,u.C),u.clsid)i.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)i.write_shift(4,0);i.write_shift(4,u.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,u.start),i.write_shift(4,u.size),i.write_shift(4,0)}else{for(c=0;c<17;++c)i.write_shift(4,0);for(c=0;c<3;++c)i.write_shift(4,-1);for(c=0;c<12;++c)i.write_shift(4,0)}}for(a=1;a<e.FileIndex.length;++a)if((u=e.FileIndex[a]).size>=4096)if(i.l=u.start+1<<9,Gs&&Buffer.isBuffer(u.content))u.content.copy(i,i.l,0,u.size),i.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)i.write_shift(1,u.content[c]);for(;511&c;++c)i.write_shift(1,0)}for(a=1;a<e.FileIndex.length;++a)if((u=e.FileIndex[a]).size>0&&u.size<4096)if(Gs&&Buffer.isBuffer(u.content))u.content.copy(i,i.l,0,u.size),i.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)i.write_shift(1,u.content[c]);for(;63&c;++c)i.write_shift(1,0)}if(Gs)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}r.version="1.2.1";var p,g=64,b=-2,v="d0cf11e0a1b11ae1",N=[208,207,17,224,161,177,26,225],x="00000000000000000000000000000000",y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:b,FREESECT:-1,HEADER_SIGNATURE:v,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:x,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function E(e){for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function w(e){return p?p.deflateRawSync(e):X(e)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],H=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function T(e){var r=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(r>>16|r>>8|r)}for(var S="undefined"!=typeof Uint8Array,j=S?new Uint8Array(256):[],k=0;k<256;++k)j[k]=T(k);function V(e,r){var t=j[255&e];return r<=8?t>>>8-r:(t=t<<8|j[e>>8&255],r<=16?t>>>16-r:(t=t<<8|j[e>>16&255])>>>24-r)}function C(e,r){var t=7&r,s=r>>>3;return(e[s]|(t<=6?0:e[s+1]<<8))>>>t&3}function R(e,r){var t=7&r,s=r>>>3;return(e[s]|(t<=5?0:e[s+1]<<8))>>>t&7}function A(e,r){var t=7&r,s=r>>>3;return(e[s]|(t<=3?0:e[s+1]<<8))>>>t&31}function M(e,r){var t=7&r,s=r>>>3;return(e[s]|(t<=1?0:e[s+1]<<8))>>>t&127}function I(e,r,t){var s=7&r,n=r>>>3,i=(1<<t)-1,a=e[n]>>>s;return t<8-s?a&i:(a|=e[n+1]<<8-s,t<16-s?a&i:(a|=e[n+2]<<16-s,t<24-s?a&i:(a|=e[n+3]<<24-s)&i))}function O(e,r,t){var s=7&r,n=r>>>3;return s<=5?e[n]|=(7&t)<<s:(e[n]|=t<<s&255,e[n+1]=(7&t)>>8-s),r+3}function P(e,r,t){return t=(1&t)<<(7&r),e[r>>>3]|=t,r+1}function L(e,r,t){var s=r>>>3;return t<<=7&r,e[s]|=255&t,t>>>=8,e[s+1]=t,r+8}function F(e,r,t){var s=r>>>3;return t<<=7&r,e[s]|=255&t,t>>>=8,e[s+1]=255&t,e[s+2]=t>>>8,r+16}function U(e,r){var t=e.length,s=2*t>r?2*t:r+5,n=0;if(t>=r)return e;if(Gs){var i=Ys(s);if(e.copy)e.copy(i);else for(;n<e.length;++n)i[n]=e[n];return i}if(S){var a=new Uint8Array(s);if(a.set)a.set(e);else for(;n<t;++n)a[n]=e[n];return a}return e.length=s,e}function B(e){for(var r=new Array(e),t=0;t<e;++t)r[t]=0;return r}function W(e,r,t){var s=1,n=0,i=0,a=0,o=0,l=e.length,c=S?new Uint16Array(32):B(32);for(i=0;i<32;++i)c[i]=0;for(i=l;i<t;++i)e[i]=0;l=e.length;var m=S?new Uint16Array(l):B(l);for(i=0;i<l;++i)c[n=e[i]]++,s<n&&(s=n),m[i]=0;for(c[0]=0,i=1;i<=s;++i)c[i+16]=o=o+c[i-1]<<1;for(i=0;i<l;++i)0!=(o=e[i])&&(m[i]=c[o+16]++);var u=0;for(i=0;i<l;++i)if(0!=(u=e[i]))for(o=V(m[i],s)>>s-u,a=(1<<s+4-u)-1;a>=0;--a)r[o|a<<u]=15&u|i<<4;return s}var z=S?new Uint16Array(512):B(512),$=S?new Uint16Array(32):B(32);if(!S){for(var G=0;G<512;++G)z[G]=0;for(G=0;G<32;++G)$[G]=0}!function(){for(var e=[],r=0;r<32;r++)e.push(5);W(e,$,32);var t=[];for(r=0;r<=143;r++)t.push(8);for(;r<=255;r++)t.push(9);for(;r<=279;r++)t.push(7);for(;r<=287;r++)t.push(8);W(t,z,288)}();var q=function(){for(var e=S?new Uint8Array(32768):[],r=0,t=0;r<H.length-1;++r)for(;t<H[r+1];++t)e[t]=r;for(;t<32768;++t)e[t]=29;var s=S?new Uint8Array(259):[];for(r=0,t=0;r<_.length-1;++r)for(;t<_[r+1];++t)s[t]=r;return function(r,t){return r.length<8?function(e,r){for(var t=0;t<e.length;){var s=Math.min(65535,e.length-t),n=t+s==e.length;for(r.write_shift(1,+n),r.write_shift(2,s),r.write_shift(2,65535&~s);s-- >0;)r[r.l++]=e[t++]}return r.l}(r,t):function(r,t){for(var n=0,i=0,a=S?new Uint16Array(32768):[];i<r.length;){var o=Math.min(65535,r.length-i);if(o<10){for(7&(n=O(t,n,+!(i+o!=r.length)))&&(n+=8-(7&n)),t.l=n/8|0,t.write_shift(2,o),t.write_shift(2,65535&~o);o-- >0;)t[t.l++]=r[i++];n=8*t.l}else{n=O(t,n,+!(i+o!=r.length)+2);for(var l=0;o-- >0;){var c=r[i],m=-1,u=0;if((m=a[l=32767&(l<<5^c)])&&((m|=-32768&i)>i&&(m-=32768),m<i))for(;r[m+u]==r[i+u]&&u<250;)++u;if(u>2){(c=s[u])<=22?n=L(t,n,j[c+1]>>1)-1:(L(t,n,3),L(t,n+=5,j[c-23]>>5),n+=3);var d=c<8?0:c-4>>2;d>0&&(F(t,n,u-_[c]),n+=d),c=e[i-m],n=L(t,n,j[c]>>3),n-=3;var f=c<4?0:c-2>>1;f>0&&(F(t,n,i-m-H[c]),n+=f);for(var h=0;h<u;++h)a[l]=32767&i,l=32767&(l<<5^r[i]),++i;o-=u-1}else c<=143?c+=48:n=P(t,n,1),n=L(t,n,j[c]),a[l]=32767&i,++i}n=L(t,n,0)-1}}return t.l=(n+7)/8|0,t.l}(r,t)}}();function X(e){var r=Do(50+Math.floor(1.1*e.length)),t=q(e,r);return r.slice(0,t)}var Y=S?new Uint16Array(32768):B(32768),K=S?new Uint16Array(32768):B(32768),J=S?new Uint16Array(128):B(128),Q=1,Z=1;function ee(e,r){var t=A(e,r)+257,s=A(e,r+=5)+1,n=function(e,r){var t=7&r,s=r>>>3;return(e[s]|(t<=4?0:e[s+1]<<8))>>>t&15}(e,r+=5)+4;r+=4;for(var i=0,a=S?new Uint8Array(19):B(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=S?new Uint8Array(8):B(8),m=S?new Uint8Array(8):B(8),u=a.length,d=0;d<n;++d)a[D[d]]=i=R(e,r),l<i&&(l=i),c[i]++,r+=3;var f=0;for(c[0]=0,d=1;d<=l;++d)m[d]=f=f+c[d-1]<<1;for(d=0;d<u;++d)0!=(f=a[d])&&(o[d]=m[f]++);var h=0;for(d=0;d<u;++d)if(0!=(h=a[d])){f=j[o[d]]>>8-h;for(var p=(1<<7-h)-1;p>=0;--p)J[f|p<<h]=7&h|d<<3}var g=[];for(l=1;g.length<t+s;)switch(r+=7&(f=J[M(e,r)]),f>>>=3){case 16:for(i=3+C(e,r),r+=2,f=g[g.length-1];i-- >0;)g.push(f);break;case 17:for(i=3+R(e,r),r+=3;i-- >0;)g.push(0);break;case 18:for(i=11+M(e,r),r+=7;i-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var b=g.slice(0,t),v=g.slice(t);for(d=t;d<286;++d)b[d]=0;for(d=s;d<30;++d)v[d]=0;return Q=W(b,Y,286),Z=W(v,K,30),r}function re(e,r){var t=function(e,r){if(3==e[0]&&!(3&e[1]))return[Xs(r),2];for(var t=0,s=0,n=Ys(r||1<<18),i=0,a=n.length>>>0,o=0,l=0;!(1&s);)if(s=R(e,t),t+=3,s>>>1!=0)for(s>>1==1?(o=9,l=5):(t=ee(e,t),o=Q,l=Z);;){!r&&a<i+32767&&(a=(n=U(n,i+32767)).length);var c=I(e,t,o),m=s>>>1==1?z[c]:Y[c];if(t+=15&m,(m>>>=4)>>>8&255){if(256==m)break;var u=(m-=257)<8?0:m-4>>2;u>5&&(u=0);var d=i+_[m];u>0&&(d+=I(e,t,u),t+=u),c=I(e,t,l),t+=15&(m=s>>>1==1?$[c]:K[c]);var f=(m>>>=4)<4?0:m-2>>1,h=H[m];for(f>0&&(h+=I(e,t,f),t+=f),!r&&a<d&&(a=(n=U(n,d+100)).length);i<d;)n[i]=n[i-h],++i}else n[i++]=m}else{7&t&&(t+=8-(7&t));var p=e[t>>>3]|e[(t>>>3)+1]<<8;if(t+=32,p>0)for(!r&&a<i+p&&(a=(n=U(n,i+p)).length);p-- >0;)n[i++]=e[t>>>3],t+=8}return r?[n,t+7>>>3]:[n.slice(0,i),t+7>>>3]}(e.slice(e.l||0),r);return e.l+=t[1],t[0]}function te(e,r){if(!e)throw new Error(r)}function se(e,r){var t=e;Eo(t,0);var s={FileIndex:[],FullPaths:[]};d(s,{root:r.root});for(var n=t.length-4;(80!=t[n]||75!=t[n+1]||5!=t[n+2]||6!=t[n+3])&&n>=0;)--n;t.l=n+4,t.l+=4;var a=t.read_shift(2);t.l+=6;var o=t.read_shift(4);for(t.l=o,n=0;n<a;++n){t.l+=20;var l=t.read_shift(4),c=t.read_shift(4),m=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2);t.l+=8;var h=t.read_shift(4),p=i(t.slice(t.l+m,t.l+m+u));t.l+=m+u+f;var g=t.l;t.l=h+4,ne(t,l,c,s,p),t.l=g}return s}function ne(e,r,t,s,n){e.l+=2;var a=e.read_shift(2),o=e.read_shift(2),l=function(e){var r=65535&e.read_shift(2),t=65535&e.read_shift(2),s=new Date,n=31&t,i=15&(t>>>=5);t>>>=4,s.setMilliseconds(0),s.setFullYear(t+1980),s.setMonth(i-1),s.setDate(n);var a=31&r,o=63&(r>>>=5);return r>>>=6,s.setHours(r),s.setMinutes(o),s.setSeconds(a<<1),s}(e);if(8257&a)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),m=e.read_shift(4),u=e.read_shift(2),d=e.read_shift(2),f="",h=0;h<u;++h)f+=String.fromCharCode(e[e.l++]);if(d){var g=i(e.slice(e.l,e.l+d));(g[21589]||{}).mt&&(l=g[21589].mt),((n||{})[21589]||{}).mt&&(l=n[21589].mt)}e.l+=d;var b=e.slice(e.l,e.l+c);switch(o){case 8:b=function(e,r){if(!p)return re(e,r);var t=new(0,p.InflateRaw),s=t._processChunk(e.slice(e.l),t._finishFlushFlag);return e.l+=t.bytesRead,s}(e,m);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var v=!1;8&a&&(134695760==e.read_shift(4)&&(e.read_shift(4),v=!0),c=e.read_shift(4),m=e.read_shift(4)),c!=r&&te(v,"Bad compressed size: "+r+" != "+c),m!=t&&te(v,"Bad uncompressed size: "+t+" != "+m),me(s,f,b,{unsafe:!0,mt:l})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ae(e,r){if(e.ctype)return e.ctype;var t=e.name||"",s=t.match(/\.([^\.]+)$/);return s&&ie[s[1]]||r&&(s=(t=r).match(/[\.\\]([^\.\\])+$/))&&ie[s[1]]?ie[s[1]]:"application/octet-stream"}function oe(e){for(var r=zs(e),t=[],s=0;s<r.length;s+=76)t.push(r.slice(s,s+76));return t.join("\r\n")+"\r\n"}function le(e){var r=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var r=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==r.length?"0"+r:r)});"\n"==(r=r.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(r="=0D"+r.slice(1));for(var t=[],s=(r=r.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),n=0;n<s.length;++n){var i=s[n];if(0!=i.length)for(var a=0;a<i.length;){var o=76,l=i.slice(a,a+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=i.slice(a,a+o),(a+=o)<i.length&&(l+="="),t.push(l)}else t.push("")}return t.join("\r\n")}function ce(e,r,t){for(var s,n="",i="",a="",o=0;o<10;++o){var l=r[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":n=c[2].trim();break;case"content-type":a=c[2].trim();break;case"content-transfer-encoding":i=c[2].trim()}}switch(++o,i.toLowerCase()){case"base64":s=Ks($s(r.slice(o).join("")));break;case"quoted-printable":s=function(e){for(var r=[],t=0;t<e.length;++t){for(var s=e[t];t<=e.length&&"="==s.charAt(s.length-1);)s=s.slice(0,s.length-1)+e[++t];r.push(s)}for(var n=0;n<r.length;++n)r[n]=r[n].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return Ks(r.join("\r\n"))}(r.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var m=me(e,n.slice(t.length),s,{unsafe:!0});a&&(m.ctype=a)}function me(e,r,t,n){var i=n&&n.unsafe;i||d(e);var a=!i&&Zn.find(e,r);if(!a){var o=e.FullPaths[0];r.slice(0,o.length)==o?o=r:("/"!=o.slice(-1)&&(o+="/"),o=(o+r).replace("//","/")),a={name:s(r),type:2},e.FileIndex.push(a),e.FullPaths.push(o),i||Zn.utils.cfb_gc(e)}return a.content=t,a.size=t?t.length:0,n&&(n.CLSID&&(a.clsid=n.CLSID),n.mt&&(a.mt=n.mt),n.ct&&(a.ct=n.ct)),a}return r.find=function(e,r){var t=e.FullPaths.map(function(e){return e.toUpperCase()}),s=t.map(function(e){var r=e.split("/");return r[r.length-("/"==e.slice(-1)?2:1)]}),n=!1;47===r.charCodeAt(0)?(n=!0,r=t[0].slice(0,-1)+r):n=-1!==r.indexOf("/");var i=r.toUpperCase(),a=!0===n?t.indexOf(i):s.indexOf(i);if(-1!==a)return e.FileIndex[a];var o=!i.match(tn);for(i=i.replace(rn,""),o&&(i=i.replace(tn,"!")),a=0;a<t.length;++a){if((o?t[a].replace(tn,"!"):t[a]).replace(rn,"")==i)return e.FileIndex[a];if((o?s[a].replace(tn,"!"):s[a]).replace(rn,"")==i)return e.FileIndex[a]}return null},r.read=function(r,t){var s=t&&t.type;switch(s||Gs&&Buffer.isBuffer(r)&&(s="buffer"),s||"base64"){case"file":return function(r,t){return a(),o(e.readFileSync(r),t)}(r,t);case"base64":return o(Ks($s(r)),t);case"binary":return o(Ks(r),t)}return o(r,t)},r.parse=o,r.write=function(r,t){var s=h(r,t);switch(t&&t.type||"buffer"){case"file":return a(),e.writeFileSync(t.filename,s),s;case"binary":return"string"==typeof s?s:E(s);case"base64":return zs("string"==typeof s?s:E(s));case"buffer":if(Gs)return Buffer.isBuffer(s)?s:qs(s);case"array":return"string"==typeof s?Ks(s):s}return s},r.writeFile=function(r,t,s){a();var n=h(r,s);e.writeFileSync(t,n)},r.utils={cfb_new:function(e){var r={};return d(r,e),r},cfb_add:me,cfb_del:function(e,r){d(e);var t=Zn.find(e,r);if(t)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==t)return e.FileIndex.splice(s,1),e.FullPaths.splice(s,1),!0;return!1},cfb_mov:function(e,r,t){d(e);var n=Zn.find(e,r);if(n)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==n)return e.FileIndex[i].name=s(t),e.FullPaths[i]=t,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:go,CheckField:yo,prep_blob:Eo,bconcat:en,use_zlib:function(e){try{var r=new(0,e.InflateRaw);if(r._processChunk(new Uint8Array([3,0]),r._finishFlushFlag),!r.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(t){}},_deflateRaw:X,_inflateRaw:re,consts:y},r}();let ei;function ri(e){return"string"==typeof e?Js(e):Array.isArray(e)?function(e){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function ti(e,r,t){if(void 0!==ei&&ei.writeFileSync)return t?ei.writeFileSync(e,r,t):ei.writeFileSync(e,r);if("undefined"!=typeof Deno){if(t&&"string"==typeof r)switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=Js(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var s="utf8"==t?aa(r):r;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(s,e);if("undefined"!=typeof Blob){var n=new Blob([ri(s)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!=typeof saveAs)return saveAs(n,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var a=document.createElement("a");if(null!=a.download)return a.download=e,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(r)&&(r=Qs(r)),o.write(r),o.close(),r}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function si(e){for(var r=Object.keys(e),t=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(e,r[s])&&t.push(r[s]);return t}function ni(e,r){for(var t=[],s=si(e),n=0;n!==s.length;++n)null==t[e[s[n]][r]]&&(t[e[s[n]][r]]=s[n]);return t}function ii(e){for(var r=[],t=si(e),s=0;s!==t.length;++s)r[e[t[s]]]=t[s];return r}function ai(e){for(var r=[],t=si(e),s=0;s!==t.length;++s)r[e[t[s]]]=parseInt(t[s],10);return r}var oi=new Date(1899,11,30,0,0,0);function li(e,r){return(e.getTime()-(oi.getTime()+6e4*(e.getTimezoneOffset()-oi.getTimezoneOffset())))/864e5}var ci=new Date,mi=oi.getTime()+6e4*(ci.getTimezoneOffset()-oi.getTimezoneOffset()),ui=ci.getTimezoneOffset();function di(e){var r=new Date;return r.setTime(24*e*60*60*1e3+mi),r.getTimezoneOffset()!==ui&&r.setTime(r.getTime()+6e4*(r.getTimezoneOffset()-ui)),r}function fi(e){var r=0,t=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(t=1,i>3&&(s=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":t*=24;case"H":t*=60;case"M":if(!s)throw new Error("Unsupported ISO Duration Field: M");t*=60}r+=t*parseInt(n[i],10)}return r}var hi=new Date("2017-02-19T19:06:09.000Z"),pi=isNaN(hi.getFullYear())?new Date("2/19/17"):hi,gi=2017==pi.getFullYear();function bi(e,r){var t=new Date(e);if(gi)return r>0?t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3):r<0&&t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t;if(e instanceof Date)return e;if(1917==pi.getFullYear()&&!isNaN(t.getFullYear())){var s=t.getFullYear();return e.indexOf(""+s)>-1||t.setFullYear(t.getFullYear()+100),t}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function vi(e,r){if(Gs&&Buffer.isBuffer(e)){if(r){if(255==e[0]&&254==e[1])return aa(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return aa(Ps(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(r){if(255==e[0]&&254==e[1])return aa(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return aa(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"","ƒ":"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"","Š":"","‹":"","Œ":"","Ž":"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"","š":"","›":"","œ":"","ž":"","Ÿ":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(e){return t[e]||e})}catch(i){}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function Ni(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Ni(e[t]));return r}function xi(e,r){for(var t="";t.length<r;)t+=e;return t}function yi(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return isNaN(r=Number(s))?(s=s.replace(/[(](.*)[)]/,function(e,r){return t=-t,r}),isNaN(r=Number(s))?r:r/t):r/t}var Ei=["january","february","march","april","may","june","july","august","september","october","november","december"];function wi(e){var r=new Date(e),t=new Date(NaN),s=r.getYear(),n=r.getMonth(),i=r.getDate();if(isNaN(i))return t;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Ei.indexOf(a))return t}else if(a.match(/[a-z]/))return t;return s<0||s>8099?t:(n>0||i>1)&&101!=s?r:e.match(/[^-0-9:,\/\\]/)?t:r}var Di=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(r,t,s){if(e||"string"==typeof t)return r.split(t);for(var n=r.split(t),i=[n[0]],a=1;a<n.length;++a)i.push(s),i.push(n[a]);return i}}();function _i(e){return e?e.content&&e.type?vi(e.content,!0):e.data?Fs(e.data):e.asNodeBuffer&&Gs?Fs(e.asNodeBuffer().toString("binary")):e.asBinary?Fs(e.asBinary()):e._data&&e._data.getContent?Fs(vi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Hi(e){if(!e)return null;if(e.data)return Os(e.data);if(e.asNodeBuffer&&Gs)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return"string"==typeof r?Os(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Ti(e,r){for(var t=e.FullPaths||si(e.files),s=r.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),i=0;i<t.length;++i){var a=t[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==a||n==a)return e.files?e.files[t[i]]:e.FileIndex[i]}return null}function Si(e,r){var t=Ti(e,r);if(null==t)throw new Error("Cannot find file "+r+" in zip");return t}function ji(e,r,t){if(!t)return(s=Si(e,r))&&".bin"===s.name.slice(-4)?Hi(s):_i(s);var s;if(!r)return null;try{return ji(e,r)}catch(n){return null}}function ki(e,r,t){if(!t)return _i(Si(e,r));if(!r)return null;try{return ki(e,r)}catch(s){return null}}function Vi(e){for(var r=e.FullPaths||si(e.files),t=[],s=0;s<r.length;++s)"/"!=r[s].slice(-1)&&t.push(r[s].replace(/^Root Entry[\/]/,""));return t.sort()}function Ci(e,r,t){if(e.FullPaths){var s;if("string"==typeof t)return s=Gs?qs(t):function(e){for(var r=[],t=0,s=e.length+250,n=Xs(e.length+255),i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a<128)n[t++]=a;else if(a<2048)n[t++]=192|a>>6&31,n[t++]=128|63&a;else if(a>=55296&&a<57344){a=64+(1023&a);var o=1023&e.charCodeAt(++i);n[t++]=240|a>>8&7,n[t++]=128|a>>2&63,n[t++]=128|o>>6&15|(3&a)<<4,n[t++]=128|63&o}else n[t++]=224|a>>12&15,n[t++]=128|a>>6&63,n[t++]=128|63&a;t>s&&(r.push(n.slice(0,t)),t=0,n=Xs(65535),s=65530)}return r.push(n.slice(0,t)),en(r)}(t),Zn.utils.cfb_add(e,r,s);Zn.utils.cfb_add(e,r,t)}else e.file(r,t)}function Ri(){return Zn.utils.cfb_new()}function Ai(e,r){switch(r.type){case"base64":return Zn.read(e,{type:"base64"});case"binary":return Zn.read(e,{type:"binary"});case"buffer":case"array":return Zn.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Mi(e,r){if("/"==e.charAt(0))return e.slice(1);var t=r.split("/");"/"!=r.slice(-1)&&t.pop();for(var s=e.split("/");0!==s.length;){var n=s.shift();".."===n?t.pop():"."!==n&&t.push(n)}return t.join("/")}var Ii='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Oi=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Pi=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Li=Ii.match(Pi)?Pi:/<[^>]*>/g,Fi=/<\w*:/,Ui=/<(\/?)\w+:/;function Bi(e,r,t){for(var s={},n=0,i=0;n!==e.length&&(32!==(i=e.charCodeAt(n))&&10!==i&&13!==i);++n);if(r||(s[0]=e.slice(0,n)),n===e.length)return s;var a=e.match(Oi),o=0,l="",c=0,m="",u="",d=1;if(a)for(c=0;c!=a.length;++c){for(u=a[c],i=0;i!=u.length&&61!==u.charCodeAt(i);++i);for(m=u.slice(0,i).trim();32==u.charCodeAt(i+1);)++i;for(d=34==(n=u.charCodeAt(i+1))||39==n?1:0,l=u.slice(i+1+d,u.length-d),o=0;o!=m.length&&58!==m.charCodeAt(o);++o);if(o===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),s[m]=l,s[m.toLowerCase()]=l;else{var f=(5===o&&"xmlns"===m.slice(0,5)?"xmlns":"")+m.slice(o+1);if(s[f]&&"ext"==m.slice(o-3,o))continue;s[f]=l,s[f.toLowerCase()]=l}}return s}function Wi(e){return e.replace(Ui,"<$1")}var zi={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$i=ii(zi),Gi=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,r=/_x([\da-fA-F]{4})_/gi;return function t(s){var n=s+"",i=n.indexOf("<![CDATA[");if(-1==i)return n.replace(e,function(e,r){return zi[e]||String.fromCharCode(parseInt(r,e.indexOf("x")>-1?16:10))||e}).replace(r,function(e,r){return String.fromCharCode(parseInt(r,16))});var a=n.indexOf("]]>");return t(n.slice(0,i))+n.slice(i+9,a)+t(n.slice(a+3))}}(),qi=/[&<>'"]/g,Xi=/[\u0000-\u0008\u000b-\u001f]/g;function Yi(e){return(e+"").replace(qi,function(e){return $i[e]}).replace(Xi,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ki(e){return Yi(e).replace(/ /g,"_x0020_")}var Ji=/[\u0000-\u001f]/g;function Qi(e){return(e+"").replace(qi,function(e){return $i[e]}).replace(/\n/g,"<br/>").replace(Ji,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var Zi=function(){var e=/&#(\d+);/g;function r(e,r){return String.fromCharCode(parseInt(r,10))}return function(t){return t.replace(e,r)}}();function ea(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ra(e){for(var r="",t=0,s=0,n=0,i=0,a=0,o=0;t<e.length;)(s=e.charCodeAt(t++))<128?r+=String.fromCharCode(s):(n=e.charCodeAt(t++),s>191&&s<224?(a=(31&s)<<6,a|=63&n,r+=String.fromCharCode(a)):(i=e.charCodeAt(t++),s<240?r+=String.fromCharCode((15&s)<<12|(63&n)<<6|63&i):(o=((7&s)<<18|(63&n)<<12|(63&i)<<6|63&(a=e.charCodeAt(t++)))-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(1023&o)))));return r}function ta(e){var r,t,s,n=Xs(2*e.length),i=1,a=0,o=0;for(t=0;t<e.length;t+=i)i=1,(s=e.charCodeAt(t))<128?r=s:s<224?(r=64*(31&s)+(63&e.charCodeAt(t+1)),i=2):s<240?(r=4096*(15&s)+64*(63&e.charCodeAt(t+1))+(63&e.charCodeAt(t+2)),i=3):(i=4,r=262144*(7&s)+4096*(63&e.charCodeAt(t+1))+64*(63&e.charCodeAt(t+2))+(63&e.charCodeAt(t+3)),o=55296+((r-=65536)>>>10&1023),r=56320+(1023&r)),0!==o&&(n[a++]=255&o,n[a++]=o>>>8,o=0),n[a++]=r%256,n[a++]=r>>>8;return n.slice(0,a).toString("ucs2")}function sa(e){return qs(e,"binary").toString("utf8")}var na="foo bar bazâð£",ia=Gs&&(sa(na)==ra(na)&&sa||ta(na)==ra(na)&&ta)||ra,aa=Gs?function(e){return qs(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,s=0,n=0;t<e.length;)switch(s=e.charCodeAt(t++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(63&s)));break;case s>=55296&&s<57344:s-=55296,n=e.charCodeAt(t++)-56320+(s<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(63&n)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(63&s)))}return r.join("")},oa=function(){var e={};return function(r,t){var s=r+"|"+(t||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",t||"")}}(),la=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var t=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),s=0;s<e.length;++s)t=t.replace(e[s][0],e[s][1]);return t}}(),ca=function(){var e={};return function(r){return void 0!==e[r]?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),ma=/<\/?(?:vt:)?variant>/g,ua=/<(?:vt:)([^>]*)>([\s\S]*)</;function da(e,r){var t=Bi(e),s=e.match(ca(t.baseType))||[],n=[];if(s.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+s.length+" != "+t.size);return n}return s.forEach(function(e){var r=e.replace(ma,"").match(ua);r&&n.push({v:ia(r[2]),t:r[1]})}),n}var fa=/(^\s|\s$|\n)/;function ha(e,r){return"<"+e+(r.match(fa)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function pa(e){return si(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function ga(e,r,t){return"<"+e+(null!=t?pa(t):"")+(null!=r?(r.match(fa)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function ba(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function va(e){if(Gs&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return ia(Qs(Zs(e)));throw new Error("Bad input format: expected Buffer or string")}var Na=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,xa="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",ya="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Ea="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",wa="http://schemas.openxmlformats.org/package/2006/content-types",Da="http://schemas.openxmlformats.org/package/2006/relationships",_a="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Ha="http://purl.org/dc/elements/1.1/",Ta="http://purl.org/dc/terms/",Sa="http://purl.org/dc/dcmitype/",ja="http://schemas.openxmlformats.org/officeDocument/2006/relationships",ka="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Va="http://www.w3.org/2001/XMLSchema-instance",Ca="http://www.w3.org/2001/XMLSchema",Ra=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Aa="urn:schemas-microsoft-com:office:office",Ma="urn:schemas-microsoft-com:office:excel",Ia="urn:schemas-microsoft-com:office:spreadsheet",Oa="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",Pa="http://macVmlSchemaUri",La="urn:schemas-microsoft-com:vml",Fa="http://www.w3.org/TR/REC-html40";var Ua=function(e){for(var r=[],t=0;t<e[0].length;++t)if(e[0][t])for(var s=0,n=e[0][t].length;s<n;s+=10240)r.push.apply(r,e[0][t].slice(s,s+10240));return r},Ba=Gs?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:qs(e)})):Ua(e)}:Ua,Wa=function(e,r,t){for(var s=[],n=r;n<t;n+=2)s.push(String.fromCharCode(mo(e,n)));return s.join("").replace(rn,"")},za=Gs?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(rn,""):Wa(e,r,t)}:Wa,$a=function(e,r,t){for(var s=[],n=r;n<r+t;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},Ga=Gs?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):$a(e,r,t)}:$a,qa=function(e,r,t){for(var s=[],n=r;n<t;n++)s.push(String.fromCharCode(co(e,n)));return s.join("")},Xa=Gs?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf8",r,t):qa(e,r,t)}:qa,Ya=function(e,r){var t=fo(e,r);return t>0?Xa(e,r+4,r+4+t-1):""},Ka=Ya,Ja=function(e,r){var t=fo(e,r);return t>0?Xa(e,r+4,r+4+t-1):""},Qa=Ja,Za=function(e,r){var t=2*fo(e,r);return t>0?Xa(e,r+4,r+4+t-1):""},eo=Za,ro=function(e,r){var t=fo(e,r);return t>0?za(e,r+4,r+4+t):""},to=ro,so=function(e,r){var t=fo(e,r);return t>0?Xa(e,r+4,r+4+t):""},no=so,io=function(e,r){return function(e,r){for(var t=1-2*(e[r+7]>>>7),s=((127&e[r+7])<<4)+(e[r+6]>>>4&15),n=15&e[r+6],i=5;i>=0;--i)n=256*n+e[r+i];return 2047==s?0==n?t*(1/0):NaN:(0==s?s=-1022:(s-=1023,n+=Math.pow(2,52)),t*Math.pow(2,s-52)*n)}(e,r)},ao=io,oo=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};function lo(){za=function(e,r,t){return Ls.utils.decode(1200,e.slice(r,t)).replace(rn,"")},Xa=function(e,r,t){return Ls.utils.decode(65001,e.slice(r,t))},Ka=function(e,r){var t=fo(e,r);return t>0?Ls.utils.decode(Vs,e.slice(r+4,r+4+t-1)):""},Qa=function(e,r){var t=fo(e,r);return t>0?Ls.utils.decode(ks,e.slice(r+4,r+4+t-1)):""},eo=function(e,r){var t=2*fo(e,r);return t>0?Ls.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},to=function(e,r){var t=fo(e,r);return t>0?Ls.utils.decode(1200,e.slice(r+4,r+4+t)):""},no=function(e,r){var t=fo(e,r);return t>0?Ls.utils.decode(65001,e.slice(r+4,r+4+t)):""}}Gs&&(Ka=function(e,r){if(!Buffer.isBuffer(e))return Ya(e,r);var t=e.readUInt32LE(r);return t>0?e.toString("utf8",r+4,r+4+t-1):""},Qa=function(e,r){if(!Buffer.isBuffer(e))return Ja(e,r);var t=e.readUInt32LE(r);return t>0?e.toString("utf8",r+4,r+4+t-1):""},eo=function(e,r){if(!Buffer.isBuffer(e))return Za(e,r);var t=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+t-1)},to=function(e,r){if(!Buffer.isBuffer(e))return ro(e,r);var t=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+t)},no=function(e,r){if(!Buffer.isBuffer(e))return so(e,r);var t=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+t)},ao=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):io(e,r)},oo=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array}),void 0!==Ls&&lo();var co=function(e,r){return e[r]},mo=function(e,r){return 256*e[r+1]+e[r]},uo=function(e,r){var t=256*e[r+1]+e[r];return t<32768?t:-1*(65535-t+1)},fo=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},ho=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},po=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function go(e,r){var t,s,n,i,a,o,l="",c=[];switch(r){case"dbcs":if(o=this.l,Gs&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)l+=String.fromCharCode(mo(this,o)),o+=2;e*=2;break;case"utf8":l=Xa(this,this.l,this.l+e);break;case"utf16le":e*=2,l=za(this,this.l,this.l+e);break;case"wstr":if(void 0===Ls)return go.call(this,e,"dbcs");l=Ls.utils.decode(ks,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Ka(this,this.l),e=4+fo(this,this.l);break;case"lpstr-cp":l=Qa(this,this.l),e=4+fo(this,this.l);break;case"lpwstr":l=eo(this,this.l),e=4+2*fo(this,this.l);break;case"lpp4":e=4+fo(this,this.l),l=to(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+fo(this,this.l),l=no(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(n=co(this,this.l+e++));)c.push(Us(n));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(n=mo(this,this.l+e));)c.push(Us(n)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,a=0;a<e;++a){if(this.lens&&-1!==this.lens.indexOf(o))return n=co(this,o),this.l=o+1,i=go.call(this,e-a,n?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(Us(mo(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if(void 0!==Ls){l=Ls.utils.decode(ks,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,a=0;a!=e;++a){if(this.lens&&-1!==this.lens.indexOf(o))return n=co(this,o),this.l=o+1,i=go.call(this,e-a,n?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(Us(co(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return t=co(this,this.l),this.l++,t;case 2:return t=("i"===r?uo:mo)(this,this.l),this.l+=2,t;case 4:case-4:return"i"!==r&&128&this[this.l+3]?(s=fo(this,this.l),this.l+=4,s):(t=(e>0?ho:po)(this,this.l),this.l+=4,t);case 8:case-8:if("f"===r)return s=8==e?ao(this,this.l):ao([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:l=Ga(this,this.l,e)}}return this.l+=e,l}var bo=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},vo=function(e,r,t){e[t]=255&r,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},No=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255};function xo(e,r,t){var s=0,n=0;if("dbcs"===t){for(n=0;n!=r.length;++n)No(this,r.charCodeAt(n),this.l+2*n);s=2*r.length}else if("sbcs"===t){if(void 0!==Ls&&874==Vs)for(n=0;n!=r.length;++n){var i=Ls.utils.encode(Vs,r.charAt(n));this[this.l+n]=i[0]}else for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=255&r.charCodeAt(n);s=r.length}else{if("hex"===t){for(;n<e;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}if("utf16le"===t){var a=Math.min(this.l+e,this.length);for(n=0;n<Math.min(r.length,e);++n){var o=r.charCodeAt(n);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}switch(e){case 1:s=1,this[this.l]=255&r;break;case 2:s=2,this[this.l]=255&r,r>>>=8,this[this.l+1]=255&r;break;case 3:s=3,this[this.l]=255&r,r>>>=8,this[this.l+1]=255&r,r>>>=8,this[this.l+2]=255&r;break;case 4:s=4,bo(this,r,this.l);break;case 8:if(s=8,"f"===t){!function(e,r,t){var s=(r<0||1/r==-1/0?1:0)<<7,n=0,i=0,a=s?-r:r;isFinite(a)?0==a?n=i=0:(n=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(r)?26985:0);for(var o=0;o<=5;++o,i/=256)e[t+o]=255&i;e[t+6]=(15&n)<<4|15&i,e[t+7]=n>>4|s}(this,r,this.l);break}case 16:break;case-4:s=4,vo(this,r,this.l)}}return this.l+=s,this}function yo(e,r){var t=Ga(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Eo(e,r){e.l=r,e.read_shift=go,e.chk=yo,e.write_shift=xo}function wo(e,r){e.l+=r}function Do(e){var r=Xs(e);return Eo(r,0),r}function _o(e,r,t){if(e){var s,n,i;Eo(e,e.l||0);for(var a=e.length,o=0,l=0;e.l<a;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=Ah[o]||Ah[65535];for(i=127&(s=e.read_shift(1)),n=1;n<4&&128&s;++n)i+=(127&(s=e.read_shift(1)))<<7*n;l=e.l+i;var m=c.f&&c.f(e,i,t);if(e.l=l,r(m,c,o))return}}}function Ho(){var e=[],r=Gs?256:2048,t=function(e){var r=Do(e);return Eo(r,0),r},s=t(r),n=function(){s&&(s.length>s.l&&((s=s.slice(0,s.l)).l=s.length),s.length>0&&e.push(s),s=null)},i=function(e){return s&&e<s.length-s.l?s:(n(),s=t(Math.max(e+1,r)))};return{next:i,push:function(e){n(),null==(s=e).l&&(s.l=s.length),i(r)},end:function(){return n(),en(e)},_bufs:e}}function To(e,r,t,s){var n,i=+r;if(!isNaN(i)){s||(s=Ah[i].p||(t||[]).length||0),n=1+(i>=128?1:0)+1,s>=128&&++n,s>=16384&&++n,s>=2097152&&++n;var a=e.next(n);i<=127?a.write_shift(1,i):(a.write_shift(1,128+(127&i)),a.write_shift(1,i>>7));for(var o=0;4!=o;++o){if(!(s>=128)){a.write_shift(1,s);break}a.write_shift(1,128+(127&s)),s>>=7}s>0&&oo(t)&&e.push(t)}}function So(e,r,t){var s=Ni(e);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!t||t.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function jo(e,r,t){var s=Ni(e);return s.s=So(s.s,r.s,t),s.e=So(s.e,r.s,t),s}function ko(e,r){if(e.cRel&&e.c<0)for(e=Ni(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Ni(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=Oo(e);return e.cRel||null==e.cRel||(t=t.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(t=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(t)),t}function Vo(e,r){return 0!=e.s.r||e.s.rRel||e.e.r!=(r.biff>=12?1048575:r.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(r.biff>=12?16383:255)||e.e.cRel?ko(e.s,r.biff)+":"+ko(e.e,r.biff):(e.s.rRel?"":"$")+Ro(e.s.r)+":"+(e.e.rRel?"":"$")+Ro(e.e.r):(e.s.cRel?"":"$")+Mo(e.s.c)+":"+(e.e.cRel?"":"$")+Mo(e.e.c)}function Co(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Ro(e){return""+(e+1)}function Ao(e){for(var r=e.replace(/^\$([A-Z])/,"$1"),t=0,s=0;s!==r.length;++s)t=26*t+r.charCodeAt(s)-64;return t-1}function Mo(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Io(e){for(var r=0,t=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:r-1}}function Oo(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Po(e){var r=e.indexOf(":");return-1==r?{s:Io(e),e:Io(e)}:{s:Io(e.slice(0,r)),e:Io(e.slice(r+1))}}function Lo(e,r){return void 0===r||"number"==typeof r?Lo(e.s,e.e):("string"!=typeof e&&(e=Oo(e)),"string"!=typeof r&&(r=Oo(r)),e==r?e:e+":"+r)}function Fo(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,s=0,n=0,i=e.length;for(t=0;s<i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)t=26*t+n;for(r.s.c=--t,t=0;s<i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)t=10*t+n;if(r.s.r=--t,s===i||10!=n)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,t=0;s!=i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)t=26*t+n;for(r.e.c=--t,t=0;s!=i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)t=10*t+n;return r.e.r=--t,r}function Uo(e,r){var t="d"==e.t&&r instanceof Date;if(null!=e.z)try{return e.w=$n(e.z,t?li(r):r)}catch(s){}try{return e.w=$n((e.XF||{}).numFmtId||(t?14:0),t?li(r):r)}catch(s){return""+r}}function Bo(e,r,t){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),"e"==e.t?Tl[e.v]||e.v:Uo(e,null==r?e.v:r))}function Wo(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",s={};return s[t]=e,{SheetNames:[t],Sheets:s}}function zo(e,r,t){var s=t||{},n=e?Array.isArray(e):s.dense,i=e||(n?[]:{}),a=0,o=0;if(i&&null!=s.origin){if("number"==typeof s.origin)a=s.origin;else{var l="string"==typeof s.origin?Io(s.origin):s.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var m=Fo(i["!ref"]);c.s.c=m.s.c,c.s.r=m.s.r,c.e.c=Math.max(c.e.c,m.e.c),c.e.r=Math.max(c.e.r,m.e.r),-1==a&&(c.e.r=a=m.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=r[u].length;++d)if(void 0!==r[u][d]){var f={v:r[u][d]},h=a+u,p=o+d;if(c.s.r>h&&(c.s.r=h),c.s.c>p&&(c.s.c=p),c.e.r<h&&(c.e.r=h),c.e.c<p&&(c.e.c=p),!r[u][d]||"object"!=typeof r[u][d]||Array.isArray(r[u][d])||r[u][d]instanceof Date)if(Array.isArray(f.v)&&(f.f=r[u][d][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(s.nullError)f.t="e",f.v=0;else{if(!s.sheetStubs)continue;f.t="z"}else"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.z=s.dateNF||fn[14],s.cellDates?(f.t="d",f.w=$n(f.z,li(f.v))):(f.t="n",f.v=li(f.v),f.w=$n(f.z,f.v))):f.t="s";else f=r[u][d];if(n)i[h]||(i[h]=[]),i[h][p]&&i[h][p].z&&(f.z=i[h][p].z),i[h][p]=f;else{var g=Oo({c:p,r:h});i[g]&&i[g].z&&(f.z=i[g].z),i[g]=f}}}return c.s.c<1e7&&(i["!ref"]=Lo(c)),i}function $o(e,r){return zo(null,e,r)}function Go(e,r){return r||(r=Do(4)),r.write_shift(4,e),r}function qo(e){var r=e.read_shift(4);return 0===r?"":e.read_shift(r,"dbcs")}function Xo(e,r){var t=!1;return null==r&&(t=!0,r=Do(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function Yo(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ko(e,r){var t=e.l,s=e.read_shift(1),n=qo(e),i=[],a={t:n,h:n};if(1&s){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(Yo(e));a.r=i}else a.r=[{ich:0,ifnt:0}];return e.l=t+r,a}var Jo=Ko;function Qo(e,r){var t=!1;return null==r&&(t=!0,r=Do(23+4*e.t.length)),r.write_shift(1,1),Xo(e.t,r),r.write_shift(4,1),function(e,r){r||(r=Do(4)),r.write_shift(2,0),r.write_shift(2,0)}(0,r),t?r.slice(0,r.l):r}function Zo(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function el(e,r){return null==r&&(r=Do(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function rl(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function tl(e,r){return null==r&&(r=Do(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var sl=qo,nl=Xo;function il(e){var r=e.read_shift(4);return 0===r||4294967295===r?"":e.read_shift(r,"dbcs")}function al(e,r){var t=!1;return null==r&&(t=!0,r=Do(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var ol=qo,ll=il,cl=al;function ml(e){var r=e.slice(e.l,e.l+4),t=1&r[0],s=2&r[0];e.l+=4;var n=0===s?ao([0,0,0,0,252&r[0],r[1],r[2],r[3]],0):ho(r,0)>>2;return t?n/100:n}function ul(e,r){null==r&&(r=Do(4));var t=0,s=0,n=100*e;if(e==(0|e)&&e>=-536870912&&e<1<<29?s=1:n==(0|n)&&n>=-536870912&&n<1<<29&&(s=1,t=1),!s)throw new Error("unsupported RkNumber "+e);r.write_shift(-4,((t?n:e)<<2)+(t+2))}function dl(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var fl=dl,hl=function(e,r){return r||(r=Do(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r};function pl(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function gl(e,r){return(r||Do(8)).write_shift(8,e,"f")}function bl(e,r){if(r||(r=Do(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;null!=e.index?(r.write_shift(1,2),r.write_shift(1,e.index)):null!=e.theme?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),e.rgb&&null==e.theme){var s=e.rgb||"FFFFFF";"number"==typeof s&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}else r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r}function vl(e,r){var t=e.read_shift(4);switch(t){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(t>400)throw new Error("Unsupported Clipboard: "+t.toString(16));return e.l-=4,e.read_shift(0,1==r?"lpstr":"lpwstr")}var Nl=80,xl=[Nl,81],yl={1:{n:"CodePage",t:2},2:{n:"Category",t:Nl},3:{n:"PresentationFormat",t:Nl},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Nl},15:{n:"Company",t:Nl},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Nl},27:{n:"ContentStatus",t:Nl},28:{n:"Language",t:Nl},29:{n:"Version",t:Nl},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},El={1:{n:"CodePage",t:2},2:{n:"Title",t:Nl},3:{n:"Subject",t:Nl},4:{n:"Author",t:Nl},5:{n:"Keywords",t:Nl},6:{n:"Comments",t:Nl},7:{n:"Template",t:Nl},8:{n:"LastAuthor",t:Nl},9:{n:"RevNumber",t:Nl},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Nl},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},wl={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Dl=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function _l(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var Hl=Ni(_l([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Tl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Sl={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},jl={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},kl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Vl(e,r){var t,s=function(e){for(var r=[],t=si(e),s=0;s!==t.length;++s)null==r[e[t[s]]]&&(r[e[t[s]]]=[]),r[e[t[s]]].push(t[s]);return r}(jl),n=[];n[n.length]=Ii,n[n.length]=ga("Types",null,{xmlns:wa,"xmlns:xsd":Ca,"xmlns:xsi":Va}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return ga("Default",null,{Extension:e[0],ContentType:e[1]})}));var i=function(s){e[s]&&e[s].length>0&&(t=e[s][0],n[n.length]=ga("Override",null,{PartName:("/"==t[0]?"":"/")+t,ContentType:kl[s][r.bookType]||kl[s].xlsx}))},a=function(t){(e[t]||[]).forEach(function(e){n[n.length]=ga("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:kl[t][r.bookType]||kl[t].xlsx})})},o=function(r){(e[r]||[]).forEach(function(e){n[n.length]=ga("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:s[r][0]})})};return i("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Cl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Rl(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Al(e,r){var t={"!id":{}};if(!e)return t;"/"!==r.charAt(0)&&(r="/"+r);var s={};return(e.match(Li)||[]).forEach(function(e){var n=Bi(e);if("<Relationship"===n[0]){var i={};i.Type=n.Type,i.Target=n.Target,i.Id=n.Id,n.TargetMode&&(i.TargetMode=n.TargetMode);var a="External"===n.TargetMode?n.Target:Mi(n.Target,r);t[a]=i,s[n.Id]=i}}),t["!id"]=s,t}function Ml(e){var r=[Ii,ga("Relationships",null,{xmlns:Da})];return si(e["!id"]).forEach(function(t){r[r.length]=ga("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Il(e,r,t,s,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,n.Id="rId"+r,n.Type=s,n.Target=t,[Cl.HLINK,Cl.XPATH,Cl.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,r}function Ol(e,r,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+'"/>\n',"  </rdf:Description>\n"].join("")}function Pl(e,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+'"/>\n',"  </rdf:Description>\n"].join("")}function Ll(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+js.version+"</meta:generator></office:meta></office:document-meta>"}var Fl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Ul=function(){for(var e=new Array(Fl.length),r=0;r<Fl.length;++r){var t=Fl[r],s="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function Bl(e){var r={};e=ia(e);for(var t=0;t<Fl.length;++t){var s=Fl[t],n=e.match(Ul[t]);null!=n&&n.length>0&&(r[s[1]]=Gi(n[1])),"date"===s[2]&&r[s[1]]&&(r[s[1]]=bi(r[s[1]]))}return r}function Wl(e,r,t,s,n){null==n[e]&&null!=r&&""!==r&&(n[e]=r,r=Yi(r),s[s.length]=t?ga(e,r,t):ha(e,r))}function zl(e,r){var t=r||{},s=[Ii,ga("cp:coreProperties",null,{"xmlns:cp":xa,"xmlns:dc":Ha,"xmlns:dcterms":Ta,"xmlns:dcmitype":Sa,"xmlns:xsi":Va})],n={};if(!e&&!t.Props)return s.join("");e&&(null!=e.CreatedDate&&Wl("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:ba(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),null!=e.ModifiedDate&&Wl("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:ba(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var i=0;i!=Fl.length;++i){var a=Fl[i],o=t.Props&&null!=t.Props[a[1]]?t.Props[a[1]]:e?e[a[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&Wl(a[0],o,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var $l=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Gl=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ql(e,r,t,s){var n=[];if("string"==typeof e)n=da(e,s);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(e){return{v:e}}));var a="string"==typeof r?da(r,s).map(function(e){return e.v}):r,o=0,l=0;if(a.length>0)for(var c=0;c!==n.length;c+=2){switch(l=+n[c+1].v,n[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=l,t.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=a.slice(o,o+l)}o+=l}}function Xl(e){var r=[],t=ga;return e||(e={}),e.Application="SheetJS",r[r.length]=Ii,r[r.length]=ga("Properties",null,{xmlns:Ea,"xmlns:vt":ka}),$l.forEach(function(s){if(void 0!==e[s[1]]){var n;switch(s[2]){case"string":n=Yi(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false"}void 0!==n&&(r[r.length]=t(s[0],n))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+Yi(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Yl=/<[^>]+>[^<]*/g;function Kl(e){var r=[Ii,ga("Properties",null,{xmlns:ya,"xmlns:vt":ka})];if(!e)return r.join("");var t=1;return si(e).forEach(function(s){++t,r[r.length]=ga("property",function(e){switch(typeof e){case"string":var r=ga("vt:lpwstr",Yi(e));return r.replace(/&quot;/g,"_x0022_");case"number":return ga((0|e)==e?"vt:i4":"vt:r8",Yi(String(e)));case"boolean":return ga("vt:bool",e?"true":"false")}if(e instanceof Date)return ga("vt:filetime",ba(e));throw new Error("Unable to serialize "+e)}(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Yi(s)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Jl,Ql={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Zl(e,r,t){Jl||(Jl=ii(Ql)),e[r=Jl[r]||r]=t}function ec(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date(1e3*(t/1e7*Math.pow(2,32)+r/1e7-11644473600)).toISOString().replace(/\.000/,"")}function rc(e,r,t){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-s&3;)++e.l;return n}function tc(e,r,t){return e.read_shift(0,"lpwstr")}function sc(e,r,t){return 31===r?tc(e):rc(e,0,t)}function nc(e,r,t){return sc(e,r,!1===t?0:4)}function ic(e){var r=e.l,t=lc(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-r&2&&(e.l+=2),[t,lc(e,3)]}function ac(e,r){for(var t=e.read_shift(4),s={},n=0;n!=t;++n){var i=e.read_shift(4),a=e.read_shift(4);s[i]=e.read_shift(a,1200===r?"utf16le":"utf8").replace(rn,"").replace(tn,"!"),1200===r&&a%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),s}function oc(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(3&r)>0&&(e.l+=4-(3&r)&3),t}function lc(e,r,t){var s,n=e.read_shift(2),i=t||{};if(e.l+=2,12!==r&&n!==r&&-1===xl.indexOf(r)&&(4126!=(65534&r)||4126!=(65534&n)))throw new Error("Expected type "+r+" saw "+n);switch(12===r?n:r){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return s=e.read_shift(4);case 30:return rc(e,0,4).replace(rn,"");case 31:return tc(e);case 64:return ec(e);case 65:return oc(e);case 71:return function(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}(e);case 80:return nc(e,n,!i.raw).replace(rn,"");case 81:return function(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return sc(e,r,0)}(e,n).replace(rn,"");case 4108:return function(e){for(var r=e.read_shift(4),t=[],s=0;s<r/2;++s)t.push(ic(e));return t}(e);case 4126:case 4127:return 4127==n?function(e){for(var r=e.read_shift(4),t=[],s=0;s!=r;++s){var n=e.l;t[s]=e.read_shift(0,"lpwstr").replace(rn,""),e.l-n&2&&(e.l+=2)}return t}(e):function(e){for(var r=e.read_shift(4),t=[],s=0;s!=r;++s)t[s]=e.read_shift(0,"lpstr-cp").replace(rn,"");return t}(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function cc(e,r){var t=Do(4),s=Do(4);switch(t.write_shift(4,80==e?31:e),e){case 3:s.write_shift(-4,r);break;case 5:(s=Do(8)).write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=function(e){var r=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,t=r%Math.pow(2,32),s=(r-t)/Math.pow(2,32);s*=1e7;var n=(t*=1e7)/Math.pow(2,32)|0;n>0&&(t%=Math.pow(2,32),s+=n);var i=Do(8);return i.write_shift(4,t),i.write_shift(4,s),i}(r);break;case 31:case 80:for((s=Do(4+2*(r.length+1)+(r.length%2?0:2))).write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return en([t,s])}function mc(e,r){var t=e.l,s=e.read_shift(4),n=e.read_shift(4),i=[],a=0,o=0,l=-1,c={};for(a=0;a!=n;++a){var m=e.read_shift(4),u=e.read_shift(4);i[a]=[m,u+t]}i.sort(function(e,r){return e[1]-r[1]});var d={};for(a=0;a!=n;++a){if(e.l!==i[a][1]){var f=!0;if(a>0&&r)switch(r[i[a-1][0]].t){case 2:e.l+2===i[a][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=i[a][1]&&(e.l=i[a][1],f=!1)}if((!r||0==a)&&e.l<=i[a][1]&&(f=!1,e.l=i[a][1]),f)throw new Error("Read Error: Expected address "+i[a][1]+" at "+e.l+" :"+a)}if(r){var h=r[i[a][0]];if(d[h.n]=lc(e,h.t,{raw:!0}),"version"===h.p&&(d[h.n]=String(d[h.n]>>16)+"."+("0000"+String(65535&d[h.n])).slice(-4)),"CodePage"==h.n)switch(d[h.n]){case 0:d[h.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ms(o=d[h.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[h.n])}}else if(1===i[a][0]){if(o=d.CodePage=lc(e,2),Ms(o),-1!==l){var p=e.l;e.l=i[l][1],c=ac(e,o),e.l=p}}else if(0===i[a][0]){if(0===o){l=a,e.l=i[a+1][1];continue}c=ac(e,o)}else{var g,b=c[i[a][0]];switch(e[e.l]){case 65:e.l+=4,g=oc(e);break;case 30:case 31:e.l+=4,g=nc(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=bc(e,4);break;case 64:e.l+=4,g=bi(ec(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[b]=g}}return e.l=t+s,d}var uc=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function dc(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function fc(e,r,t){var s=Do(8),n=[],i=[],a=8,o=0,l=Do(8),c=Do(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),n.push(c),a+=8+l.length,!r){(c=Do(8)).write_shift(4,0),n.unshift(c);var m=[Do(4)];for(m[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for((l=Do(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);m.push(l)}l=en(m),i.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if((!r||r[e[o][0]])&&!(uc.indexOf(e[o][0])>-1||Gl.indexOf(e[o][0])>-1)&&null!=e[o][1]){var d=e[o][1],f=0;if(r){var h=t[f=+r[e[o][0]]];if("version"==h.p&&"string"==typeof d){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}l=cc(h.t,d)}else{var g=dc(d);-1==g&&(g=31,d=String(d)),l=cc(g,d)}i.push(l),(c=Do(8)).write_shift(4,r?f:2+o),n.push(c),a+=8+l.length}var b=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,b),b+=i[o].length;return s.write_shift(4,a),s.write_shift(4,i.length),en([s].concat(n).concat(i))}function hc(e,r,t){var s=e.content;if(!s)return{};Eo(s,0);var n,i,a,o,l=0;s.chk("feff","Byte Order: "),s.read_shift(2);var c=s.read_shift(4),m=s.read_shift(16);if(m!==Zn.utils.consts.HEADER_CLSID&&m!==t)throw new Error("Bad PropertySet CLSID "+m);if(1!==(n=s.read_shift(4))&&2!==n)throw new Error("Unrecognized #Sets: "+n);if(i=s.read_shift(16),o=s.read_shift(4),1===n&&o!==s.l)throw new Error("Length mismatch: "+o+" !== "+s.l);2===n&&(a=s.read_shift(16),l=s.read_shift(4));var u,d=mc(s,r),f={SystemIdentifier:c};for(var h in d)f[h]=d[h];if(f.FMTID=i,1===n)return f;if(l-s.l==2&&(s.l+=2),s.l!==l)throw new Error("Length mismatch 2: "+s.l+" !== "+l);try{u=mc(s,null)}catch(p){}for(h in u)f[h]=u[h];return f.FMTID=[i,a],f}function pc(e,r,t,s,n,i){var a=Do(n?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Zn.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,n?2:1),a.write_shift(16,r,"hex"),a.write_shift(4,n?68:48);var l=fc(e,t,s);if(o.push(l),n){var c=fc(n,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+l.length),o.push(c)}return en(o)}function gc(e,r){return e.read_shift(r),null}function bc(e,r){return 1===e.read_shift(r)}function vc(e,r){return r||(r=Do(2)),r.write_shift(2,+!!e),r}function Nc(e){return e.read_shift(2,"u")}function xc(e,r){return r||(r=Do(2)),r.write_shift(2,e),r}function yc(e,r){return function(e,r,t){for(var s=[],n=e.l+r;e.l<n;)s.push(t(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}(e,r,Nc)}function Ec(e,r,t){return t||(t=Do(2)),t.write_shift(1,"e"==r?+e:+!!e),t.write_shift(1,"e"==r?1:0),t}function wc(e,r,t){var s=e.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont",i=ks;(t&&t.biff>=8&&(ks=1200),t&&8!=t.biff)?12==t.biff&&(n="wstr"):e.read_shift(1)&&(n="dbcs-cont");t.biff>=2&&t.biff<=5&&(n="cpstr");var a=s?e.read_shift(s,n):"";return ks=i,a}function Dc(e){var r=ks;ks=1200;var t,s=e.read_shift(2),n=e.read_shift(1),i=4&n,a=8&n,o=1+(1&n),l=0,c={};a&&(l=e.read_shift(2)),i&&(t=e.read_shift(4));var m=2==o?"dbcs-cont":"sbcs-cont",u=0===s?"":e.read_shift(s,m);return a&&(e.l+=4*l),i&&(e.l+=t),c.t=u,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),ks=r,c}function _c(e){var r=e.t||"",t=Do(3);t.write_shift(2,r.length),t.write_shift(1,1);var s=Do(2*r.length);return s.write_shift(2*r.length,r,"utf16le"),en([t,s])}function Hc(e,r,t){if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(r,"sbcs-cont"):e.read_shift(r,"dbcs-cont")}function Tc(e,r,t){var s=e.read_shift(t&&2==t.biff?1:2);return 0===s?(e.l++,""):Hc(e,s,t)}function Sc(e,r,t){if(t.biff>5)return Tc(e,0,t);var s=e.read_shift(1);return 0===s?(e.l++,""):e.read_shift(s,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function jc(e,r,t){return t||(t=Do(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function kc(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var r=e.read_shift(4),t=e.l,s=!1;r>24&&(e.l+=r-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(s=!0),e.l=t);var n=e.read_shift((s?r-24:r)>>1,"utf16le").replace(rn,"");return s&&(e.l+=24),n}(e);case"0303000000000000c000000000000046":return function(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return t+s.replace(/\\/g,"/");var n=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return t+e.read_shift(n>>1,"utf16le").replace(rn,"")}(e);default:throw new Error("Unsupported Moniker "+t)}}function Vc(e){var r=e.read_shift(4);return r>0?e.read_shift(r,"utf16le").replace(rn,""):""}function Cc(e,r){r||(r=Do(6+2*e.length)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function Rc(e){var r=Do(512),t=0,s=e.Target;"file://"==s.slice(0,7)&&(s=s.slice(7));var n=s.indexOf("#"),i=n>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3}r.write_shift(4,2),r.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)r.write_shift(4,a[t]);if(28==i)Cc(s=s.slice(1),r);else if(2&i){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)r.write_shift(1,parseInt(a[t],16));var o=n>-1?s.slice(0,n):s;for(r.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)r.write_shift(2,o.charCodeAt(t));r.write_shift(2,0),8&i&&Cc(n>-1?s.slice(n+1):"",r)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)r.write_shift(1,parseInt(a[t],16));for(var l=0;"../"==s.slice(3*l,3*l+3)||"..\\"==s.slice(3*l,3*l+3);)++l;for(r.write_shift(2,l),r.write_shift(4,s.length-3*l+1),t=0;t<s.length-3*l;++t)r.write_shift(1,255&s.charCodeAt(t+3*l));for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function Ac(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Mc(e,r){var t=Ac(e);return t[3]=0,t}function Ic(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Oc(e,r,t,s){return s||(s=Do(6)),s.write_shift(2,e),s.write_shift(2,r),s.write_shift(2,t||0),s}function Pc(e,r,t){var s=t.biff>8?4:2;return[e.read_shift(s),e.read_shift(s,"i"),e.read_shift(s,"i")]}function Lc(e){return[e.read_shift(2),ml(e)]}function Fc(e){var r=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(2),r:r},e:{c:e.read_shift(2),r:t}}}function Uc(e,r){return r||(r=Do(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function Bc(e){var r=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(1),r:r},e:{c:e.read_shift(1),r:t}}}var Wc=Bc;function zc(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[t,r,s]}function $c(e){e.l+=2,e.l+=e.read_shift(2)}var Gc={0:$c,4:$c,5:$c,6:$c,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:$c,9:$c,10:$c,11:$c,12:$c,13:function(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r},14:$c,15:$c,16:$c,17:$c,18:$c,19:$c,20:$c,21:zc};function qc(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),(r-=2)>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Xc(e,r,t){var s=1536,n=16;switch(t.bookType){case"biff8":case"xla":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;default:throw new Error("unsupported BIFF version")}var i=Do(n);return i.write_shift(2,s),i.write_shift(2,r),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Yc(e,r){var t=!r||r.biff>=8?2:1,s=Do(8+t*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function Kc(e,r,t){var s=0;t&&2==t.biff||(s=e.read_shift(2));var n=e.read_shift(2);return t&&2==t.biff&&(s=1-(n>>15),n&=32767),[{Unsynced:1&s,DyZero:(2&s)>>1,ExAsc:(4&s)>>2,ExDsc:(8&s)>>3},n]}function Jc(e,r,t,s){var n=t&&5==t.biff;s||(s=Do(n?3+r.length:5+2*r.length)),s.write_shift(2,e),s.write_shift(n?1:2,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return null==i.l&&(i.l=i.length),i}var Qc=Sc;function Zc(e,r,t){var s=e.l+r,n=8!=t.biff&&t.biff?2:4,i=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(2),l=e.read_shift(2);return e.l=s,{s:{r:i,c:o},e:{r:a,c:l}}}function em(e,r,t,s){var n=t&&5==t.biff;s||(s=Do(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,r<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function rm(e,r,t){var s=Ic(e);2!=t.biff&&9!=r||++e.l;var n=function(e){var r=e.read_shift(1);return 1===e.read_shift(1)?r:1===r}(e);return s.val=n,s.t=!0===n||!1===n?"b":"e",s}var tm=function(e,r,t){return 0===r?"":Sc(e,0,t)};function sm(e,r,t){var s,n=e.read_shift(2),i={fBuiltIn:1&n,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return 14849===t.sbcch&&(s=function(e,r,t){e.l+=4,r-=4;var s=e.l+r,n=wc(e,0,t),i=e.read_shift(2);if(i!==(s-=e.l))throw new Error("Malformed AddinUdf: padding = "+s+" != "+i);return e.l+=i,n}(e,r-2,t)),i.body=s||e.read_shift(r-2),"string"==typeof s&&(i.Name=s),i}var nm=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function im(e,r,t){var s=e.l+r,n=e.read_shift(2),i=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(t&&2==t.biff?1:2),l=0;(!t||t.biff>=5)&&(5!=t.biff&&(e.l+=2),l=e.read_shift(2),5==t.biff&&(e.l+=2),e.l+=4);var c=Hc(e,a,t);32&n&&(c=nm[c.charCodeAt(0)]);var m=s-e.l;t&&2==t.biff&&--m;var u=s!=e.l&&0!==o&&m>0?function(e,r,t,s){var n,i=e.l+r,a=xd(e,s,t);i!==e.l&&(n=Nd(e,i-e.l,a,t));return[a,n]}(e,m,t,o):[];return{chKey:i,Name:c,itab:l,rgce:u}}function am(e,r,t){if(t.biff<8)return function(e,r,t){3==e[e.l+1]&&e[e.l]++;var s=wc(e,0,t);return 3==s.charCodeAt(0)?s.slice(1):s}(e,0,t);for(var s=[],n=e.l+r,i=e.read_shift(t.biff>8?4:2);0!==i--;)s.push(Pc(e,t.biff,t));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function om(e,r,t){var s=Wc(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[s,Hd(e,r,t)]}var lm={8:function(e,r){var t=e.l+r;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=t,{fmt:s}}};function cm(e){var r=Do(24),t=Io(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)r.write_shift(1,parseInt(s[n],16));return en([r,Rc(e[1])])}function mm(e){var r=e[1].Tooltip,t=Do(10+2*(r.length+1));t.write_shift(2,2048);var s=Io(e[0]);t.write_shift(2,s.r),t.write_shift(2,s.r),t.write_shift(2,s.c),t.write_shift(2,s.c);for(var n=0;n<r.length;++n)t.write_shift(2,r.charCodeAt(n));return t.write_shift(2,0),t}function um(e,r,t){if(!t.cellStyles)return wo(e,r);var s=t&&t.biff>=12?4:2,n=e.read_shift(s),i=e.read_shift(s),a=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2);2==s&&(e.l+=2);var c={s:n,e:i,w:a,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}var dm=Ic,fm=yc,hm=Tc;var pm=[2,3,48,49,131,139,140,245],gm=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=ii({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(r,t){var s=t||{};s.dateNF||(s.dateNF="yyyymmdd");var n=$o(function(r,t){var s=[],n=Xs(1);switch(t.type){case"base64":n=Ks($s(r));break;case"binary":n=Ks(r);break;case"buffer":case"array":n=r}Eo(n,0);var i=n.read_shift(1),a=!!(136&i),o=!1,l=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,a=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var c=0,m=521;2==i&&(c=n.read_shift(2)),n.l+=3,2!=i&&(c=n.read_shift(4)),c>1048576&&(c=1e6),2!=i&&(m=n.read_shift(2));var u=n.read_shift(2),d=t.codepage||1252;2!=i&&(n.l+=16,n.read_shift(1),0!==n[n.l]&&(d=e[n[n.l]]),n.l+=1,n.l+=2),l&&(n.l+=36);for(var f=[],h={},p=Math.min(n.length,2==i?521:m-10-(o?264:0)),g=l?32:11;n.l<p&&13!=n[n.l];)switch((h={}).name=Ls.utils.decode(d,n.slice(n.l,n.l+g)).replace(/[\u0000\r\n].*$/g,""),n.l+=g,h.type=String.fromCharCode(n.read_shift(1)),2==i||l||(h.offset=n.read_shift(4)),h.len=n.read_shift(1),2==i&&(h.offset=n.read_shift(2)),h.dec=n.read_shift(1),h.name.length&&f.push(h),2!=i&&(n.l+=l?13:14),h.type){case"B":(!o||8!=h.len)&&t.WTF;break;case"G":case"P":t.WTF;break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+h.type)}if(13!==n[n.l]&&(n.l=m-1),13!==n.read_shift(1))throw new Error("DBF Terminator not found "+n.l+" "+n[n.l]);n.l=m;var b=0,v=0;for(s[0]=[],v=0;v!=f.length;++v)s[0][v]=f[v].name;for(;c-- >0;)if(42!==n[n.l])for(++n.l,s[++b]=[],v=0,v=0;v!=f.length;++v){var N=n.slice(n.l,n.l+f[v].len);n.l+=f[v].len,Eo(N,0);var x=Ls.utils.decode(d,N);switch(f[v].type){case"C":x.trim().length&&(s[b][v]=x.replace(/\s+$/,""));break;case"D":8===x.length?s[b][v]=new Date(+x.slice(0,4),+x.slice(4,6)-1,+x.slice(6,8)):s[b][v]=x;break;case"F":s[b][v]=parseFloat(x.trim());break;case"+":case"I":s[b][v]=l?2147483648^N.read_shift(-4,"i"):N.read_shift(4,"i");break;case"L":switch(x.trim().toUpperCase()){case"Y":case"T":s[b][v]=!0;break;case"N":case"F":s[b][v]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+x+"|")}break;case"M":if(!a)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));s[b][v]="##MEMO##"+(l?parseInt(x.trim(),10):N.read_shift(4));break;case"N":(x=x.replace(/\u0000/g,"").trim())&&"."!=x&&(s[b][v]=+x||0);break;case"@":s[b][v]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":s[b][v]=new Date(864e5*(N.read_shift(4)-2440588)+N.read_shift(4));break;case"Y":s[b][v]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":s[b][v]=-N.read_shift(-8,"f");break;case"B":if(o&&8==f[v].len){s[b][v]=N.read_shift(8,"f");break}case"G":case"P":N.l+=f[v].len;break;case"0":if("_NullFlags"===f[v].name)break;default:throw new Error("DBF Unsupported data type "+f[v].type)}}else n.l+=u;if(2!=i&&n.l<n.length&&26!=n[n.l++])throw new Error("DBF EOF Marker missing "+(n.l-1)+" of "+n.length+" "+n[n.l-1].toString(16));return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),t.DBF=f,s}(r,s),s);return n["!cols"]=s.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete s.DBF,n}var s={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,r){try{return Wo(t(e,r),r)}catch(s){if(r&&r.WTF)throw s}return{SheetNames:[],Sheets:{}}},to_sheet:t,from_sheet:function(e,t){var n=t||{};if(+n.codepage>=0&&Ms(+n.codepage),"string"==n.type)throw new Error("Cannot write DBF to JS string");var i=Ho(),a=ig(e,{header:1,raw:!0,cellDates:!0}),o=a[0],l=a.slice(1),c=e["!cols"]||[],m=0,u=0,d=0,f=1;for(m=0;m<o.length;++m)if(((c[m]||{}).DBF||{}).name)o[m]=c[m].DBF.name,++d;else if(null!=o[m]){if(++d,"number"==typeof o[m]&&(o[m]=o[m].toString(10)),"string"!=typeof o[m])throw new Error("DBF Invalid column name "+o[m]+" |"+typeof o[m]+"|");if(o.indexOf(o[m])!==m)for(u=0;u<1024;++u)if(-1==o.indexOf(o[m]+"_"+u)){o[m]+="_"+u;break}}var h=Fo(e["!ref"]),p=[],g=[],b=[];for(m=0;m<=h.e.c-h.s.c;++m){var v="",N="",x=0,y=[];for(u=0;u<l.length;++u)null!=l[u][m]&&y.push(l[u][m]);if(0!=y.length&&null!=o[m]){for(u=0;u<y.length;++u){switch(typeof y[u]){case"number":N="B";break;case"string":default:N="C";break;case"boolean":N="L";break;case"object":N=y[u]instanceof Date?"D":"C"}x=Math.max(x,String(y[u]).length),v=v&&v!=N?"C":N}x>250&&(x=250),"C"==(N=((c[m]||{}).DBF||{}).type)&&c[m].DBF.len>x&&(x=c[m].DBF.len),"B"==v&&"N"==N&&(v="N",b[m]=c[m].DBF.dec,x=c[m].DBF.len),g[m]="C"==v||"N"==N?x:s[v]||0,f+=g[m],p[m]=v}else p[m]="?"}var E=i.next(32);for(E.write_shift(4,318902576),E.write_shift(4,l.length),E.write_shift(2,296+32*d),E.write_shift(2,f),m=0;m<4;++m)E.write_shift(4,0);for(E.write_shift(4,(+r[Vs]||3)<<8),m=0,u=0;m<o.length;++m)if(null!=o[m]){var w=i.next(32),D=(o[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);w.write_shift(1,D,"sbcs"),w.write_shift(1,"?"==p[m]?"C":p[m],"sbcs"),w.write_shift(4,u),w.write_shift(1,g[m]||s[p[m]]||0),w.write_shift(1,b[m]||0),w.write_shift(1,2),w.write_shift(4,0),w.write_shift(1,0),w.write_shift(4,0),w.write_shift(4,0),u+=g[m]||s[p[m]]||0}var _=i.next(264);for(_.write_shift(4,13),m=0;m<65;++m)_.write_shift(4,0);for(m=0;m<l.length;++m){var H=i.next(f);for(H.write_shift(1,0),u=0;u<o.length;++u)if(null!=o[u])switch(p[u]){case"L":H.write_shift(1,null==l[m][u]?63:l[m][u]?84:70);break;case"B":H.write_shift(8,l[m][u]||0,"f");break;case"N":var T="0";for("number"==typeof l[m][u]&&(T=l[m][u].toFixed(b[u]||0)),d=0;d<g[u]-T.length;++d)H.write_shift(1,32);H.write_shift(1,T,"sbcs");break;case"D":l[m][u]?(H.write_shift(4,("0000"+l[m][u].getFullYear()).slice(-4),"sbcs"),H.write_shift(2,("00"+(l[m][u].getMonth()+1)).slice(-2),"sbcs"),H.write_shift(2,("00"+l[m][u].getDate()).slice(-2),"sbcs")):H.write_shift(8,"00000000","sbcs");break;case"C":var S=String(null!=l[m][u]?l[m][u]:"").slice(0,g[u]);for(H.write_shift(1,S,"sbcs"),d=0;d<g[u]-S.length;++d)H.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),bm=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("N("+si(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(r,t){var s=e[t];return"number"==typeof s?Bs(s):s},s=function(e,r,t){var s=r.charCodeAt(0)-32<<4|t.charCodeAt(0)-48;return 59==s?e:Bs(s)};function n(e,n){var i,a=e.split(/[\n\r]+/),o=-1,l=-1,c=0,m=0,u=[],d=[],f=null,h={},p=[],g=[],b=[],v=0;for(+n.codepage>=0&&Ms(+n.codepage);c!==a.length;++c){v=0;var N,x=a[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,t),y=x.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),E=y[0];if(x.length>0)switch(E){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==y[1].charAt(0)&&d.push(x.slice(3).replace(/;;/g,";"));break;case"C":var w=!1,D=!1,_=!1,H=!1,T=-1,S=-1;for(m=1;m<y.length;++m)switch(y[m].charAt(0)){case"A":case"G":break;case"X":l=parseInt(y[m].slice(1))-1,D=!0;break;case"Y":for(o=parseInt(y[m].slice(1))-1,D||(l=0),i=u.length;i<=o;++i)u[i]=[];break;case"K":'"'===(N=y[m].slice(1)).charAt(0)?N=N.slice(1,N.length-1):"TRUE"===N?N=!0:"FALSE"===N?N=!1:isNaN(yi(N))?isNaN(wi(N).getDate())||(N=bi(N)):(N=yi(N),null!==f&&Un(f)&&(N=di(N))),void 0!==Ls&&"string"==typeof N&&"string"!=(n||{}).type&&(n||{}).codepage&&(N=Ls.utils.decode(n.codepage,N)),w=!0;break;case"E":H=!0;var j=Xu(y[m].slice(1),{r:o,c:l});u[o][l]=[u[o][l],j];break;case"S":_=!0,u[o][l]=[u[o][l],"S5S"];break;case"R":T=parseInt(y[m].slice(1))-1;break;case"C":S=parseInt(y[m].slice(1))-1;break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+x)}if(w&&(u[o][l]&&2==u[o][l].length?u[o][l][0]=N:u[o][l]=N,f=null),_){if(H)throw new Error("SYLK shared formula cannot have own formula");var k=T>-1&&u[T][S];if(!k||!k[1])throw new Error("SYLK shared formula cannot find base");u[o][l][1]=Ju(k[1],{r:o-T,c:l-S})}break;case"F":var V=0;for(m=1;m<y.length;++m)switch(y[m].charAt(0)){case"X":l=parseInt(y[m].slice(1))-1,++V;break;case"Y":for(o=parseInt(y[m].slice(1))-1,i=u.length;i<=o;++i)u[i]=[];break;case"M":v=parseInt(y[m].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=d[parseInt(y[m].slice(1))];break;case"W":for(b=y[m].slice(1).split(" "),i=parseInt(b[0],10);i<=parseInt(b[1],10);++i)v=parseInt(b[2],10),g[i-1]=0===v?{hidden:!0}:{wch:v},su(g[i-1]);break;case"C":g[l=parseInt(y[m].slice(1))-1]||(g[l]={});break;case"R":p[o=parseInt(y[m].slice(1))-1]||(p[o]={}),v>0?(p[o].hpt=v,p[o].hpx=au(v)):0===v&&(p[o].hidden=!0);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+x)}V<1&&(f=null);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+x)}}return p.length>0&&(h["!rows"]=p),g.length>0&&(h["!cols"]=g),n&&n.sheetRows&&(u=u.slice(0,n.sheetRows)),[u,h]}function i(e,r){var t=function(e,r){switch(r.type){case"base64":return n($s(e),r);case"binary":return n(e,r);case"buffer":return n(Gs&&Buffer.isBuffer(e)?e.toString("binary"):Qs(e),r);case"array":return n(vi(e),r)}throw new Error("Unrecognized type "+r.type)}(e,r),s=t[0],i=t[1],a=$o(s,r);return si(i).forEach(function(e){a[e]=i[e]}),a}function a(e,r,t,s){var n="C;Y"+(t+1)+";X"+(s+1)+";K";switch(e.t){case"n":n+=e.v||0,e.f&&!e.F&&(n+=";E"+Ku(e.f,{r:t,c:s}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||e.v;break;case"d":n+='"'+(e.w||e.v)+'"';break;case"s":n+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return n}return e["|"]=254,{to_workbook:function(e,r){return Wo(i(e,r),r)},to_sheet:i,from_sheet:function(e,r){var t,s,n=["ID;PWXL;N;E"],i=[],o=Fo(e["!ref"]),l=Array.isArray(e),c="\r\n";n.push("P;PGeneral"),n.push("F;P0;DG0G8;M255"),e["!cols"]&&(s=n,e["!cols"].forEach(function(e,r){var t="F;W"+(r+1)+" "+(r+1)+" ";e.hidden?t+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Qm(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Zm(e.wpx)),"number"==typeof e.wch&&(t+=Math.round(e.wch)))," "!=t.charAt(t.length-1)&&s.push(t)})),e["!rows"]&&function(e,r){r.forEach(function(r,t){var s="F;";r.hidden?s+="M0;":r.hpt?s+="M"+20*r.hpt+";":r.hpx&&(s+="M"+20*iu(r.hpx)+";"),s.length>2&&e.push(s+"R"+(t+1))})}(n,e["!rows"]),n.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var m=o.s.r;m<=o.e.r;++m)for(var u=o.s.c;u<=o.e.c;++u){var d=Oo({r:m,c:u});(t=l?(e[m]||[])[u]:e[d])&&(null!=t.v||t.f&&!t.F)&&i.push(a(t,0,m,u))}return n.join(c)+c+i.join(c)+c+"E"+c}}}(),vm=function(){function e(e,r){for(var t=e.split("\n"),s=-1,n=-1,i=0,a=[];i!==t.length;++i)if("BOT"!==t[i].trim()){if(!(s<0)){for(var o=t[i].trim().split(","),l=o[0],c=o[1],m=t[++i]||"";1&(m.match(/["]/g)||[]).length&&i<t.length-1;)m+="\n"+t[++i];switch(m=m.trim(),+l){case-1:if("BOT"===m){a[++s]=[],n=0;continue}if("EOD"!==m)throw new Error("Unrecognized DIF special command "+m);break;case 0:"TRUE"===m?a[s][n]=!0:"FALSE"===m?a[s][n]=!1:isNaN(yi(c))?isNaN(wi(c).getDate())?a[s][n]=c:a[s][n]=bi(c):a[s][n]=yi(c),++n;break;case 1:(m=(m=m.slice(1,m.length-1)).replace(/""/g,'"'))&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),a[s][n++]=""!==m?m:null}if("EOD"===m)break}}else a[++s]=[],n=0;return r&&r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}function r(r,t){return $o(function(r,t){switch(t.type){case"base64":return e($s(r),t);case"binary":return e(r,t);case"buffer":return e(Gs&&Buffer.isBuffer(r)?r.toString("binary"):Qs(r),t);case"array":return e(vi(r),t)}throw new Error("Unrecognized type "+t.type)}(r,t),t)}return{to_workbook:function(e,t){return Wo(r(e,t),t)},to_sheet:r,from_sheet:function(){var e=function(e,r,t,s,n){e.push(r),e.push(t+","+s),e.push('"'+n.replace(/"/g,'""')+'"')},r=function(e,r,t,s){e.push(r+","+t),e.push(1==r?'"'+s.replace(/"/g,'""')+'"':s)};return function(t){var s,n=[],i=Fo(t["!ref"]),a=Array.isArray(t);e(n,"TABLE",0,1,"sheetjs"),e(n,"VECTORS",0,i.e.r-i.s.r+1,""),e(n,"TUPLES",0,i.e.c-i.s.c+1,""),e(n,"DATA",0,0,"");for(var o=i.s.r;o<=i.e.r;++o){r(n,-1,0,"BOT");for(var l=i.s.c;l<=i.e.c;++l){var c=Oo({r:o,c:l});if(s=a?(t[o]||[])[l]:t[c])switch(s.t){case"n":var m=s.w;m||null==s.v||(m=s.v),null==m?s.f&&!s.F?r(n,1,0,"="+s.f):r(n,1,0,""):r(n,0,m,"V");break;case"b":r(n,0,s.v?1:0,s.v?"TRUE":"FALSE");break;case"s":r(n,1,0,isNaN(s.v)?s.v:'="'+s.v+'"');break;case"d":s.w||(s.w=$n(s.z||fn[14],li(bi(s.v)))),r(n,0,s.w,"V");break;default:r(n,1,0,"")}else r(n,1,0,"")}}r(n,-1,0,"EOD");return n.join("\r\n")}}()}}(),Nm=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function r(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(r,t){return $o(function(r,t){for(var s=r.split("\n"),n=-1,i=-1,a=0,o=[];a!==s.length;++a){var l=s[a].trim().split(":");if("cell"===l[0]){var c=Io(l[1]);if(o.length<=c.r)for(n=o.length;n<=c.r;++n)o[n]||(o[n]=[]);switch(n=c.r,i=c.c,l[2]){case"t":o[n][i]=e(l[3]);break;case"v":o[n][i]=+l[3];break;case"vtf":var m=l[l.length-1];case"vtc":"nl"===l[3]?o[n][i]=!!+l[4]:o[n][i]=+l[4],"vtf"==l[2]&&(o[n][i]=[o[n][i],m])}}}return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}(r,t),t)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),a="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var t,s=[],n=[],i="",a=Po(e["!ref"]),o=Array.isArray(e),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c)if(i=Oo({r:l,c:c}),(t=o?(e[l]||[])[c]:e[i])&&null!=t.v&&"z"!==t.t){switch(n=["cell",i,"t"],t.t){case"s":case"str":n.push(r(t.v));break;case"n":t.f?(n[2]="vtf",n[3]="n",n[4]=t.v,n[5]=r(t.f)):(n[2]="v",n[3]=t.v);break;case"b":n[2]="vt"+(t.f?"f":"c"),n[3]="nl",n[4]=t.v?"1":"0",n[5]=r(t.f||(t.v?"TRUE":"FALSE"));break;case"d":var m=li(bi(t.v));n[2]="vtc",n[3]="nd",n[4]=""+m,n[5]=t.w||$n(t.z||fn[14],m);break;case"e":continue}s.push(n.join(":"))}return s.push("sheet:c:"+(a.e.c-a.s.c+1)+":r:"+(a.e.r-a.s.r+1)+":tvf:1"),s.push("valueformat:1:text-wiki"),s.join("\n")}return{to_workbook:function(e,r){return Wo(t(e,r),r)},to_sheet:t,from_sheet:function(e){return[s,n,i,n,o(e),a].join("\n")}}}(),xm=function(){function e(e,r,t,s,n){n.raw?r[t][s]=e:""===e||("TRUE"===e?r[t][s]=!0:"FALSE"===e?r[t][s]=!1:isNaN(yi(e))?isNaN(wi(e).getDate())?r[t][s]=e:r[t][s]=bi(e):r[t][s]=yi(e))}var r={44:",",9:"\t",59:";",124:"|"},t={44:3,9:2,59:1,124:0};function s(e){for(var s={},n=!1,i=0,a=0;i<e.length;++i)34==(a=e.charCodeAt(i))?n=!n:!n&&a in r&&(s[a]=(s[a]||0)+1);for(i in a=[],s)Object.prototype.hasOwnProperty.call(s,i)&&a.push([s[i],i]);if(!a.length)for(i in s=t)Object.prototype.hasOwnProperty.call(s,i)&&a.push([s[i],i]);return a.sort(function(e,r){return e[0]-r[0]||t[e[1]]-t[r[1]]}),r[a.pop()[1]]||44}function n(e,r){var t=r||{},n="",i=t.dense?[]:{},a={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(n=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(n=e.charAt(4),e=e.slice(6)):n=s(e.slice(0,1024)):n=t&&t.FS?t.FS:s(e.slice(0,1024));var o=0,l=0,c=0,m=0,u=0,d=n.charCodeAt(0),f=!1,h=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g,b,v=null!=t.dateNF?(g=t.dateNF,b=(b="number"==typeof g?fn[g]:g).replace(Jn,"(\\d+)"),new RegExp("^"+b+"$")):null;function N(){var r=e.slice(m,u),s={};if('"'==r.charAt(0)&&'"'==r.charAt(r.length-1)&&(r=r.slice(1,-1).replace(/""/g,'"')),0===r.length)s.t="z";else if(t.raw)s.t="s",s.v=r;else if(0===r.trim().length)s.t="s",s.v=r;else if(61==r.charCodeAt(0))34==r.charCodeAt(1)&&34==r.charCodeAt(r.length-1)?(s.t="s",s.v=r.slice(2,-1).replace(/""/g,'"')):1!=r.length?(s.t="n",s.f=r.slice(1)):(s.t="s",s.v=r);else if("TRUE"==r)s.t="b",s.v=!0;else if("FALSE"==r)s.t="b",s.v=!1;else if(isNaN(c=yi(r)))if(!isNaN(wi(r).getDate())||v&&r.match(v)){s.z=t.dateNF||fn[14];var n=0;v&&r.match(v)&&(r=function(e,r,t){var s=-1,n=-1,i=-1,a=-1,o=-1,l=-1;(r.match(Jn)||[]).forEach(function(e,r){var c=parseInt(t[r+1],10);switch(e.toLowerCase().charAt(0)){case"y":s=c;break;case"d":i=c;break;case"h":a=c;break;case"s":l=c;break;case"m":a>=0?o=c:n=c}}),l>=0&&-1==o&&n>=0&&(o=n,n=-1);var c=(""+(s>=0?s:(new Date).getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var m=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==a&&-1==o&&-1==l?c:-1==s&&-1==n&&-1==i?m:c+"T"+m}(0,t.dateNF,r.match(v)||[]),n=1),t.cellDates?(s.t="d",s.v=bi(r,n)):(s.t="n",s.v=li(bi(r,n))),!1!==t.cellText&&(s.w=$n(s.z,s.v instanceof Date?li(s.v):s.v)),t.cellNF||delete s.z}else s.t="s",s.v=r;else s.t="n",!1!==t.cellText&&(s.w=r),s.v=c;if("z"==s.t||(t.dense?(i[o]||(i[o]=[]),i[o][l]=s):i[Oo({c:l,r:o})]=s),m=u+1,p=e.charCodeAt(m),a.e.c<l&&(a.e.c=l),a.e.r<o&&(a.e.r=o),h==d)++l;else if(l=0,++o,t.sheetRows&&t.sheetRows<=o)return!0}e:for(;u<e.length;++u)switch(h=e.charCodeAt(u)){case 34:34===p&&(f=!f);break;case d:case 10:case 13:if(!f&&N())break e}return u-m>0&&N(),i["!ref"]=Lo(a),i}function i(r,t){return t&&t.PRN?t.FS||"sep="==r.slice(0,4)||r.indexOf("\t")>=0||r.indexOf(",")>=0||r.indexOf(";")>=0?n(r,t):$o(function(r,t){var s=t||{},n=[];if(!r||0===r.length)return n;for(var i=r.split(/[\r\n]/),a=i.length-1;a>=0&&0===i[a].length;)--a;for(var o=10,l=0,c=0;c<=a;++c)-1==(l=i[c].indexOf(" "))?l=i[c].length:l++,o=Math.max(o,l);for(c=0;c<=a;++c){n[c]=[];var m=0;for(e(i[c].slice(0,o).trim(),n,c,m,s),m=1;m<=(i[c].length-o)/10+1;++m)e(i[c].slice(o+10*(m-1),o+10*m).trim(),n,c,m,s)}return s.sheetRows&&(n=n.slice(0,s.sheetRows)),n}(r,t),t):n(r,t)}function a(e,r){var t="",s="string"==r.type?[0,0,0,0]:$p(e,r);switch(r.type){case"base64":t=$s(e);break;case"binary":case"string":t=e;break;case"buffer":t=65001==r.codepage?e.toString("utf8"):r.codepage&&void 0!==Ls?Ls.utils.decode(r.codepage,e):Gs&&Buffer.isBuffer(e)?e.toString("binary"):Qs(e);break;case"array":t=vi(e);break;default:throw new Error("Unrecognized type "+r.type)}return 239==s[0]&&187==s[1]&&191==s[2]?t=ia(t.slice(3)):"string"!=r.type&&"buffer"!=r.type&&65001==r.codepage?t=ia(t):"binary"==r.type&&void 0!==Ls&&r.codepage&&(t=Ls.utils.decode(r.codepage,Ls.utils.encode(28591,t))),"socialcalc:version:"==t.slice(0,19)?Nm.to_sheet("string"==r.type?t:ia(t),r):i(t,r)}return{to_workbook:function(e,r){return Wo(a(e,r),r)},to_sheet:a,from_sheet:function(e){for(var r,t=[],s=Fo(e["!ref"]),n=Array.isArray(e),i=s.s.r;i<=s.e.r;++i){for(var a=[],o=s.s.c;o<=s.e.c;++o){var l=Oo({r:i,c:o});if((r=n?(e[i]||[])[o]:e[l])&&null!=r.v){for(var c=(r.w||(Bo(r),r.w)||"").slice(0,10);c.length<10;)c+=" ";a.push(c+(0===o?" ":""))}else a.push("          ")}t.push(a.join(""))}return t.join("\n")}}}();var ym=function(){function e(e,r,t){if(e){Eo(e,e.l||0);for(var s=t.Enum||b;e.l<e.length;){var n=e.read_shift(2),i=s[n]||s[65535],a=e.read_shift(2),o=e.l+a,l=i.f&&i.f(e,a,t);if(e.l=o,r(l,i,n))return}}}function r(r,t){if(!r)return r;var s=t||{},n=s.dense?[]:{},i="Sheet1",a="",o=0,l={},c=[],m=[],u={s:{r:0,c:0},e:{r:0,c:0}},d=s.sheetRows||0;if(0==r[2]&&(8==r[3]||9==r[3])&&r.length>=16&&5==r[14]&&108===r[15])throw new Error("Unsupported Works 3 for Mac file");if(2==r[2])s.Enum=b,e(r,function(e,r,t){switch(t){case 0:s.vers=e,e>=4096&&(s.qpro=!0);break;case 6:u=e;break;case 204:e&&(a=e);break;case 222:a=e;break;case 15:case 51:s.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==t&&!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=s.dateNF||fn[14],s.cellDates&&(e[1].t="d",e[1].v=di(e[1].v))),s.qpro&&e[3]>o&&(n["!ref"]=Lo(u),l[i]=n,c.push(i),n=s.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i=a||"Sheet"+(o+1),a="");var m=s.dense?(n[e[0].r]||[])[e[0].c]:n[Oo(e[0])];if(m){m.t=e[1].t,m.v=e[1].v,null!=e[1].z&&(m.z=e[1].z),null!=e[1].f&&(m.f=e[1].f);break}s.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[Oo(e[0])]=e[1]}},s);else{if(26!=r[2]&&14!=r[2])throw new Error("Unrecognized LOTUS BOF "+r[2]);s.Enum=v,14==r[2]&&(s.qpro=!0,r.l=0),e(r,function(e,r,t){switch(t){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(n["!ref"]=Lo(u),l[i]=n,c.push(i),n=s.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i="Sheet"+(o+1)),d>0&&e[0].r>=d)break;s.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[Oo(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(m[e[14e3][0]]=e[14e3][1]);break;case 1537:m[e[0]]=e[1],e[0]==o&&(i=e[1])}},s)}if(n["!ref"]=Lo(u),l[a||i]=n,c.push(a||i),!m.length)return{SheetNames:c,Sheets:l};for(var f={},h=[],p=0;p<m.length;++p)l[c[p]]?(h.push(m[p]||c[p]),f[m[p]]=l[m[p]]||l[c[p]]):(h.push(m[p]),f[m[p]]={"!ref":"A1"});return{SheetNames:h,Sheets:f}}function t(e,r,t){var s=[{c:0,r:0},{t:"n",v:0},0,0];return t.qpro&&20768!=t.vers?(s[0].c=e.read_shift(1),s[3]=e.read_shift(1),s[0].r=e.read_shift(2),e.l+=2):(s[2]=e.read_shift(1),s[0].c=e.read_shift(2),s[0].r=e.read_shift(2)),s}function s(e,r,s){var n=e.l+r,i=t(e,0,s);if(i[1].t="s",20768==s.vers){e.l++;var a=e.read_shift(1);return i[1].v=e.read_shift(a,"utf8"),i}return s.qpro&&e.l++,i[1].v=e.read_shift(n-e.l,"cstr"),i}function n(e,r,t){var s=Do(7+t.length);s.write_shift(1,255),s.write_shift(2,r),s.write_shift(2,e),s.write_shift(1,39);for(var n=0;n<s.length;++n){var i=t.charCodeAt(n);s.write_shift(1,i>=128?95:i)}return s.write_shift(1,0),s}function i(e,r,t){var s=Do(7);return s.write_shift(1,255),s.write_shift(2,r),s.write_shift(2,e),s.write_shift(2,t,"i"),s}function a(e,r,t){var s=Do(13);return s.write_shift(1,255),s.write_shift(2,r),s.write_shift(2,e),s.write_shift(8,t,"f"),s}function o(e,r,t){var s=32768&r;return r=(s?e:0)+((r&=-32769)>=8192?r-16384:r),(s?"":"$")+(t?Mo(r):Ro(r))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function m(e){var r=[{c:0,r:0},{t:"n",v:0},0];return r[0].r=e.read_shift(2),r[3]=e[e.l++],r[0].c=e[e.l++],r}function u(e,r,t,s){var n=Do(6+s.length);n.write_shift(2,e),n.write_shift(1,t),n.write_shift(1,r),n.write_shift(1,39);for(var i=0;i<s.length;++i){var a=s.charCodeAt(i);n.write_shift(1,a>=128?95:a)}return n.write_shift(1,0),n}function d(e,r){var t=m(e),s=e.read_shift(4),n=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===s&&3221225472===n?(t[1].t="e",t[1].v=15):0===s&&3489660928===n?(t[1].t="e",t[1].v=42):t[1].v=0,t;var a=32768&i;return i=(32767&i)-16446,t[1].v=(1-2*a)*(n*Math.pow(2,i+32)+s*Math.pow(2,i)),t}function f(e,r,t,s){var n=Do(14);if(n.write_shift(2,e),n.write_shift(1,t),n.write_shift(1,r),0==s)return n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,65535),n;var i,a=0,o=0,l=0;return s<0&&(a=1,s=-s),o=0|Math.log2(s),2147483648&(l=(s/=Math.pow(2,o-31))>>>0)||(++o,l=(s/=2)>>>0),s-=l,l|=2147483648,l>>>=0,i=(s*=Math.pow(2,32))>>>0,n.write_shift(4,i),n.write_shift(4,l),o+=16383+(a?32768:0),n.write_shift(2,o),n}function h(e,r){var t=m(e),s=e.read_shift(8,"f");return t[1].v=s,t}function p(e,r){return 0==e[e.l+r-1]?e.read_shift(r,"cstr"):""}function g(e,r){var t=Do(5+e.length);t.write_shift(2,14e3),t.write_shift(2,r);for(var s=0;s<e.length;++s){var n=e.charCodeAt(s);t[t.l++]=n>127?95:n}return t[t.l++]=0,t}var b={0:{n:"BOF",f:Nc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,r,t){var s={s:{c:0,r:0},e:{c:0,r:0}};return 8==r&&t.qpro?(s.s.c=e.read_shift(1),e.l++,s.s.r=e.read_shift(2),s.e.c=e.read_shift(1),e.l++,s.e.r=e.read_shift(2),s):(s.s.c=e.read_shift(2),s.s.r=e.read_shift(2),12==r&&t.qpro&&(e.l+=2),s.e.c=e.read_shift(2),s.e.r=e.read_shift(2),12==r&&t.qpro&&(e.l+=2),65535==s.s.c&&(s.s.c=s.e.c=s.s.r=s.e.r=0),s)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,r,s){var n=t(e,0,s);return n[1].v=e.read_shift(2,"i"),n}},14:{n:"NUMBER",f:function(e,r,s){var n=t(e,0,s);return n[1].v=e.read_shift(8,"f"),n}},15:{n:"LABEL",f:s},16:{n:"FORMULA",f:function(e,r,s){var n=e.l+r,i=t(e,0,s);if(i[1].v=e.read_shift(8,"f"),s.qpro)e.l=n;else{var a=e.read_shift(2);!function(e,r){Eo(e,0);var t=[],s=0,n="",i="",a="",m="";for(;e.l<e.length;){var u=e[e.l++];switch(u){case 0:t.push(e.read_shift(8,"f"));break;case 1:i=o(r[0].c,e.read_shift(2),!0),n=o(r[0].r,e.read_shift(2),!1),t.push(i+n);break;case 2:var d=o(r[0].c,e.read_shift(2),!0),f=o(r[0].r,e.read_shift(2),!1);i=o(r[0].c,e.read_shift(2),!0),n=o(r[0].r,e.read_shift(2),!1),t.push(d+f+":"+i+n);break;case 3:if(e.l<e.length)return;break;case 4:t.push("("+t.pop()+")");break;case 5:t.push(e.read_shift(2));break;case 6:for(var h="";u=e[e.l++];)h+=String.fromCharCode(u);t.push('"'+h.replace(/"/g,'""')+'"');break;case 8:t.push("-"+t.pop());break;case 23:t.push("+"+t.pop());break;case 22:t.push("NOT("+t.pop()+")");break;case 20:case 21:m=t.pop(),a=t.pop(),t.push(["AND","OR"][u-20]+"("+a+","+m+")");break;default:if(u<32&&c[u])m=t.pop(),a=t.pop(),t.push(a+c[u]+m);else{if(!l[u])return;if(69==(s=l[u][1])&&(s=e[e.l++]),s>t.length)return;var p=t.slice(-s);t.length-=s,t.push(l[u][0]+"("+p.join(",")+")")}}}1==t.length&&(r[1].f=""+t[0])}(e.slice(e.l,e.l+a),i),e.l+=a}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:s},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,r){var t=e[e.l++];t>r-1&&(t=r-1);for(var s="";s.length<t;)s+=String.fromCharCode(e[e.l++]);return s}},65535:{n:""}},v={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,r){var t=m(e);return t[1].t="s",t[1].v=e.read_shift(r-4,"cstr"),t}},23:{n:"NUMBER17",f:d},24:{n:"NUMBER18",f:function(e,r){var t=m(e);t[1].v=e.read_shift(2);var s=t[1].v>>1;if(1&t[1].v)switch(7&s){case 0:s=5e3*(s>>3);break;case 1:s=500*(s>>3);break;case 2:s=(s>>3)/20;break;case 3:s=(s>>3)/200;break;case 4:s=(s>>3)/2e3;break;case 5:s=(s>>3)/2e4;break;case 6:s=(s>>3)/16;break;case 7:s=(s>>3)/64}return t[1].v=s,t}},25:{n:"FORMULA19",f:function(e,r){var t=d(e);return e.l+=r-14,t}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,r){for(var t={},s=e.l+r;e.l<s;){var n=e.read_shift(2);if(14e3==n){for(t[n]=[0,""],t[n][0]=e.read_shift(2);e[e.l];)t[n][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return t}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,r){var t=m(e),s=e.read_shift(4);return t[1].v=s>>6,t}},38:{n:"??"},39:{n:"NUMBER27",f:h},40:{n:"FORMULA28",f:function(e,r){var t=h(e);return e.l+=r-10,t}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,r,t){if(t.qpro&&!(r<21)){var s=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[s,e.read_shift(r-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,r){var t=r||{};if(+t.codepage>=0&&Ms(+t.codepage),"string"==t.type)throw new Error("Cannot write WK1 to JS string");var s,o,l=Ho(),c=Fo(e["!ref"]),m=Array.isArray(e),u=[];Ih(l,0,(s=1030,(o=Do(2)).write_shift(2,s),o)),Ih(l,6,function(e){var r=Do(8);return r.write_shift(2,e.s.c),r.write_shift(2,e.s.r),r.write_shift(2,e.e.c),r.write_shift(2,e.e.r),r}(c));for(var d=Math.min(c.e.r,8191),f=c.s.r;f<=d;++f)for(var h=Ro(f),p=c.s.c;p<=c.e.c;++p){f===c.s.r&&(u[p]=Mo(p));var g=u[p]+h,b=m?(e[f]||[])[p]:e[g];if(b&&"z"!=b.t)if("n"==b.t)(0|b.v)==b.v&&b.v>=-32768&&b.v<=32767?Ih(l,13,i(f,p,b.v)):Ih(l,14,a(f,p,b.v));else Ih(l,15,n(f,p,Bo(b).slice(0,239)))}return Ih(l,1),l.end()},book_to_wk3:function(e,r){var t=r||{};if(+t.codepage>=0&&Ms(+t.codepage),"string"==t.type)throw new Error("Cannot write WK3 to JS string");var s=Ho();Ih(s,0,function(e){var r=Do(26);r.write_shift(2,4096),r.write_shift(2,4),r.write_shift(4,0);for(var t=0,s=0,n=0,i=0;i<e.SheetNames.length;++i){var a=e.SheetNames[i],o=e.Sheets[a];if(o&&o["!ref"]){++n;var l=Po(o["!ref"]);t<l.e.r&&(t=l.e.r),s<l.e.c&&(s=l.e.c)}}t>8191&&(t=8191);return r.write_shift(2,t),r.write_shift(1,n),r.write_shift(1,s),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,1),r.write_shift(1,2),r.write_shift(4,0),r.write_shift(4,0),r}(e));for(var n=0,i=0;n<e.SheetNames.length;++n)(e.Sheets[e.SheetNames[n]]||{})["!ref"]&&Ih(s,27,g(e.SheetNames[n],i++));var a=0;for(n=0;n<e.SheetNames.length;++n){var o=e.Sheets[e.SheetNames[n]];if(o&&o["!ref"]){for(var l=Fo(o["!ref"]),c=Array.isArray(o),m=[],d=Math.min(l.e.r,8191),h=l.s.r;h<=d;++h)for(var p=Ro(h),b=l.s.c;b<=l.e.c;++b){h===l.s.r&&(m[b]=Mo(b));var v=m[b]+p,N=c?(o[h]||[])[b]:o[v];if(N&&"z"!=N.t)if("n"==N.t)Ih(s,23,f(h,b,a,N.v));else Ih(s,22,u(h,b,a,Bo(N).slice(0,239)))}++a}}return Ih(s,1),s.end()},to_workbook:function(e,t){switch(t.type){case"base64":return r(Ks($s(e)),t);case"binary":return r(Ks(e),t);case"buffer":case"array":return r(e,t)}throw"Unsupported type "+t.type}}}();var Em=function(){var e=oa("t"),r=oa("rPr");function t(t){var s=t.match(e);if(!s)return{t:"s",v:""};var n={t:"s",v:Gi(s[1])},i=t.match(r);return i&&(n.s=function(e){var r={},t=e.match(Li),s=0,n=!1;if(t)for(;s!=t.length;++s){var i=Bi(t[s]);switch(i[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==i.val)break;r.cp=Rs[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=i.val;break;case"<sz":r.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting"}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if("0"==i.val)break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if("0"==i.val)break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":i.rgb&&(r.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(47!==i[0].charCodeAt(1)&&!n)throw new Error("Unrecognized rich format "+i[0])}}return r}(i[1])),n}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(e){return e.replace(s,"").split(n).map(t).filter(function(e){return e.v})}}(),wm=function(){var e=/(\r\n|\n)/g;function r(r){var t=[[],r.v,[]];return r.v?(r.s&&function(e,r,t){var s=[];e.u&&s.push("text-decoration: underline;"),e.uval&&s.push("text-underline-style:"+e.uval+";"),e.sz&&s.push("font-size:"+e.sz+"pt;"),e.outline&&s.push("text-effect: outline;"),e.shadow&&s.push("text-shadow: auto;"),r.push('<span style="'+s.join("")+'">'),e.b&&(r.push("<b>"),t.push("</b>")),e.i&&(r.push("<i>"),t.push("</i>")),e.strike&&(r.push("<s>"),t.push("</s>"));var n=e.valign||"";"superscript"==n||"super"==n?n="sup":"subscript"==n&&(n="sub"),""!=n&&(r.push("<"+n+">"),t.push("</"+n+">")),t.push("</span>")}(r.s,t[0],t[2]),t[0].join("")+t[1].replace(e,"<br/>")+t[2].join("")):""}return function(e){return e.map(r).join("")}}(),Dm=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_m=/<(?:\w+:)?r>/,Hm=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Tm(e,r){var t=!r||r.cellHTML,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Gi(ia(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=ia(e),t&&(s.h=Qi(s.t))):e.match(_m)&&(s.r=ia(e),s.t=Gi(ia((e.replace(Hm,"").match(Dm)||[]).join("").replace(Li,""))),t&&(s.h=wm(Em(s.r)))),s):{t:""}}var Sm=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,jm=/<(?:\w+:)?(?:si|sstItem)>/g,km=/<\/(?:\w+:)?(?:si|sstItem)>/;var Vm=/^\s|\s$|[\t\n\r]/;function Cm(e,r){if(!r.bookSST)return"";var t=[Ii];t[t.length]=ga("sst",null,{xmlns:Ra[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(null!=e[s]){var n=e[s],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(Vm)&&(i+=' xml:space="preserve"'),i+=">"+Yi(n.t)+"</t>"),i+="</si>",t[t.length]=i}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}var Rm=function(e,r){var t=!1;return null==r&&(t=!0,r=Do(15+4*e.t.length)),r.write_shift(1,0),Xo(e.t,r),t?r.slice(0,r.l):r};function Am(e){var r=Ho();To(r,159,function(e,r){return r||(r=Do(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}(e));for(var t=0;t<e.length;++t)To(r,19,Rm(e[t]));return To(r,160),r.end()}function Mm(e){if(void 0!==Ls)return Ls.utils.encode(Vs,e);for(var r=[],t=e.split(""),s=0;s<t.length;++s)r[s]=t[s].charCodeAt(0);return r}function Im(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function Om(e){for(var r=e.read_shift(4),t=e.l+r-4,s={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=i,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return s}function Pm(e){var r=function(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Im(e,4),r.U=Im(e,4),r.W=Im(e,4),r}(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return r}function Lm(e,r){var t=e.l+r,s={};s.Flags=63&e.read_shift(4),e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=36==s.Flags;break;case 26625:n=4==s.Flags;break;case 0:n=16==s.Flags||4==s.Flags||36==s.Flags;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,s}function Fm(e,r){var t={},s=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,s),e.l=s,t}function Um(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4);return{t:"Std",h:Lm(e,r),v:Fm(e,e.length-e.l)}}function Bm(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Wm(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),s={};return t.replace(Li,function(e){var t=Bi(e);switch(Wi(t[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":r.forEach(function(e){s[e]=t[e]});break;case"<dataIntegrity":s.encryptedHmacKey=t.encryptedHmacKey,s.encryptedHmacValue=t.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"<keyEncryptor":s.uri=t.uri;break;case"<encryptedKey":s.encs.push(t);break;default:throw t[0]}}),s}function zm(e){var r,t,s=0,n=Mm(e),i=n.length+1;for((r=Xs(i))[0]=n.length,t=1;t!=i;++t)r[t]=n[t-1];for(t=i-1;t>=0;--t)s=((16384&s?1:0)|s<<1&32767)^r[t];return 52811^s}var $m=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(e,r){return 255&((t=e^r)/2|128*t);var t};return function(n){for(var i,a,o,l=Mm(n),c=function(e){for(var s=r[e.length-1],n=104,i=e.length-1;i>=0;--i)for(var a=e[i],o=0;7!=o;++o)64&a&&(s^=t[n]),a*=2,--n;return s}(l),m=l.length,u=Xs(16),d=0;16!=d;++d)u[d]=0;for(1&~m||(i=c>>8,u[m]=s(e[0],i),--m,i=255&c,a=l[l.length-1],u[m]=s(a,i));m>0;)i=c>>8,u[--m]=s(l[m],i),i=255&c,u[--m]=s(l[m],i);for(m=15,o=15-l.length;o>0;)i=c>>8,u[m]=s(e[o],i),--o,i=255&c,u[--m]=s(l[m],i),--m,--o;return u}}(),Gm=function(e){var r=0,t=$m(e);return function(e){var s=function(e,r,t,s,n){var i,a;for(n||(n=r),s||(s=$m(e)),i=0;i!=r.length;++i)a=r[i],a=255&((a^=s[t])>>5|a<<3),n[i]=a,++t;return[n,t,s]}("",e,r,t);return r=s[1],s[0]}};function qm(e,r,t){var s=t||{};return s.Info=e.read_shift(2),e.l-=2,1===s.Info?s.Data=function(e){var r={},t=r.EncryptionVersionInfo=Im(e,4);if(1!=t.Major||1!=t.Minor)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}(e):s.Data=function(e,r){var t={},s=t.EncryptionVersionInfo=Im(e,4);if(r-=4,2!=s.Minor)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);t.Flags=e.read_shift(4),r-=4;var n=e.read_shift(4);return r-=4,t.EncryptionHeader=Lm(e,n),r-=n,t.EncryptionVerifier=Fm(e,r),t}(e,r),s}var Xm=function(){function e(e,t){switch(t.type){case"base64":return r($s(e),t);case"binary":return r(e,t);case"buffer":return r(Gs&&Buffer.isBuffer(e)?e.toString("binary"):Qs(e),t);case"array":return r(vi(e),t)}throw new Error("Unrecognized type "+t.type)}function r(e,r){var t=(r||{}).dense?[]:{},s=e.match(/\\trowd.*?\\row\b/g);if(!s.length)throw new Error("RTF missing table");var n={s:{c:0,r:0},e:{c:0,r:s.length-1}};return s.forEach(function(e,r){Array.isArray(t)&&(t[r]=[]);for(var s,i=/\\\w+\b/g,a=0,o=-1;s=i.exec(e);){if("\\cell"===s[0]){var l=e.slice(a,i.lastIndex-s[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(t)?t[r][o]=c:t[Oo({r:r,c:o})]=c}}a=i.lastIndex}o>n.e.c&&(n.e.c=o)}),t["!ref"]=Lo(n),t}return{to_workbook:function(r,t){return Wo(e(r,t),t)},to_sheet:e,from_sheet:function(e){for(var r,t=["{\\rtf1\\ansi"],s=Fo(e["!ref"]),n=Array.isArray(e),i=s.s.r;i<=s.e.r;++i){t.push("\\trowd\\trautofit1");for(var a=s.s.c;a<=s.e.c;++a)t.push("\\cellx"+(a+1));for(t.push("\\pard\\intbl"),a=s.s.c;a<=s.e.c;++a){var o=Oo({r:i,c:a});(r=n?(e[i]||[])[a]:e[o])&&(null!=r.v||r.f&&!r.F)&&(t.push(" "+(r.w||(Bo(r),r.w))),t.push("\\cell"))}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}}}();function Ym(e){for(var r=0,t=1;3!=r;++r)t=256*t+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Km(e,r){if(0===r)return e;var t,s,n=function(e){var r=e[0]/255,t=e[1]/255,s=e[2]/255,n=Math.max(r,t,s),i=Math.min(r,t,s),a=n-i;if(0===a)return[0,0,r];var o,l=0,c=n+i;switch(o=a/(c>1?2-c:c),n){case r:l=((t-s)/a+6)%6;break;case t:l=(s-r)/a+2;break;case s:l=(r-t)/a+4}return[l/6,o,c/2]}((s=(t=e).slice("#"===t[0]?1:0).slice(0,6),[parseInt(s.slice(0,2),16),parseInt(s.slice(2,4),16),parseInt(s.slice(4,6),16)]));return n[2]=r<0?n[2]*(1+r):1-(1-n[2])*(1-r),Ym(function(e){var r,t=e[0],s=e[1],n=e[2],i=2*s*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],l=6*t;if(0!==s)switch(0|l){case 0:case 6:r=i*l,o[0]+=i,o[1]+=r;break;case 1:r=i*(2-l),o[0]+=r,o[1]+=i;break;case 2:r=i*(l-2),o[1]+=i,o[2]+=r;break;case 3:r=i*(4-l),o[1]+=r,o[2]+=i;break;case 4:r=i*(l-4),o[2]+=i,o[0]+=r;break;case 5:r=i*(6-l),o[2]+=r,o[0]+=i}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(n))}var Jm=6;function Qm(e){return Math.floor((e+Math.round(128/Jm)/256)*Jm)}function Zm(e){return Math.floor((e-5)/Jm*100+.5)/100}function eu(e){return Math.round((e*Jm+5)/Jm*256)/256}function ru(e){return eu(Zm(Qm(e)))}function tu(e){var r=Math.abs(e-ru(e)),t=Jm;if(r>.005)for(Jm=1;Jm<15;++Jm)Math.abs(e-ru(e))<=r&&(r=Math.abs(e-ru(e)),t=Jm);Jm=t}function su(e){e.width?(e.wpx=Qm(e.width),e.wch=Zm(e.wpx),e.MDW=Jm):e.wpx?(e.wch=Zm(e.wpx),e.width=eu(e.wch),e.MDW=Jm):"number"==typeof e.wch&&(e.width=eu(e.wch),e.wpx=Qm(e.width),e.MDW=Jm),e.customWidth&&delete e.customWidth}var nu=96;function iu(e){return 96*e/nu}function au(e){return e*nu/96}var ou={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var lu=["numFmtId","fillId","fontId","borderId","xfId"],cu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var mu=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,t=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,a,o){var l,c={};return i?((l=(i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,r,t){r.NumberFmt=[];for(var s=si(fn),n=0;n<s.length;++n)r.NumberFmt[s[n]]=fn[s[n]];var i=e[0].match(Li);if(i)for(n=0;n<i.length;++n){var a=Bi(i[n]);switch(Wi(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=Gi(ia(a.formatCode)),l=parseInt(a.numFmtId,10);if(r.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=r.NumberFmt[l];--l);r.NumberFmt[l]=o}Gn(o,l)}break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}(l,c,o),(l=i.match(s))&&function(e,r,t,s){r.Fonts=[];var n={},i=!1;(e[0].match(Li)||[]).forEach(function(e){var a=Bi(e);switch(Wi(a[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":a.val&&(n.name=ia(a.val));break;case"<b":n.bold=a.val?ea(a.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=a.val?ea(a.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(a.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=a.val?ea(a.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=a.val?ea(a.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=a.val?ea(a.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=a.val?ea(a.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=a.val?ea(a.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":a.val&&(n.sz=+a.val);break;case"<vertAlign":a.val&&(n.vertAlign=a.val);break;case"<family":a.val&&(n.family=parseInt(a.val,10));break;case"<scheme":a.val&&(n.scheme=a.val);break;case"<charset":if("1"==a.val)break;a.codepage=Rs[parseInt(a.val,10)];break;case"<color":if(n.color||(n.color={}),a.auto&&(n.color.auto=ea(a.auto)),a.rgb)n.color.rgb=a.rgb.slice(-6);else if(a.indexed){n.color.index=parseInt(a.indexed,10);var o=Hl[n.color.index];81==n.color.index&&(o=Hl[1]),o||(o=Hl[1]),n.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else a.theme&&(n.color.theme=parseInt(a.theme,10),a.tint&&(n.color.tint=parseFloat(a.tint)),a.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=Km(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+a[0]+" in fonts")}})}(l,c,a,o),(l=i.match(t))&&function(e,r,t,s){r.Fills=[];var n={},i=!1;(e[0].match(Li)||[]).forEach(function(e){var t=Bi(e);switch(Wi(t[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":t.patternType&&(n.patternType=t.patternType);break;case"<bgColor":n.bgColor||(n.bgColor={}),t.indexed&&(n.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(n.bgColor.theme=parseInt(t.theme,10)),t.tint&&(n.bgColor.tint=parseFloat(t.tint)),t.rgb&&(n.bgColor.rgb=t.rgb.slice(-6));break;case"<fgColor":n.fgColor||(n.fgColor={}),t.theme&&(n.fgColor.theme=parseInt(t.theme,10)),t.tint&&(n.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(n.fgColor.rgb=t.rgb.slice(-6));break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+t[0]+" in fills")}})}(l,c,0,o),(l=i.match(n))&&function(e,r,t,s){r.Borders=[];var n={},i=!1;(e[0].match(Li)||[]).forEach(function(e){var t=Bi(e);switch(Wi(t[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":n={},t.diagonalUp&&(n.diagonalUp=ea(t.diagonalUp)),t.diagonalDown&&(n.diagonalDown=ea(t.diagonalDown)),r.Borders.push(n);break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+t[0]+" in borders")}})}(l,c,0,o),(l=i.match(r))&&function(e,r,t){var s;r.CellXf=[];var n=!1;(e[0].match(Li)||[]).forEach(function(e){var i=Bi(e),a=0;switch(Wi(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(s=i)[0],a=0;a<lu.length;++a)s[lu[a]]&&(s[lu[a]]=parseInt(s[lu[a]],10));for(a=0;a<cu.length;++a)s[cu[a]]&&(s[cu[a]]=ea(s[cu[a]]));if(r.NumberFmt&&s.numFmtId>392)for(a=392;a>60;--a)if(r.NumberFmt[s.numFmtId]==r.NumberFmt[a]){s.numFmtId=a;break}r.CellXf.push(s);break;case"<alignment":case"<alignment/>":var o={};i.vertical&&(o.vertical=i.vertical),i.horizontal&&(o.horizontal=i.horizontal),null!=i.textRotation&&(o.textRotation=i.textRotation),i.indent&&(o.indent=i.indent),i.wrapText&&(o.wrapText=ea(i.wrapText)),s.alignment=o;break;case"<AlternateContent":case"<ext":n=!0;break;case"</AlternateContent>":case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}(l,c,o),c):c}}();function uu(e,r){var t,s=[Ii,ga("styleSheet",null,{xmlns:Ra[0],"xmlns:vt":ka})];return e.SSF&&null!=(t=function(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var s=t[0];s<=t[1];++s)null!=e[s]&&(r[r.length]=ga("numFmt",null,{numFmtId:s,formatCode:Yi(e[s])}))}),1===r.length?"":(r[r.length]="</numFmts>",r[0]=ga("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(e.SSF))&&(s[s.length]=t),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(t=function(e){var r=[];return r[r.length]=ga("cellXfs",null),e.forEach(function(e){r[r.length]=ga("xf",null,e)}),r[r.length]="</cellXfs>",2===r.length?"":(r[0]=ga("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(r.cellXfs))&&(s[s.length]=t),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',s.length>2&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}function du(e,r,t){t||(t=Do(6+4*r.length)),t.write_shift(2,e),Xo(r,t);var s=t.length>t.l?t.slice(0,t.l):t;return null==t.l&&(t.l=t.length),s}function fu(e,r){r||(r=Do(153)),r.write_shift(2,20*e.sz),function(e,r){r||(r=Do(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);r.write_shift(1,t),r.write_shift(1,0)}(e,r),r.write_shift(2,e.bold?700:400);var t=0;"superscript"==e.vertAlign?t=1:"subscript"==e.vertAlign&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),bl(e.color,r);return r.write_shift(1,2),Xo(e.name,r),r.length>r.l?r.slice(0,r.l):r}var hu,pu=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],gu=wo;function bu(e,r){r||(r=Do(84)),hu||(hu=ii(pu));var t=hu[e.patternType];null==t&&(t=40),r.write_shift(4,t);var s=0;if(40!=t)for(bl({auto:1},r),bl({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function vu(e,r,t){t||(t=Do(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Nu(e,r){return r||(r=Do(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var xu=wo;function yu(e){var r;To(e,613,Go(1)),To(e,46,(r||(r=Do(51)),r.write_shift(1,0),Nu(0,r),Nu(0,r),Nu(0,r),Nu(0,r),Nu(0,r),r.length>r.l?r.slice(0,r.l):r)),To(e,614)}function Eu(e){var r,t;To(e,619,Go(1)),To(e,48,(r={xfId:0,name:"Normal"},t||(t=Do(52)),t.write_shift(4,r.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),al(r.name||"",t),t.length>t.l?t.slice(0,t.l):t)),To(e,620)}function wu(e){To(e,508,function(e,r,t){var s=Do(2052);return s.write_shift(4,e),al(r,s),al(t,s),s.length>s.l?s.slice(0,s.l):s}(0,"TableStyleMedium9","PivotStyleMedium4")),To(e,509)}function Du(e,r){var t=Ho();return To(t,278),function(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var s=e[0];s<=e[1];++s)null!=r[s]&&++t}),0!=t&&(To(e,615,Go(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var s=t[0];s<=t[1];++s)null!=r[s]&&To(e,44,du(s,r[s]))}),To(e,616))}}(t,e.SSF),function(e){To(e,611,Go(1)),To(e,43,fu({sz:12,color:{theme:1},name:"Calibri",family:2})),To(e,612)}(t),function(e){To(e,603,Go(2)),To(e,45,bu({patternType:"none"})),To(e,45,bu({patternType:"gray125"})),To(e,604)}(t),yu(t),function(e){To(e,626,Go(1)),To(e,47,vu({numFmtId:0},65535)),To(e,627)}(t),function(e,r){To(e,617,Go(r.length)),r.forEach(function(r){To(e,47,vu(r,0))}),To(e,618)}(t,r.cellXfs),Eu(t),function(e){To(e,505,Go(0)),To(e,506)}(t),wu(t),To(t,279),t.end()}var _u=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Hu(e,r,t){r.themeElements.clrScheme=[];var s={};(e[0].match(Li)||[]).forEach(function(e){var n=Bi(e);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=n.val;break;case"<a:sysClr":s.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===n[0].charAt(1)?(r.themeElements.clrScheme[_u.indexOf(n[0])]=s,s={}):s.name=n[0].slice(3,n[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function Tu(){}function Su(){}var ju=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ku=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Vu=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Cu=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Ru(e,r){var t;e&&0!==e.length||(e=Au());var s={};if(!(t=e.match(Cu)))throw new Error("themeElements not found in theme");return function(e,r,t){var s;r.themeElements={},[["clrScheme",ju,Hu],["fontScheme",ku,Tu],["fmtScheme",Vu,Su]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,r,t)})}(t[0],s,r),s.raw=e,s}function Au(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var t=[Ii];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Mu(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:case 4:e.l+=4;break;case 1:r.xclrValue=function(e,r){return wo(e,r)}(e,4);break;case 2:r.xclrValue=Ac(e);break;case 3:r.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,r}function Iu(e){var r=e.read_shift(2),t=e.read_shift(2)-4,s=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=Mu(e);break;case 6:s[1]=function(e,r){return wo(e,r)}(e,t);break;case 14:case 15:s[1]=e.read_shift(1===t?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return s}function Ou(e,r){r.forEach(function(e){e[0]})}function Pu(){var e,r,t=Ho();return To(t,332),To(t,334,Go(1)),To(t,335,((r=Do(12+2*(e={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,e.flags),r.write_shift(4,e.version),Xo(e.name,r),r.slice(0,r.l))),To(t,336),To(t,339,function(e,r){var t=Do(8+2*r.length);return t.write_shift(4,e),Xo(r,t),t.slice(0,t.l)}(1,"XLDAPR")),To(t,52),To(t,35,Go(514)),To(t,4096,Go(0)),To(t,4097,xc(1)),To(t,36),To(t,53),To(t,340),To(t,337,function(e){var r=Do(8);return r.write_shift(4,e),r.write_shift(4,1),r}(1)),To(t,51,function(e){var r=Do(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}([[1,0]])),To(t,338),To(t,333),t.end()}function Lu(){var e=[Ii];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Fu=1024;function Uu(e,r){for(var t=[21600,21600],s=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),n=[ga("xml",null,{"xmlns:v":La,"xmlns:o":Aa,"xmlns:x":Ma,"xmlns:mv":Pa}).replace(/\/>/,">"),ga("o:shapelayout",ga("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ga("v:shapetype",[ga("v:stroke",null,{joinstyle:"miter"}),ga("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:s})];Fu<1e3*e;)Fu+=1e3;return r.forEach(function(e){var r=Io(e[0]),t={color2:"#BEFF82",type:"gradient"};"gradient"==t.type&&(t.angle="-180");var s="gradient"==t.type?ga("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,i=ga("v:fill",s,t);++Fu,n=n.concat(["<v:shape"+pa({id:"_x0000_s"+Fu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",i,ga("v:shadow",null,{on:"t",obscured:"t"}),ga("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ha("x:Anchor",[r.c+1,0,r.r+1,0,r.c+3,20,r.r+5,20].join(",")),ha("x:AutoFill","False"),ha("x:Row",String(r.r)),ha("x:Column",String(r.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Bu(e,r,t,s){var n,i=Array.isArray(e);r.forEach(function(r){var a=Io(r.ref);if(i?(e[a.r]||(e[a.r]=[]),n=e[a.r][a.c]):n=e[r.ref],!n){n={t:"z"},i?e[a.r][a.c]=n:e[r.ref]=n;var o=Fo(e["!ref"]||"BDWGO1000001:A1");o.s.r>a.r&&(o.s.r=a.r),o.e.r<a.r&&(o.e.r=a.r),o.s.c>a.c&&(o.s.c=a.c),o.e.c<a.c&&(o.e.c=a.c);var l=Lo(o);l!==e["!ref"]&&(e["!ref"]=l)}n.c||(n.c=[]);var c={a:r.author,t:r.t,r:r.r,T:t};r.h&&(c.h=r.h);for(var m=n.c.length-1;m>=0;--m){if(!t&&n.c[m].T)return;t&&!n.c[m].T&&n.c.splice(m,1)}if(t&&s)for(m=0;m<s.length;++m)if(c.a==s[m].id){c.a=s[m].name||c.a;break}n.c.push(c)})}function Wu(e){var r=[Ii,ga("comments",null,{xmlns:Ra[0]})],t=[];return r.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var s=Yi(e.a);-1==t.indexOf(s)&&(t.push(s),r.push("<author>"+s+"</author>")),e.T&&e.ID&&-1==t.indexOf("tc="+e.ID)&&(t.push("tc="+e.ID),r.push("<author>tc="+e.ID+"</author>"))})}),0==t.length&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(e){var s=0,n=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?s=t.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(s=t.indexOf(Yi(e.a))),n.push(e.t||"")}),r.push('<comment ref="'+e[0]+'" authorId="'+s+'"><text>'),n.length<=1)r.push(ha("t",Yi(n[0]||"")));else{for(var i="Comment:\n    "+n[0]+"\n",a=1;a<n.length;++a)i+="Reply:\n    "+n[a]+"\n";r.push(ha("t",Yi(i)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function zu(e,r,t){var s=[Ii,ga("ThreadedComments",null,{xmlns:_a}).replace(/[\/]>/,">")];return e.forEach(function(e){var n="";(e[1]||[]).forEach(function(i,a){if(i.T){i.a&&-1==r.indexOf(i.a)&&r.push(i.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};0==a?n=o.id:o.parentId=n,i.ID=o.id,i.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(i.a)).slice(-12)+"}"),s.push(ga("threadedComment",ha("text",i.t||""),o))}else delete i.ID})}),s.push("</ThreadedComments>"),s.join("")}var $u=qo;function Gu(e){var r=Ho(),t=[];return To(r,628),To(r,630),e.forEach(function(e){e[1].forEach(function(e){t.indexOf(e.a)>-1||(t.push(e.a.slice(0,54)),To(r,632,function(e){return Xo(e.slice(0,54))}(e.a)))})}),To(r,631),To(r,633),e.forEach(function(e){e[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var n={s:Io(e[0]),e:Io(e[0])};To(r,635,function(e,r){return null==r&&(r=Do(36)),r.write_shift(4,e[1].iauthor),hl(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}([n,s])),s.t&&s.t.length>0&&To(r,637,Qo(s)),To(r,636),delete s.iauthor})}),To(r,634),To(r,629),r.end()}var qu=["xlsb","xlsm","xlam","biff8","xla"];var Xu=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(e,t,s,n){var i=!1,a=!1;0==s.length?a=!0:"["==s.charAt(0)&&(a=!0,s=s.slice(1,-1)),0==n.length?i=!0:"["==n.charAt(0)&&(i=!0,n=n.slice(1,-1));var o=s.length>0?0|parseInt(s,10):0,l=n.length>0?0|parseInt(n,10):0;return i?l+=r.c:--l,a?o+=r.r:--o,t+(i?"":"$")+Mo(l)+(a?"":"$")+Ro(o)}return function(s,n){return r=n,s.replace(e,t)}}(),Yu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ku=function(){return function(e,r){return e.replace(Yu,function(e,t,s,n,i,a){var o=Ao(n)-(s?0:r.c),l=Co(a)-(i?0:r.r);return t+"R"+(0==l?"":i?l+1:"["+l+"]")+"C"+(0==o?"":s?o+1:"["+o+"]")})}}();function Ju(e,r){return e.replace(Yu,function(e,t,s,n,i,a){return t+("$"==s?s+n:Mo(Ao(n)+r.c))+("$"==i?i+a:Ro(Co(a)+r.r))})}function Qu(e,r,t){var s=Po(r).s,n=Io(t);return Ju(e,{r:n.r-s.r,c:n.c-s.c})}function Zu(e){return e.replace(/_xlfn\./g,"")}function ed(e){e.l+=1}function rd(e,r){var t=e.read_shift(2);return[16383&t,t>>14&1,t>>15&1]}function td(e,r,t){var s=2;if(t){if(t.biff>=2&&t.biff<=5)return sd(e);12==t.biff&&(s=4)}var n=e.read_shift(s),i=e.read_shift(s),a=rd(e),o=rd(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function sd(e){var r=rd(e),t=rd(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function nd(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return function(e){var r=rd(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}(e);var s=e.read_shift(t&&12==t.biff?4:2),n=rd(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function id(e){var r=e.read_shift(2),t=e.read_shift(2);return{r:r,c:255&t,fQuoted:!!(16384&t),cRel:t>>15,rRel:t>>15}}function ad(e){var r=1&e[e.l+1];return e.l+=4,[r,1]}function od(e){return[e.read_shift(1),e.read_shift(1)]}function ld(e,r){var t=[e.read_shift(1)];if(12==r)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2}switch(t[0]){case 4:t[1]=bc(e,1)?"TRUE":"FALSE",12!=r&&(e.l+=7);break;case 37:case 16:t[1]=Tl[e[e.l]],e.l+=12==r?4:8;break;case 0:e.l+=8;break;case 1:t[1]=pl(e);break;case 2:t[1]=Sc(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function cd(e,r,t){for(var s=e.read_shift(12==t.biff?4:2),n=[],i=0;i!=s;++i)n.push((12==t.biff?fl:Fc)(e));return n}function md(e,r,t){var s=0,n=0;12==t.biff?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--s,0==--n&&(n=256));for(var i=0,a=[];i!=s&&(a[i]=[]);++i)for(var o=0;o!=n;++o)a[i][o]=ld(e,t.biff);return a}function ud(e,r,t){return e.l+=2,[id(e)]}function dd(e){return e.l+=6,[]}function fd(e){return e.l+=2,[Nc(e),1&e.read_shift(2)]}var hd=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var pd={1:{n:"PtgExp",f:function(e,r,t){return e.l++,t&&12==t.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(t&&2==t.biff?1:2)]}},2:{n:"PtgTbl",f:wo},3:{n:"PtgAdd",f:ed},4:{n:"PtgSub",f:ed},5:{n:"PtgMul",f:ed},6:{n:"PtgDiv",f:ed},7:{n:"PtgPower",f:ed},8:{n:"PtgConcat",f:ed},9:{n:"PtgLt",f:ed},10:{n:"PtgLe",f:ed},11:{n:"PtgEq",f:ed},12:{n:"PtgGe",f:ed},13:{n:"PtgGt",f:ed},14:{n:"PtgNe",f:ed},15:{n:"PtgIsect",f:ed},16:{n:"PtgUnion",f:ed},17:{n:"PtgRange",f:ed},18:{n:"PtgUplus",f:ed},19:{n:"PtgUminus",f:ed},20:{n:"PtgPercent",f:ed},21:{n:"PtgParen",f:ed},22:{n:"PtgMissArg",f:ed},23:{n:"PtgStr",f:function(e,r,t){return e.l++,wc(e,0,t)}},26:{n:"PtgSheet",f:function(e,r,t){return e.l+=5,e.l+=2,e.l+=2==t.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,r,t){return e.l+=2==t.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Tl[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,pl(e)}},32:{n:"PtgArray",f:function(e,r,t){var s=(96&e[e.l++])>>5;return e.l+=2==t.biff?6:12==t.biff?14:7,[s]}},33:{n:"PtgFunc",f:function(e,r,t){var s=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(t&&t.biff<=3?1:2);return[Od[n],Id[n],s]}},34:{n:"PtgFuncVar",f:function(e,r,t){var s=e[e.l++],n=e.read_shift(1),i=t&&t.biff<=3?[88==s?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[n,(0===i[0]?Id:Md)[i[1]]]}},35:{n:"PtgName",f:function(e,r,t){var s=e.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,i=e.read_shift(n);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[s,0,i]}},36:{n:"PtgRef",f:function(e,r,t){var s=(96&e[e.l])>>5;return e.l+=1,[s,nd(e,0,t)]}},37:{n:"PtgArea",f:function(e,r,t){return[(96&e[e.l++])>>5,td(e,t.biff>=2&&t.biff,t)]}},38:{n:"PtgMemArea",f:function(e,r,t){var s=e.read_shift(1)>>>5&3;return e.l+=t&&2==t.biff?3:4,[s,e.read_shift(t&&2==t.biff?1:2)]}},39:{n:"PtgMemErr",f:wo},40:{n:"PtgMemNoMem",f:wo},41:{n:"PtgMemFunc",f:function(e,r,t){return[e.read_shift(1)>>>5&3,e.read_shift(t&&2==t.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,r,t){var s=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,12==t.biff&&(e.l+=2),[s]}},43:{n:"PtgAreaErr",f:function(e,r,t){var s=(96&e[e.l++])>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[s]}},44:{n:"PtgRefN",f:function(e,r,t){var s=(96&e[e.l])>>5;e.l+=1;var n=function(e,r,t){var s=t&&t.biff?t.biff:8;if(s>=2&&s<=5)return function(e){var r=e.read_shift(2),t=e.read_shift(1),s=(32768&r)>>15,n=(16384&r)>>14;return r&=16383,1==s&&r>=8192&&(r-=16384),1==n&&t>=128&&(t-=256),{r:r,c:t,cRel:n,rRel:s}}(e);var n=e.read_shift(s>=12?4:2),i=e.read_shift(2),a=(16384&i)>>14,o=(32768&i)>>15;if(i&=16383,1==o)for(;n>524287;)n-=1048576;if(1==a)for(;i>8191;)i-=16384;return{r:n,c:i,cRel:a,rRel:o}}(e,0,t);return[s,n]}},45:{n:"PtgAreaN",f:function(e,r,t){var s=(96&e[e.l++])>>5,n=function(e,r,t){if(t.biff<8)return sd(e);var s=e.read_shift(12==t.biff?4:2),n=e.read_shift(12==t.biff?4:2),i=rd(e),a=rd(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}(e,0,t);return[s,n]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,r,t){return 5==t.biff?function(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[r,t,s]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,r,t){var s=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(2);return t&&5==t.biff&&(e.l+=12),[s,n,nd(e,0,t)]}},59:{n:"PtgArea3d",f:function(e,r,t){var s=(96&e[e.l++])>>5,n=e.read_shift(2,"i");if(t)switch(t.biff){case 5:e.l+=12;break;case 12:0}return[s,n,td(e,0,t)]}},60:{n:"PtgRefErr3d",f:function(e,r,t){var s=(96&e[e.l++])>>5,n=e.read_shift(2),i=4;if(t)switch(t.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[s,n]}},61:{n:"PtgAreaErr3d",f:function(e,r,t){var s=(96&e[e.l++])>>5,n=e.read_shift(2),i=8;if(t)switch(t.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[s,n]}},255:{}},gd={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},bd={1:{n:"PtgElfLel",f:fd},2:{n:"PtgElfRw",f:ud},3:{n:"PtgElfCol",f:ud},6:{n:"PtgElfRwV",f:ud},7:{n:"PtgElfColV",f:ud},10:{n:"PtgElfRadical",f:ud},11:{n:"PtgElfRadicalS",f:dd},13:{n:"PtgElfColS",f:dd},15:{n:"PtgElfColSV",f:dd},16:{n:"PtgElfRadicalLel",f:fd},25:{n:"PtgList",f:function(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2);return{ixti:r,coltype:3&t,rt:hd[t>>2&31],idx:s,c:n,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},vd={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,r,t){var s=255&e[e.l+1]?1:0;return e.l+=t&&2==t.biff?3:4,[s]}},2:{n:"PtgAttrIf",f:function(e,r,t){var s=255&e[e.l+1]?1:0;return e.l+=2,[s,e.read_shift(t&&2==t.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,r,t){e.l+=2;for(var s=e.read_shift(t&&2==t.biff?1:2),n=[],i=0;i<=s;++i)n.push(e.read_shift(t&&2==t.biff?1:2));return n}},8:{n:"PtgAttrGoto",f:function(e,r,t){var s=255&e[e.l+1]?1:0;return e.l+=2,[s,e.read_shift(t&&2==t.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,r,t){e.l+=t&&2==t.biff?3:4}},32:{n:"PtgAttrBaxcel",f:ad},33:{n:"PtgAttrBaxcel",f:ad},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),od(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),od(e)}},128:{n:"PtgAttrIfError",f:function(e){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(2)]}},255:{}};function Nd(e,r,t,s){if(s.biff<8)return wo(e,r);for(var n=e.l+r,i=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=md(e,0,s),i.push(t[a][1]);break;case"PtgMemArea":t[a][2]=cd(e,t[a][1],s),i.push(t[a][2]);break;case"PtgExp":s&&12==s.biff&&(t[a][1][1]=e.read_shift(4),i.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return 0!==(r=n-e.l)&&i.push(wo(e,r)),i}function xd(e,r,t){for(var s,n,i=e.l+r,a=[];i!=e.l;)r=i-e.l,n=e[e.l],s=pd[n]||pd[gd[n]],24!==n&&25!==n||(s=(24===n?bd:vd)[e[e.l+1]]),s&&s.f?a.push([s.n,s.f(e,r,t)]):wo(e,r);return a}function yd(e){for(var r=[],t=0;t<e.length;++t){for(var s=e[t],n=[],i=0;i<s.length;++i){var a=s[i];if(a)if(2===a[0])n.push('"'+a[1].replace(/"/g,'""')+'"');else n.push(a[1]);else n.push("")}r.push(n.join(","))}return r.join(";")}var Ed={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function wd(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),0==r?"":e.XTI[r-1];if(!s)return"SH33TJSERR1";var n="";if(t.biff>8)switch(e[s[0]][0]){case 357:return n=-1==s[1]?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return null!=t.SID?e.SheetNames[t.SID]:"SH33TJSSAME"+e[s[0]][0];default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=-1==s[1]?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[s[0]][0][3]?(n=-1==s[1]?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Dd(e,r,t){var s=wd(e,r,t);return"#REF"==s?s:function(e,r){if(!(e||r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(s,t)}function _d(e,r,t,s,n){var i,a,o,l,c=n&&n.biff||8,m={s:{c:0,r:0}},u=[],d=0,f=0,h="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",b=0,v=e[0].length;b<v;++b){var N=e[0][b];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=u.pop(),a=u.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=xi(" ",e[0][p][1][1]);break;case 1:g=xi("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}a+=g,p=-1}u.push(a+Ed[N[0]]+i);break;case"PtgIsect":i=u.pop(),a=u.pop(),u.push(a+" "+i);break;case"PtgUnion":i=u.pop(),a=u.pop(),u.push(a+","+i);break;case"PtgRange":i=u.pop(),a=u.pop(),u.push(a+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=So(N[1][1],m,n),u.push(ko(o,c));break;case"PtgRefN":o=t?So(N[1][1],t,n):N[1][1],u.push(ko(o,c));break;case"PtgRef3d":d=N[1][1],o=So(N[1][2],m,n),h=Dd(s,d,n),u.push(h+"!"+ko(o,c));break;case"PtgFunc":case"PtgFuncVar":var x=N[1][0],y=N[1][1];x||(x=0);var E=0==(x&=127)?[]:u.slice(-x);u.length-=x,"User"===y&&(y=E.shift()),u.push(y+"("+E.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=jo(N[1][1],t?{s:t}:m,n),u.push(Vo(l,n));break;case"PtgArea":l=jo(N[1][1],m,n),u.push(Vo(l,n));break;case"PtgArea3d":d=N[1][1],l=N[1][2],h=Dd(s,d,n),u.push(h+"!"+Vo(l,n));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":f=N[1][2];var w=(s.names||[])[f-1]||(s[0]||[])[f],D=w?w.Name:"SH33TJSNAME"+String(f);D&&"_xlfn."==D.slice(0,6)&&!n.xlfn&&(D=D.slice(6)),u.push(D);break;case"PtgNameX":var _,H=N[1][1];if(f=N[1][2],!(n.biff<=5)){var T="";if(14849==((s[H]||[])[0]||[])[0]||(1025==((s[H]||[])[0]||[])[0]?s[H][f]&&s[H][f].itab>0&&(T=s.SheetNames[s[H][f].itab-1]+"!"):T=s.SheetNames[f-1]+"!"),s[H]&&s[H][f])T+=s[H][f].Name;else if(s[0]&&s[0][f])T+=s[0][f].Name;else{var S=(wd(s,H,n)||"").split(";;");S[f-1]?T=S[f-1]:T+="SH33TJSERRX"}u.push(T);break}H<0&&(H=-H),s[H]&&(_=s[H][f]),_||(_={Name:"SH33TJSERRY"}),u.push(_.Name);break;case"PtgParen":var j="(",k=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:j=xi(" ",e[0][p][1][1])+j;break;case 3:j=xi("\r",e[0][p][1][1])+j;break;case 4:k=xi(" ",e[0][p][1][1])+k;break;case 5:k=xi("\r",e[0][p][1][1])+k;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}u.push(j+u.pop()+k);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":o={c:N[1][1],r:N[1][0]};var V={c:t.c,r:t.r};if(s.sharedf[Oo(o)]){var C=s.sharedf[Oo(o)];u.push(_d(C,m,V,s,n))}else{var R=!1;for(i=0;i!=s.arrayf.length;++i)if(a=s.arrayf[i],!(o.c<a[0].s.c||o.c>a[0].e.c||o.r<a[0].s.r||o.r>a[0].e.r)){u.push(_d(a[1],m,V,s,n)),R=!0;break}R||u.push(N[1])}break;case"PtgArray":u.push("{"+yd(N[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=b;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(N))}if(3!=n.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][b][0])){var A=!0;switch((N=e[0][p])[1][0]){case 4:A=!1;case 0:g=xi(" ",N[1][1]);break;case 5:A=!1;case 1:g=xi("\r",N[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((A?g:"")+u.pop()+(A?"":g)),p=-1}}if(u.length>1&&n.WTF)throw new Error("bad formula stack");return u[0]}function Hd(e,r,t){var s,n=e.l+r,i=2==t.biff?1:2,a=e.read_shift(i);if(65535==a)return[[],wo(e,r-2)];var o=xd(e,a,t);return r!==a+i&&(s=Nd(e,r-a-i,o,t)),e.l=n,[o,s]}function Td(e,r,t){var s,n=e.l+r,i=e.read_shift(2),a=xd(e,i,t);return 65535==i?[[],wo(e,r-2)]:(r!==i+2&&(s=Nd(e,n-i-2,a,t)),[a,s])}function Sd(e,r,t){var s=e.l+r,n=Ic(e);2==t.biff&&++e.l;var i=function(e){var r;if(65535!==mo(e,e.l+6))return[pl(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=1===e[e.l+2],e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),a=e.read_shift(1);2!=t.biff&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=function(e,r,t){var s,n=e.l+r,i=2==t.biff?1:2,a=e.read_shift(i);if(65535==a)return[[],wo(e,r-2)];var o=xd(e,a,t);return r!==a+i&&(s=Nd(e,r-a-i,o,t)),e.l=n,[o,s]}(e,s-e.l,t);return{cell:n,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function jd(e,r,t,s,n){var i=Oc(r,t,n),a=function(e){if(null==e){var r=Do(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}return gl("number"==typeof e?e:0)}(e.v),o=Do(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=Do(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return en([i,a,o,l])}function kd(e,r,t){var s=e.read_shift(4),n=xd(e,s,t),i=e.read_shift(4);return[n,i>0?Nd(e,i,n,t):null]}var Vd=kd,Cd=kd,Rd=kd,Ad=kd,Md={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Id={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Od={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Pd(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Ld(e){return("of:="+e.replace(Yu,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function Fd(e){var r=e.split(":");return[r[0].split(".")[0],r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function Ud(e){return e.replace(/\./,"!")}var Bd={},Wd={},zd="undefined"!=typeof Map;function $d(e,r,t){var s=0,n=e.length;if(t){if(zd?t.has(r):Object.prototype.hasOwnProperty.call(t,r))for(var i=zd?t.get(r):t[r];s<i.length;++s)if(e[i[s]].t===r)return e.Count++,i[s]}else for(;s<n;++s)if(e[s].t===r)return e.Count++,s;return e[n]={t:r},e.Count++,e.Unique++,t&&(zd?(t.has(r)||t.set(r,[]),t.get(r).push(n)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(n))),n}function Gd(e,r){var t={min:e+1,max:e+1},s=-1;return r.MDW&&(Jm=r.MDW),null!=r.width?t.customWidth=1:null!=r.wpx?s=Zm(r.wpx):null!=r.wch&&(s=r.wch),s>-1?(t.width=eu(s),t.customWidth=1):null!=r.width&&(t.width=r.width),r.hidden&&(t.hidden=!0),null!=r.level&&(t.outlineLevel=t.level=r.level),t}function qd(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];"xlml"==r&&(t=[1,1,1,1,.5,.5]),null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer&&(e.footer=t[5])}}function Xd(e,r,t){var s=t.revssf[null!=r.z?r.z:"General"],n=60,i=e.length;if(null==s&&t.ssf)for(;n<392;++n)if(null==t.ssf[n]){Gn(r.z,n),t.ssf[n]=r.z,t.revssf[r.z]=s=n;break}for(n=0;n!=i;++n)if(e[n].numFmtId===s)return n;return e[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Yd(e,r,t,s,n,i){try{s.cellNF&&(e.z=fn[r])}catch(o){if(s.WTF)throw o}if("z"!==e.t||s.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=bi(e.v)),(!s||!1!==s.cellText)&&"z"!==e.t)try{if(null==fn[r]&&Gn(Kn[r]||"General",r),"e"===e.t)e.w=e.w||Tl[e.v];else if(0===r)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=wn(e.v);else if("d"===e.t){var a=li(e.v);e.w=(0|a)===a?a.toString(10):wn(a)}else{if(void 0===e.v)return"";e.w=Dn(e.v,Wd)}else"d"===e.t?e.w=$n(r,li(e.v),Wd):e.w=$n(r,e.v,Wd)}catch(o){if(s.WTF)throw o}if(s.cellStyles&&null!=t)try{e.s=i.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Km(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Km(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(s.WTF&&i.Fills)throw o}}}function Kd(e,r,t){if(e&&e["!ref"]){var s=Fo(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}var Jd=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Qd=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Zd=/<(?:\w:)?hyperlink [^>]*>/gm,ef=/"(\w*:\w*)"/,rf=/<(?:\w:)?col\b[^>]*[\/]?>/g,tf=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,sf=/<(?:\w:)?pageMargins[^>]*\/>/g,nf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,af=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,of=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function lf(e,r,t,s,n,i,a){if(!e)return e;s||(s={"!id":{}});var o=r.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",m="",u=e.match(Qd);u?(c=e.slice(0,u.index),m=e.slice(u.index+u[0].length)):c=m=e;var d=c.match(nf);d?cf(d[0],o,n,t):(d=c.match(af))&&function(e,r,t,s,n){cf(e.slice(0,e.indexOf(">")),t,s,n)}(d[0],d[1],o,n,t);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var h=c.slice(f,f+50).match(ef);h&&function(e,r){var t=Fo(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Lo(t))}(o,h[1])}var p=c.match(of);p&&p[1]&&function(e,r){r.Views||(r.Views=[{}]);(e.match(df)||[]).forEach(function(e,t){var s=Bi(e);r.Views[t]||(r.Views[t]={}),+s.zoomScale&&(r.Views[t].zoom=+s.zoomScale),ea(s.rightToLeft)&&(r.Views[t].RTL=!0)})}(p[1],n);var g=[];if(r.cellStyles){var b=c.match(rf);b&&function(e,r){for(var t=!1,s=0;s!=r.length;++s){var n=Bi(r[s],!0);n.hidden&&(n.hidden=ea(n.hidden));var i=parseInt(n.min,10)-1,a=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,tu(n.width)),su(n);i<=a;)e[i++]=Ni(n)}}(g,b)}u&&hf(u[1],o,r,l,i,a);var v=m.match(tf);v&&(o["!autofilter"]=function(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}(v[0]));var N=[],x=m.match(Jd);if(x)for(f=0;f!=x.length;++f)N[f]=Fo(x[f].slice(x[f].indexOf('"')+1));var y=m.match(Zd);y&&function(e,r,t){for(var s=Array.isArray(e),n=0;n!=r.length;++n){var i=Bi(ia(r[n]),!0);if(!i.ref)return;var a=((t||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+Gi(i.location))):(i.Target="#"+Gi(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Fo(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var m=Oo({c:c,r:l});s?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=i)}}}(o,y,s);var E,w,D=m.match(sf);if(D&&(o["!margins"]=(E=Bi(D[0]),w={},["left","right","top","bottom","header","footer"].forEach(function(e){E[e]&&(w[e]=parseFloat(E[e]))}),w)),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Lo(l)),r.sheetRows>0&&o["!ref"]){var _=Fo(o["!ref"]);r.sheetRows<=+_.e.r&&(_.e.r=r.sheetRows-1,_.e.r>l.e.r&&(_.e.r=l.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>l.e.c&&(_.e.c=l.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Lo(_))}return g.length>0&&(o["!cols"]=g),N.length>0&&(o["!merges"]=N),o}function cf(e,r,t,s){var n=Bi(e);t.Sheets[s]||(t.Sheets[s]={}),n.codeName&&(t.Sheets[s].CodeName=Gi(ia(n.codeName)))}var mf=["objects","scenarios","selectLockedCells","selectUnlockedCells"],uf=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var df=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ff(e,r,t,s){if(e.c&&t["!comments"].push([r,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var n="",i=e.t,a=e.v;if("z"!==e.t)switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Tl[e.v];break;case"d":s&&s.cellDates?n=bi(e.v,-1).toISOString():((e=Ni(e)).t="n",n=""+(e.v=li(bi(e.v)))),void 0===e.z&&(e.z=fn[14]);break;default:n=e.v}var o=ha("v",Yi(n)),l={r:r},c=Xd(s.cellXfs,e,s);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){o=ha("v",""+$d(s.Strings,e.v,s.revStrings)),l.t="s";break}l.t="str"}if(e.t!=i&&(e.t=i,e.v=a),"string"==typeof e.f&&e.f){var m=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;o=ga("f",Yi(e.f),m)+(null!=e.v?o:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(l.cm=1),ga("c",o,l)}var hf=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=oa("v"),a=oa("f");return function(o,l,c,m,u,d){for(var f,h,p,g,b,v=0,N="",x=[],y=[],E=0,w=0,D=0,_="",H=0,T=0,S=0,j=0,k=Array.isArray(d.CellXf),V=[],C=[],R=Array.isArray(l),A=[],M={},I=!1,O=!!c.sheetStubs,P=o.split(r),L=0,F=P.length;L!=F;++L){var U=(N=P[L].trim()).length;if(0!==U){var B=0;e:for(v=0;v<U;++v)switch(N[v]){case">":if("/"!=N[v-1]){++v;break e}if(c&&c.cellStyles){if(H=null!=(h=Bi(N.slice(B,v),!0)).r?parseInt(h.r,10):H+1,T=-1,c.sheetRows&&c.sheetRows<H)continue;M={},I=!1,h.ht&&(I=!0,M.hpt=parseFloat(h.ht),M.hpx=au(M.hpt)),"1"==h.hidden&&(I=!0,M.hidden=!0),null!=h.outlineLevel&&(I=!0,M.level=+h.outlineLevel),I&&(A[H-1]=M)}break;case"<":B=v}if(B>=v)break;if(H=null!=(h=Bi(N.slice(B,v),!0)).r?parseInt(h.r,10):H+1,T=-1,!(c.sheetRows&&c.sheetRows<H)){m.s.r>H-1&&(m.s.r=H-1),m.e.r<H-1&&(m.e.r=H-1),c&&c.cellStyles&&(M={},I=!1,h.ht&&(I=!0,M.hpt=parseFloat(h.ht),M.hpx=au(M.hpt)),"1"==h.hidden&&(I=!0,M.hidden=!0),null!=h.outlineLevel&&(I=!0,M.level=+h.outlineLevel),I&&(A[H-1]=M)),x=N.slice(v).split(e);for(var W=0;W!=x.length&&"<"==x[W].trim().charAt(0);++W);for(x=x.slice(W),v=0;v!=x.length;++v)if(0!==(N=x[v].trim()).length){if(y=N.match(t),E=v,w=0,D=0,N="<c "+("<"==N.slice(0,1)?">":"")+N,null!=y&&2===y.length){for(E=0,_=y[1],w=0;w!=_.length&&!((D=_.charCodeAt(w)-64)<1||D>26);++w)E=26*E+D;T=--E}else++T;for(w=0;w!=N.length&&62!==N.charCodeAt(w);++w);if(++w,(h=Bi(N.slice(0,w),!0)).r||(h.r=Oo({r:H-1,c:T})),f={t:""},null!=(y=(_=N.slice(w)).match(i))&&""!==y[1]&&(f.v=Gi(y[1])),c.cellFormula){if(null!=(y=_.match(a))&&""!==y[1]){if(f.f=Gi(ia(y[1])).replace(/\r\n/g,"\n"),c.xlfn||(f.f=Zu(f.f)),y[0].indexOf('t="array"')>-1)f.F=(_.match(n)||[])[1],f.F.indexOf(":")>-1&&V.push([Fo(f.F),f.F]);else if(y[0].indexOf('t="shared"')>-1){g=Bi(y[0]);var z=Gi(ia(y[1]));c.xlfn||(z=Zu(z)),C[parseInt(g.si,10)]=[g,z,h.r]}}else(y=_.match(/<f[^>]*\/>/))&&C[(g=Bi(y[0])).si]&&(f.f=Qu(C[g.si][1],C[g.si][2],h.r));var $=Io(h.r);for(w=0;w<V.length;++w)$.r>=V[w][0].s.r&&$.r<=V[w][0].e.r&&$.c>=V[w][0].s.c&&$.c<=V[w][0].e.c&&(f.F=V[w][1])}if(null==h.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!O)continue;f.t="z"}else f.t=h.t||"n";switch(m.s.c>T&&(m.s.c=T),m.e.c<T&&(m.e.c=T),f.t){case"n":if(""==f.v||null==f.v){if(!O)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if(void 0===f.v){if(!O)continue;f.t="z"}else p=Bd[parseInt(f.v,10)],f.v=p.t,f.r=p.r,c.cellHTML&&(f.h=p.h);break;case"str":f.t="s",f.v=null!=f.v?ia(f.v):"",c.cellHTML&&(f.h=Qi(f.v));break;case"inlineStr":y=_.match(s),f.t="s",null!=y&&(p=Tm(y[1]))?(f.v=p.t,c.cellHTML&&(f.h=p.h)):f.v="";break;case"b":f.v=ea(f.v);break;case"d":c.cellDates?f.v=bi(f.v,1):(f.v=li(bi(f.v,1)),f.t="n");break;case"e":c&&!1===c.cellText||(f.w=f.v),f.v=Sl[f.v]}if(S=j=0,b=null,k&&void 0!==h.s&&null!=(b=d.CellXf[h.s])&&(null!=b.numFmtId&&(S=b.numFmtId),c.cellStyles&&null!=b.fillId&&(j=b.fillId)),Yd(f,S,j,c,u,d),c.cellDates&&k&&"n"==f.t&&Un(fn[S])&&(f.t="d",f.v=di(f.v)),h.cm&&c.xlmeta){var G=(c.xlmeta.Cell||[])[+h.cm-1];G&&"XLDAPR"==G.type&&(f.D=!0)}if(R){var q=Io(h.r);l[q.r]||(l[q.r]=[]),l[q.r][q.c]=f}else l[h.r]=f}}}}A.length>0&&(l["!rows"]=A)}}();function pf(e,r,t,s){var n,i=[Ii,ga("worksheet",null,{xmlns:Ra[0],"xmlns:r":ja})],a=t.SheetNames[e],o="",l=t.Sheets[a];null==l&&(l={});var c=l["!ref"]||"A1",m=Fo(c);if(m.e.c>16383||m.e.r>1048575){if(r.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),c=Lo(m)}s||(s={}),l["!comments"]=[];var u=[];!function(e,r,t,s,n){var i=!1,a={},o=null;if("xlsx"!==s.bookType&&r.vbaraw){var l=r.SheetNames[t];try{r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch(m){}i=!0,a.codeName=aa(Yi(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+ga("outlinePr",null,c)}(i||o)&&(n[n.length]=ga("sheetPr",o,a))}(l,t,e,r,i),i[i.length]=ga("dimension",null,{ref:c}),i[i.length]=function(e,r,t,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),ga("sheetViews",ga("sheetView",null,n),{})}(0,0,0,t),r.sheetFormat&&(i[i.length]=ga("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(i[i.length]=function(e,r){for(var t,s=["<cols>"],n=0;n!=r.length;++n)(t=r[n])&&(s[s.length]=ga("col",null,Gd(n,t)));return s[s.length]="</cols>",s.join("")}(0,l["!cols"])),i[n=i.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,r){var t,s,n=[],i=[],a=Fo(e["!ref"]),o="",l="",c=[],m=0,u=0,d=e["!rows"],f=Array.isArray(e),h={r:l},p=-1;for(u=a.s.c;u<=a.e.c;++u)c[u]=Mo(u);for(m=a.s.r;m<=a.e.r;++m){for(i=[],l=Ro(m),u=a.s.c;u<=a.e.c;++u){t=c[u]+l;var g=f?(e[m]||[])[u]:e[t];void 0!==g&&null!=(o=ff(g,t,e,r))&&i.push(o)}(i.length>0||d&&d[m])&&(h={r:l},d&&d[m]&&((s=d[m]).hidden&&(h.hidden=1),p=-1,s.hpx?p=iu(s.hpx):s.hpt&&(p=s.hpt),p>-1&&(h.ht=p,h.customHeight=1),s.level&&(h.outlineLevel=s.level)),n[n.length]=ga("row",i.join(""),h))}if(d)for(;m<d.length;++m)d&&d[m]&&(h={r:m+1},(s=d[m]).hidden&&(h.hidden=1),p=-1,s.hpx?p=iu(s.hpx):s.hpt&&(p=s.hpt),p>-1&&(h.ht=p,h.customHeight=1),s.level&&(h.outlineLevel=s.level),n[n.length]=ga("row","",h));return n.join("")}(l,r),o.length>0&&(i[i.length]=o)),i.length>n+1&&(i[i.length]="</sheetData>",i[n]=i[n].replace("/>",">")),l["!protect"]&&(i[i.length]=function(e){var r={sheet:1};return mf.forEach(function(t){null!=e[t]&&e[t]&&(r[t]="1")}),uf.forEach(function(t){null==e[t]||e[t]||(r[t]="0")}),e.password&&(r.password=zm(e.password).toString(16).toUpperCase()),ga("sheetProtection",null,r)}(l["!protect"])),null!=l["!autofilter"]&&(i[i.length]=function(e,r,t,s){var n="string"==typeof e.ref?e.ref:Lo(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var i=t.Workbook.Names,a=Po(n);a.s.r==a.e.r&&(a.e.r=Po(r["!ref"]).e.r,n=Lo(a));for(var o=0;o<i.length;++o){var l=i[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==s){l.Ref="'"+t.SheetNames[s]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+n}),ga("autoFilter",null,{ref:n})}(l["!autofilter"],l,t,e)),null!=l["!merges"]&&l["!merges"].length>0&&(i[i.length]=function(e){if(0===e.length)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Lo(e[t])+'"/>';return r+"</mergeCells>"}(l["!merges"]));var d,f,h=-1,p=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(d={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=Il(s,-1,Yi(e[1].Target).replace(/#.*$/,""),Cl.HLINK),d["r:id"]="rId"+p),(h=e[1].Target.indexOf("#"))>-1&&(d.location=Yi(e[1].Target.slice(h+1))),e[1].Tooltip&&(d.tooltip=Yi(e[1].Tooltip)),i[i.length]=ga("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(i[i.length]=(qd(f=l["!margins"]),ga("pageMargins",null,f))),r&&!r.ignoreEC&&null!=r.ignoreEC||(i[i.length]=ha("ignoredErrors",ga("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(p=Il(s,-1,"../drawings/drawing"+(e+1)+".xml",Cl.DRAW),i[i.length]=ga("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=u),l["!comments"].length>0&&(p=Il(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Cl.VML),i[i.length]=ga("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function gf(e,r,t,s){var n=function(e,r,t){var s=Do(145),n=(t["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var i=320;n.hpx?i=20*iu(n.hpx):n.hpt&&(i=20*n.hpt),s.write_shift(2,i),s.write_shift(1,0);var a=0;n.level&&(a|=n.level),n.hidden&&(a|=16),(n.hpx||n.hpt)&&(a|=32),s.write_shift(1,a),s.write_shift(1,0);var o=0,l=s.l;s.l+=4;for(var c={r:e,c:0},m=0;m<16;++m)if(!(r.s.c>m+1<<10||r.e.c<m<<10)){for(var u=-1,d=-1,f=m<<10;f<m+1<<10;++f)c.c=f,(Array.isArray(t)?(t[c.r]||[])[c.c]:t[Oo(c)])&&(u<0&&(u=f),d=f);u<0||(++o,s.write_shift(4,u),s.write_shift(4,d))}var h=s.l;return s.l=l,s.write_shift(4,o),s.l=h,s.length>s.l?s.slice(0,s.l):s}(s,t,r);(n.length>17||(r["!rows"]||[])[s])&&To(e,0,n)}var bf=fl,vf=hl;function Nf(e){return[rl(e),pl(e),"n"]}var xf=fl,yf=hl;var Ef=["left","right","top","bottom","header","footer"];function wf(e,r,t,s,n,i,a){if(void 0===r.v)return!1;var o="";switch(r.t){case"b":o=r.v?"1":"0";break;case"d":(r=Ni(r)).z=r.z||fn[14],r.v=li(bi(r.v)),r.t="n";break;case"n":case"e":o=""+r.v;break;default:o=r.v}var l={r:t,c:s};switch(l.s=Xd(n.cellXfs,r,n),r.l&&i["!links"].push([Oo(l),r.l]),r.c&&i["!comments"].push([Oo(l),r.c]),r.t){case"s":case"str":return n.bookSST?(o=$d(n.Strings,r.v,n.revStrings),l.t="s",l.v=o,a?To(e,18,function(e,r,t){return null==t&&(t=Do(8)),tl(r,t),t.write_shift(4,r.v),t}(0,l)):To(e,7,function(e,r,t){return null==t&&(t=Do(12)),el(r,t),t.write_shift(4,r.v),t}(0,l))):(l.t="str",a?To(e,17,function(e,r,t){return null==t&&(t=Do(8+4*e.v.length)),tl(r,t),Xo(e.v,t),t.length>t.l?t.slice(0,t.l):t}(r,l)):To(e,6,function(e,r,t){return null==t&&(t=Do(12+4*e.v.length)),el(r,t),Xo(e.v,t),t.length>t.l?t.slice(0,t.l):t}(r,l))),!0;case"n":return r.v==(0|r.v)&&r.v>-1e3&&r.v<1e3?a?To(e,13,function(e,r,t){return null==t&&(t=Do(8)),tl(r,t),ul(e.v,t),t}(r,l)):To(e,2,function(e,r,t){return null==t&&(t=Do(12)),el(r,t),ul(e.v,t),t}(r,l)):a?To(e,16,function(e,r,t){return null==t&&(t=Do(12)),tl(r,t),gl(e.v,t),t}(r,l)):To(e,5,function(e,r,t){return null==t&&(t=Do(16)),el(r,t),gl(e.v,t),t}(r,l)),!0;case"b":return l.t="b",a?To(e,15,function(e,r,t){return null==t&&(t=Do(5)),tl(r,t),t.write_shift(1,e.v?1:0),t}(r,l)):To(e,4,function(e,r,t){return null==t&&(t=Do(9)),el(r,t),t.write_shift(1,e.v?1:0),t}(r,l)),!0;case"e":return l.t="e",a?To(e,14,function(e,r,t){return null==t&&(t=Do(8)),tl(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}(r,l)):To(e,3,function(e,r,t){return null==t&&(t=Do(9)),el(r,t),t.write_shift(1,e.v),t}(r,l)),!0}return a?To(e,12,function(e,r,t){return null==t&&(t=Do(4)),tl(r,t)}(0,l)):To(e,1,function(e,r,t){return null==t&&(t=Do(8)),el(r,t)}(0,l)),!0}function Df(e,r){var t,s;r&&r["!merges"]&&(To(e,177,(t=r["!merges"].length,null==s&&(s=Do(4)),s.write_shift(4,t),s)),r["!merges"].forEach(function(r){To(e,176,yf(r))}),To(e,178))}function _f(e,r){r&&r["!cols"]&&(To(e,390),r["!cols"].forEach(function(r,t){r&&To(e,60,function(e,r,t){null==t&&(t=Do(18));var s=Gd(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,256*(s.width||10)),t.write_shift(4,0);var n=0;return r.hidden&&(n|=1),"number"==typeof s.width&&(n|=2),r.level&&(n|=r.level<<8),t.write_shift(2,n),t}(t,r))}),To(e,391))}function Hf(e,r){var t,s;r&&r["!ref"]&&(To(e,648),To(e,649,(t=Fo(r["!ref"]),(s=Do(24)).write_shift(4,4),s.write_shift(4,1),hl(t,s),s)),To(e,650))}function Tf(e,r,t){r["!links"].forEach(function(r){if(r[1].Target){var s=Il(t,-1,r[1].Target.replace(/#.*$/,""),Cl.HLINK);To(e,494,function(e,r){var t=Do(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));hl({s:Io(e[0]),e:Io(e[0])},t),cl("rId"+r,t);var s=e[1].Target.indexOf("#");return Xo((-1==s?"":e[1].Target.slice(s+1))||"",t),Xo(e[1].Tooltip||"",t),Xo("",t),t.slice(0,t.l)}(r,s))}}),delete r["!links"]}function Sf(e,r,t){To(e,133),To(e,137,function(e,r,t){null==t&&(t=Do(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),t.write_shift(2,s),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}(0,t)),To(e,138),To(e,134)}function jf(e,r){var t,s;r["!protect"]&&To(e,535,(t=r["!protect"],null==s&&(s=Do(66)),s.write_shift(2,t.password?zm(t.password):0),s.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?s.write_shift(4,null==t[e[0]]||t[e[0]]?0:1):s.write_shift(4,null!=t[e[0]]&&t[e[0]]?0:1)}),s))}function kf(e,r,t,s){var n=Ho(),i=t.SheetNames[e],a=t.Sheets[i]||{},o=i;try{t&&t.Workbook&&(o=t.Workbook.Sheets[e].CodeName||o)}catch(u){}var l,c,m=Fo(a["!ref"]||"A1");if(m.e.c>16383||m.e.r>1048575){if(r.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],To(n,129),(t.vbaraw||a["!outline"])&&To(n,147,function(e,r,t){null==t&&(t=Do(84+4*e.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),t.write_shift(1,s);for(var n=1;n<3;++n)t.write_shift(1,0);return bl({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),nl(e,t),t.slice(0,t.l)}(o,a["!outline"])),To(n,148,vf(m)),Sf(n,0,t.Workbook),_f(n,a),function(e,r,t,s){var n,i=Fo(r["!ref"]||"A1"),a="",o=[];To(e,145);var l=Array.isArray(r),c=i.e.r;r["!rows"]&&(c=Math.max(i.e.r,r["!rows"].length-1));for(var m=i.s.r;m<=c;++m){a=Ro(m),gf(e,r,i,m);var u=!1;if(m<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){m===i.s.r&&(o[d]=Mo(d)),n=o[d]+a;var f=l?(r[m]||[])[d]:r[n];u=!!f&&wf(e,f,m,d,s,r,u)}}To(e,146)}(n,a,0,r),jf(n,a),function(e,r,t,s){if(r["!autofilter"]){var n=r["!autofilter"],i="string"==typeof n.ref?n.ref:Lo(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=Po(i);o.s.r==o.e.r&&(o.e.r=Po(r["!ref"]).e.r,i=Lo(o));for(var l=0;l<a.length;++l){var c=a[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==s){c.Ref="'"+t.SheetNames[s]+"'!"+i;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+i}),To(e,161,hl(Fo(i))),To(e,162)}}(n,a,t,e),Df(n,a),Tf(n,a,s),a["!margins"]&&To(n,476,(l=a["!margins"],null==c&&(c=Do(48)),qd(l),Ef.forEach(function(e){gl(l[e],c)}),c)),r&&!r.ignoreEC&&null!=r.ignoreEC||Hf(n,a),function(e,r,t,s){if(r["!comments"].length>0){var n=Il(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Cl.VML);To(e,551,cl("rId"+n)),r["!legacy"]=n}}(n,a,e,s),To(n,130),n.end()}function Vf(e,r,t,s,n,i){var a=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var r=function(e){var r,t=[],s=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var r=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);r&&(t[+r[1]]=s?+r[2]:r[2])});var n=Gi((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){r=e.replace(/<.*?>/g,"")}),[t,n,r]}(e);m.s.r=m.s.c=0,m.e.c=o,c=Mo(o),r[0].forEach(function(e,t){a[c+Ro(t)]={t:"n",v:e,z:r[1]},l=t}),m.e.r<l&&(m.e.r=l),++o}),o>0&&(a["!ref"]=Lo(m)),a}var Cf=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Rf=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Af=[],Mf=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function If(e,r){for(var t=0;t!=e.length;++t)for(var s=e[t],n=0;n!=r.length;++n){var i=r[n];if(null==s[i[0]])s[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof s[i[0]]&&(s[i[0]]=ea(s[i[0]]));break;case"int":"string"==typeof s[i[0]]&&(s[i[0]]=parseInt(s[i[0]],10))}}}function Of(e,r){for(var t=0;t!=r.length;++t){var s=r[t];if(null==e[s[0]])e[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof e[s[0]]&&(e[s[0]]=ea(e[s[0]]));break;case"int":"string"==typeof e[s[0]]&&(e[s[0]]=parseInt(e[s[0]],10))}}}function Pf(e){Of(e.WBProps,Cf),Of(e.CalcPr,Mf),If(e.WBView,Rf),If(e.Sheets,Af),Wd.date1904=ea(e.WBProps.date1904)}var Lf="][*?/\\".split("");function Ff(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");return Lf.forEach(function(r){if(-1!=e.indexOf(r))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),!0}function Uf(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r,t,s,n=e.Workbook&&e.Workbook.Sheets||[];r=e.SheetNames,t=n,s=!!e.vbaraw,r.forEach(function(e,n){Ff(e);for(var i=0;i<n;++i)if(e==r[i])throw new Error("Duplicate Sheet Name: "+e);if(s){var a=t&&t[n]&&t[n].CodeName||e;if(95==a.charCodeAt(0)&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}});for(var i=0;i<e.SheetNames.length;++i)Kd(e.Sheets[e.SheetNames[i]],e.SheetNames[i],i)}var Bf=/<\w+:workbook/;function Wf(e){var r=[Ii];r[r.length]=ga("workbook",null,{xmlns:Ra[0],"xmlns:r":ja});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Cf.forEach(function(r){null!=e.Workbook.WBProps[r[0]]&&e.Workbook.WBProps[r[0]]!=r[1]&&(s[r[0]]=e.Workbook.WBProps[r[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=ga("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=e.SheetNames.length&&n[i]&&n[i].Hidden;++i);i==e.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var a={name:Yi(e.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden"}r[r.length]=ga("sheet",null,a)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var t={name:e.Name};e.Comment&&(t.comment=e.Comment),null!=e.Sheet&&(t.localSheetId=""+e.Sheet),e.Hidden&&(t.hidden="1"),e.Ref&&(r[r.length]=ga("definedName",Yi(e.Ref),t))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function zf(e,r){return r||(r=Do(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),cl(e.strRelID,r),Xo(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function $f(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function Gf(e,r){if(r.Workbook&&r.Workbook.Sheets){for(var t,s,n=r.Workbook.Sheets,i=0,a=-1,o=-1;i<n.length;++i)!n[i]||!n[i].Hidden&&-1==a?a=i:1==n[i].Hidden&&-1==o&&(o=i);if(!(o>a))To(e,135),To(e,158,(t=a,s||(s=Do(29)),s.write_shift(-4,0),s.write_shift(-4,460),s.write_shift(4,28800),s.write_shift(4,17600),s.write_shift(4,500),s.write_shift(4,t),s.write_shift(4,t),s.write_shift(1,120),s.length>s.l?s.slice(0,s.l):s)),To(e,136)}}function qf(e,r){var t=Ho();return To(t,131),To(t,128,function(e,r){r||(r=Do(127));for(var t=0;4!=t;++t)r.write_shift(4,0);return Xo("SheetJS",r),Xo(js.version,r),Xo(js.version,r),Xo("7262",r),r.length>r.l?r.slice(0,r.l):r}()),To(t,153,function(e,r){r||(r=Do(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),nl(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}(e.Workbook&&e.Workbook.WBProps||null)),Gf(t,e),function(e,r){To(e,143);for(var t=0;t!=r.SheetNames.length;++t)To(e,156,zf({Hidden:r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]}));To(e,144)}(t,e),To(t,132),t.end()}function Xf(e,r,t){return".bin"===r.slice(-4)?function(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;r||(r={}),r.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],Ah[16]={n:"BrtFRTArchID$",f:$f},_o(e,function(e,o,l){switch(l){case 156:a.SheetNames.push(e.name),t.Sheets.push(e);break;case 153:t.WBProps=e;break;case 39:null!=e.Sheet&&(r.SID=e.Sheet),e.Ref=_d(e.Ptg,0,null,a,r),delete r.SID,delete e.Ptg,i.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:a[0].length?a.push([l,e]):a[0]=[l,e],a[a.length-1].XTI=[];break;case 362:0===a.length&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(e),a.XTI=a.XTI.concat(e);break;case 35:case 37:s.push(l),n=!0;break;case 36:case 38:s.pop(),n=!1;break;default:if(o.T);else if(!n||r.WTF&&37!=s[s.length-1]&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},r),Pf(t),t.Names=i,t.supbooks=a,t}(e,t):function(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",i={},a=0;if(e.replace(Li,function(o,l){var c=Bi(o);switch(Wi(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(Bf)&&(n="xmlns"+o.match(/<(\w+):/)[1]),t.xmlns=c[n];break;case"<fileVersion":delete c[0],t.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":Cf.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":t.WBProps[e[0]]=ea(c[e[0]]);break;case"int":t.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:t.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(t.WBProps.CodeName=ia(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],t.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Gi(ia(c.name)),delete c[0],t.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":s=!1;break;case"<definedName":(i={}).Name=ia(c.name),c.comment&&(i.Comment=c.comment),c.localSheetId&&(i.Sheet=+c.localSheetId),ea(c.hidden||"0")&&(i.Hidden=!0),a=l+o.length;break;case"</definedName>":i.Ref=Gi(ia(e.slice(a,l))),t.Names.push(i);break;case"<calcPr":case"<calcPr/>":delete c[0],t.CalcPr=c;break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===Ra.indexOf(t.xmlns))throw new Error("Unknown Namespace: "+t.xmlns);return Pf(t),t}(e,t)}function Yf(e,r,t,s,n,i,a,o){return".bin"===r.slice(-4)?function(e,r,t,s,n,i,a){if(!e)return e;var o=r||{};s||(s={"!id":{}});var l,c,m,u,d,f,h,p,g,b,v=o.dense?[]:{},N={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,y=!1,E=[];o.biff=12,o["!row"]=0;var w=0,D=!1,_=[],H={},T=o.supbooks||n.supbooks||[[]];if(T.sharedf=H,T.arrayf=_,T.SheetNames=n.SheetNames||n.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=T,n.Names))for(var S=0;S<n.Names.length;++S)T[0][S+1]=n.Names[S];var j,k=[],V=[],C=!1;if(Ah[16]={n:"BrtShortReal",f:Nf},_o(e,function(e,r,S){if(!y)switch(S){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(y=!0),g=Ro(d=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=au(e.hpt)),V[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:e[2]},e[2]){case"n":m.v=e[1];break;case"s":p=Bd[e[1]],m.v=p.t,m.r=p.r;break;case"b":m.v=!!e[1];break;case"e":m.v=e[1],!1!==o.cellText&&(m.w=Tl[m.v]);break;case"str":m.t="s",m.v=e[1];break;case"is":m.t="s",m.v=e[1].t}if((u=a.CellXf[e[0].iStyleRef])&&Yd(m,u.numFmtId,null,o,i,a),f=-1==e[0].c?f+1:e[0].c,o.dense?(v[d]||(v[d]=[]),v[d][f]=m):v[Mo(f)+g]=m,o.cellFormula){for(D=!1,w=0;w<_.length;++w){var R=_[w];c.r>=R[0].s.r&&c.r<=R[0].e.r&&f>=R[0].s.c&&f<=R[0].e.c&&(m.F=Lo(R[0]),D=!0)}!D&&e.length>3&&(m.f=e[3])}if(N.s.r>c.r&&(N.s.r=c.r),N.s.c>f&&(N.s.c=f),N.e.r<c.r&&(N.e.r=c.r),N.e.c<f&&(N.e.c=f),o.cellDates&&u&&"n"==m.t&&Un(fn[u.numFmtId])){var A=bn(m.v);A&&(m.t="d",m.v=new Date(A.y,A.m-1,A.d,A.H,A.M,A.S,A.u))}j&&("XLDAPR"==j.type&&(m.D=!0),j=void 0);break;case 1:case 12:if(!o.sheetStubs||x)break;m={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,o.dense?(v[d]||(v[d]=[]),v[d][f]=m):v[Mo(f)+g]=m,N.s.r>c.r&&(N.s.r=c.r),N.s.c>f&&(N.s.c=f),N.e.r<c.r&&(N.e.r=c.r),N.e.c<f&&(N.e.c=f),j&&("XLDAPR"==j.type&&(m.D=!0),j=void 0);break;case 176:E.push(e);break;case 49:j=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var M=s["!id"][e.relId];for(M?(e.Target=M.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=M):""==e.relId&&(e.Target="#"+e.loc),d=e.rfx.s.r;d<=e.rfx.e.r;++d)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)o.dense?(v[d]||(v[d]=[]),v[d][f]||(v[d][f]={t:"z",v:void 0}),v[d][f].l=e):(h=Oo({c:f,r:d}),v[h]||(v[h]={t:"z",v:void 0}),v[h].l=e);break;case 426:if(!o.cellFormula)break;_.push(e),(b=o.dense?v[d][f]:v[Mo(f)+g]).f=_d(e[1],0,{r:c.r,c:f},T,o),b.F=Lo(e[0]);break;case 427:if(!o.cellFormula)break;H[Oo(e[0].s)]=e[1],(b=o.dense?v[d][f]:v[Mo(f)+g]).f=_d(e[1],0,{r:c.r,c:f},T,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)k[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},C||(C=!0,tu(e.w/256)),su(k[e.e+1]);break;case 161:v["!autofilter"]={ref:Lo(e)};break;case 476:v["!margins"]=e;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),e.name&&(n.Sheets[t].CodeName=e.name),(e.above||e.left)&&(v["!outline"]={above:e.above,left:e.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),e.RTL&&(n.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:case 37:x=!0;break;case 36:case 38:x=!1;break;default:if(r.T);else if(!x||o.WTF)throw new Error("Unexpected record 0x"+S.toString(16))}},o),delete o.supbooks,delete o["!row"],!v["!ref"]&&(N.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(v["!ref"]=Lo(l||N)),o.sheetRows&&v["!ref"]){var R=Fo(v["!ref"]);o.sheetRows<=+R.e.r&&(R.e.r=o.sheetRows-1,R.e.r>N.e.r&&(R.e.r=N.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>N.e.c&&(R.e.c=N.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),v["!fullref"]=v["!ref"],v["!ref"]=Lo(R))}return E.length>0&&(v["!merges"]=E),k.length>0&&(v["!cols"]=k),V.length>0&&(v["!rows"]=V),v}(e,s,t,n,i,a,o):lf(e,s,t,n,i,a,o)}function Kf(e,r,t,s,n,i,a,o){return".bin"===r.slice(-4)?function(e,r,t,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return _o(e,function(e,s,o){switch(o){case 550:i["!rel"]=e;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),e.name&&(n.Sheets[t].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:case 37:case 38:break;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T>0);else if(s.T<0);else if(!a||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}},r),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}(e,s,t,n,i):function(e,r,t,s,n){if(!e)return e;s||(s={"!id":{}});var i,a={"!type":"chart","!drawel":null,"!rel":""},o=e.match(nf);return o&&cf(o[0],0,n,t),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),s["!id"][a["!rel"]]&&(a["!drawel"]=s["!id"][a["!rel"]]),a}(e,0,t,n,i)}function Jf(e,r,t,s){return".bin"===r.slice(-4)?function(e,r,t){var s={NumberFmt:[]};for(var n in fn)s.NumberFmt[n]=fn[n];s.CellXf=[],s.Fonts=[];var i=[],a=!1;return _o(e,function(e,n,o){switch(o){case 44:s.NumberFmt[e[0]]=e[1],Gn(e[1],e[0]);break;case 43:s.Fonts.push(e),null!=e.color.theme&&r&&r.themeElements&&r.themeElements.clrScheme&&(e.color.rgb=Km(r.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&s.CellXf.push(e);break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(o),a=!0;break;case 38:i.pop(),a=!1;break;default:if(n.T>0)i.push(o);else if(n.T<0)i.pop();else if(!a||t.WTF&&37!=i[i.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),s}(e,t,s):mu(e,t,s)}function Qf(e,r,t){return".bin"===r.slice(-4)?function(e,r){var t=[],s=!1;return _o(e,function(e,n,i){switch(i){case 159:t.Count=e[0],t.Unique=e[1];break;case 19:t.push(e);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(n.T,!s||r.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}),t}(e,t):function(e,r){var t=[],s="";if(!e)return t;var n=e.match(Sm);if(n){s=n[2].replace(jm,"").split(km);for(var i=0;i!=s.length;++i){var a=Tm(s[i].trim(),r);null!=a&&(t[t.length]=a)}n=Bi(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}(e,t)}function Zf(e,r,t){return".bin"===r.slice(-4)?function(e,r){var t=[],s=[],n={},i=!1;return _o(e,function(e,a,o){switch(o){case 632:s.push(e);break;case 635:n=e;break;case 637:n.t=e.t,n.h=e.h,n.r=e.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(a.T);else if(!i||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}(e,t):function(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var r=e.match(/<(?:\w+:)?author[^>]*>(.*)/);r&&t.push(r[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var n=e.match(/<(?:\w+:)?comment[^>]*>/);if(n){var i=Bi(n[0]),a={author:i.authorId&&t[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},o=Io(i.ref);if(!(r.sheetRows&&r.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&Tm(l[1])||{r:"",t:"",h:""};a.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),a.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),r.cellHTML&&(a.h=c.h),s.push(a)}}}}),s}(e,t)}function eh(e,r,t){return".bin"===r.slice(-4)?function(e){var r=[];return _o(e,function(e,t,s){if(63===s)r.push(e);else if(!t.T)throw new Error("Unexpected record 0x"+s.toString(16))}),r}(e):function(e){var r=[];if(!e)return r;var t=1;return(e.match(Li)||[]).forEach(function(e){var s=Bi(e);switch(s[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,r.push(s)}}),r}(e)}function rh(e,r,t,s){if(".bin"===t.slice(-4))return function(e,r,t,s){if(!e)return e;var n=s||{},i=!1;_o(e,function(e,r,t){switch(t){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(r.T);else if(!i||n.WTF)throw new Error("Unexpected record 0x"+t.toString(16))}},n)}(e,0,0,s)}function th(e,r,t){return".bin"===r.slice(-4)?function(e,r,t){var s={Types:[],Cell:[],Value:[]},n=t||{},i=[],a=!1,o=2;return _o(e,function(e,r,t){switch(t){case 335:s.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?s.Cell.push({type:s.Types[e[0]-1].name,index:e[1]}):0==o&&s.Value.push({type:s.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:i.push(t),a=!0;break;case 36:i.pop(),a=!1;break;default:if(r.T);else if(!a||n.WTF&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+t.toString(16))}}),s}(e,0,t):function(e,r,t){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n,i=!1,a=2;return e.replace(Li,function(e){var r=Bi(e);switch(Wi(r[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":s.Types.push({name:r.name});break;case"<futureMetadata":for(var o=0;o<s.Types.length;++o)s.Types[o].name==r.name&&(n=s.Types[o]);break;case"<rc":1==a?s.Cell.push({type:s.Types[r.t-1].name,index:+r.v}):0==a&&s.Value.push({type:s.Types[r.t-1].name,index:+r.v});break;case"<cellMetadata":a=1;break;case"</cellMetadata>":case"</valueMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!n)break;n.offsets||(n.offsets=[]),n.offsets.push(+r.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+r[0]+" in metadata")}return e}),s}(e,0,t)}function sh(e,r,t,s,n){return(".bin"===r.slice(-4)?kf:pf)(e,t,s,n)}function nh(e,r,t){return(".bin"===r.slice(-4)?Gu:Wu)(e)}var ih,ah=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,oh=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function lh(e,r){var t=e.split(/\s+/),s=[];if(s[0]=t[0],1===t.length)return s;var n,i,a,o=e.match(ah);if(o)for(a=0;a!=o.length;++a)-1===(i=(n=o[a].match(oh))[1].indexOf(":"))?s[n[1]]=n[2].slice(1,n[2].length-1):s["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(i+1)]=n[2].slice(1,n[2].length-1);return s}function ch(e){var r={};if(1===e.split(/\s+/).length)return r;var t,s,n,i=e.match(ah);if(i)for(n=0;n!=i.length;++n)-1===(s=(t=i[n].match(oh))[1].indexOf(":"))?r[t[1]]=t[2].slice(1,t[2].length-1):r["xmlns:"===t[1].slice(0,6)?"xmlns"+t[1].slice(6):t[1].slice(s+1)]=t[2].slice(1,t[2].length-1);return r}function mh(e,r,t,s){var n=s;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=ea(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=bi(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Gi(r)]=n}function uh(e,r,t){if("z"!==e.t){if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Tl[e.v]:"General"===r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=wn(e.v):e.w=Dn(e.v):e.w=(s=r||"General",n=e.v,"General"===(i=ih[s]||Gi(s))?Dn(n):$n(i,n))}catch(l){if(t.WTF)throw l}var s,n,i;try{var a=ih[r]||r||"General";if(t.cellNF&&(e.z=a),t.cellDates&&"n"==e.t&&Un(a)){var o=bn(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}catch(l){if(t.WTF)throw l}}}function dh(e,r,t){if(t.cellStyles&&r.Interior){var s=r.Interior;s.Pattern&&(s.patternType=ou[s.Pattern]||s.Pattern)}e[r.ID]=r}function fh(e,r,t,s,n,i,a,o,l,c){var m="General",u=s.StyleID,d={};c=c||{};var f=[],h=0;for(void 0===u&&o&&(u=o.StyleID),void 0===u&&a&&(u=a.StyleID);void 0!==i[u]&&(i[u].nf&&(m=i[u].nf),i[u].Interior&&f.push(i[u].Interior),i[u].Parent);)u=i[u].Parent;switch(t.Type){case"Boolean":s.t="b",s.v=ea(e);break;case"String":s.t="s",s.r=Zi(Gi(e)),s.v=e.indexOf("<")>-1?Gi(r||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),s.v=(bi(e)-new Date(Date.UTC(1899,11,30)))/864e5,s.v!=s.v?s.v=Gi(e):s.v<60&&(s.v=s.v-1),m&&"General"!=m||(m="yyyy-mm-dd");case"Number":void 0===s.v&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=Sl[e],!1!==c.cellText&&(s.w=e);break;default:""==e&&""==r?s.t="z":(s.t="s",s.v=Zi(r||e))}if(uh(s,m,c),!1!==c.cellFormula)if(s.Formula){var p=Gi(s.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),s.f=Xu(p,n),delete s.Formula,"RC"==s.ArrayRange?s.F=Xu("RC:RC",n):s.ArrayRange&&(s.F=Xu(s.ArrayRange,n),l.push([Fo(s.F),s.F]))}else for(h=0;h<l.length;++h)n.r>=l[h][0].s.r&&n.r<=l[h][0].e.r&&n.c>=l[h][0].s.c&&n.c<=l[h][0].e.c&&(s.F=l[h][1]);c.cellStyles&&(f.forEach(function(e){!d.patternType&&e.patternType&&(d.patternType=e.patternType)}),s.s=d),void 0!==s.StyleID&&(s.ixfe=s.StyleID)}function hh(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function ph(e,r){var t=r||{};Xn();var s=Fs(va(e));"binary"!=t.type&&"array"!=t.type&&"base64"!=t.type||(s=void 0!==Ls?Ls.utils.decode(65001,Os(s)):ia(s));var n,i=s.slice(0,1024).toLowerCase(),a=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var o=Ni(t);return o.type="string",xm.to_workbook(s,o)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){i.indexOf("<"+e)>=0&&(a=!0)}),a)return function(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||0==t.length)throw new Error("Invalid HTML: could not find <table>");if(1==t.length)return Wo(Gh(t[0],r),r);var s={SheetNames:[],Sheets:{}};return t.forEach(function(e,t){fg(s,Gh(e,r),"Sheet"+(t+1))}),s}(s,t);ih={"General Number":"General","General Date":fn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":fn[15],"Short Date":fn[14],"Long Time":fn[19],"Medium Time":fn[18],"Short Time":fn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:fn[2],Standard:fn[4],Percent:fn[10],Scientific:fn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c,m=[],u={},d=[],f=t.dense?[]:{},h="",p={},g={},b=lh('<Data ss:Type="String">'),v=0,N=0,x=0,y={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},w={},D="",_=0,H=[],T={},S={},j=0,k=[],V=[],C={},R=[],A=!1,M=[],I=[],O={},P=0,L=0,F={Sheets:[],WBProps:{date1904:!1}},U={};Na.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/gm,"");for(var B="";n=Na.exec(s);)switch(n[3]=(B=n[3]).toLowerCase()){case"data":if("data"==B){if("/"===n[1]){if((l=m.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&m.push([n[3],!0]);break}if(m[m.length-1][1])break;"/"===n[1]?fh(s.slice(v,n.index),D,b,"comment"==m[m.length-1][0]?C:p,{c:N,r:x},E,R[N],g,M,t):(D="",b=lh(n[0]),v=n.index+n[0].length);break;case"cell":if("/"===n[1])if(V.length>0&&(p.c=V),(!t.sheetRows||t.sheetRows>x)&&void 0!==p.v&&(t.dense?(f[x]||(f[x]=[]),f[x][N]=p):f[Mo(N)+Ro(x)]=p),p.HRef&&(p.l={Target:Gi(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(P=N+(0|parseInt(p.MergeAcross,10)),L=x+(0|parseInt(p.MergeDown,10)),H.push({s:{c:N,r:x},e:{c:P,r:L}})),t.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var W=N;W<=P;++W)for(var z=x;z<=L;++z)(W>N||z>x)&&(t.dense?(f[z]||(f[z]=[]),f[z][W]={t:"z"}):f[Mo(W)+Ro(z)]={t:"z"});N=P+1}else++N;else p.MergeAcross?N=P+1:++N;else(p=ch(n[0])).Index&&(N=+p.Index-1),N<y.s.c&&(y.s.c=N),N>y.e.c&&(y.e.c=N),"/>"===n[0].slice(-2)&&++N,V=[];break;case"row":"/"===n[1]||"/>"===n[0].slice(-2)?(x<y.s.r&&(y.s.r=x),x>y.e.r&&(y.e.r=x),"/>"===n[0].slice(-2)&&(g=lh(n[0])).Index&&(x=+g.Index-1),N=0,++x):((g=lh(n[0])).Index&&(x=+g.Index-1),O={},("0"==g.AutoFitHeight||g.Height)&&(O.hpx=parseInt(g.Height,10),O.hpt=iu(O.hpx),I[x]=O),"1"==g.Hidden&&(O.hidden=!0,I[x]=O));break;case"worksheet":if("/"===n[1]){if((l=m.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"));d.push(h),y.s.r<=y.e.r&&y.s.c<=y.e.c&&(f["!ref"]=Lo(y),t.sheetRows&&t.sheetRows<=y.e.r&&(f["!fullref"]=f["!ref"],y.e.r=t.sheetRows-1,f["!ref"]=Lo(y))),H.length&&(f["!merges"]=H),R.length>0&&(f["!cols"]=R),I.length>0&&(f["!rows"]=I),u[h]=f}else y={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=N=0,m.push([n[3],!1]),l=lh(n[0]),h=Gi(l.Name),f=t.dense?[]:{},H=[],M=[],I=[],U={name:h,Hidden:0},F.Sheets.push(U);break;case"table":if("/"===n[1]){if((l=m.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==n[0].slice(-2))break;m.push([n[3],!1]),R=[],A=!1}break;case"style":"/"===n[1]?dh(E,w,t):w=lh(n[0]);break;case"numberformat":w.nf=Gi(lh(n[0]).Format||"General"),ih[w.nf]&&(w.nf=ih[w.nf]);for(var $=0;392!=$&&fn[$]!=w.nf;++$);if(392==$)for($=57;392!=$;++$)if(null==fn[$]){Gn(w.nf,$);break}break;case"column":if("table"!==m[m.length-1][0])break;if((c=lh(n[0])).Hidden&&(c.hidden=!0,delete c.Hidden),c.Width&&(c.wpx=parseInt(c.Width,10)),!A&&c.wpx>10){A=!0,Jm=6;for(var G=0;G<R.length;++G)R[G]&&su(R[G])}A&&su(c),R[c.Index-1||R.length]=c;for(var q=0;q<+c.Span;++q)R[R.length]=Ni(c);break;case"namedrange":if("/"===n[1])break;F.Names||(F.Names=[]);var X=Bi(n[0]),Y={Name:X.Name,Ref:Xu(X.RefersTo.slice(1),{r:0,c:0})};F.Sheets.length>0&&(Y.Sheet=F.Sheets.length-1),F.Names.push(Y);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===n[0].slice(-2))break;"/"===n[1]?D+=s.slice(_,n.index):_=n.index+n[0].length;break;case"interior":if(!t.cellStyles)break;w.Interior=lh(n[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===n[0].slice(-2))break;"/"===n[1]?Zl(T,B,s.slice(j,n.index)):j=n.index+n[0].length;break;case"styles":case"workbook":if("/"===n[1]){if((l=m.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else m.push([n[3],!1]);break;case"comment":if("/"===n[1]){if((l=m.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"));hh(C),V.push(C)}else m.push([n[3],!1]),C={a:(l=lh(n[0])).Author};break;case"autofilter":if("/"===n[1]){if((l=m.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==n[0].charAt(n[0].length-2)){var K=lh(n[0]);f["!autofilter"]={ref:Xu(K.Range).replace(/\$/g,"")},m.push([n[3],!0])}break;case"datavalidation":if("/"===n[1]){if((l=m.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&m.push([n[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===n[1]){if((l=m.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&m.push([n[3],!0]);break;default:if(0==m.length&&"document"==n[3])return ip(s,t);if(0==m.length&&"uof"==n[3])return ip(s,t);var J=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(n[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(n[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(n[3]){case"date1904":F.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(n[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(n[3]){case"visible":if("/>"===n[0].slice(-2));else if("/"===n[1])switch(s.slice(j,n.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2}else j=n.index+n[0].length;break;case"header":f["!margins"]||qd(f["!margins"]={},"xlml"),isNaN(+Bi(n[0]).Margin)||(f["!margins"].header=+Bi(n[0]).Margin);break;case"footer":f["!margins"]||qd(f["!margins"]={},"xlml"),isNaN(+Bi(n[0]).Margin)||(f["!margins"].footer=+Bi(n[0]).Margin);break;case"pagemargins":var Q=Bi(n[0]);f["!margins"]||qd(f["!margins"]={},"xlml"),isNaN(+Q.Top)||(f["!margins"].top=+Q.Top),isNaN(+Q.Left)||(f["!margins"].left=+Q.Left),isNaN(+Q.Right)||(f["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(f["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":F.Views||(F.Views=[]),F.Views[0]||(F.Views[0]={}),F.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(n[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(n[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(n[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(n[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(n[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(n[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(n[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(n[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+n[3]+"|"+m.join("|");if("customdocumentproperties"===m[m.length-1][0]){if("/>"===n[0].slice(-2))break;"/"===n[1]?mh(S,B,k,s.slice(j,n.index)):(k=n,j=n.index+n[0].length);break}if(t.WTF)throw"Unrecognized tag: "+n[3]+"|"+m.join("|")}var Z={};return t.bookSheets||t.bookProps||(Z.Sheets=u),Z.SheetNames=d,Z.Workbook=F,Z.SSF=Ni(fn),Z.Props=T,Z.Custprops=S,Z}function gh(e,r){switch(Op(r=r||{}),r.type||"base64"){case"base64":return ph($s(e),r);case"binary":case"buffer":case"file":return ph(e,r);case"array":return ph(Qs(e),r)}}function bh(e,r){var t=[];return e.Props&&t.push(function(e,r){var t=[];return si(Ql).map(function(e){for(var r=0;r<Fl.length;++r)if(Fl[r][1]==e)return Fl[r];for(r=0;r<$l.length;++r)if($l[r][1]==e)return $l[r];throw e}).forEach(function(s){if(null!=e[s[1]]){var n=r&&r.Props&&null!=r.Props[s[1]]?r.Props[s[1]]:e[s[1]];"date"===s[2]&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof n?n=String(n):!0===n||!1===n?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),t.push(ha(Ql[s[1]]||s[1],n))}}),ga("DocumentProperties",t.join(""),{xmlns:Aa})}(e.Props,r)),e.Custprops&&t.push(function(e,r){var t=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&si(e).forEach(function(r){if(Object.prototype.hasOwnProperty.call(e,r)){for(var s=0;s<Fl.length;++s)if(r==Fl[s][1])return;for(s=0;s<$l.length;++s)if(r==$l[s][1])return;for(s=0;s<t.length;++s)if(r==t[s])return;var i=e[r],a="string";"number"==typeof i?(a="float",i=String(i)):!0===i||!1===i?(a="boolean",i=i?"1":"0"):i=String(i),n.push(ga(Ki(r),i,{"dt:dt":a}))}}),r&&si(r).forEach(function(t){if(Object.prototype.hasOwnProperty.call(r,t)&&(!e||!Object.prototype.hasOwnProperty.call(e,t))){var s=r[t],i="string";"number"==typeof s?(i="float",s=String(s)):!0===s||!1===s?(i="boolean",s=s?"1":"0"):s instanceof Date?(i="dateTime.tz",s=s.toISOString()):s=String(s),n.push(ga(Ki(t),s,{"dt:dt":i}))}}),"<"+s+' xmlns="'+Aa+'">'+n.join("")+"</"+s+">"}(e.Props,e.Custprops)),t.join("")}function vh(e){return ga("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ku(e.Ref,{r:0,c:0})})}function Nh(e,r,t,s,n,i,a){if(!e||null==e.v&&null==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Yi(Ku(e.f,a))),e.F&&e.F.slice(0,r.length)==r){var l=Io(e.F.slice(r.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Yi(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Yi(e.l.Tooltip))),t["!merges"])for(var c=t["!merges"],m=0;m!=c.length;++m)c[m].s.c==a.c&&c[m].s.r==a.r&&(c[m].e.c>c[m].s.c&&(o["ss:MergeAcross"]=c[m].e.c-c[m].s.c),c[m].e.r>c[m].s.r&&(o["ss:MergeDown"]=c[m].e.r-c[m].s.r));var u="",d="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":u="Number",d=String(e.v);break;case"b":u="Boolean",d=e.v?"1":"0";break;case"e":u="Error",d=Tl[e.v];break;case"d":u="DateTime",d=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||fn[14]);break;case"s":u="String",d=((e.v||"")+"").replace(qi,function(e){return $i[e]}).replace(Ji,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=Xd(s.cellXfs,e,s);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=a.c+1;var h=null!=e.v?d:"",p="z"==e.t?"":'<Data ss:Type="'+u+'">'+h+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map(function(e){var r=ga("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return ga("Comment",r,{"ss:Author":e.a})}).join("")),ga("Cell",p,o)}function xh(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=au(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function yh(e,r,t){var s=[],n=t.SheetNames[e],i=t.Sheets[n],a=i?function(e,r,t,s){if(!e)return"";if(!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,i=[],a=0;a<n.length;++a){var o=n[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||i.push(vh(o)))}return i.join("")}(i,0,e,t):"";return a.length>0&&s.push("<Names>"+a+"</Names>"),a=i?function(e,r){if(!e["!ref"])return"";var t=Fo(e["!ref"]),s=e["!merges"]||[],n=0,i=[];e["!cols"]&&e["!cols"].forEach(function(e,r){su(e);var t=!!e.width,s=Gd(r,e),n={"ss:Index":r+1};t&&(n["ss:Width"]=Qm(s.width)),e.hidden&&(n["ss:Hidden"]="1"),i.push(ga("Column",null,n))});for(var a=Array.isArray(e),o=t.s.r;o<=t.e.r;++o){for(var l=[xh(o,(e["!rows"]||[])[o])],c=t.s.c;c<=t.e.c;++c){var m=!1;for(n=0;n!=s.length;++n)if(!(s[n].s.c>c||s[n].s.r>o||s[n].e.c<c||s[n].e.r<o)){s[n].s.c==c&&s[n].s.r==o||(m=!0);break}if(!m){var u={r:o,c:c},d=Oo(u),f=a?(e[o]||[])[c]:e[d];l.push(Nh(f,d,e,r,0,0,u))}}l.push("</Row>"),l.length>2&&i.push(l.join(""))}return i.join("")}(i,r):"",a.length>0&&s.push("<Table>"+a+"</Table>"),s.push(function(e,r,t,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(ga("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(ga("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(ga("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[t])if(s.Workbook.Sheets[t].Hidden)n.push(ga("Visible",1==s.Workbook.Sheets[t].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<t&&(!s.Workbook.Sheets[i]||s.Workbook.Sheets[i].Hidden);++i);i==t&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(ha("ProtectContents","True")),e["!protect"].objects&&n.push(ha("ProtectObjects","True")),e["!protect"].scenarios&&n.push(ha("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||n.push(ha("EnableSelection","UnlockedCells")):n.push(ha("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(r){e["!protect"][r[0]]&&n.push("<"+r[1]+"/>")})),0==n.length?"":ga("WorksheetOptions",n.join(""),{xmlns:Ma})}(i,0,e,t)),s.join("")}function Eh(e,r){r||(r={}),e.SSF||(e.SSF=Ni(fn)),e.SSF&&(Xn(),qn(e.SSF),r.revssf=ai(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],Xd(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(bh(e,r)),t.push(""),t.push(""),t.push("");for(var s=0;s<e.SheetNames.length;++s)t.push(ga("Worksheet",yh(s,r,e),{"ss:Name":Yi(e.SheetNames[s])}));return t[2]=function(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(e,r){var s=[];s.push(ga("NumberFormat",null,{"ss:Format":Yi(fn[e.numFmtId])}));var n={"ss:ID":"s"+(21+r)};t.push(ga("Style",s.join(""),n))}),ga("Styles",t.join(""))}(0,r),t[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],s=0;s<r.length;++s){var n=r[s];null==n.Sheet&&(n.Name.match(/^_xlfn\./)||t.push(vh(n)))}return ga("Names",t.join(""))}(e),Ii+ga("Workbook",t.join(""),{xmlns:Ia,"xmlns:o":Aa,"xmlns:x":Ma,"xmlns:ss":Ia,"xmlns:dt":Oa,"xmlns:html":Fa})}function wh(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=function(e){return vl(e,1)}(t),t.length-t.l<=4)return r;var s=t.read_shift(4);return 0==s||s>40?r:(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4||1907505652!==(s=t.read_shift(4))?r:(r.UnicodeClipboardFormat=function(e){return vl(e,2)}(t),0==(s=t.read_shift(4))||s>40?r:(t.l-=4,void(r.Reserved2=t.read_shift(0,"lpwstr")))))}var Dh=[60,1084,2066,2165,2175];function _h(e,r,t,s,n){var i=s,a=[],o=t.slice(t.l,t.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:n.enc.insitu(o)}a.push(o),t.l+=i;for(var l=mo(t,t.l),c=Mh[l],m=0;null!=c&&Dh.indexOf(l)>-1;)i=mo(t,t.l+2),m=t.l+4,2066==l?m+=4:2165!=l&&2175!=l||(m+=12),o=t.slice(m,t.l+4+i),a.push(o),t.l+=4+i,c=Mh[l=mo(t,t.l)];var u=en(a);Eo(u,0);var d=0;u.lens=[];for(var f=0;f<a.length;++f)u.lens.push(d),d+=a[f].length;if(u.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+s;return r.f(u,u.length,n)}function Hh(e,r,t){if("z"!==e.t&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=fn[s])}catch(i){if(r.WTF)throw i}if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Tl[e.v]:0===s||"General"==s?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=wn(e.v):e.w=Dn(e.v):e.w=$n(s,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(i){if(r.WTF)throw i}if(r.cellDates&&s&&"n"==e.t&&Un(fn[s]||String(s))){var n=bn(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Th(e,r,t){return{v:e,ixfe:r,t:t}}function Sh(e,r){var t,s,n,i,a,o,l,c,m={opts:{}},u={},d=r.dense?[]:{},f={},h={},p=null,g=[],b="",v={},N="",x={},y=[],E=[],w=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},_={},H=function(e){return e<8?Hl[e]:e<64&&w[e-8]||Hl[e]},T=function(e,r,s){if(!(O>1||s.sheetRows&&e.r>=s.sheetRows)){if(s.cellStyles&&r.XF&&r.XF.data&&function(e,r,t){var s,n=r.XF.data;n&&n.patternType&&t&&t.cellStyles&&(r.s={},r.s.patternType=n.patternType,(s=Ym(H(n.icvFore)))&&(r.s.fgColor={rgb:s}),(s=Ym(H(n.icvBack)))&&(r.s.bgColor={rgb:s}))}(0,r,s),delete r.ixfe,delete r.XF,t=e,N=Oo(e),h&&h.s&&h.e||(h={s:{r:0,c:0},e:{r:0,c:0}}),e.r<h.s.r&&(h.s.r=e.r),e.c<h.s.c&&(h.s.c=e.c),e.r+1>h.e.r&&(h.e.r=e.r+1),e.c+1>h.e.c&&(h.e.c=e.c+1),s.cellFormula&&r.f)for(var n=0;n<y.length;++n)if(!(y[n][0].s.c>e.c||y[n][0].s.r>e.r||y[n][0].e.c<e.c||y[n][0].e.r<e.r)){r.F=Lo(y[n][0]),y[n][0].s.c==e.c&&y[n][0].s.r==e.r||delete r.f,r.f&&(r.f=""+_d(y[n][1],0,e,A,S));break}s.dense?(d[e.r]||(d[e.r]=[]),d[e.r][e.c]=r):d[N]=r}},S={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(S.password=r.password);var j=[],k=[],V=[],C=[],R=!1,A=[];A.SheetNames=S.snames,A.sharedf=S.sharedf,A.arrayf=S.arrayf,A.names=[],A.XTI=[];var M,I=0,O=0,P=0,L=[],F=[];S.codepage=1200,Ms(1200);for(var U=!1;e.l<e.length-1;){var B=e.l,W=e.read_shift(2);if(0===W&&10===I)break;var z=e.l===e.length?0:e.read_shift(2),$=Mh[W];if($&&$.f){if(r.bookSheets&&133===I&&133!==W)break;if(I=W,2===$.r||12==$.r){var G=e.read_shift(2);if(z-=2,!S.enc&&G!==W&&((255&G)<<8|G>>8)!==W)throw new Error("rt mismatch: "+G+"!="+W);12==$.r&&(e.l+=10,z-=10)}var q={};if(q=10===W?$.f(e,z,S):_h(W,$,e,z,S),0==O&&-1===[9,521,1033,2057].indexOf(I))continue;switch(W){case 34:m.opts.Date1904=D.WBProps.date1904=q;break;case 134:m.opts.WriteProtect=!0;break;case 47:if(S.enc||(e.l=0),S.enc=q,!r.password)throw new Error("File is password-protected");if(null==q.valid)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:S.lastuser=q;break;case 66:var X=Number(q);switch(X){case 21010:X=1200;break;case 32768:X=1e4;break;case 32769:X=1252}Ms(S.codepage=X),U=!0;break;case 317:S.rrtabid=q;break;case 25:S.winlocked=q;break;case 439:m.opts.RefreshAll=q;break;case 12:m.opts.CalcCount=q;break;case 16:m.opts.CalcDelta=q;break;case 17:m.opts.CalcIter=q;break;case 13:m.opts.CalcMode=q;break;case 14:m.opts.CalcPrecision=q;break;case 95:m.opts.CalcSaveRecalc=q;break;case 15:S.CalcRefMode=q;break;case 2211:m.opts.FullCalc=q;break;case 129:q.fDialog&&(d["!type"]="dialog"),q.fBelow||((d["!outline"]||(d["!outline"]={})).above=!0),q.fRight||((d["!outline"]||(d["!outline"]={})).left=!0);break;case 224:E.push(q);break;case 430:A.push([q]),A[A.length-1].XTI=[];break;case 35:case 547:A[A.length-1].push(q);break;case 24:case 536:M={Name:q.Name,Ref:_d(q.rgce,0,null,A,S)},q.itab>0&&(M.Sheet=q.itab-1),A.names.push(M),A[0]||(A[0]=[],A[0].XTI=[]),A[A.length-1].push(q),"_xlnm._FilterDatabase"==q.Name&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&"PtgArea3d"==q.rgce[0][0][0]&&(F[q.itab-1]={ref:Lo(q.rgce[0][0][1][2])});break;case 22:S.ExternCount=q;break;case 23:0==A.length&&(A[0]=[],A[0].XTI=[]),A[A.length-1].XTI=A[A.length-1].XTI.concat(q),A.XTI=A.XTI.concat(q);break;case 2196:if(S.biff<8)break;null!=M&&(M.Comment=q[1]);break;case 18:d["!protect"]=q;break;case 19:0!==q&&S.WTF;break;case 133:f[q.pos]=q,S.snames.push(q.name);break;case 10:if(--O)break;if(h.e){if(h.e.r>0&&h.e.c>0){if(h.e.r--,h.e.c--,d["!ref"]=Lo(h),r.sheetRows&&r.sheetRows<=h.e.r){var Y=h.e.r;h.e.r=r.sheetRows-1,d["!fullref"]=d["!ref"],d["!ref"]=Lo(h),h.e.r=Y}h.e.r++,h.e.c++}j.length>0&&(d["!merges"]=j),k.length>0&&(d["!objects"]=k),V.length>0&&(d["!cols"]=V),C.length>0&&(d["!rows"]=C),D.Sheets.push(_)}""===b?v=d:u[b]=d,d=r.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===S.biff&&(S.biff={9:2,521:3,1033:4}[W]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),S.biffguess=0==q.BIFFVer,0==q.BIFFVer&&4096==q.dt&&(S.biff=5,U=!0,Ms(S.codepage=28591)),8==S.biff&&0==q.BIFFVer&&16==q.dt&&(S.biff=2),O++)break;if(d=r.dense?[]:{},S.biff<8&&!U&&(U=!0,Ms(S.codepage=r.codepage||1252)),S.biff<5||0==q.BIFFVer&&4096==q.dt){""===b&&(b="Sheet1"),h={s:{r:0,c:0},e:{r:0,c:0}};var K={pos:e.l-z,name:b};f[K.pos]=K,S.snames.push(b)}else b=(f[B]||{name:""}).name;32==q.dt&&(d["!type"]="chart"),64==q.dt&&(d["!type"]="macro"),j=[],k=[],S.arrayf=y=[],V=[],C=[],R=!1,_={Hidden:(f[B]||{hs:0}).hs,name:b};break;case 515:case 3:case 2:"chart"==d["!type"]&&(r.dense?(d[q.r]||[])[q.c]:d[Oo({c:q.c,r:q.r})])&&++q.c,o={ixfe:q.ixfe,XF:E[q.ixfe]||{},v:q.val,t:"n"},P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T({c:q.c,r:q.r},o,r);break;case 5:case 517:o={ixfe:q.ixfe,XF:E[q.ixfe],v:q.val,t:q.t},P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T({c:q.c,r:q.r},o,r);break;case 638:o={ixfe:q.ixfe,XF:E[q.ixfe],v:q.rknum,t:"n"},P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T({c:q.c,r:q.r},o,r);break;case 189:for(var J=q.c;J<=q.C;++J){var Q=q.rkrec[J-q.c][0];o={ixfe:Q,XF:E[Q],v:q.rkrec[J-q.c][1],t:"n"},P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T({c:J,r:q.r},o,r)}break;case 6:case 518:case 1030:if("String"==q.val){p=q;break}if((o=Th(q.val,q.cell.ixfe,q.tt)).XF=E[o.ixfe],r.cellFormula){var Z=q.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],re=Z[0][0][1][1],te=Oo({r:ee,c:re});x[te]?o.f=""+_d(q.formula,0,q.cell,A,S):o.F=((r.dense?(d[ee]||[])[re]:d[te])||{}).F}else o.f=""+_d(q.formula,0,q.cell,A,S)}P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T(q.cell,o,r),p=q;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=q,(o=Th(q,p.cell.ixfe,"s")).XF=E[o.ixfe],r.cellFormula&&(o.f=""+_d(p.formula,0,p.cell,A,S)),P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T(p.cell,o,r),p=null;break;case 33:case 545:y.push(q);var se=Oo(q[0].s);if(s=r.dense?(d[q[0].s.r]||[])[q[0].s.c]:d[se],r.cellFormula&&s){if(!p)break;if(!se||!s)break;s.f=""+_d(q[1],0,q[0],A,S),s.F=Lo(q[0])}break;case 1212:if(!r.cellFormula)break;if(N){if(!p)break;x[Oo(p.cell)]=q[0],((s=r.dense?(d[p.cell.r]||[])[p.cell.c]:d[Oo(p.cell)])||{}).f=""+_d(q[0],0,t,A,S)}break;case 253:o=Th(g[q.isst].t,q.ixfe,"s"),g[q.isst].h&&(o.h=g[q.isst].h),o.XF=E[o.ixfe],P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T({c:q.c,r:q.r},o,r);break;case 513:r.sheetStubs&&(o={ixfe:q.ixfe,XF:E[q.ixfe],t:"z"},P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T({c:q.c,r:q.r},o,r));break;case 190:if(r.sheetStubs)for(var ne=q.c;ne<=q.C;++ne){var ie=q.ixfe[ne-q.c];o={ixfe:ie,XF:E[ie],t:"z"},P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T({c:ne,r:q.r},o,r)}break;case 214:case 516:case 4:(o=Th(q.val,q.ixfe,"s")).XF=E[o.ixfe],P>0&&(o.z=L[o.ixfe>>8&63]),Hh(o,r,m.opts.Date1904),T({c:q.c,r:q.r},o,r);break;case 0:case 512:1===O&&(h=q);break;case 252:g=q;break;case 1054:if(4==S.biff){L[P++]=q[1];for(var ae=0;ae<P+163&&fn[ae]!=q[1];++ae);ae>=163&&Gn(q[1],P+163)}else Gn(q[1],q[0]);break;case 30:L[P++]=q;for(var oe=0;oe<P+163&&fn[oe]!=q;++oe);oe>=163&&Gn(q,P+163);break;case 229:j=j.concat(q);break;case 93:k[q.cmo[0]]=S.lastobj=q;break;case 438:S.lastobj.TxO=q;break;case 127:S.lastobj.ImData=q;break;case 440:for(a=q[0].s.r;a<=q[0].e.r;++a)for(i=q[0].s.c;i<=q[0].e.c;++i)(s=r.dense?(d[a]||[])[i]:d[Oo({c:i,r:a})])&&(s.l=q[1]);break;case 2048:for(a=q[0].s.r;a<=q[0].e.r;++a)for(i=q[0].s.c;i<=q[0].e.c;++i)(s=r.dense?(d[a]||[])[i]:d[Oo({c:i,r:a})])&&s.l&&(s.l.Tooltip=q[1]);break;case 28:if(S.biff<=5&&S.biff>=2)break;s=r.dense?(d[q[0].r]||[])[q[0].c]:d[Oo(q[0])];var le=k[q[2]];s||(r.dense?(d[q[0].r]||(d[q[0].r]=[]),s=d[q[0].r][q[0].c]={t:"z"}):s=d[Oo(q[0])]={t:"z"},h.e.r=Math.max(h.e.r,q[0].r),h.s.r=Math.min(h.s.r,q[0].r),h.e.c=Math.max(h.e.c,q[0].c),h.s.c=Math.min(h.s.c,q[0].c)),s.c||(s.c=[]),n={a:q[1],t:le.TxO.t},s.c.push(n);break;case 2173:Ou(E[q.ixfe],q.ext);break;case 125:if(!S.cellStyles)break;for(;q.e>=q.s;)V[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(1&q.flags)},R||(R=!0,tu(q.w/256)),su(V[q.e+1]);break;case 520:var ce={};null!=q.level&&(C[q.r]=ce,ce.level=q.level),q.hidden&&(C[q.r]=ce,ce.hidden=!0),q.hpt&&(C[q.r]=ce,ce.hpt=q.hpt,ce.hpx=au(q.hpt));break;case 38:case 39:case 40:case 41:d["!margins"]||qd(d["!margins"]={}),d["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[W]]=q;break;case 161:d["!margins"]||qd(d["!margins"]={}),d["!margins"].header=q.header,d["!margins"].footer=q.footer;break;case 574:q.RTL&&(D.Views[0].RTL=!0);break;case 146:w=q;break;case 2198:c=q;break;case 140:l=q;break;case 442:b?_.CodeName=q||_.name:D.WBProps.CodeName=q||"ThisWorkbook"}}else e.l+=z}return m.SheetNames=si(f).sort(function(e,r){return Number(e)-Number(r)}).map(function(e){return f[e].name}),r.bookSheets||(m.Sheets=u),!m.SheetNames.length&&v["!ref"]?(m.SheetNames.push("Sheet1"),m.Sheets&&(m.Sheets.Sheet1=v)):m.Preamble=v,m.Sheets&&F.forEach(function(e,r){m.Sheets[m.SheetNames[r]]["!autofilter"]=e}),m.Strings=g,m.SSF=Ni(fn),S.enc&&(m.Encryption=S.enc),c&&(m.Themes=c),m.Metadata={},void 0!==l&&(m.Metadata.Country=l),A.names.length>0&&(D.Names=A.names),m.Workbook=D,m}var jh="e0859ff2f94f6810ab9108002b27b3d9",kh="02d5cdd59c2e1b10939708002b2cf9ae",Vh="05d5cdd59c2e1b10939708002b2cf9ae";function Ch(e,r){var t,s,n,i;if(r||(r={}),Op(r),Is(),r.codepage&&As(r.codepage),e.FullPaths){if(Zn.find(e,"/encryption"))throw new Error("File is password-protected");t=Zn.find(e,"!CompObj"),s=Zn.find(e,"/Workbook")||Zn.find(e,"/Book")}else{switch(r.type){case"base64":e=Ks($s(e));break;case"binary":e=Ks(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Eo(e,0),s={content:e}}if(t&&wh(t),r.bookProps&&!r.bookSheets)n={};else{var a=Gs?"buffer":"array";if(s&&s.content)n=Sh(s.content,r);else if((i=Zn.find(e,"PerfectOffice_MAIN"))&&i.content)n=ym.to_workbook(i.content,(r.type=a,r));else{if(!(i=Zn.find(e,"NativeContent_MAIN"))||!i.content)throw(i=Zn.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n=ym.to_workbook(i.content,(r.type=a,r))}r.bookVBA&&e.FullPaths&&Zn.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=function(e){var r=Zn.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,s){if("/"!==t.slice(-1)&&t.match(/_VBA_PROJECT_CUR/)){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Zn.utils.cfb_add(r,n,e.FileIndex[s].content)}}),Zn.write(r)}(e))}var o={};return e.FullPaths&&function(e,r,t){var s=Zn.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=hc(s,yl,kh);for(var i in n)r[i]=n[i]}catch(c){if(t.WTF)throw c}var a=Zn.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=hc(a,El,jh);for(var l in o)null==r[l]&&(r[l]=o[l])}catch(c){if(t.WTF)throw c}r.HeadingPairs&&r.TitlesOfParts&&(ql(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}(e,o,r),n.Props=n.Custprops=o,r.bookFiles&&(n.cfb=e),n}function Rh(e,r){var t=r||{},s=Zn.utils.cfb_new({root:"R"}),n="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":n="/Workbook",t.biff=8;break;case"biff5":n="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Zn.utils.cfb_add(s,n,$h(e,t)),8==t.biff&&(e.Props||e.Custprops)&&function(e,r){var t,s=[],n=[],i=[],a=0,o=ni(yl,"n"),l=ni(El,"n");if(e.Props)for(t=si(e.Props),a=0;a<t.length;++a)(Object.prototype.hasOwnProperty.call(o,t[a])?s:Object.prototype.hasOwnProperty.call(l,t[a])?n:i).push([t[a],e.Props[t[a]]]);if(e.Custprops)for(t=si(e.Custprops),a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},t[a])||(Object.prototype.hasOwnProperty.call(o,t[a])?s:Object.prototype.hasOwnProperty.call(l,t[a])?n:i).push([t[a],e.Custprops[t[a]]]);var c=[];for(a=0;a<i.length;++a)uc.indexOf(i[a][0])>-1||Gl.indexOf(i[a][0])>-1||null!=i[a][1]&&c.push(i[a]);n.length&&Zn.utils.cfb_add(r,"/SummaryInformation",pc(n,jh,l,El)),(s.length||c.length)&&Zn.utils.cfb_add(r,"/DocumentSummaryInformation",pc(s,kh,o,yl,c.length?c:null,Vh))}(e,s),8==t.biff&&e.vbaraw&&function(e,r){r.FullPaths.forEach(function(t,s){if(0!=s){var n=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==n.slice(-1)&&Zn.utils.cfb_add(e,n,r.FileIndex[s].content)}})}(s,Zn.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),s}var Ah={0:{f:function(e,r){var t={},s=e.l+r;t.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=s,7&i&&(t.level=7&i),16&i&&(t.hidden=!0),32&i&&(t.hpt=n/20),t}},1:{f:function(e){return[Zo(e)]}},2:{f:function(e){return[Zo(e),ml(e),"n"]}},3:{f:function(e){return[Zo(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Zo(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Zo(e),pl(e),"n"]}},6:{f:function(e){return[Zo(e),qo(e),"str"]}},7:{f:function(e){return[Zo(e),e.read_shift(4),"s"]}},8:{f:function(e,r,t){var s=e.l+r,n=Zo(e);n.r=t["!row"];var i=[n,qo(e),"str"];if(t.cellFormula){e.l+=2;var a=Cd(e,s-e.l,t);i[3]=_d(a,0,n,t.supbooks,t)}else e.l=s;return i}},9:{f:function(e,r,t){var s=e.l+r,n=Zo(e);n.r=t["!row"];var i=[n,pl(e),"n"];if(t.cellFormula){e.l+=2;var a=Cd(e,s-e.l,t);i[3]=_d(a,0,n,t.supbooks,t)}else e.l=s;return i}},10:{f:function(e,r,t){var s=e.l+r,n=Zo(e);n.r=t["!row"];var i=[n,e.read_shift(1),"b"];if(t.cellFormula){e.l+=2;var a=Cd(e,s-e.l,t);i[3]=_d(a,0,n,t.supbooks,t)}else e.l=s;return i}},11:{f:function(e,r,t){var s=e.l+r,n=Zo(e);n.r=t["!row"];var i=[n,e.read_shift(1),"e"];if(t.cellFormula){e.l+=2;var a=Cd(e,s-e.l,t);i[3]=_d(a,0,n,t.supbooks,t)}else e.l=s;return i}},12:{f:function(e){return[rl(e)]}},13:{f:function(e){return[rl(e),ml(e),"n"]}},14:{f:function(e){return[rl(e),e.read_shift(1),"e"]}},15:{f:function(e){return[rl(e),e.read_shift(1),"b"]}},16:{f:Nf},17:{f:function(e){return[rl(e),qo(e),"str"]}},18:{f:function(e){return[rl(e),e.read_shift(4),"s"]}},19:{f:Ko},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,r,t){var s=e.l+r;e.l+=4,e.l+=1;var n=e.read_shift(4),i=ol(e),a=Rd(e,0,t),o=il(e);e.l=s;var l={Name:i,Ptg:a};return n<268435455&&(l.Sheet=n),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,r,t){var s={};s.sz=e.read_shift(2)/20;var n=function(e){var r=e.read_shift(1);return e.l++,{fBold:1&r,fItalic:2&r,fUnderline:4&r,fStrikeout:8&r,fOutline:16&r,fShadow:32&r,fCondense:64&r,fExtend:128&r}}(e);switch(n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1),700===e.read_shift(2)&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(s.underline=i);var a=e.read_shift(1);a>0&&(s.family=a);var o=e.read_shift(1);switch(o>0&&(s.charset=o),e.l++,s.color=function(e){var r={},t=e.read_shift(1)>>>1,s=e.read_shift(1),n=e.read_shift(2,"i"),i=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(1);switch(e.l++,t){case 0:r.auto=1;break;case 1:r.index=s;var l=Hl[s];l&&(r.rgb=Ym(l));break;case 2:r.rgb=Ym([i,a,o]);break;case 3:r.theme=s}return 0!=n&&(r.tint=n>0?n/32767:n/32768),r}(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor"}return s.name=qo(e),s}},44:{f:function(e,r){return[e.read_shift(2),qo(e)]}},45:{f:gu},46:{f:xu},47:{f:function(e,r){var t=e.l+r,s=e.read_shift(2),n=e.read_shift(2);return e.l=t,{ixfe:s,numFmtId:n}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:um},62:{f:function(e){return[Zo(e),Ko(e),"is"]}},63:{f:function(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=Oo(t);var s=e.read_shift(1);return 2&s&&(r.l="1"),8&s&&(r.a="1"),r}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:wo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var r=e.read_shift(2);return e.l+=28,{RTL:32&r}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,r){var t={},s=e[e.l];return++e.l,t.above=!(64&s),t.left=!(128&s),e.l+=18,t.name=sl(e),t}},148:{f:bf,p:16},151:{f:function(){}},152:{},153:{f:function(e,r){var t={},s=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var n=r>8?qo(e):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(65536&s),t.backupFile=!!(64&s),t.checkCompatibility=!!(4096&s),t.date1904=!!(1&s),t.filterPrivacy=!!(8&s),t.hidePivotFieldList=!!(1024&s),t.promptedSolutions=!!(16&s),t.publishItems=!!(2048&s),t.refreshAllConnections=!!(262144&s),t.saveExternalLinkValues=!!(128&s),t.showBorderUnselectedTables=!!(4&s),t.showInkAnnotation=!!(32&s),t.showObjects=["all","placeholders","none"][s>>13&3],t.showPivotChartFilter=!!(32768&s),t.updateLinks=["userSet","never","always"][s>>8&3],t}},154:{},155:{},156:{f:function(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=ll(e),t.name=qo(e),t}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:fl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:xf},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:qo(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ll},357:{},358:{},359:{},360:{T:1},361:{},362:{f:am},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,r,t){var s=e.l+r,n=dl(e),i=e.read_shift(1),a=[n];if(a[2]=i,t.cellFormula){var o=Vd(e,s-e.l,t);a[1]=o}else e.l=s;return a}},427:{f:function(e,r,t){var s=e.l+r,n=[fl(e)];if(t.cellFormula){var i=Ad(e,s-e.l,t);n[1]=i,e.l=s}else e.l=s;return n}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var r={};return Ef.forEach(function(t){r[t]=pl(e)}),r}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,r){var t=e.l+r,s=fl(e),n=il(e),i=qo(e),a=qo(e),o=qo(e);e.l=t;var l={rfx:s,relId:n,loc:i,display:o};return a&&(l.Tooltip=a),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ll},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$u},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var r={};r.iauthor=e.read_shift(4);var t=fl(e);return r.rfx=t.s,r.ref=Oo(t.s),e.l+=16,r}},636:{T:-1},637:{f:Jo},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,r){return e.l+=10,{name:qo(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mh={6:{f:Sd},10:{f:gc},12:{f:Nc},13:{f:Nc},14:{f:bc},15:{f:bc},16:{f:pl},17:{f:bc},18:{f:bc},19:{f:Nc},20:{f:tm},21:{f:tm},23:{f:am},24:{f:im},25:{f:bc},26:{},27:{},28:{f:function(e,r,t){return function(e,r,t){if(!(t.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),o=Sc(e,0,t);return t.biff<8&&e.read_shift(1),[{r:s,c:n},o,a,i]}}(e,0,t)}},29:{},34:{f:bc},35:{f:sm},38:{f:pl},39:{f:pl},40:{f:pl},41:{f:pl},42:{f:bc},43:{f:bc},47:{f:function(e,r,t){var s={Type:t.biff>=8?e.read_shift(2):0};return s.Type?qm(e,r-2,s):function(e,r,t,s){var n={key:Nc(e),verificationBytes:Nc(e)};t.password&&(n.verifier=zm(t.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=Gm(t.password))}(e,t.biff,t,s),s}},49:{f:function(e,r,t){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return s.name=wc(e,0,t),s}},51:{f:Nc},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:bc},65:{f:function(){}},66:{f:Nc},77:{},80:{},81:{},82:{},85:{f:Nc},89:{},90:{},91:{},92:{f:function(e,r,t){if(t.enc)return e.l+=r,"";var s=e.l,n=Sc(e,0,t);return e.read_shift(r+s-e.l),n}},93:{f:function(e,r,t){if(t&&t.biff<8)return function(e,r,t){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var a=[];return a.push((lm[s]||wo)(e,r,t)),{cmo:[n,s,i],ft:a}}(e,r,t);var s=zc(e),n=function(e,r){for(var t=e.l+r,s=[];e.l<t;){var n=e.read_shift(2);e.l-=2;try{s.push(Gc[n](e,t-e.l))}catch(i){return e.l=t,s}}return e.l!=t&&(e.l=t),s}(e,r-22,s[1]);return{cmo:s,ft:n}}},94:{},95:{f:bc},96:{},97:{},99:{f:bc},125:{f:um},128:{f:function(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(0!==r[0]&&r[0]--,0!==r[1]&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}},129:{f:function(e,r,t){var s=t&&8==t.biff||2==r?e.read_shift(2):(e.l+=r,0);return{fDialog:16&s,fBelow:64&s,fRight:128&s}}},130:{f:Nc},131:{f:bc},132:{f:bc},133:{f:function(e,r,t){var s=e.read_shift(4),n=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var a=wc(e,0,t);return 0===a.length&&(a="Sheet1"),{pos:s,hs:n,dt:i,name:a}}},134:{},140:{f:function(e){var r,t=[0,0];return r=e.read_shift(2),t[0]=wl[r]||r,r=e.read_shift(2),t[1]=wl[r]||r,t}},141:{f:Nc},144:{},146:{f:function(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Mc(e));return t}},151:{},152:{},153:{},154:{},155:{},156:{f:Nc},157:{},158:{},160:{f:fm},161:{f:function(e,r){var t={};return r<32||(e.l+=16,t.header=pl(e),t.footer=pl(e),e.l+=2),t}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,r){for(var t=e.l+r-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<t;)i.push(Lc(e));if(e.l!==t)throw new Error("MulRK read error");var a=e.read_shift(2);if(i.length!=a-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:a,rkrec:i}}},190:{f:function(e,r){for(var t=e.l+r-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<t;)i.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var a=e.read_shift(2);if(i.length!=a-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:a,ixfe:i}}},193:{f:gc},197:{},198:{},199:{},200:{},201:{},202:{f:bc},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Nc},220:{},221:{f:bc},222:{},224:{f:function(e,r,t){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,s.data=function(e,r,t,s){var n={},i=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return n.patternType=Dl[o>>26],s.cellStyles?(n.alc=7&i,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=15&a,n.dgRight=a>>4&15,n.dgTop=a>>8&15,n.dgBottom=a>>12&15,n.icvLeft=a>>16&127,n.icvRight=a>>23&127,n.grbitDiag=a>>30&3,n.icvTop=127&o,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=127&l,n.icvBack=l>>7&127,n.fsxButton=l>>14&1,n):n}(e,0,s.fStyle,t),s}},225:{f:function(e,r){return 0===r||e.read_shift(2),1200}},226:{f:gc},227:{},229:{f:function(e,r){for(var t=[],s=e.read_shift(2);s--;)t.push(Fc(e));return t}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,r){for(var t=e.l+r,s=e.read_shift(4),n=e.read_shift(4),i=[],a=0;a!=n&&e.l<t;++a)i.push(Dc(e));return i.Count=s,i.Unique=n,i}},253:{f:function(e){var r=Ic(e);return r.isst=e.read_shift(4),r}},255:{f:function(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:yc},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:bc},353:{f:gc},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,r,t){var s=e.l+r,n=e.read_shift(2),i=e.read_shift(2);if(t.sbcch=i,1025==i||14849==i)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=Hc(e,i),o=[];s>e.l;)o.push(Tc(e));return[i,n,a,o]}},431:{f:bc},432:{},433:{},434:{},437:{},438:{f:function(e,r,t){var s=e.l,n="";try{e.l+=4;var i=(t.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:function(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}(e);var a=e.read_shift(2);e.read_shift(2),Nc(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-s!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((n+=Hc(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?a:2*a))break}if(n.length!==a&&n.length!==2*a)throw new Error("cchText: "+a+" != "+n.length);return e.l=s+r,{t:n}}catch(m){return e.l=s+r,{t:n}}}},439:{f:bc},440:{f:function(e,r){var t=Fc(e);e.l+=16;var s=function(e,r){var t=e.l+r,s=e.read_shift(4);if(2!==s)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var i,a,o,l,c,m,u="";16&n&&(i=Vc(e,e.l)),128&n&&(a=Vc(e,e.l)),257&~n||(o=Vc(e,e.l)),1==(257&n)&&(l=kc(e,e.l)),8&n&&(u=Vc(e,e.l)),32&n&&(c=e.read_shift(16)),64&n&&(m=ec(e)),e.l=t;var d=a||o||l||"";d&&u&&(d+="#"+u),d||(d="#"+u),2&n&&"/"==d.charAt(0)&&"/"!=d.charAt(1)&&(d="file://"+d);var f={Target:d};return c&&(f.guid=c),m&&(f.time=m),i&&(f.Tooltip=i),f}(e,r-24);return[t,s]}},441:{},442:{f:Tc},443:{},444:{f:Nc},445:{},446:{},448:{f:gc},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:gc},512:{f:Zc},513:{f:dm},515:{f:function(e,r,t){t.biffguess&&2==t.biff&&(t.biff=5);var s=Ic(e),n=pl(e);return s.val=n,s}},516:{f:function(e,r,t){t.biffguess&&2==t.biff&&(t.biff=5),e.l;var s=Ic(e);2==t.biff&&e.l++;var n=Tc(e,e.l,t);return s.val=n,s}},517:{f:rm},519:{f:hm},520:{f:function(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,7&s&&(r.level=7&s),32&s&&(r.hidden=!0),64&s&&(r.hpt=t/20),r}},523:{},545:{f:om},549:{f:Kc},566:{},574:{f:function(e,r,t){return t&&t.biff>=2&&t.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var r=e.read_shift(2),t=e.read_shift(2),s=Lc(e);return{r:r,c:t,ixfe:s[0],rknum:s[1]}}},659:{},1048:{},1054:{f:function(e,r,t){return[e.read_shift(2),Sc(e,0,t)]}},1084:{},1212:{f:function(e,r,t){var s=Bc(e);e.l++;var n=e.read_shift(1);return[Td(e,r-=8,t),n,s]}},2048:{f:function(e,r){e.read_shift(2);var t=Fc(e),s=e.read_shift((r-10)/2,"dbcs-cont");return[t,s=s.replace(rn,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gc},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r},r:12},2173:{f:function(e,r){e.l,e.l+=2;var t=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),n=[];s-- >0;)n.push(Iu(e,e.l));return{ixfe:t,ext:n}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:bc,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,r,t){if(!(t.biff<8)){var s=e.read_shift(2),n=e.read_shift(2);return[Hc(e,s,t),Hc(e,n,t)]}e.l+=r},r:12},2197:{},2198:{f:function(e,r,t){var s=e.l+r;if(124226!==e.read_shift(4))if(t.cellStyles){var n,i=e.slice(e.l);e.l=s;try{n=Ai(i,{type:"array"})}catch(o){return}var a=ki(n,"theme/theme/theme1.xml",!0);if(a)return Ru(a,t)}else e.l=s},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:gc},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var r=function(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}(e);if(2211!=r.type)throw new Error("Invalid Future Record "+r.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Nc},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,r,t){var s={area:!1};if(5!=t.biff)return e.l+=r,s;var n=e.read_shift(1);return e.l+=3,16&n&&(s.area=!0),s}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(Mc(e));return t}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Zc},1:{},2:{f:function(e){var r=Ic(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}},3:{f:function(e){var r=Ic(e);++e.l;var t=pl(e);return r.t="n",r.val=t,r}},4:{f:function(e,r,t){t.biffguess&&5==t.biff&&(t.biff=2);var s=Ic(e);++e.l;var n=Sc(e,0,t);return s.t="str",s.val=n,s}},5:{f:rm},7:{f:function(e){var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,"sbcs-cont")}},8:{},9:{f:qc},11:{},22:{f:Nc},30:{f:Qc},31:{},32:{},33:{f:om},36:{},37:{f:Kc},50:{f:function(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}},62:{},52:{},67:{},68:{f:Nc},69:{},86:{},126:{},127:{f:function(e){var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(4),n={fmt:r,env:t,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,r,t){var s=e.l+r,n=Ic(e),i=e.read_shift(2),a=Hc(e,i,t);return e.l=s,n.t="str",n.val=a,n}},223:{},234:{},354:{},421:{},518:{f:Sd},521:{f:qc},536:{f:im},547:{f:sm},561:{},579:{},1030:{f:Sd},1033:{f:qc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ih(e,r,t,s){var n=r;if(!isNaN(n)){var i=s||(t||[]).length||0,a=e.next(4);a.write_shift(2,n),a.write_shift(2,i),i>0&&oo(t)&&e.push(t)}}function Oh(e,r,t){return e||(e=Do(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function Ph(e,r,t,s){if(null!=r.v)switch(r.t){case"d":case"n":var n="d"==r.t?li(bi(r.v)):r.v;return void(n==(0|n)&&n>=0&&n<65536?Ih(e,2,(i=t,a=s,o=n,l=Do(9),Oh(l,i,a),l.write_shift(2,o),l)):Ih(e,3,function(e,r,t){var s=Do(15);return Oh(s,e,r),s.write_shift(8,t,"f"),s}(t,s,n)));case"b":case"e":return void Ih(e,5,function(e,r,t,s){var n=Do(9);return Oh(n,e,r),Ec(t,s||"b",n),n}(t,s,r.v,r.t));case"s":case"str":return void Ih(e,4,function(e,r,t){var s=Do(8+2*t.length);return Oh(s,e,r),s.write_shift(1,t.length),s.write_shift(t.length,t,"sbcs"),s.l<s.length?s.slice(0,s.l):s}(t,s,(r.v||"").slice(0,255)))}var i,a,o,l;Ih(e,1,Oh(null,t,s))}function Lh(e,r){for(var t=r||{},s=Ho(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==t.sheet&&(n=i);if(0==n&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ih(s,4==t.biff?1033:3==t.biff?521:9,Xc(0,16,t)),function(e,r,t,s){var n,i=Array.isArray(r),a=Fo(r["!ref"]||"A1"),o="",l=[];if(a.e.c>255||a.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),n=Lo(a)}for(var c=a.s.r;c<=a.e.r;++c){o=Ro(c);for(var m=a.s.c;m<=a.e.c;++m){c===a.s.r&&(l[m]=Mo(m)),n=l[m]+o;var u=i?(r[c]||[])[m]:r[n];u&&Ph(e,u,c,m)}}}(s,e.Sheets[e.SheetNames[n]],0,t),Ih(s,10),s.end()}function Fh(e,r,t){Ih(e,49,function(e,r){var t=e.name||"Arial",s=r&&5==r.biff,n=Do(s?15+t.length:16+2*t.length);return n.write_shift(2,20*e.sz),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le"),n}({sz:12,name:"Arial"},t))}function Uh(e,r){if(r){var t=0;r.forEach(function(r,s){++t<=256&&r&&Ih(e,125,function(e,r){var t=Do(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,256*e.width),t.write_shift(2,0);var s=0;return e.hidden&&(s|=1),t.write_shift(1,s),s=e.level||0,t.write_shift(1,s),t.write_shift(2,0),t}(Gd(s,r),s))})}}function Bh(e,r,t,s,n){var i=16+Xd(n.cellXfs,r,n);if(null!=r.v||r.bf)if(r.bf)Ih(e,6,jd(r,t,s,0,i));else switch(r.t){case"d":case"n":Ih(e,515,function(e,r,t,s){var n=Do(14);return Oc(e,r,s,n),gl(t,n),n}(t,s,"d"==r.t?li(bi(r.v)):r.v,i));break;case"b":case"e":Ih(e,517,function(e,r,t,s,n,i){var a=Do(8);return Oc(e,r,s,a),Ec(t,i,a),a}(t,s,r.v,i,0,r.t));break;case"s":case"str":if(n.bookSST)Ih(e,253,function(e,r,t,s){var n=Do(10);return Oc(e,r,s,n),n.write_shift(4,t),n}(t,s,$d(n.Strings,r.v,n.revStrings),i));else Ih(e,516,function(e,r,t,s,n){var i=!n||8==n.biff,a=Do(+i+8+(1+i)*t.length);return Oc(e,r,s,a),a.write_shift(2,t.length),i&&a.write_shift(1,1),a.write_shift((1+i)*t.length,t,i?"utf16le":"sbcs"),a}(t,s,(r.v||"").slice(0,255),i,n));break;default:Ih(e,513,Oc(t,s,i))}else Ih(e,513,Oc(t,s,i))}function Wh(e,r,t){var s,n,i=Ho(),a=t.SheetNames[e],o=t.Sheets[a]||{},l=(t||{}).Workbook||{},c=(l.Sheets||[])[e]||{},m=Array.isArray(o),u=8==r.biff,d="",f=[],h=Fo(o["!ref"]||"A1"),p=u?65536:16384;if(h.e.c>255||h.e.r>=p){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,p-1)}Ih(i,2057,Xc(0,16,r)),Ih(i,13,xc(1)),Ih(i,12,xc(100)),Ih(i,15,vc(!0)),Ih(i,17,vc(!1)),Ih(i,16,gl(.001)),Ih(i,95,vc(!0)),Ih(i,42,vc(!1)),Ih(i,43,vc(!1)),Ih(i,130,xc(1)),Ih(i,128,((n=Do(8)).write_shift(4,0),n.write_shift(2,0),n.write_shift(2,0),n)),Ih(i,131,vc(!1)),Ih(i,132,vc(!1)),u&&Uh(i,o["!cols"]),Ih(i,512,function(e,r){var t=8!=r.biff&&r.biff?2:4,s=Do(2*t+6);return s.write_shift(t,e.s.r),s.write_shift(t,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}(h,r)),u&&(o["!links"]=[]);for(var g=h.s.r;g<=h.e.r;++g){d=Ro(g);for(var b=h.s.c;b<=h.e.c;++b){g===h.s.r&&(f[b]=Mo(b)),s=f[b]+d;var v=m?(o[g]||[])[b]:o[s];v&&(Bh(i,v,g,b,r),u&&v.l&&o["!links"].push([s,v.l]))}}var N=c.CodeName||c.name||a;return u&&Ih(i,574,function(e){var r=Do(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}((l.Views||[])[0])),u&&(o["!merges"]||[]).length&&Ih(i,229,function(e){var r=Do(2+8*e.length);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)Uc(e[t],r);return r}(o["!merges"])),u&&function(e,r){for(var t=0;t<r["!links"].length;++t){var s=r["!links"][t];Ih(e,440,cm(s)),s[1].Tooltip&&Ih(e,2048,mm(s))}delete r["!links"]}(i,o),Ih(i,442,jc(N)),u&&function(e,r){var t=Do(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ih(e,2151,t),(t=Do(39)).write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Uc(Fo(r["!ref"]||"A1"),t),t.write_shift(4,4),Ih(e,2152,t)}(i,o),Ih(i,10),i.end()}function zh(e,r,t){var s,n=Ho(),i=(e||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},l=8==t.biff,c=5==t.biff;(Ih(n,2057,Xc(0,5,t)),"xla"==t.bookType&&Ih(n,135),Ih(n,225,l?xc(1200):null),Ih(n,193,function(e,r){r||(r=Do(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}(2)),c&&Ih(n,191),c&&Ih(n,192),Ih(n,226),Ih(n,92,function(e,r){var t=!r||8==r.biff,s=Do(t?112:54);for(s.write_shift(8==r.biff?2:1,7),t&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(t?0:536870912));s.l<s.length;)s.write_shift(1,t?0:32);return s}(0,t)),Ih(n,66,xc(l?1200:1252)),l&&Ih(n,353,xc(0)),l&&Ih(n,448),Ih(n,317,function(e){for(var r=Do(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}(e.SheetNames.length)),l&&e.vbaraw&&Ih(n,211),l&&e.vbaraw)&&Ih(n,442,jc(o.CodeName||"ThisWorkbook"));Ih(n,156,xc(17)),Ih(n,25,vc(!1)),Ih(n,18,vc(!1)),Ih(n,19,xc(0)),l&&Ih(n,431,vc(!1)),l&&Ih(n,444,xc(0)),Ih(n,61,((s=Do(18)).write_shift(2,0),s.write_shift(2,0),s.write_shift(2,29280),s.write_shift(2,17600),s.write_shift(2,56),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,1),s.write_shift(2,500),s)),Ih(n,64,vc(!1)),Ih(n,141,xc(0)),Ih(n,34,vc("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&ea(e.Workbook.WBProps.date1904)?"true":"false"}(e))),Ih(n,14,vc(!0)),l&&Ih(n,439,vc(!1)),Ih(n,218,xc(0)),Fh(n,0,t),function(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)null!=r[n]&&Ih(e,1054,Jc(n,r[n],t))})}(n,e.SSF,t),function(e,r){for(var t=0;t<16;++t)Ih(e,224,em({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(t){Ih(e,224,em(t,0,r))})}(n,t),l&&Ih(n,352,vc(!1));var m=n.end(),u=Ho();l&&Ih(u,140,function(e){return e||(e=Do(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),l&&t.Strings&&function(e,r,t){var s=(t||[]).length||0;if(s<=8224)return Ih(e,r,t,s);var n=r;if(!isNaN(n)){for(var i=t.parts||[],a=0,o=0,l=0;l+(i[a]||8224)<=8224;)l+=i[a]||8224,a++;var c=e.next(4);for(c.write_shift(2,n),c.write_shift(2,l),e.push(t.slice(o,o+l)),o+=l;o<s;){for((c=e.next(4)).write_shift(2,60),l=0;l+(i[a]||8224)<=8224;)l+=i[a]||8224,a++;c.write_shift(2,l),e.push(t.slice(o,o+l)),o+=l}}}(u,252,function(e){var r=Do(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var t=[],s=0;s<e.length;++s)t[s]=_c(e[s]);var n=en([r].concat(t));return n.parts=[r.length].concat(t.map(function(e){return e.length})),n}(t.Strings)),Ih(u,10);var d=u.end(),f=Ho(),h=0,p=0;for(p=0;p<e.SheetNames.length;++p)h+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var g=m.length+h+d.length;for(p=0;p<e.SheetNames.length;++p){Ih(f,133,Yc({pos:g,hs:(a[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},t)),g+=r[p].length}var b=f.end();if(h!=b.length)throw new Error("BS8 "+h+" != "+b.length);var v=[];return m.length&&v.push(m),b.length&&v.push(b),d.length&&v.push(d),en(v)}function $h(e,r){for(var t=0;t<=e.SheetNames.length;++t){var s=e.Sheets[e.SheetNames[t]];if(s&&s["!ref"])Po(s["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error}var n=r||{};switch(n.biff||2){case 8:case 5:return function(e,r){var t=r||{},s=[];e&&!e.SSF&&(e.SSF=Ni(fn)),e&&e.SSF&&(Xn(),qn(e.SSF),t.revssf=ai(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Pp(t),t.cellXfs=[],Xd(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=Wh(n,t,e);return s.unshift(zh(e,s,t)),en(s)}(e,r);case 4:case 3:case 2:return Lh(e,r)}throw new Error("invalid type "+n.bookType+" for BIFF")}function Gh(e,r){var t=r||{},s=t.dense?[]:{},n=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),a=n.index,o=i&&i.index||e.length,l=Di(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,m=0,u=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},h=[];for(a=0;a<l.length;++a){var p=l[a].trim(),g=p.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var b=p.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var v=b[o].trim();if(v.match(/<t[dh]/i)){for(var N=v,x=0;"<"==N.charAt(0)&&(x=N.indexOf(">"))>-1;)N=N.slice(x+1);for(var y=0;y<h.length;++y){var E=h[y];E.s.c==m&&E.s.r<c&&c<=E.e.r&&(m=E.e.c+1,y=-1)}var w=Bi(v.slice(0,v.indexOf(">")));d=w.colspan?+w.colspan:1,((u=+w.rowspan)>1||d>1)&&h.push({s:{r:c,c:m},e:{r:c+(u||1)-1,c:m+d-1}});var D=w.t||w["data-t"]||"";if(N.length)if(N=la(N),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>m&&(f.s.c=m),f.e.c<m&&(f.e.c=m),N.length){var _={t:"s",v:N};t.raw||!N.trim().length||"s"==D||("TRUE"===N?_={t:"b",v:!0}:"FALSE"===N?_={t:"b",v:!1}:isNaN(yi(N))?isNaN(wi(N).getDate())||(_={t:"d",v:bi(N)},t.cellDates||(_={t:"n",v:li(_.v)}),_.z=t.dateNF||fn[14]):_={t:"n",v:yi(N)}),t.dense?(s[c]||(s[c]=[]),s[c][m]=_):s[Oo({r:c,c:m})]=_,m+=d}else m+=d;else m+=d}}}}else{if(++c,t.sheetRows&&t.sheetRows<=c){--c;break}m=0}}return s["!ref"]=Lo(f),h.length&&(s["!merges"]=h),s}function qh(e,r,t,s){for(var n=e["!merges"]||[],i=[],a=r.s.c;a<=r.e.c;++a){for(var o=0,l=0,c=0;c<n.length;++c)if(!(n[c].s.r>t||n[c].s.c>a||n[c].e.r<t||n[c].e.c<a)){if(n[c].s.r<t||n[c].s.c<a){o=-1;break}o=n[c].e.r-n[c].s.r+1,l=n[c].e.c-n[c].s.c+1;break}if(!(o<0)){var m=Oo({r:t,c:a}),u=s.dense?(e[t]||[])[a]:e[m],d=u&&null!=u.v&&(u.h||Qi(u.w||(Bo(u),u.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),s.editable?d='<span contenteditable="true">'+d+"</span>":u&&(f["data-t"]=u&&u.t||"z",null!=u.v&&(f["data-v"]=u.v),null!=u.z&&(f["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(d='<a href="'+u.l.Target+'">'+d+"</a>")),f.id=(s.id||"sjs")+"-"+m,i.push(ga("td",d,f))}}return"<tr>"+i.join("")+"</tr>"}var Xh='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Yh="</body></html>";function Kh(e,r,t){return[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Jh(e,r){var t=r||{},s=null!=t.header?t.header:Xh,n=null!=t.footer?t.footer:Yh,i=[s],a=Po(e["!ref"]);t.dense=Array.isArray(e),i.push(Kh(0,0,t));for(var o=a.s.r;o<=a.e.r;++o)i.push(qh(e,a,o,t));return i.push("</table>"+n),i.join("")}function Qh(e,r,t){var s=t||{},n=0,i=0;if(null!=s.origin)if("number"==typeof s.origin)n=s.origin;else{var a="string"==typeof s.origin?Io(s.origin):s.origin;n=a.r,i=a.c}var o=r.getElementsByTagName("tr"),l=Math.min(s.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var m=Po(e["!ref"]);c.s.r=Math.min(c.s.r,m.s.r),c.s.c=Math.min(c.s.c,m.s.c),c.e.r=Math.max(c.e.r,m.e.r),c.e.c=Math.max(c.e.c,m.e.c),-1==n&&(c.e.r=n=m.e.r+1)}var u=[],d=0,f=e["!rows"]||(e["!rows"]=[]),h=0,p=0,g=0,b=0,v=0,N=0;for(e["!cols"]||(e["!cols"]=[]);h<o.length&&p<l;++h){var x=o[h];if(ep(x)){if(s.display)continue;f[p]={hidden:!0}}var y=x.children;for(g=b=0;g<y.length;++g){var E=y[g];if(!s.display||!ep(E)){var w=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):la(E.innerHTML),D=E.getAttribute("data-z")||E.getAttribute("z");for(d=0;d<u.length;++d){var _=u[d];_.s.c==b+i&&_.s.r<p+n&&p+n<=_.e.r&&(b=_.e.c+1-i,d=-1)}N=+E.getAttribute("colspan")||1,((v=+E.getAttribute("rowspan")||1)>1||N>1)&&u.push({s:{r:p+n,c:b+i},e:{r:p+n+(v||1)-1,c:b+i+(N||1)-1}});var H={t:"s",v:w},T=E.getAttribute("data-t")||E.getAttribute("t")||"";null!=w&&(0==w.length?H.t=T||"z":s.raw||0==w.trim().length||"s"==T||("TRUE"===w?H={t:"b",v:!0}:"FALSE"===w?H={t:"b",v:!1}:isNaN(yi(w))?isNaN(wi(w).getDate())||(H={t:"d",v:bi(w)},s.cellDates||(H={t:"n",v:li(H.v)}),H.z=s.dateNF||fn[14]):H={t:"n",v:yi(w)})),void 0===H.z&&null!=D&&(H.z=D);var S="",j=E.getElementsByTagName("A");if(j&&j.length)for(var k=0;k<j.length&&(!j[k].hasAttribute("href")||"#"==(S=j[k].getAttribute("href")).charAt(0));++k);S&&"#"!=S.charAt(0)&&(H.l={Target:S}),s.dense?(e[p+n]||(e[p+n]=[]),e[p+n][b+i]=H):e[Oo({c:b+i,r:p+n})]=H,c.e.c<b+i&&(c.e.c=b+i),b+=N}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+n),e["!ref"]=Lo(c),p>=l&&(e["!fullref"]=Lo((c.e.r=o.length-h+p-1+n,c))),e}function Zh(e,r){return Qh((r||{}).dense?[]:{},e,r)}function ep(e){var r="",t=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),"none"===r}function rp(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,r){return Array(parseInt(r,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Gi(r.replace(/<[^>]*>/g,""))]}var tp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function sp(e,r){var t,s,n,i,a,o,l=r||{},c=va(e),m=[],u={name:""},d="",f=0,h={},p=[],g=l.dense?[]:{},b={value:""},v="",N=0,x=[],y=-1,E=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,_={},H=[],T={},S=[],j=1,k=1,V=[],C={Names:[]},R={},A=["",""],M=[],I={},O="",P=0,L=!1,F=!1,U=0;for(Na.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");a=Na.exec(c);)switch(a[3]=a[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===a[1]?(w.e.c>=w.s.c&&w.e.r>=w.s.r?g["!ref"]=Lo(w):g["!ref"]="A1:A1",l.sheetRows>0&&l.sheetRows<=w.e.r&&(g["!fullref"]=g["!ref"],w.e.r=l.sheetRows-1,g["!ref"]=Lo(w)),H.length&&(g["!merges"]=H),S.length&&(g["!rows"]=S),n.name=n["名称"]||n.name,"undefined"!=typeof JSON&&JSON.stringify(n),p.push(n.name),h[n.name]=g,F=!1):"/"!==a[0].charAt(a[0].length-2)&&(n=Bi(a[0],!1),y=E=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,g=l.dense?[]:{},H=[],S=[],F=!0);break;case"table-row-group":"/"===a[1]?--D:++D;break;case"table-row":case"行":if("/"===a[1]){y+=j,j=1;break}if((i=Bi(a[0],!1))["行号"]?y=i["行号"]-1:-1==y&&(y=0),(j=+i["number-rows-repeated"]||1)<10)for(U=0;U<j;++U)D>0&&(S[y+U]={level:D});E=-1;break;case"covered-table-cell":"/"!==a[1]&&++E,l.sheetStubs&&(l.dense?(g[y]||(g[y]=[]),g[y][E]={t:"z"}):g[Oo({r:y,c:E})]={t:"z"}),v="",x=[];break;case"table-cell":case"数据":if("/"===a[0].charAt(a[0].length-2))++E,b=Bi(a[0],!1),k=parseInt(b["number-columns-repeated"]||"1",10),o={t:"z",v:null},b.formula&&0!=l.cellFormula&&(o.f=Pd(Gi(b.formula))),"string"==(b["数据类型"]||b["value-type"])&&(o.t="s",o.v=Gi(b["string-value"]||""),l.dense?(g[y]||(g[y]=[]),g[y][E]=o):g[Oo({r:y,c:E})]=o),E+=k-1;else if("/"!==a[1]){v="",N=0,x=[],k=1;var B=j?y+j-1:y;if(++E>w.e.c&&(w.e.c=E),E<w.s.c&&(w.s.c=E),y<w.s.r&&(w.s.r=y),B>w.e.r&&(w.e.r=B),M=[],I={},o={t:(b=Bi(a[0],!1))["数据类型"]||b["value-type"],v:null},l.cellFormula)if(b.formula&&(b.formula=Gi(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(T={s:{r:y,c:E},e:{r:y+(parseInt(b["number-matrix-rows-spanned"],10)||0)-1,c:E+(parseInt(b["number-matrix-columns-spanned"],10)||0)-1}},o.F=Lo(T),V.push([T,o.F])),b.formula)o.f=Pd(b.formula);else for(U=0;U<V.length;++U)y>=V[U][0].s.r&&y<=V[U][0].e.r&&E>=V[U][0].s.c&&E<=V[U][0].e.c&&(o.F=V[U][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(T={s:{r:y,c:E},e:{r:y+(parseInt(b["number-rows-spanned"],10)||0)-1,c:E+(parseInt(b["number-columns-spanned"],10)||0)-1}},H.push(T)),b["number-columns-repeated"]&&(k=parseInt(b["number-columns-repeated"],10)),o.t){case"boolean":o.t="b",o.v=ea(b["boolean-value"]);break;case"float":case"percentage":case"currency":o.t="n",o.v=parseFloat(b.value);break;case"date":o.t="d",o.v=bi(b["date-value"]),l.cellDates||(o.t="n",o.v=li(o.v)),o.z="m/d/yy";break;case"time":o.t="n",o.v=fi(b["time-value"])/86400,l.cellDates&&(o.t="d",o.v=di(o.v)),o.z="HH:MM:SS";break;case"number":o.t="n",o.v=parseFloat(b["数据数值"]);break;default:if("string"!==o.t&&"text"!==o.t&&o.t)throw new Error("Unsupported value type "+o.t);o.t="s",null!=b["string-value"]&&(v=Gi(b["string-value"]),x=[])}}else{if(L=!1,"s"===o.t&&(o.v=v||"",x.length&&(o.R=x),L=0==N),R.Target&&(o.l=R),M.length>0&&(o.c=M,M=[]),v&&!1!==l.cellText&&(o.w=v),L&&(o.t="z",delete o.v),(!L||l.sheetStubs)&&!(l.sheetRows&&l.sheetRows<=y))for(var W=0;W<j;++W){if(k=parseInt(b["number-columns-repeated"]||"1",10),l.dense)for(g[y+W]||(g[y+W]=[]),g[y+W][E]=0==W?o:Ni(o);--k>0;)g[y+W][E+k]=Ni(o);else for(g[Oo({r:y+W,c:E})]=o;--k>0;)g[Oo({r:y+W,c:E+k})]=Ni(o);w.e.c<=E&&(w.e.c=E)}E+=(k=parseInt(b["number-columns-repeated"]||"1",10))-1,k=0,o={},v="",x=[]}R={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===a[1]){if((t=m.pop())[0]!==a[3])throw"Bad state: "+t}else"/"!==a[0].charAt(a[0].length-2)&&m.push([a[3],!0]);break;case"annotation":if("/"===a[1]){if((t=m.pop())[0]!==a[3])throw"Bad state: "+t;I.t=v,x.length&&(I.R=x),I.a=O,M.push(I)}else"/"!==a[0].charAt(a[0].length-2)&&m.push([a[3],!1]);O="",P=0,v="",N=0,x=[];break;case"creator":"/"===a[1]?O=c.slice(P,a.index):P=a.index+a[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===a[1]){if((t=m.pop())[0]!==a[3])throw"Bad state: "+t}else"/"!==a[0].charAt(a[0].length-2)&&m.push([a[3],!1]);v="",N=0,x=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===a[1]){if(_[u.name]=d,(t=m.pop())[0]!==a[3])throw"Bad state: "+t}else"/"!==a[0].charAt(a[0].length-2)&&(d="",u=Bi(a[0],!1),m.push([a[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(m[m.length-1][0]){case"time-style":case"date-style":s=Bi(a[0],!1),d+=tp[a[3]]["long"===s.style?1:0]}break;case"text":if("/>"===a[0].slice(-2))break;if("/"===a[1])switch(m[m.length-1][0]){case"number-style":case"date-style":case"time-style":d+=c.slice(f,a.index)}else f=a.index+a[0].length;break;case"named-range":A=Fd((s=Bi(a[0],!1))["cell-range-address"]);var z={Name:s.name,Ref:A[0]+"!"+A[1]};F&&(z.Sheet=p.length),C.Names.push(z);break;case"p":case"文本串":if(["master-styles"].indexOf(m[m.length-1][0])>-1)break;if("/"!==a[1]||b&&b["string-value"])Bi(a[0],!1),N=a.index+a[0].length;else{var $=rp(c.slice(N,a.index));v=(v.length>0?v+"\n":"")+$[0]}break;case"database-range":if("/"===a[1])break;try{h[(A=Fd(Bi(a[0])["target-range-address"]))[0]]["!autofilter"]={ref:A[1]}}catch(q){}break;case"a":if("/"!==a[1]){if(!(R=Bi(a[0],!1)).href)break;R.Target=Gi(R.href),delete R.href,"#"==R.Target.charAt(0)&&R.Target.indexOf(".")>-1?(A=Fd(R.Target.slice(1)),R.Target="#"+A[0]+"!"+A[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;default:switch(a[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(l.WTF)throw new Error(a)}}var G={Sheets:h,SheetNames:p,Workbook:C};return l.bookSheets&&delete G.Sheets,G}function np(e,r){r=r||{},Ti(e,"META-INF/manifest.xml")&&function(e,r){for(var t,s,n=va(e);t=Na.exec(n);)switch(t[3]){case"manifest":break;case"file-entry":if("/"==(s=Bi(t[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==s.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw t}}(ji(e,"META-INF/manifest.xml"),r);var t=ki(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var s=sp(ia(t),r);return Ti(e,"meta.xml")&&(s.Props=Bl(ji(e,"meta.xml"))),s}function ip(e,r){return sp(e,r)}var ap=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+pa({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ii+r}}(),op=function(){var e=function(e){return Yi(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r="          <table:table-cell />\n",t=function(t,s,n){var i=[];i.push('      <table:table table:name="'+Yi(s.SheetNames[n])+'" table:style-name="ta1">\n');var a=0,o=0,l=Po(t["!ref"]||"A1"),c=t["!merges"]||[],m=0,u=Array.isArray(t);if(t["!cols"])for(o=0;o<=l.e.c;++o)i.push("        <table:table-column"+(t["!cols"][o]?' table:style-name="co'+t["!cols"][o].ods+'"':"")+"></table:table-column>\n");var d="",f=t["!rows"]||[];for(a=0;a<l.s.r;++a)d=f[a]?' table:style-name="ro'+f[a].ods+'"':"",i.push("        <table:table-row"+d+"></table:table-row>\n");for(;a<=l.e.r;++a){for(d=f[a]?' table:style-name="ro'+f[a].ods+'"':"",i.push("        <table:table-row"+d+">\n"),o=0;o<l.s.c;++o)i.push(r);for(;o<=l.e.c;++o){var h=!1,p={},g="";for(m=0;m!=c.length;++m)if(!(c[m].s.c>o||c[m].s.r>a||c[m].e.c<o||c[m].e.r<a)){c[m].s.c==o&&c[m].s.r==a||(h=!0),p["table:number-columns-spanned"]=c[m].e.c-c[m].s.c+1,p["table:number-rows-spanned"]=c[m].e.r-c[m].s.r+1;break}if(h)i.push("          <table:covered-table-cell/>\n");else{var b=Oo({r:a,c:o}),v=u?(t[a]||[])[o]:t[b];if(v&&v.f&&(p["table:formula"]=Yi(Ld(v.f)),v.F&&v.F.slice(0,b.length)==b)){var N=Po(v.F);p["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,p["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(v){switch(v.t){case"b":g=v.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=v.v?"true":"false";break;case"n":g=v.w||String(v.v||0),p["office:value-type"]="float",p["office:value"]=v.v||0;break;case"s":case"str":g=null==v.v?"":v.v,p["office:value-type"]="string";break;case"d":g=v.w||bi(v.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=bi(v.v).toISOString(),p["table:style-name"]="ce1";break;default:i.push(r);continue}var x=e(g);if(v.l&&v.l.Target){var y=v.l.Target;"#"==(y="#"==y.charAt(0)?"#"+Ud(y.slice(1)):y).charAt(0)||y.match(/^\w+:/)||(y="../"+y),x=ga("text:a",x,{"xlink:href":y.replace(/&/g,"&amp;")})}i.push("          "+ga("table:table-cell",ga("text:p",x,{}),p)+"\n")}else i.push(r)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")};return function(e,r){var s=[Ii],n=pa({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=pa({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==r.bookType?(s.push("<office:document"+n+i+">\n"),s.push(Ll().replace(/office:document-meta/g,"office:meta"))):s.push("<office:document-content"+n+">\n"),function(e,r){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var t=0;r.SheetNames.map(function(e){return r.Sheets[e]}).forEach(function(r){if(r&&r["!cols"])for(var s=0;s<r["!cols"].length;++s)if(r["!cols"][s]){var n=r["!cols"][s];if(null==n.width&&null==n.wpx&&null==n.wch)continue;su(n),n.ods=t;var i=r["!cols"][s].wpx+"px";e.push('  <style:style style:name="co'+t+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+i+'"/>\n'),e.push("  </style:style>\n"),++t}});var s=0;r.SheetNames.map(function(e){return r.Sheets[e]}).forEach(function(r){if(r&&r["!rows"])for(var t=0;t<r["!rows"].length;++t)if(r["!rows"][t]){r["!rows"][t].ods=s;var n=r["!rows"][t].hpx+"px";e.push('  <style:style style:name="ro'+s+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+n+'"/>\n'),e.push("  </style:style>\n"),++s}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(s,e),s.push("  <office:body>\n"),s.push("    <office:spreadsheet>\n");for(var a=0;a!=e.SheetNames.length;++a)s.push(t(e.Sheets[e.SheetNames[a]],e,a));return s.push("    </office:spreadsheet>\n"),s.push("  </office:body>\n"),"fods"==r.bookType?s.push("</office:document>"):s.push("</office:document-content>"),s.join("")}}();function lp(e,r){if("fods"==r.bookType)return op(e,r);var t=Ri(),s="",n=[],i=[];return Ci(t,s="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Ci(t,s="content.xml",op(e,r)),n.push([s,"text/xml"]),i.push([s,"ContentFile"]),Ci(t,s="styles.xml",ap(e,r)),n.push([s,"text/xml"]),i.push([s,"StylesFile"]),Ci(t,s="meta.xml",Ii+Ll()),n.push([s,"text/xml"]),i.push([s,"MetadataFile"]),Ci(t,s="manifest.rdf",function(e){var r=[Ii];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var t=0;t!=e.length;++t)r.push(Ol(e[t][0],e[t][1])),r.push(Pl("",e[t][0]));return r.push(Ol("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(i)),n.push([s,"application/rdf+xml"]),Ci(t,s="META-INF/manifest.xml",function(e){var r=[Ii];r.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),r.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+'"/>\n');return r.push("</manifest:manifest>"),r.join("")}(n)),t}
/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function cp(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function mp(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):ia(Qs(e))}function up(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Ks(aa(e))}function dp(e){var r=e.reduce(function(e,r){return e+r.length},0),t=new Uint8Array(r),s=0;return e.forEach(function(e){t.set(e,s),s+=e.length}),t}function fp(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function hp(e,r){var t=r?r[0]:0,s=127&e[t];e:if(e[t++]>=128){if(s|=(127&e[t])<<7,e[t++]<128)break e;if(s|=(127&e[t])<<14,e[t++]<128)break e;if(s|=(127&e[t])<<21,e[t++]<128)break e;if(s+=(127&e[t])*Math.pow(2,28),++t,e[t++]<128)break e;if(s+=(127&e[t])*Math.pow(2,35),++t,e[t++]<128)break e;if(s+=(127&e[t])*Math.pow(2,42),++t,e[t++]<128)break e}return r&&(r[0]=t),s}function pp(e){var r=new Uint8Array(7);r[0]=127&e;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383)break e;if(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)break e;if(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)break e;if(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)break e;if(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103)break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function gp(e){var r=0,t=127&e[r];e:if(e[r++]>=128){if(t|=(127&e[r])<<7,e[r++]<128)break e;if(t|=(127&e[r])<<14,e[r++]<128)break e;if(t|=(127&e[r])<<21,e[r++]<128)break e;t|=(127&e[r])<<28}return t}function bp(e){for(var r=[],t=[0];t[0]<e.length;){var s,n=t[0],i=hp(e,t),a=7&i,o=0;if(0==(i=Math.floor(i/8)))break;switch(a){case 0:for(var l=t[0];e[t[0]++]>=128;);s=e.slice(l,t[0]);break;case 5:o=4,s=e.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,s=e.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=hp(e,t),s=e.slice(t[0],t[0]+o),t[0]+=o;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var c={data:s,type:a};null==r[i]?r[i]=[c]:r[i].push(c)}return r}function vp(e){var r=[];return e.forEach(function(e,t){e.forEach(function(e){e.data&&(r.push(pp(8*t+e.type)),2==e.type&&r.push(pp(e.data.length)),r.push(e.data))})}),dp(r)}function Np(e,r){return(null==e?void 0:e.map(function(e){return r(e.data)}))||[]}function xp(e){for(var r,t=[],s=[0];s[0]<e.length;){var n=hp(e,s),i=bp(e.slice(s[0],s[0]+n));s[0]+=n;var a={id:gp(i[1][0].data),messages:[]};i[2].forEach(function(r){var t=bp(r.data),n=gp(t[3][0].data);a.messages.push({meta:t,data:e.slice(s[0],s[0]+n)}),s[0]+=n}),(null==(r=i[3])?void 0:r[0])&&(a.merge=gp(i[3][0].data)>>>0>0),t.push(a)}return t}function yp(e){var r=[];return e.forEach(function(e){var t=[];t[1]=[{data:pp(e.id),type:0}],t[2]=[],null!=e.merge&&(t[3]=[{data:pp(+!!e.merge),type:0}]);var s=[];e.messages.forEach(function(e){s.push(e.data),e.meta[3]=[{type:0,data:pp(e.data.length)}],t[2].push({data:vp(e.meta),type:2})});var n=vp(t);r.push(pp(n.length)),r.push(n),s.forEach(function(e){return r.push(e)})}),dp(r)}function Ep(e,r){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],s=hp(r,t),n=[];t[0]<r.length;){var i=3&r[t[0]];if(0!=i){var a=0,o=0;if(1==i?(o=4+(r[t[0]]>>2&7),a=(224&r[t[0]++])<<3,a|=r[t[0]++]):(o=1+(r[t[0]++]>>2),2==i?(a=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(a=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),n=[dp(n)],0==a)throw new Error("Invalid offset 0");if(a>n[0].length)throw new Error("Invalid offset beyond length");if(o>=a)for(n.push(n[0].slice(-a)),o-=a;o>=n[n.length-1].length;)n.push(n[n.length-1]),o-=n[n.length-1].length;n.push(n[0].slice(-a,-a+o))}else{var l=r[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=r[t[0]],c>1&&(l|=r[t[0]+1]<<8),c>2&&(l|=r[t[0]+2]<<16),c>3&&(l|=r[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}n.push(r.slice(t[0],t[0]+l)),t[0]+=l}}var m=dp(n);if(m.length!=s)throw new Error("Unexpected length: ".concat(m.length," != ").concat(s));return m}function wp(e){for(var r=[],t=0;t<e.length;){var s=e[t++],n=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(Ep(s,e.slice(t,t+n))),t+=n}if(t!==e.length)throw new Error("data is not a valid framed stream!");return dp(r)}function Dp(e){for(var r=[],t=0;t<e.length;){var s=Math.min(e.length-t,268435455),n=new Uint8Array(4);r.push(n);var i=pp(s),a=i.length;r.push(i),s<=60?(a++,r.push(new Uint8Array([s-1<<2]))):s<=256?(a+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(a+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(a+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(a+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(e.slice(t,t+s)),a+=s,n[0]=0,n[1]=255&a,n[2]=a>>8&255,n[3]=a>>16&255,t+=s}return dp(r)}function _p(e,r,t){var s,n=cp(e),i=n.getUint32(8,!0),a=12,o=-1,l=-1,c=NaN,m=NaN,u=new Date(2001,0,1);switch(1&i&&(c=function(e,r){for(var t=(127&e[r+15])<<7|e[r+14]>>1,s=1&e[r+14],n=r+13;n>=r;--n)s=256*s+e[n];return(128&e[r+15]?-s:s)*Math.pow(10,t-6176)}(e,a),a+=16),2&i&&(m=n.getFloat64(a,!0),a+=8),4&i&&(u.setTime(u.getTime()+1e3*n.getFloat64(a,!0)),a+=8),8&i&&(l=n.getUint32(a,!0),a+=4),16&i&&(o=n.getUint32(a,!0),a+=4),e[1]){case 0:break;case 2:case 10:s={t:"n",v:c};break;case 3:s={t:"s",v:r[l]};break;case 5:s={t:"d",v:u};break;case 6:s={t:"b",v:m>0};break;case 7:s={t:"n",v:m/86400};break;case 8:s={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)));s={t:"s",v:t[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)))}return s}function Hp(e,r){var t=new Uint8Array(32),s=cp(t),n=12,i=0;switch(t[0]=5,e.t){case"n":t[1]=2,function(e,r,t){var s=Math.floor(0==t?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,n=t/Math.pow(10,s-6176);e[r+15]|=s>>7,e[r+14]|=(127&s)<<1;for(var i=0;n>=1;++i,n/=256)e[r+i]=255&n;e[r+15]|=t>=0?0:128}(t,n,e.v),i|=1,n+=16;break;case"b":t[1]=6,s.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(-1==r.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,s.setUint32(n,r.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,i,!0),t.slice(0,n)}function Tp(e,r){var t=new Uint8Array(32),s=cp(t),n=12,i=0;switch(t[0]=3,e.t){case"n":t[2]=2,s.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":t[2]=6,s.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(-1==r.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,s.setUint32(n,r.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,i,!0),t.slice(0,n)}function Sp(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,r,t,s){var n,i=cp(e),a=i.getUint32(4,!0),o=(s>1?12:8)+4*fp(a&(s>1?3470:398)),l=-1,c=-1,m=NaN,u=new Date(2001,0,1);switch(512&a&&(l=i.getUint32(o,!0),o+=4),o+=4*fp(a&(s>1?12288:4096)),16&a&&(c=i.getUint32(o,!0),o+=4),32&a&&(m=i.getFloat64(o,!0),o+=8),64&a&&(u.setTime(u.getTime()+1e3*i.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:n={t:"n",v:m};break;case 3:n={t:"s",v:r[c]};break;case 5:n={t:"d",v:u};break;case 6:n={t:"b",v:m>0};break;case 7:n={t:"n",v:m/86400};break;case 8:n={t:"e",v:0};break;case 9:if(l>-1)n={t:"s",v:t[l]};else if(c>-1)n={t:"s",v:r[c]};else{if(isNaN(m))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));n={t:"n",v:m}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return n}(e,r,t,e[0]);case 5:return _p(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function jp(e){return hp(bp(e)[1][0].data)}function kp(e,r){var t=bp(r.data),s=gp(t[1][0].data),n=t[3],i=[];return(n||[]).forEach(function(r){var t=bp(r.data),n=gp(t[1][0].data)>>>0;switch(s){case 1:i[n]=mp(t[3][0].data);break;case 8:var a=bp(e[jp(t[9][0].data)][0].data),o=e[jp(a[1][0].data)][0],l=gp(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=bp(o.data);i[n]=c[3].map(function(e){return mp(e.data)}).join("")}}),i}function Vp(e,r){var t,s=bp(r.data),n=(null==(t=null==s?void 0:s[7])?void 0:t[0])?gp(s[7][0].data)>>>0>0?1:0:-1,i=Np(s[5],function(e){return function(e,r){var t,s,n,i,a,o,l,c,m,u,d,f,h,p,g,b,v=bp(e),N=gp(v[1][0].data)>>>0,x=gp(v[2][0].data)>>>0,y=(null==(s=null==(t=v[8])?void 0:t[0])?void 0:s.data)&&gp(v[8][0].data)>0||!1;if((null==(i=null==(n=v[7])?void 0:n[0])?void 0:i.data)&&0!=r)g=null==(o=null==(a=v[7])?void 0:a[0])?void 0:o.data,b=null==(c=null==(l=v[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(u=null==(m=v[4])?void 0:m[0])?void 0:u.data)||1==r)throw"NUMBERS Tile missing ".concat(r," cell storage");g=null==(f=null==(d=v[4])?void 0:d[0])?void 0:f.data,b=null==(p=null==(h=v[3])?void 0:h[0])?void 0:p.data}for(var E=y?4:1,w=cp(g),D=[],_=0;_<g.length/2;++_){var H=w.getUint16(2*_,!0);H<65535&&D.push([_,H])}if(D.length!=x)throw"Expected ".concat(x," cells, found ").concat(D.length);var T=[];for(_=0;_<D.length-1;++_)T[D[_][0]]=b.subarray(D[_][1]*E,D[_+1][1]*E);return D.length>=1&&(T[D[D.length-1][0]]=b.subarray(D[D.length-1][1]*E)),{R:N,cells:T}}(e,n)});return{nrows:gp(s[4][0].data)>>>0,data:i.reduce(function(e,r){return e[r.R]||(e[r.R]=[]),r.cells.forEach(function(t,s){if(e[r.R][s])throw new Error("Duplicate cell r=".concat(r.R," c=").concat(s));e[r.R][s]=t}),e},[])}}function Cp(e,r){var t={"!ref":"A1"},s=e[jp(bp(r.data)[2][0].data)],n=gp(s[0].meta[1][0].data);if(6001!=n)throw new Error("6000 unexpected reference to ".concat(n));return function(e,r,t){var s,n=bp(r.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(gp(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(gp(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=Lo(i);var a=bp(n[4][0].data),o=kp(e,e[jp(a[4][0].data)][0]),l=(null==(s=a[17])?void 0:s[0])?kp(e,e[jp(a[17][0].data)][0]):[],c=bp(a[3][0].data),m=0;c[1].forEach(function(r){var s=bp(r.data),n=e[jp(s[2][0].data)][0],i=gp(n.meta[1][0].data);if(6002!=i)throw new Error("6001 unexpected reference to ".concat(i));var a=Vp(0,n);a.data.forEach(function(e,r){e.forEach(function(e,s){var n=Oo({r:m+r,c:s}),i=Sp(e,o,l);i&&(t[n]=i)})}),m+=a.nrows})}(e,s[0],t),t}function Rp(e,r){var t={SheetNames:[],Sheets:{}};if(Np(bp(r.data)[1],jp).forEach(function(r){e[r].forEach(function(r){if(2==gp(r.meta[1][0].data)){var s=function(e,r){var t,s=bp(r.data),n={name:(null==(t=s[1])?void 0:t[0])?mp(s[1][0].data):"",sheets:[]};return Np(s[2],jp).forEach(function(r){e[r].forEach(function(r){6e3==gp(r.meta[1][0].data)&&n.sheets.push(Cp(e,r))})}),n}(e,r);s.sheets.forEach(function(e,r){fg(t,e,0==r?s.name:s.name+"_"+r,!0)})}})}),0==t.SheetNames.length)throw new Error("Empty NUMBERS file");return t}function Ap(e){var r,t,s,n,i={},a=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var r,t;try{r=wp(e.content)}catch(s){return}try{t=xp(r)}catch(s){return}t.forEach(function(e){i[e.id]=e.messages,a.push(e.id)})}}),!a.length)throw new Error("File has no messages");var o=(null==(n=null==(s=null==(t=null==(r=null==i?void 0:i[1])?void 0:r[0])?void 0:t.meta)?void 0:s[1])?void 0:n[0].data)&&1==gp(i[1][0].meta[1][0].data)&&i[1][0];if(o||a.forEach(function(e){i[e].forEach(function(e){if(1==gp(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}})}),!o)throw new Error("Cannot find Document root");return Rp(i,o)}function Mp(e,r,t){var s,n,i,a;if(!(null==(s=e[6])?void 0:s[0])||!(null==(n=e[7])?void 0:n[0]))throw"Mutation only works on post-BNC storages!";if((null==(a=null==(i=e[8])?void 0:i[0])?void 0:a.data)&&gp(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=cp(e[7][0].data),c=0,m=[],u=cp(e[4][0].data),d=0,f=[],h=0;h<r.length;++h)if(null!=r[h]){var p,g;switch(l.setUint16(2*h,c,!0),u.setUint16(2*h,d,!0),typeof r[h]){case"string":p=Hp({t:"s",v:r[h]},t),g=Tp({t:"s",v:r[h]},t);break;case"number":p=Hp({t:"n",v:r[h]},t),g=Tp({t:"n",v:r[h]},t);break;case"boolean":p=Hp({t:"b",v:r[h]},t),g=Tp({t:"b",v:r[h]},t);break;default:throw new Error("Unsupported value "+r[h])}m.push(p),c+=p.length,f.push(g),d+=g.length,++o}else l.setUint16(2*h,65535,!0),u.setUint16(2*h,65535);for(e[2][0].data=pp(o);h<e[7][0].data.length/2;++h)l.setUint16(2*h,65535,!0),u.setUint16(2*h,65535,!0);return e[6][0].data=dp(m),e[3][0].data=dp(f),o}function Ip(e){return function(r){for(var t=0;t!=e.length;++t){var s=e[t];void 0===r[s[0]]&&(r[s[0]]=s[1]),"n"===s[2]&&(r[s[0]]=Number(r[s[0]]))}}}function Op(e){Ip([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Pp(e){Ip([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Lp(e,r,t,s,n,i,a,o,l,c,m,u){try{i[s]=Al(ki(e,t,!0),r);var d,f=ji(e,r);switch(o){case"sheet":d=Yf(f,r,n,l,i[s],c,m,u);break;case"chart":if(!(d=Kf(f,r,n,l,i[s],c))||!d["!drawel"])break;var h=Mi(d["!drawel"].Target,r),p=Rl(h),g=function(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}(ki(e,h,!0),Al(ki(e,p,!0),h)),b=Mi(g,h),v=Rl(b);d=Vf(ki(e,b,!0),0,0,Al(ki(e,v,!0),b),0,d);break;case"macro":x=r,i[s],x.slice(-4),d={"!type":"macro"};break;case"dialog":d=function(e,r){return r.slice(-4),{"!type":"dialog"}}(0,r,0,0,i[s]);break;default:throw new Error("Unrecognized sheet type "+o)}a[s]=d;var N=[];i&&i[s]&&si(i[s]).forEach(function(t){var n="";if(i[s][t].Type==Cl.CMNT){n=Mi(i[s][t].Target,r);var a=Zf(ji(e,n,!0),n,l);if(!a||!a.length)return;Bu(d,a,!1)}i[s][t].Type==Cl.TCMNT&&(n=Mi(i[s][t].Target,r),N=N.concat(function(e,r){var t=[],s=!1,n={},i=0;return e.replace(Li,function(a,o){var l=Bi(a);switch(Wi(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=n.t&&t.push(n);break;case"<text>":case"<text":i=o+a.length;break;case"</text>":n.t=e.slice(i,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":s=!0;break;case"</mentions>":case"</ext>":s=!1;break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return a}),t}(ji(e,n,!0),l)))}),N&&N.length&&Bu(d,N,!0,l.people||[])}catch(y){if(l.WTF)throw y}var x}function Fp(e){return"/"==e.charAt(0)?e.slice(1):e}function Up(e,r){if(Xn(),Op(r=r||{}),Ti(e,"META-INF/manifest.xml"))return np(e,r);if(Ti(e,"objectdata.xml"))return np(e,r);if(Ti(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==Ap){if(e.FileIndex)return Ap(e);var t=Zn.utils.cfb_new();return Vi(e).forEach(function(r){Ci(t,r,function(e,r){return Hi(Si(e,r))}(e,r))}),Ap(t)}throw new Error("Unsupported NUMBERS file")}if(!Ti(e,"[Content_Types].xml")){if(Ti(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Ti(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var s,n,i=Vi(e),a=function(e){var r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return r;var t={};if((e.match(Li)||[]).forEach(function(e){var s=Bi(e);switch(s[0].replace(Fi,"<")){case"<?xml":break;case"<Types":r.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":void 0!==r[jl[s.ContentType]]&&r[jl[s.ContentType]].push(s.PartName)}}),r.xmlns!==wa)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}(ki(e,"[Content_Types].xml")),o=!1;if(0===a.workbooks.length&&ji(e,n="xl/workbook.xml",!0)&&a.workbooks.push(n),0===a.workbooks.length){if(!ji(e,n="xl/workbook.bin",!0))throw new Error("Could not find workbook");a.workbooks.push(n),o=!0}"bin"==a.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!r.bookSheets&&!r.bookProps){if(Bd=[],a.sst)try{Bd=Qf(ji(e,Fp(a.sst)),a.sst,r)}catch(k){if(r.WTF)throw k}r.cellStyles&&a.themes.length&&(l=function(e,r,t){return Ru(e,t)}(ki(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(c=Jf(ji(e,Fp(a.style)),a.style,l,r))}a.links.map(function(t){try{Al(ki(e,Rl(Fp(t))),t);return rh(ji(e,Fp(t)),0,t,r)}catch(k){}});var m=Xf(ji(e,Fp(a.workbooks[0])),a.workbooks[0],r),u={},d="";a.coreprops.length&&((d=ji(e,Fp(a.coreprops[0]),!0))&&(u=Bl(d)),0!==a.extprops.length&&(d=ji(e,Fp(a.extprops[0]),!0))&&function(e,r,t){var s={};r||(r={}),e=ia(e),$l.forEach(function(t){var n=(e.match(oa(t[0]))||[])[1];switch(t[2]){case"string":n&&(r[t[1]]=Gi(n));break;case"bool":r[t[1]]="true"===n;break;case"raw":var i=e.match(new RegExp("<"+t[0]+"[^>]*>([\\s\\S]*?)</"+t[0]+">"));i&&i.length>0&&(s[t[1]]=i[1])}}),s.HeadingPairs&&s.TitlesOfParts&&ql(s.HeadingPairs,s.TitlesOfParts,r,t)}(d,u,r));var f={};r.bookSheets&&!r.bookProps||0!==a.custprops.length&&(d=ki(e,Fp(a.custprops[0]),!0))&&(f=function(e,r){var t={},s="",n=e.match(Yl);if(n)for(var i=0;i!=n.length;++i){var a=n[i],o=Bi(a);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":s=Gi(o.name);break;case"</property>":s=null;break;default:if(0===a.indexOf("<vt:")){var l=a.split(">"),c=l[0].slice(4),m=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":t[s]=Gi(m);break;case"bool":t[s]=ea(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[s]=parseInt(m,10);break;case"r4":case"r8":case"decimal":t[s]=parseFloat(m);break;case"filetime":case"date":t[s]=bi(m);break;default:if("/"==c.slice(-1))break;r.WTF}}else if("</"===a.slice(0,2));else if(r.WTF)throw new Error(a)}}return t}(d,r));var h={};if((r.bookSheets||r.bookProps)&&(m.Sheets?s=m.Sheets.map(function(e){return e.name}):u.Worksheets&&u.SheetNames.length>0&&(s=u.SheetNames),r.bookProps&&(h.Props=u,h.Custprops=f),r.bookSheets&&void 0!==s&&(h.SheetNames=s),r.bookSheets?h.SheetNames:r.bookProps))return h;s={};var p={};r.bookDeps&&a.calcchain&&(p=eh(ji(e,Fp(a.calcchain)),a.calcchain));var g,b,v=0,N={},x=m.Sheets;u.Worksheets=x.length,u.SheetNames=[];for(var y=0;y!=x.length;++y)u.SheetNames[y]=x[y].name;var E=o?"bin":"xml",w=a.workbooks[0].lastIndexOf("/"),D=(a.workbooks[0].slice(0,w+1)+"_rels/"+a.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");Ti(e,D)||(D="xl/_rels/workbook."+E+".rels");var _=Al(ki(e,D,!0),D.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=th(ji(e,Fp(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=function(e,r){var t=[],s=!1;return e.replace(Li,function(e){var n=Bi(e);switch(Wi(n[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":t.push({name:n.displayname,id:n.id});break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&r.WTF)throw new Error("unrecognized "+n[0]+" in threaded comments")}return e}),t}(ji(e,Fp(a.people[0])),r)),_&&(_=function(e,r){if(!e)return 0;try{e=r.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,(t=e["!id"][r.id].Type,Cl.WS.indexOf(t)>-1?"sheet":t==Cl.CS?"chart":t==Cl.DS?"dialog":t==Cl.MS?"macro":t&&t.length?t:"sheet")];var t})}catch(k){return null}return e&&0!==e.length?e:null}(_,m.Sheets));var H=ji(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=u.Worksheets;++v){var T="sheet";if(_&&_[v]?(g="xl/"+_[v][1].replace(/[\/]?xl\//,""),Ti(e,g)||(g=_[v][1]),Ti(e,g)||(g=D.replace(/_rels\/.*$/,"")+_[v][1]),T=_[v][2]):g=(g="xl/worksheets/sheet"+(v+1-H)+"."+E).replace(/sheet0\./,"sheet."),b=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&null!=r.sheets)switch(typeof r.sheets){case"number":if(v!=r.sheets)continue e;break;case"string":if(u.SheetNames[v].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var S=!1,j=0;j!=r.sheets.length;++j)"number"==typeof r.sheets[j]&&r.sheets[j]==v&&(S=1),"string"==typeof r.sheets[j]&&r.sheets[j].toLowerCase()==u.SheetNames[v].toLowerCase()&&(S=1);if(!S)continue e}}Lp(e,g,b,u.SheetNames[v],v,N,s,T,r,m,l,c)}return h={Directory:a,Workbook:m,Props:u,Custprops:f,Deps:p,Sheets:s,SheetNames:u.SheetNames,Strings:Bd,Styles:c,Themes:l,SSF:Ni(fn)},r&&r.bookFiles&&(e.files?(h.keys=i,h.files=e.files):(h.keys=[],h.files={},e.FullPaths.forEach(function(r,t){r=r.replace(/^Root Entry[\/]/,""),h.keys.push(r),h.files[r]=e.FileIndex[t]}))),r&&r.bookVBA&&(a.vba.length>0?h.vbaraw=ji(e,Fp(a.vba[0]),!0):a.defaults&&"application/vnd.ms-office.vbaProject"===a.defaults.bin&&(h.vbaraw=ji(e,"xl/vbaProject.bin",!0))),h}function Bp(e,r){var t,s,n=r||{},i="Workbook",a=Zn.find(e,i);try{if(i="/!DataSpaces/Version",!(a=Zn.find(e,i))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(t=a.content,(s={}).id=t.read_shift(0,"lpp4"),s.R=Im(t,4),s.U=Im(t,4),s.W=Im(t,4),i="/!DataSpaces/DataSpaceMap",!(a=Zn.find(e,i))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);var o=function(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(Om(e));return r}(a.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=Zn.find(e,i))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);var l=function(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}(a.content);if(1!=l.length||"StrongEncryptionTransform"!=l[0])throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=Zn.find(e,i))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);Pm(a.content)}catch(m){}if(i="/EncryptionInfo",!(a=Zn.find(e,i))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);var c=function(e){var r=Im(e);switch(r.Minor){case 2:return[r.Minor,Um(e)];case 3:return[r.Minor,Bm()];case 4:return[r.Minor,Wm(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}(a.content);if(i="/EncryptedPackage",!(a=Zn.find(e,i))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(4==c[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(c[1],a.content,n.password||"",n);if(2==c[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(c[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function Wp(e,r){return"ods"==r.bookType?lp(e,r):"numbers"==r.bookType?function(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length;var s=Po(t["!ref"]);s.s.r=s.s.c=0,s.e.c>9&&(s.e.c=9),s.e.r>49&&(s.e.r=49);var n=ig(t,{range:s,header:1}),i=["~Sh33tJ5~"];n.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&i.push(e)})});var a={},o=[],l=Zn.read(r.numbers,{type:"base64"});l.FileIndex.map(function(e,r){return[e,l.FullPaths[r]]}).forEach(function(e){var r=e[0],t=e[1];2==r.type&&r.name.match(/\.iwa/)&&xp(wp(r.content)).forEach(function(e){o.push(e.id),a[e.id]={deps:[],location:t,type:gp(e.messages[0].meta[1][0].data)}})}),o.sort(function(e,r){return e-r});var c=o.filter(function(e){return e>1}).map(function(e){return[e,pp(e)]});l.FileIndex.map(function(e,r){return[e,l.FullPaths[r]]}).forEach(function(e){var r=e[0];e[1],r.name.match(/\.iwa/)&&xp(wp(r.content)).forEach(function(e){e.messages.forEach(function(r){c.forEach(function(r){e.messages.some(function(e){return 11006!=gp(e.meta[1][0].data)&&function(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var s=0;s<r.length;++s)if(e[t+s]!=r[s])continue e;return!0}return!1}(e.data,r[1])})&&a[r[0]].deps.push(e.id)})})})});for(var m,u=Zn.find(l,a[1].location),d=xp(wp(u.content)),f=0;f<d.length;++f){var h=d[f];1==h.id&&(m=h)}var p=jp(bp(m.messages[0].data)[1][0].data);for(d=xp(wp((u=Zn.find(l,a[p].location)).content)),f=0;f<d.length;++f)(h=d[f]).id==p&&(m=h);for(p=jp(bp(m.messages[0].data)[2][0].data),d=xp(wp((u=Zn.find(l,a[p].location)).content)),f=0;f<d.length;++f)(h=d[f]).id==p&&(m=h);for(p=jp(bp(m.messages[0].data)[2][0].data),d=xp(wp((u=Zn.find(l,a[p].location)).content)),f=0;f<d.length;++f)(h=d[f]).id==p&&(m=h);var g=bp(m.messages[0].data);g[6][0].data=pp(s.e.r+1),g[7][0].data=pp(s.e.c+1);for(var b=jp(g[46][0].data),v=Zn.find(l,a[b].location),N=xp(wp(v.content)),x=0;x<N.length&&N[x].id!=b;++x);if(N[x].id!=b)throw"Bad ColumnRowUIDMapArchive";var y=bp(N[x].messages[0].data);y[1]=[],y[2]=[],y[3]=[];for(var E=0;E<=s.e.c;++E){var w=[];w[1]=w[2]=[{type:0,data:pp(E+420690)}],y[1].push({type:2,data:vp(w)}),y[2].push({type:0,data:pp(E)}),y[3].push({type:0,data:pp(E)})}y[4]=[],y[5]=[],y[6]=[];for(var D=0;D<=s.e.r;++D)(w=[])[1]=w[2]=[{type:0,data:pp(D+726270)}],y[4].push({type:2,data:vp(w)}),y[5].push({type:0,data:pp(D)}),y[6].push({type:0,data:pp(D)});N[x].messages[0].data=vp(y),v.content=Dp(yp(N)),v.size=v.content.length,delete g[46];var _=bp(g[4][0].data);_[7][0].data=pp(s.e.r+1);var H=jp(bp(_[1][0].data)[2][0].data);if((N=xp(wp((v=Zn.find(l,a[H].location)).content)))[0].id!=H)throw"Bad HeaderStorageBucket";var T=bp(N[0].messages[0].data);for(D=0;D<n.length;++D){var S=bp(T[2][0].data);S[1][0].data=pp(D),S[4][0].data=pp(n[D].length),T[2][D]={type:T[2][0].type,data:vp(S)}}N[0].messages[0].data=vp(T),v.content=Dp(yp(N)),v.size=v.content.length;var j=jp(_[2][0].data);if((N=xp(wp((v=Zn.find(l,a[j].location)).content)))[0].id!=j)throw"Bad HeaderStorageBucket";for(T=bp(N[0].messages[0].data),E=0;E<=s.e.c;++E)(S=bp(T[2][0].data))[1][0].data=pp(E),S[4][0].data=pp(s.e.r+1),T[2][E]={type:T[2][0].type,data:vp(S)};N[0].messages[0].data=vp(T),v.content=Dp(yp(N)),v.size=v.content.length;var k=jp(_[4][0].data);!function(){for(var e,r=Zn.find(l,a[k].location),t=xp(wp(r.content)),s=0;s<t.length;++s){var n=t[s];n.id==k&&(e=n)}var o=bp(e.messages[0].data);o[3]=[];var c=[];i.forEach(function(e,r){c[1]=[{type:0,data:pp(r)}],c[2]=[{type:0,data:pp(1)}],c[3]=[{type:2,data:up(e)}],o[3].push({type:2,data:vp(c)})}),e.messages[0].data=vp(o);var m=Dp(yp(t));r.content=m,r.size=r.content.length}();var V=bp(_[3][0].data),C=V[1][0];delete V[2];var R=bp(C.data),A=jp(R[2][0].data);!function(){for(var e,r=Zn.find(l,a[A].location),t=xp(wp(r.content)),o=0;o<t.length;++o){var c=t[o];c.id==A&&(e=c)}var m=bp(e.messages[0].data);delete m[6],delete V[7];var u=new Uint8Array(m[5][0].data);m[5]=[];for(var d=0,f=0;f<=s.e.r;++f){var h=bp(u);d+=Mp(h,n[f],i),h[1][0].data=pp(f),m[5].push({data:vp(h),type:2})}m[1]=[{type:0,data:pp(s.e.c+1)}],m[2]=[{type:0,data:pp(s.e.r+1)}],m[3]=[{type:0,data:pp(d)}],m[4]=[{type:0,data:pp(s.e.r+1)}],e.messages[0].data=vp(m);var p=Dp(yp(t));r.content=p,r.size=r.content.length}(),C.data=vp(R),_[3][0].data=vp(V),g[4][0].data=vp(_),m.messages[0].data=vp(g);var M=Dp(yp(d));return u.content=M,u.size=u.content.length,l}(e,r):"xlsb"==r.bookType?function(e,r){Fu=1024,e&&!e.SSF&&(e.SSF=Ni(fn));e&&e.SSF&&(Xn(),qn(e.SSF),r.revssf=ai(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF);r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,zd?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xlsb"==r.bookType?"bin":"xml",s=qu.indexOf(r.bookType)>-1,n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Pp(r=r||{});var i=Ri(),a="",o=0;r.cellXfs=[],Xd(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(Ci(i,a="docProps/core.xml",zl(e.Props,r)),n.coreprops.push(a),Il(r.rels,2,a,Cl.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Ci(i,a,Xl(e.Props)),n.extprops.push(a),Il(r.rels,3,a,Cl.EXT_PROPS),e.Custprops!==e.Props&&si(e.Custprops||{}).length>0&&(Ci(i,a="docProps/custom.xml",Kl(e.Custprops)),n.custprops.push(a),Il(r.rels,4,a,Cl.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var m={"!id":{}},u=e.Sheets[e.SheetNames[o-1]];(u||{})["!type"];if(Ci(i,a="xl/worksheets/sheet"+o+"."+t,sh(o-1,a,r,e,m)),n.sheets.push(a),Il(r.wbrels,-1,"worksheets/sheet"+o+"."+t,Cl.WS[0]),u){var d=u["!comments"],f=!1,h="";d&&d.length>0&&(Ci(i,h="xl/comments"+o+"."+t,nh(d,h)),n.comments.push(h),Il(m,-1,"../comments"+o+"."+t,Cl.CMNT),f=!0),u["!legacy"]&&f&&Ci(i,"xl/drawings/vmlDrawing"+o+".vml",Uu(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}m["!id"].rId1&&Ci(i,Rl(a),Ml(m))}null!=r.Strings&&r.Strings.length>0&&(Ci(i,a="xl/sharedStrings."+t,function(e,r,t){return(".bin"===r.slice(-4)?Am:Cm)(e,t)}(r.Strings,a,r)),n.strs.push(a),Il(r.wbrels,-1,"sharedStrings."+t,Cl.SST));Ci(i,a="xl/workbook."+t,function(e,r){return(".bin"===r.slice(-4)?qf:Wf)(e)}(e,a)),n.workbooks.push(a),Il(r.rels,1,a,Cl.WB),Ci(i,a="xl/theme/theme1.xml",Au(e.Themes,r)),n.themes.push(a),Il(r.wbrels,-1,"theme/theme1.xml",Cl.THEME),Ci(i,a="xl/styles."+t,function(e,r,t){return(".bin"===r.slice(-4)?Du:uu)(e,t)}(e,a,r)),n.styles.push(a),Il(r.wbrels,-1,"styles."+t,Cl.STY),e.vbaraw&&s&&(Ci(i,a="xl/vbaProject.bin",e.vbaraw),n.vba.push(a),Il(r.wbrels,-1,"vbaProject.bin",Cl.VBA));return Ci(i,a="xl/metadata."+t,function(e){return(".bin"===e.slice(-4)?Pu:Lu)()}(a)),n.metadata.push(a),Il(r.wbrels,-1,"metadata."+t,Cl.XLMETA),Ci(i,"[Content_Types].xml",Vl(n,r)),Ci(i,"_rels/.rels",Ml(r.rels)),Ci(i,"xl/_rels/workbook."+t+".rels",Ml(r.wbrels)),delete r.revssf,delete r.ssf,i}(e,r):zp(e,r)}function zp(e,r){Fu=1024,e&&!e.SSF&&(e.SSF=Ni(fn)),e&&e.SSF&&(Xn(),qn(e.SSF),r.revssf=ai(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,zd?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",s=qu.indexOf(r.bookType)>-1,n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Pp(r=r||{});var i=Ri(),a="",o=0;if(r.cellXfs=[],Xd(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Ci(i,a="docProps/core.xml",zl(e.Props,r)),n.coreprops.push(a),Il(r.rels,2,a,Cl.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Ci(i,a,Xl(e.Props)),n.extprops.push(a),Il(r.rels,3,a,Cl.EXT_PROPS),e.Custprops!==e.Props&&si(e.Custprops||{}).length>0&&(Ci(i,a="docProps/custom.xml",Kl(e.Custprops)),n.custprops.push(a),Il(r.rels,4,a,Cl.CUST_PROPS));var m=["SheetJ5"];for(r.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},d=e.Sheets[e.SheetNames[o-1]];(d||{})["!type"];if(Ci(i,a="xl/worksheets/sheet"+o+"."+t,pf(o-1,r,e,u)),n.sheets.push(a),Il(r.wbrels,-1,"worksheets/sheet"+o+"."+t,Cl.WS[0]),d){var f=d["!comments"],h=!1,p="";if(f&&f.length>0){var g=!1;f.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(Ci(i,p="xl/threadedComments/threadedComment"+o+"."+t,zu(f,m,r)),n.threadedcomments.push(p),Il(u,-1,"../threadedComments/threadedComment"+o+"."+t,Cl.TCMNT)),Ci(i,p="xl/comments"+o+"."+t,Wu(f)),n.comments.push(p),Il(u,-1,"../comments"+o+"."+t,Cl.CMNT),h=!0}d["!legacy"]&&h&&Ci(i,"xl/drawings/vmlDrawing"+o+".vml",Uu(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Ci(i,Rl(a),Ml(u))}return null!=r.Strings&&r.Strings.length>0&&(Ci(i,a="xl/sharedStrings."+t,Cm(r.Strings,r)),n.strs.push(a),Il(r.wbrels,-1,"sharedStrings."+t,Cl.SST)),Ci(i,a="xl/workbook."+t,Wf(e)),n.workbooks.push(a),Il(r.rels,1,a,Cl.WB),Ci(i,a="xl/theme/theme1.xml",Au(e.Themes,r)),n.themes.push(a),Il(r.wbrels,-1,"theme/theme1.xml",Cl.THEME),Ci(i,a="xl/styles."+t,uu(e,r)),n.styles.push(a),Il(r.wbrels,-1,"styles."+t,Cl.STY),e.vbaraw&&s&&(Ci(i,a="xl/vbaProject.bin",e.vbaraw),n.vba.push(a),Il(r.wbrels,-1,"vbaProject.bin",Cl.VBA)),Ci(i,a="xl/metadata."+t,Lu()),n.metadata.push(a),Il(r.wbrels,-1,"metadata."+t,Cl.XLMETA),m.length>1&&(Ci(i,a="xl/persons/person.xml",function(e){var r=[Ii,ga("personList",null,{xmlns:_a,"xmlns:x":Ra[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,t){r.push(ga("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+t).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}(m)),n.people.push(a),Il(r.wbrels,-1,"persons/person.xml",Cl.PEOPLE)),Ci(i,"[Content_Types].xml",Vl(n,r)),Ci(i,"_rels/.rels",Ml(r.rels)),Ci(i,"xl/_rels/workbook.xml.rels",Ml(r.wbrels)),delete r.revssf,delete r.ssf,i}function $p(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=$s(e.slice(0,12));break;case"binary":t=e;break;default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Gp(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return gh(e.slice(t),r);default:break e}return xm.to_workbook(e,r)}function qp(e,r,t,s){return s?(t.type="string",xm.to_workbook(e,t)):xm.to_workbook(r,t)}function Xp(e,r){Is();var t=r||{};if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Xp(new Uint8Array(e),((t=Ni(t)).type="array",t));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!t.type&&(t.type="undefined"!=typeof Deno?"buffer":"array");var s,n=e,i=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Wd={},t.dateNF&&(Wd.dateNF=t.dateNF),t.type||(t.type=Gs&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==t.type&&(t.type=Gs?"buffer":"binary",n=function(e){if(void 0!==ei)return ei.readFileSync(e);if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||Gs||(t.type="array")),"string"==t.type&&(i=!0,t.type="binary",t.codepage=65001,n=function(e){return e.match(/[^\x00-\x7F]/)?aa(e):e}(e)),"array"==t.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return(t=Ni(t)).type="array",Xp(Zs(n),t)}switch((s=$p(n,t))[0]){case 208:if(207===s[1]&&17===s[2]&&224===s[3]&&161===s[4]&&177===s[5]&&26===s[6]&&225===s[7])return function(e,r){return Zn.find(e,"EncryptedPackage")?Bp(e,r):Ch(e,r)}(Zn.read(n,t),t);break;case 9:if(s[1]<=8)return Ch(n,t);break;case 60:return gh(n,t);case 73:if(73===s[1]&&42===s[2]&&0===s[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===s[1])return function(e,r){var t=r||{},s=!!t.WTF;t.WTF=!0;try{var n=bm.to_workbook(e,t);return t.WTF=s,n}catch(i){if(t.WTF=s,!i.message.match(/SYLK bad record ID/)&&s)throw i;return xm.to_workbook(e,r)}}(n,t);break;case 84:if(65===s[1]&&66===s[2]&&76===s[3])return vm.to_workbook(n,t);break;case 80:return 75===s[1]&&s[2]<9&&s[3]<9?function(e,r){var t=e,s=r||{};return s.type||(s.type=Gs&&Buffer.isBuffer(e)?"buffer":"base64"),Up(Ai(t,s),s)}(n,t):qp(e,n,t,i);case 239:return 60===s[3]?gh(n,t):qp(e,n,t,i);case 255:if(254===s[1])return function(e,r){var t=e;return"base64"==r.type&&(t=$s(t)),t=Ls.utils.decode(1200,t.slice(2),"str"),r.type="binary",Gp(t,r)}(n,t);if(0===s[1]&&2===s[2]&&0===s[3])return ym.to_workbook(n,t);break;case 0:if(0===s[1]){if(s[2]>=2&&0===s[3])return ym.to_workbook(n,t);if(0===s[2]&&(8===s[3]||9===s[3]))return ym.to_workbook(n,t)}break;case 3:case 131:case 139:case 140:return gm.to_workbook(n,t);case 123:if(92===s[1]&&114===s[2]&&116===s[3])return Xm.to_workbook(n,t);break;case 10:case 13:case 32:return function(e,r){var t="",s=$p(e,r);switch(r.type){case"base64":t=$s(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=vi(e);break;default:throw new Error("Unrecognized type "+r.type)}return 239==s[0]&&187==s[1]&&191==s[2]&&(t=ia(t)),r.type="binary",Gp(t,r)}(n,t);case 137:if(80===s[1]&&78===s[2]&&71===s[3])throw new Error("PNG Image File is not a spreadsheet")}return pm.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?gm.to_workbook(n,t):qp(e,n,t,i)}function Yp(e,r){var t=r||{};return t.type="file",Xp(e,t)}function Kp(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return ti(r.file,Zn.write(e,{type:Gs?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Zn.write(e,r)}function Jp(e,r){var t={},s=Gs?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=s;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var n=e.FullPaths?Zn.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if("undefined"!=typeof Deno&&"string"==typeof n){if("binary"==r.type||"base64"==r.type)return n;n=new Uint8Array(Js(n))}return r.password&&"undefined"!=typeof encrypt_agile?Kp(encrypt_agile(n,r.password),r):"file"===r.type?ti(r.file,n):"string"==r.type?ia(n):n}function Qp(e,r,t){t||(t="");var s=t+e;switch(r.type){case"base64":return zs(aa(s));case"binary":return aa(s);case"string":return e;case"file":return ti(r.file,s,"utf8");case"buffer":return Gs?qs(s,"utf8"):"undefined"!=typeof TextEncoder?(new TextEncoder).encode(s):Qp(s,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Zp(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",s=0;s<e.length;++s)t+=String.fromCharCode(e[s]);return"base64"==r.type?zs(t):"string"==r.type?ia(t):t;case"file":return ti(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function eg(e,r){Is(),Uf(e);var t=Ni(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),"array"==t.type){t.type="binary";var s=eg(e,t);return t.type="array",Js(s)}return function(e,r){var t=Ni(r||{});return Jp(zp(e,t),t)}(e,t)}function rg(e,r){Is(),Uf(e);var t=Ni(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),"array"==t.type){t.type="binary";var s=rg(e,t);return t.type="array",Js(s)}var n=0;if(t.sheet&&(n="number"==typeof t.sheet?t.sheet:e.SheetNames.indexOf(t.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Qp(Eh(e,t),t);case"slk":case"sylk":return Qp(bm.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"htm":case"html":return Qp(Jh(e.Sheets[e.SheetNames[n]],t),t);case"txt":return function(e,r){switch(r.type){case"base64":return zs(e);case"binary":case"string":return e;case"file":return ti(r.file,e,"binary");case"buffer":return Gs?qs(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}(cg(e.Sheets[e.SheetNames[n]],t),t);case"csv":return Qp(lg(e.Sheets[e.SheetNames[n]],t),t,"\ufeff");case"dif":return Qp(vm.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"dbf":return Zp(gm.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"prn":return Qp(xm.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"rtf":return Qp(Xm.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"eth":return Qp(Nm.from_sheet(e.Sheets[e.SheetNames[n]],t),t);case"fods":return Qp(lp(e,t),t);case"wk1":return Zp(ym.sheet_to_wk1(e.Sheets[e.SheetNames[n]],t),t);case"wk3":return Zp(ym.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Zp($h(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),function(e,r){var t=r||{};return Kp(Rh(e,t),t)}(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,r){var t=Ni(r||{});return Jp(Wp(e,t),t)}(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function tg(e){if(!e.bookType){var r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function sg(e,r,t){var s=t||{};return s.type="file",s.file=r,tg(s),rg(e,s)}function ng(e,r,t,s,n,i,a,o){var l=Ro(t),c=o.defval,m=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,d=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch(g){d.__rowNum__=t}else d.__rowNum__=t;if(!a||e[t])for(var f=r.s.c;f<=r.e.c;++f){var h=a?e[t][f]:e[s[f]+l];if(void 0!==h&&void 0!==h.t){var p=h.v;switch(h.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+h.t)}if(null!=i[f]){if(null==p)if("e"==h.t&&null===p)d[i[f]]=null;else if(void 0!==c)d[i[f]]=c;else{if(!m||null!==p)continue;d[i[f]]=null}else d[i[f]]=m&&("n"!==h.t||"n"===h.t&&!1!==o.rawNumbers)?p:Bo(h,p,o);null!=p&&(u=!1)}}else{if(void 0===c)continue;null!=i[f]&&(d[i[f]]=c)}}return{row:d,isempty:u}}function ig(e,r){if(null==e||null==e["!ref"])return[];var t={t:"n",v:0},s=0,n=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=r||{},m=null!=c.range?c.range:e["!ref"];switch(1===c.header?s=1:"A"===c.header?s=2:Array.isArray(c.header)?s=3:null==c.header&&(s=0),typeof m){case"string":l=Fo(m);break;case"number":(l=Fo(e["!ref"])).s.r=m;break;default:l=m}s>0&&(n=0);var u=Ro(l.s.r),d=[],f=[],h=0,p=0,g=Array.isArray(e),b=l.s.r,v=0,N={};g&&!e[b]&&(e[b]=[]);var x=c.skipHidden&&e["!cols"]||[],y=c.skipHidden&&e["!rows"]||[];for(v=l.s.c;v<=l.e.c;++v)if(!(x[v]||{}).hidden)switch(d[v]=Mo(v),t=g?e[b][v]:e[d[v]+u],s){case 1:i[v]=v-l.s.c;break;case 2:i[v]=d[v];break;case 3:i[v]=c.header[v-l.s.c];break;default:if(null==t&&(t={w:"__EMPTY",t:"s"}),o=a=Bo(t,null,c),p=N[a]||0){do{o=a+"_"+p++}while(N[o]);N[a]=p,N[o]=1}else N[a]=1;i[v]=o}for(b=l.s.r+n;b<=l.e.r;++b)if(!(y[b]||{}).hidden){var E=ng(e,l,b,d,s,i,g,c);(!1===E.isempty||(1===s?!1!==c.blankrows:c.blankrows))&&(f[h++]=E.row)}return f.length=h,f}var ag=/"/g;function og(e,r,t,s,n,i,a,o){for(var l=!0,c=[],m="",u=Ro(t),d=r.s.c;d<=r.e.c;++d)if(s[d]){var f=o.dense?(e[t]||[])[d]:e[s[d]+u];if(null==f)m="";else if(null!=f.v){l=!1,m=""+(o.rawNumbers&&"n"==f.t?f.v:Bo(f,null,o));for(var h=0,p=0;h!==m.length;++h)if((p=m.charCodeAt(h))===n||p===i||34===p||o.forceQuotes){m='"'+m.replace(ag,'""')+'"';break}"ID"==m&&(m='"ID"')}else null==f.f||f.F?m="":(l=!1,(m="="+f.f).indexOf(",")>=0&&(m='"'+m.replace(ag,'""')+'"'));c.push(m)}return!1===o.blankrows&&l?null:c.join(a)}function lg(e,r){var t=[],s=null==r?{}:r;if(null==e||null==e["!ref"])return"";var n=Fo(e["!ref"]),i=void 0!==s.FS?s.FS:",",a=i.charCodeAt(0),o=void 0!==s.RS?s.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),m="",u=[];s.dense=Array.isArray(e);for(var d=s.skipHidden&&e["!cols"]||[],f=s.skipHidden&&e["!rows"]||[],h=n.s.c;h<=n.e.c;++h)(d[h]||{}).hidden||(u[h]=Mo(h));for(var p=0,g=n.s.r;g<=n.e.r;++g)(f[g]||{}).hidden||null!=(m=og(e,n,g,u,a,l,i,s))&&(s.strip&&(m=m.replace(c,"")),(m||!1!==s.blankrows)&&t.push((p++?o:"")+m));return delete s.dense,t.join("")}function cg(e,r){r||(r={}),r.FS="\t",r.RS="\n";var t=lg(e,r);if(void 0===Ls||"string"==r.type)return t;var s=Ls.utils.encode(1200,t,"str");return String.fromCharCode(255)+String.fromCharCode(254)+s}function mg(e,r,t){var s,n=t||{},i=+!n.skipHeader,a=e||{},o=0,l=0;if(a&&null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var c="string"==typeof n.origin?Io(n.origin):n.origin;o=c.r,l=c.c}var m={s:{c:0,r:0},e:{c:l,r:o+r.length-1+i}};if(a["!ref"]){var u=Fo(a["!ref"]);m.e.c=Math.max(m.e.c,u.e.c),m.e.r=Math.max(m.e.r,u.e.r),-1==o&&(o=u.e.r+1,m.e.r=o+r.length-1+i)}else-1==o&&(o=0,m.e.r=r.length-1+i);var d=n.header||[],f=0;r.forEach(function(e,r){si(e).forEach(function(t){-1==(f=d.indexOf(t))&&(d[f=d.length]=t);var c=e[t],m="z",u="",h=Oo({c:l+f,r:o+r+i});s=ug(a,h),!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?m="n":"boolean"==typeof c?m="b":"string"==typeof c?m="s":c instanceof Date?(m="d",n.cellDates||(m="n",c=li(c)),u=n.dateNF||fn[14]):null===c&&n.nullError&&(m="e",c=0),s?(s.t=m,s.v=c,delete s.w,delete s.R,u&&(s.z=u)):a[h]=s={t:m,v:c},u&&(s.z=u)):a[h]=c})}),m.e.c=Math.max(m.e.c,l+d.length-1);var h=Ro(o);if(i)for(f=0;f<d.length;++f)a[Mo(f+l)+h]={t:"s",v:d[f]};return a["!ref"]=Lo(m),a}function ug(e,r,t){if("string"==typeof r){if(Array.isArray(e)){var s=Io(r);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return ug(e,Oo("number"!=typeof r?r:{r:r,c:t||0}))}function dg(){return{SheetNames:[],Sheets:{}}}function fg(e,r,t,s){var n=1;if(!t)for(;n<=65535&&-1!=e.SheetNames.indexOf(t="Sheet"+n);++n,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(t)>=0){var i=t.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var a=i&&i[1]||t;for(++n;n<=65535&&-1!=e.SheetNames.indexOf(t=a+n);++n);}if(Ff(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function hg(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}var pg,gg={encode_col:Mo,encode_row:Ro,encode_cell:Oo,encode_range:Lo,decode_col:Ao,decode_row:Co,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Io,decode_range:Po,format_cell:Bo,sheet_add_aoa:zo,sheet_add_json:mg,sheet_add_dom:Qh,aoa_to_sheet:$o,json_to_sheet:function(e,r){return mg(null,e,r)},table_to_sheet:Zh,table_to_book:function(e,r){return Wo(Zh(e,r),r)},sheet_to_csv:lg,sheet_to_txt:cg,sheet_to_json:ig,sheet_to_html:Jh,sheet_to_formulae:function(e){var r,t="",s="";if(null==e||null==e["!ref"])return[];var n,i=Fo(e["!ref"]),a="",o=[],l=[],c=Array.isArray(e);for(n=i.s.c;n<=i.e.c;++n)o[n]=Mo(n);for(var m=i.s.r;m<=i.e.r;++m)for(a=Ro(m),n=i.s.c;n<=i.e.c;++n)if(t=o[n]+a,s="",void 0!==(r=c?(e[m]||[])[n]:e[t])){if(null!=r.F){if(t=r.F,!r.f)continue;s=r.f,-1==t.indexOf(":")&&(t=t+":"+t)}if(null!=r.f)s=r.f;else{if("z"==r.t)continue;if("n"==r.t&&null!=r.v)s=""+r.v;else if("b"==r.t)s=r.v?"TRUE":"FALSE";else if(void 0!==r.w)s="'"+r.w;else{if(void 0===r.v)continue;s="s"==r.t?"'"+r.v:""+r.v}}l[l.length]=t+"="+s}return l},sheet_to_row_object_array:ig,sheet_get_cell:ug,book_new:dg,book_append_sheet:fg,book_set_sheet_visibility:function(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=function(e,r){if("number"==typeof r){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}if("string"==typeof r){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}throw new Error("Cannot find sheet |"+r+"|")}(e,r);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[s].Hidden=t},cell_set_number_format:function(e,r){return e.z=r,e},cell_set_hyperlink:hg,cell_set_internal_link:function(e,r,t){return hg(e,"#"+r,t)},cell_add_comment:function(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})},sheet_set_array_formula:function(e,r,t,s){for(var n="string"!=typeof r?r:Fo(r),i="string"==typeof r?r:Lo(r),a=n.s.r;a<=n.e.r;++a)for(var o=n.s.c;o<=n.e.c;++o){var l=ug(e,a,o);l.t="n",l.F=i,delete l.v,a==n.s.r&&o==n.s.c&&(l.f=t,s&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var bg={to_json:function(e,r){var t=pg({objectMode:!0});if(null==e||null==e["!ref"])return t.push(null),t;var s={t:"n",v:0},n=0,i=1,a=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},m=r||{},u=null!=m.range?m.range:e["!ref"];switch(1===m.header?n=1:"A"===m.header?n=2:Array.isArray(m.header)&&(n=3),typeof u){case"string":c=Fo(u);break;case"number":(c=Fo(e["!ref"])).s.r=u;break;default:c=u}n>0&&(i=0);var d=Ro(c.s.r),f=[],h=0,p=Array.isArray(e),g=c.s.r,b=0,v={};p&&!e[g]&&(e[g]=[]);var N=m.skipHidden&&e["!cols"]||[],x=m.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(N[b]||{}).hidden)switch(f[b]=Mo(b),s=p?e[g][b]:e[f[b]+d],n){case 1:a[b]=b-c.s.c;break;case 2:a[b]=f[b];break;case 3:a[b]=m.header[b-c.s.c];break;default:if(null==s&&(s={w:"__EMPTY",t:"s"}),l=o=Bo(s,null,m),h=v[o]||0){do{l=o+"_"+h++}while(v[l]);v[o]=h,v[l]=1}else v[o]=1;a[b]=l}return g=c.s.r+i,t._read=function(){for(;g<=c.e.r;)if(!(x[g-1]||{}).hidden){var r=ng(e,c,g,f,n,a,p,m);if(++g,!1===r.isempty||(1===n?!1!==m.blankrows:m.blankrows))return void t.push(r.row)}return t.push(null)},t},to_html:function(e,r){var t=pg(),s=r||{},n=null!=s.header?s.header:Xh,i=null!=s.footer?s.footer:Yh;t.push(n);var a=Po(e["!ref"]);s.dense=Array.isArray(e),t.push(Kh(0,0,s));var o=a.s.r,l=!1;return t._read=function(){if(o>a.e.r)return l||(l=!0,t.push("</table>"+i)),t.push(null);for(;o<=a.e.r;){t.push(qh(e,a,o,s)),++o;break}},t},to_csv:function(e,r){var t=pg(),s=null==r?{}:r;if(null==e||null==e["!ref"])return t.push(null),t;var n=Fo(e["!ref"]),i=void 0!==s.FS?s.FS:",",a=i.charCodeAt(0),o=void 0!==s.RS?s.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),m="",u=[];s.dense=Array.isArray(e);for(var d=s.skipHidden&&e["!cols"]||[],f=s.skipHidden&&e["!rows"]||[],h=n.s.c;h<=n.e.c;++h)(d[h]||{}).hidden||(u[h]=Mo(h));var p=n.s.r,g=!1,b=0;return t._read=function(){if(!g)return g=!0,t.push("\ufeff");for(;p<=n.e.r;)if(++p,!(f[p-1]||{}).hidden&&null!=(m=og(e,n,p-1,u,a,l,i,s))&&(s.strip&&(m=m.replace(c,"")),m||!1!==s.blankrows))return t.push((b++?o:"")+m);return t.push(null)},t},set_readable:function(e){pg=e}};const vg=js.version,Ng=Object.freeze(Object.defineProperty({__proto__:null,CFB:Zn,SSF:Yn,parse_xlscfb:Ch,parse_zip:Up,read:Xp,readFile:Yp,readFileSync:Yp,set_cptable:function(e){Ls=e,Ms=function(e){ks=e,As(e)},Fs=function(e){return 255===e.charCodeAt(0)&&254===e.charCodeAt(1)?Ls.utils.decode(1200,Os(e.slice(2))):e},Us=function(e){return 1200===ks?String.fromCharCode(e):Ls.utils.decode(ks,[255&e,e>>8])[0]},Bs=function(e){return Ls.utils.decode(Vs,[e])[0]},lo()},set_fs:function(e){ei=e},stream:bg,utils:gg,version:vg,write:rg,writeFile:sg,writeFileAsync:function(e,r,t,s){var n=t||{};n.type="file",n.file=e,tg(n),n.type="buffer";var i=s;return i instanceof Function||(i=t),ei.writeFile(e,rg(r,n),i)},writeFileSync:sg,writeFileXLSX:function(e,r,t){var s=t||{};return s.type="file",s.file=r,tg(s),eg(e,s)},writeXLSX:eg},Symbol.toStringTag,{value:"Module"})),xg=({isOpen:e,onClose:r,onImport:s,companies:n,currentUser:i,existingProcesses:a=[]})=>{const[o,l]=t.useState(null),[c,m]=t.useState([]),[u,d]=t.useState(!1),[f,h]=t.useState([]),[p,g]=t.useState(null);if(!e)return null;const b=async e=>{d(!0),h([]);try{const r=Xp(await e.arrayBuffer(),{type:"array"}),t=r.SheetNames[0],s=r.Sheets[t],n=gg.sheet_to_json(s).map(e=>({...e,"生效年月":v(e.生效年月)})),i=x(n);i.length>0&&h(i),m(n.slice(0,10))}catch(r){h(["Excel文件解析失败，请检查文件格式"])}finally{d(!1)}},v=e=>{if(!e)return"";if("number"==typeof e){const r=new Date(86400*(e-25569)*1e3);return`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`}const r=String(e).trim();if(r.match(/^\d{4}-\d{2}$/))return r;if(r.match(/^\d{4}-\d{2}-\d{2}$/))return r.substring(0,7);if(r.match(/^\d{4}\/\d{1,2}$/)){const[e,t]=r.split("/");return`${e}-${t.padStart(2,"0")}`}if(r.match(/^\d{4}\/\d{1,2}\/\d{1,2}$/)){const[e,t]=r.split("/");return`${e}-${t.padStart(2,"0")}`}return r},x=e=>{const r=[],t=n.map(e=>e.name),s=new Map;return e.forEach((e,i)=>{const o=i+2;if(e.公司名称?t.includes(e.公司名称)||r.push(`第${o}行：公司"${e.公司名称}"不存在`):r.push(`第${o}行：公司名称不能为空`),e.生产线||r.push(`第${o}行：生产线不能为空`),e.工时类型&&["生产工时","非生产工时"].includes(e.工时类型)||r.push(`第${o}行：工时类型必须是"生产工时"或"非生产工时"`),e.产品名称||r.push(`第${o}行：产品名称不能为空`),e.产品工序||r.push(`第${o}行：产品工序不能为空`),e.单价&&""!==e.单价&&"string"==typeof e.单价&&isNaN(Number(e.单价))&&r.push(`第${o}行：单价必须是有效数字`),e.生效年月||r.push(`第${o}行：生效年月不能为空`),e.公司名称&&e.生产线&&e.工时类型&&e.产品名称&&e.产品工序){const r=`${e.公司名称.trim()}_${e.生产线.trim()}_${e.工时类型}_${e.产品名称.trim()}_${e.产品工序.trim()}`;s.has(r)?s.get(r).push(o):s.set(r,[o])}if(e.公司名称&&e.生产线&&e.工时类型&&e.产品名称&&e.产品工序){const t=n.find(r=>r.name===e.公司名称);if(t){const s=a.find(r=>r.company_id===t.id&&r.production_line.trim()===e.生产线.trim()&&r.production_category===e.工时类型&&r.product_name.trim()===e.产品名称.trim()&&r.product_process.trim()===e.产品工序.trim());s&&r.push(`第${o}行：与现有工序重复！（公司：${s.company_name||e.公司名称}，生产线：${s.production_line}，工时类型：${s.production_category}，产品名称：${s.product_name}，产品工序：${s.product_process}）`)}}}),s.forEach((e,t)=>{if(e.length>1){const[s,n,i,a,o]=t.split("_");r.push(`导入数据内部重复：第${e.join("、")}行（公司：${s}，生产线：${n}，工时类型：${i}，产品名称：${a}，产品工序：${o}）`)}}),r},y=()=>{l(null),m([]),h([]),g(null),r()};return pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[pe.jsxDEV("h2",{className:"text-xl font-bold text-green-400",children:"批量导入工序"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:303,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:y,className:"text-gray-400 hover:text-white transition-colors",children:pe.jsxDEV(N,{className:"w-6 h-6"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:308,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:304,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:302,columnNumber:9},void 0),p?pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("h3",{className:"text-xl font-semibold text-green-400 mb-4",children:"导入完成"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:415,columnNumber:15},void 0),pe.jsxDEV("div",{className:"space-y-2",children:[pe.jsxDEV("p",{className:"text-white",children:["成功导入：",pe.jsxDEV("span",{className:"text-green-400 font-semibold",children:p.success},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:417,columnNumber:48},void 0)," 条"]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:417,columnNumber:17},void 0),pe.jsxDEV("p",{className:"text-white",children:["导入失败：",pe.jsxDEV("span",{className:"text-red-400 font-semibold",children:p.failed},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:418,columnNumber:48},void 0)," 条"]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:418,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:416,columnNumber:15},void 0),p.errors.length>0&&pe.jsxDEV("div",{className:"mt-4 p-4 bg-red-900 border border-red-600 rounded text-left",children:[pe.jsxDEV("h4",{className:"text-red-400 font-semibold mb-2",children:"错误信息："},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:423,columnNumber:19},void 0),pe.jsxDEV("ul",{className:"text-red-300 text-sm space-y-1",children:p.errors.map((e,r)=>pe.jsxDEV("li",{children:["• ",e]},r,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:426,columnNumber:23},void 0))},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:424,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:422,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:414,columnNumber:13},void 0),pe.jsxDEV("button",{onClick:y,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded transition-colors",children:"关闭"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:433,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:413,columnNumber:11},void 0):pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("div",{className:"flex items-center gap-4 mb-4",children:[pe.jsxDEV("label",{className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded cursor-pointer transition-colors",children:[pe.jsxDEV(z,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:318,columnNumber:19},void 0),"选择Excel文件",pe.jsxDEV("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{var r;const t=null==(r=e.target.files)?void 0:r[0];t&&(l(t),b(t))},className:"hidden"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:320,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:317,columnNumber:17},void 0),pe.jsxDEV("button",{onClick:()=>{var e;const r=[{"公司名称":(null==(e=null==i?void 0:i.company)?void 0:e.name)||"示例公司","生产线":"生产线A","工时类型":"生产工时","产品名称":"示例产品","产品工序":"示例工序","单价":"","生效年月":(new Date).toISOString().slice(0,7)}],t=gg.json_to_sheet(r),s=gg.book_new();gg.book_append_sheet(s,t,"工序导入模板"),sg(s,"工序导入模板.xlsx")},className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition-colors",children:[pe.jsxDEV(G,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:331,columnNumber:19},void 0),"下载模板"]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:327,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:316,columnNumber:15},void 0),o&&pe.jsxDEV("div",{className:"flex items-center gap-2 text-green-400",children:[pe.jsxDEV(q,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:338,columnNumber:19},void 0),pe.jsxDEV("span",{children:o.name},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:339,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:337,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:315,columnNumber:13},void 0),f.length>0&&pe.jsxDEV("div",{className:"mb-6 p-4 bg-red-900 border border-red-600 rounded",children:[pe.jsxDEV("h3",{className:"text-red-400 font-semibold mb-2",children:"数据验证错误："},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:347,columnNumber:17},void 0),pe.jsxDEV("ul",{className:"text-red-300 text-sm space-y-1",children:[f.slice(0,10).map((e,r)=>pe.jsxDEV("li",{children:["• ",e]},r,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:350,columnNumber:21},void 0)),f.length>10&&pe.jsxDEV("li",{className:"text-red-400",children:["... 还有 ",f.length-10," 个错误"]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:353,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:348,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:346,columnNumber:15},void 0),c.length>0&&pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("h3",{className:"text-green-400 font-semibold mb-3",children:"数据预览（前10行）："},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:362,columnNumber:17},void 0),pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full border border-gray-600 rounded",children:[pe.jsxDEV("thead",{children:pe.jsxDEV("tr",{className:"bg-gray-700",children:[pe.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"公司名称"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:367,columnNumber:25},void 0),pe.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"生产线"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:368,columnNumber:25},void 0),pe.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"工时类型"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:369,columnNumber:25},void 0),pe.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"产品名称"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:370,columnNumber:25},void 0),pe.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"产品工序"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:371,columnNumber:25},void 0),pe.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"单价"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:372,columnNumber:25},void 0),pe.jsxDEV("th",{className:"border border-gray-600 px-3 py-2 text-green-400 text-sm",children:"生效年月"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:373,columnNumber:25},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:366,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:365,columnNumber:21},void 0),pe.jsxDEV("tbody",{children:c.map((e,r)=>pe.jsxDEV("tr",{className:"hover:bg-gray-700",children:[pe.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.公司名称},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:379,columnNumber:27},void 0),pe.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.生产线},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:380,columnNumber:27},void 0),pe.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.工时类型},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:381,columnNumber:27},void 0),pe.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.产品名称},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:382,columnNumber:27},void 0),pe.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.产品工序},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:383,columnNumber:27},void 0),pe.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.单价},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:384,columnNumber:27},void 0),pe.jsxDEV("td",{className:"border border-gray-600 px-3 py-2 text-white text-sm",children:e.生效年月},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:385,columnNumber:27},void 0)]},r,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:378,columnNumber:25},void 0))},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:376,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:364,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:363,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:361,columnNumber:15},void 0),pe.jsxDEV("div",{className:"flex justify-end gap-4",children:[pe.jsxDEV("button",{onClick:y,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:396,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:async()=>{if(o&&!(f.length>0)){d(!0);try{const e=Xp(await o.arrayBuffer(),{type:"array"}),r=e.SheetNames[0],t=e.Sheets[r],i=gg.sheet_to_json(t),a=i.map(e=>({...e,"生效年月":v(e.生效年月)})).map(e=>{const r=n.find(r=>r.name===e.公司名称);return{company_id:(null==r?void 0:r.id)||"",production_line:e.生产线,production_category:e.工时类型,product_name:e.产品名称,product_process:e.产品工序,unit_price:e.单价&&""!==e.单价&&void 0!==e.单价?Number(e.单价):null,effective_date:e.生效年月||null}});await s(a),g({success:a.length,failed:0,errors:[]})}catch(e){g({success:0,failed:c.length,errors:["导入失败："+e.message]})}finally{d(!1)}}},disabled:!o||f.length>0||u,className:"px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded transition-colors",children:u?"导入中...":"确认导入"},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:402,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:395,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:313,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:301,columnNumber:7},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/ExcelImportDialog.tsx",lineNumber:300,columnNumber:5},void 0)},yg=()=>{var e;const{user:r,loading:s}=Ve(),n=i(),[o,l]=t.useState([]),[c,m]=t.useState([]),[u,d]=t.useState(!0),[f,h]=t.useState(""),[p,g]=t.useState(""),[b,v]=t.useState(""),[x,y]=t.useState(""),[E,w]=t.useState(!1),[H,T]=t.useState(!1),[S,j]=t.useState(null),[k,V]=t.useState(!1),[C,R]=t.useState([]),[A,M]=t.useState([]),[P,U]=t.useState([]),[$,G]=t.useState([]),[q,Y]=t.useState([]),[K,J]=t.useState([]),[Q,Z]=t.useState(!1),[ee,re]=t.useState(!1),[te,se]=t.useState(!1),[ne,ie]=t.useState({production_line:"",production_category:"",product_name:""}),[ae,oe]=t.useState({company_id:"",production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"生产工时"}),[le,ce]=t.useState(null),[me,ue]=t.useState(!1),[de,fe]=t.useState(null),[he,ge]=t.useState(!1),[be,Ne]=t.useState(!1);t.useEffect(()=>{if(!s&&!r)return W.error("请先登录"),void n("/login");r&&ye()},[r,s,n]);const ye=async()=>{if(!r)return;if(!(await async function(e,r){try{return(await _e(e)).includes(r)}catch(t){return!1}}(r.id,xe.PROCESS_MANAGEMENT)))return W.error("您没有权限访问工序管理功能"),void n("/dashboard");Ee(),Se()},Ee=async()=>{var e;try{if(d(!0),!r)return void W.error("用户信息不存在");let t=ve.from("processes").select("\n          *,\n          companies!inner(\n            name\n          )\n        ").eq("is_active",!0);if(!He(r.role)){if(!(null==(e=r.company)?void 0:e.id))return void W.error("用户没有关联的公司，请联系管理员");t=t.eq("company_id",r.company.id)}const{data:s,error:n}=await t.order("created_at",{ascending:!1});if(n)return void W.error(`获取工序列表失败: ${n.message}`);const i=(s||[]).map(e=>{var r;return{...e,company_name:(null==(r=e.companies)?void 0:r.name)||"未知公司"}});l(i),we(i)}catch(t){W.error(`获取工序列表失败: ${t.message||"未知错误"}`)}finally{d(!1)}},we=e=>{var t;if(!(null==(t=null==r?void 0:r.company)?void 0:t.id))return;const s=e.filter(e=>{var t;return e.company_id===(null==(t=r.company)?void 0:t.id)}),n=[...new Set(s.map(e=>e.production_line).filter(Boolean))];R(n);const i=[...new Set(s.map(e=>e.product_name).filter(Boolean))];M(i);const a=[...new Set(s.map(e=>e.product_process).filter(Boolean))];U(a)},De=(e,r)=>{switch(oe(t=>({...t,[e]:r})),e){case"production_line":const e=C.filter(e=>e.toLowerCase().includes(r.toLowerCase()));G(e),Z(r.length>0&&e.length>0);break;case"product_name":const t=A.filter(e=>e.toLowerCase().includes(r.toLowerCase()));Y(t),re(r.length>0&&t.length>0);break;case"product_process":const s=P.filter(e=>e.toLowerCase().includes(r.toLowerCase()));J(s),se(r.length>0&&s.length>0)}},Te=(e,r)=>{switch(oe(t=>({...t,[e]:r})),e){case"production_line":Z(!1);break;case"product_name":re(!1);break;case"product_process":se(!1)}},Se=async()=>{var e,t;try{if(!r)return void W.error("用户信息不存在");let s=ve.from("companies").select("id, name");He(r.role)||(s=s.eq("id",null==(e=r.company)?void 0:e.id));const{data:n,error:i}=await s.order("name");if(i)return void W.error("获取公司列表失败");m(n||[]),!He(r.role)&&(null==(t=r.company)?void 0:t.id)&&oe(e=>({...e,company_id:r.company.id}))}catch(s){W.error("获取公司列表失败")}},je=()=>{var e;return!He(null==r?void 0:r.role)&&(null==(e=null==r?void 0:r.company)?void 0:e.id)?r.company.id:""},ke=o.reduce((e,r)=>{var t,s,n;const i=`${r.company_id}_${null==(t=r.production_line)?void 0:t.trim()}_${r.production_category}_${null==(s=r.product_name)?void 0:s.trim()}_${null==(n=r.product_process)?void 0:n.trim()}`;return(!e[i]||new Date(r.created_at)>new Date(e[i].created_at))&&(e[i]=r),e},{}),Ce=Object.values(ke).filter(e=>{if(be)return!e.unit_price||e.unit_price<=0;const r=""===f||e.production_line.toLowerCase().includes(f.toLowerCase())||e.product_name.toLowerCase().includes(f.toLowerCase())||e.production_category&&e.production_category.toLowerCase().includes(f.toLowerCase())||e.product_process&&e.product_process.toLowerCase().includes(f.toLowerCase()),t=""===ne.production_line||e.production_line===ne.production_line,s=""===ne.production_category||e.production_category===ne.production_category,n=!x||e.effective_date===x;return r&&t&&s&&n}),Re=[...new Set(o.map(e=>e.production_line).filter(Boolean))],Ae=[...new Set(o.map(e=>e.production_category).filter(Boolean))];return pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-400 font-mono",children:[pe.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[pe.jsxDEV("div",{className:"mb-8",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV(D,{className:"w-8 h-8 text-green-400 mr-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:787,columnNumber:15},void 0),pe.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 font-mono",children:"工序管理"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:788,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:786,columnNumber:13},void 0),pe.jsxDEV(a,{to:"/dashboard",className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-green-300 hover:text-green-200 rounded-lg font-mono transition-all duration-200 shadow-md hover:shadow-lg border border-gray-600 hover:border-green-500/50",children:[pe.jsxDEV(_,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:794,columnNumber:15},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:795,columnNumber:15},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:796,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:790,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:785,columnNumber:11},void 0),pe.jsxDEV("div",{className:"h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:799,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:784,columnNumber:9},void 0),pe.jsxDEV("div",{className:"mb-6 space-y-4",children:[pe.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-4",children:pe.jsxDEV("div",{className:"flex-1",children:pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(I,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-green-400/60"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:807,columnNumber:17},void 0),pe.jsxDEV("input",{type:"text",placeholder:"搜索工序内容、生产线、产品名称...",value:f,onChange:e=>h(e.target.value),className:"w-full bg-black border border-green-400/30 rounded px-10 py-2 text-green-400 placeholder-green-400/60 focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:808,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:806,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:805,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:804,columnNumber:11},void 0),pe.jsxDEV("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4",children:[pe.jsxDEV("button",{onClick:()=>V(!k),className:"flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono text-sm sm:text-base",children:[pe.jsxDEV(X,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:825,columnNumber:15},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"筛选"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:826,columnNumber:15},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"筛选"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:827,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:821,columnNumber:13},void 0),pe.jsxDEV("button",{onClick:()=>{0===o.filter(e=>!e.unit_price||e.unit_price<=0).length?W.info("当前没有未定价的工序"):(h(""),ie({production_line:"",production_category:"",product_name:""}),y(""),Ne(!be))},className:"flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 font-bold rounded transition-colors font-mono text-sm sm:text-base "+(be?"bg-red-600 hover:bg-red-500 text-white":"bg-orange-600 hover:bg-orange-500 text-white"),children:[pe.jsxDEV(L,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:848,columnNumber:15},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:be?"显示全部":"未定价工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:849,columnNumber:15},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:be?"全部":"未定价"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:850,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:829,columnNumber:13},void 0),pe.jsxDEV("button",{onClick:()=>ge(!0),className:"flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono text-sm sm:text-base",children:[pe.jsxDEV(z,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:856,columnNumber:15},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"批量导入"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:857,columnNumber:15},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"导入"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:858,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:852,columnNumber:13},void 0),pe.jsxDEV("button",{onClick:()=>{E||(le?oe({...le,unit_price:"",effective_date:(new Date).toISOString().split("T")[0]}):(()=>{const e=je();oe({company_id:e,production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"生产工时"})})()),w(!E)},className:"flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono text-sm sm:text-base",children:[pe.jsxDEV(O,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:878,columnNumber:15},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"添加工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:879,columnNumber:15},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"添加"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:880,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:860,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:820,columnNumber:11},void 0),k&&pe.jsxDEV("div",{className:"bg-green-900/10 border border-green-400/30 rounded p-4",children:[pe.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium text-green-400 mb-2",children:"生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:889,columnNumber:19},void 0),pe.jsxDEV("select",{value:ne.production_line,onChange:e=>ie({...ne,production_line:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:897,columnNumber:21},void 0),Re.map(e=>pe.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:899,columnNumber:23},void 0))]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:892,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:888,columnNumber:17},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium text-green-400 mb-2",children:"工时类型"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:904,columnNumber:19},void 0),pe.jsxDEV("select",{value:ne.production_category,onChange:e=>ie({...ne,production_category:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部类别"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:912,columnNumber:21},void 0),Ae.map(e=>pe.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:914,columnNumber:23},void 0))]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:907,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:903,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:887,columnNumber:15},void 0),pe.jsxDEV("div",{className:"flex justify-start mt-4",children:pe.jsxDEV("button",{onClick:()=>{ie({production_line:"",production_category:"",product_name:""}),h(""),y(""),Ne(!1)},className:"flex items-center space-x-2 bg-gray-900/20 border border-gray-400/30 px-4 py-2 rounded hover:bg-gray-900/30 transition-colors text-gray-400",children:[pe.jsxDEV(N,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:929,columnNumber:19},void 0),pe.jsxDEV("span",{children:"清除筛选"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:930,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:920,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:919,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:886,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:803,columnNumber:9},void 0),E&&pe.jsxDEV("div",{className:"mb-6 p-4 border border-green-400/30 rounded bg-green-900/10",children:[pe.jsxDEV("h3",{className:"text-lg font-semibold mb-4 text-green-400",children:["为 ",pe.jsxDEV("strong",{children:(null==(e=null==r?void 0:r.company)?void 0:e.name)||"未设置公司"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:941,columnNumber:17},void 0)," 添加新工序"]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:940,columnNumber:13},void 0),pe.jsxDEV("div",{className:"space-y-4",children:[pe.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:["生产线 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:948,columnNumber:88},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:948,columnNumber:19},void 0),pe.jsxDEV("input",{type:"text",value:ae.production_line,onChange:e=>De("production_line",e.target.value),onFocus:()=>{ae.production_line&&$.length>0&&Z(!0)},onBlur:()=>{setTimeout(()=>Z(!1),200)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"请输入生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:949,columnNumber:19},void 0),Q&&$.length>0&&pe.jsxDEV("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-green-400/30 rounded-md shadow-lg max-h-40 overflow-y-auto",children:$.map((e,r)=>pe.jsxDEV("div",{onClick:()=>Te("production_line",e),className:"px-3 py-2 text-green-400 hover:bg-green-900/20 cursor-pointer border-b border-green-400/10 last:border-b-0",children:e},r,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:967,columnNumber:25},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:965,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:947,columnNumber:17},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:["工时类型 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:979,columnNumber:89},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:979,columnNumber:19},void 0),pe.jsxDEV("select",{value:ae.work_time_type,onChange:e=>oe({...ae,work_time_type:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"生产工时",children:"生产工时"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:985,columnNumber:21},void 0),pe.jsxDEV("option",{value:"非生产工时",children:"非生产工时"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:986,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:980,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:978,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:946,columnNumber:15},void 0),pe.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:["产品名称 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:994,columnNumber:89},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:994,columnNumber:19},void 0),pe.jsxDEV("input",{type:"text",value:ae.product_name,onChange:e=>De("product_name",e.target.value),onFocus:()=>{ae.product_name&&q.length>0&&re(!0)},onBlur:()=>{setTimeout(()=>re(!1),200)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"请输入产品名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:995,columnNumber:19},void 0),ee&&q.length>0&&pe.jsxDEV("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-green-400/30 rounded-md shadow-lg max-h-40 overflow-y-auto",children:q.map((e,r)=>pe.jsxDEV("div",{onClick:()=>Te("product_name",e),className:"px-3 py-2 text-green-400 hover:bg-green-900/20 cursor-pointer border-b border-green-400/10 last:border-b-0",children:e},r,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1013,columnNumber:23},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1011,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:993,columnNumber:17},void 0),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:["产品工序 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1025,columnNumber:89},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1025,columnNumber:19},void 0),pe.jsxDEV("input",{type:"text",value:ae.product_process,onChange:e=>De("product_process",e.target.value),onFocus:()=>{ae.product_process&&K.length>0&&se(!0)},onBlur:()=>{setTimeout(()=>se(!1),200)},className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"请输入产品工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1026,columnNumber:19},void 0),te&&K.length>0&&pe.jsxDEV("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-green-400/30 rounded-md shadow-lg max-h-40 overflow-y-auto",children:K.map((e,r)=>pe.jsxDEV("div",{onClick:()=>Te("product_process",e),className:"px-3 py-2 text-green-400 hover:bg-green-900/20 cursor-pointer border-b border-green-400/10 last:border-b-0",children:e},r,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1044,columnNumber:25},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1042,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1024,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:992,columnNumber:15},void 0),pe.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:"单价（可选）"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1060,columnNumber:19},void 0),pe.jsxDEV("input",{type:"number",step:"0.01",value:ae.unit_price,onChange:e=>oe({...ae,unit_price:e.target.value}),onWheel:e=>e.currentTarget.blur(),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400 [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [-moz-appearance:textfield]",placeholder:"请输入单价"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1061,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1059,columnNumber:17},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium mb-2 text-green-400",children:"生效年月"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1072,columnNumber:19},void 0),pe.jsxDEV("input",{type:"month",value:ae.effective_date,onChange:e=>oe({...ae,effective_date:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1073,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1071,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1058,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:944,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex space-x-4 mt-4",children:[pe.jsxDEV("button",{type:"button",onClick:async()=>{var e,t;if(!r)return W.error("用户未登录，请重新登录"),void n("/login");const s=null==(e=r.company)?void 0:e.id;if(!s)return void W.error("用户没有关联的公司，请联系管理员");if(!ae.production_line.trim())return void W.error("请填写生产线");if(!ae.product_name.trim())return void W.error("请填写产品名称");if(!ae.product_process.trim())return void W.error("请填写产品工序");if(o.find(e=>{const r=e.company_id===s&&e.production_line.trim()===ae.production_line.trim()&&e.production_category===ae.work_time_type&&e.product_name.trim()===ae.product_name.trim()&&e.product_process.trim()===ae.product_process.trim();return r}))W.error("该工序已存在，请检查输入信息！",{duration:4e3,style:{fontSize:"16px",fontWeight:"bold"}});else try{const e={company_id:s,production_line:ae.production_line,production_category:ae.work_time_type,product_name:ae.product_name,product_process:ae.product_process,unit_price:ae.unit_price&&""!==ae.unit_price.trim()?parseFloat(ae.unit_price):null,effective_date:ae.effective_date?`${ae.effective_date}-01`:null,is_active:!0},{data:r,error:n}=await ve.from("processes").insert(e).select("\n          *,\n          companies!inner(\n            name\n          )\n        ").single();if(n)return void W.error(`添加工序失败: ${n.message}`);const i={...r,company_name:(null==(t=r.companies)?void 0:t.name)||"未知公司"};l([i,...o]),ce({...ae}),oe({...ae,unit_price:""}),w(!1),W.success("工序添加成功")}catch(i){W.error(`添加工序失败: ${i.message||"未知错误"}`)}},className:"bg-green-900/20 border border-green-400/30 px-4 py-2 rounded hover:bg-green-900/30 transition-colors text-green-400",children:"确认添加"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1083,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:()=>{w(!1);const e=je();oe({company_id:e,production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"生产工时"})},className:"border border-green-400/30 px-4 py-2 rounded hover:bg-green-900/20 transition-colors text-green-400",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1088,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:()=>{const e=je();oe({company_id:e,production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"生产工时"}),W.success("表单内容已清除")},className:"bg-red-900/20 border border-red-400/30 px-4 py-2 rounded hover:bg-red-900/30 transition-colors text-red-400",children:"清除内容"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1107,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1082,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:939,columnNumber:11},void 0),H&&S&&pe.jsxDEV("div",{className:"bg-gray-800 border border-green-500 rounded-lg p-6 mb-6",children:[pe.jsxDEV("h3",{className:"text-lg font-semibold text-green-400 mb-4",children:"编辑工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1133,columnNumber:13},void 0),pe.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["公司 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1137,columnNumber:22},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1136,columnNumber:17},void 0),pe.jsxDEV("select",{value:ae.company_id,onChange:e=>oe({...ae,company_id:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"请选择公司"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1144,columnNumber:19},void 0),c.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1146,columnNumber:21},void 0))]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1139,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1135,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["生产线 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1154,columnNumber:23},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1153,columnNumber:17},void 0),pe.jsxDEV("input",{type:"text",value:ae.production_line,onChange:e=>oe({...ae,production_line:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"请输入生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1156,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1152,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["工时类型 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1166,columnNumber:24},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1165,columnNumber:17},void 0),pe.jsxDEV("select",{value:ae.work_time_type,onChange:e=>oe({...ae,work_time_type:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"生产工时",children:"生产工时"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1173,columnNumber:19},void 0),pe.jsxDEV("option",{value:"非生产工时",children:"非生产工时"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1174,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1168,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1164,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["产品名称 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1179,columnNumber:24},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1178,columnNumber:17},void 0),pe.jsxDEV("input",{type:"text",value:ae.product_name,onChange:e=>oe({...ae,product_name:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"请输入产品名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1181,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1177,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["产品工序 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1191,columnNumber:24},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1190,columnNumber:17},void 0),pe.jsxDEV("input",{type:"text",value:ae.product_process,onChange:e=>oe({...ae,product_process:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400",placeholder:"请输入产品工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1193,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1189,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"单价"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1202,columnNumber:17},void 0),pe.jsxDEV("input",{type:"number",step:"0.01",value:ae.unit_price,onChange:e=>oe({...ae,unit_price:e.target.value}),onWheel:e=>e.currentTarget.blur(),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400 [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [-moz-appearance:textfield]",placeholder:"请输入单价"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1205,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1201,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"生效年月"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1216,columnNumber:17},void 0),pe.jsxDEV("input",{type:"month",value:ae.effective_date,onChange:e=>oe({...ae,effective_date:e.target.value}),className:"w-full bg-black border border-green-400/30 rounded px-3 py-2 text-green-400 focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1219,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1215,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1134,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex justify-end space-x-3 mt-4",children:[pe.jsxDEV("button",{onClick:()=>{T(!1),j(null),oe({company_id:"",production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"生产工时"})},className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1228,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:async()=>{var e,t,s;if(!S)return;if(!r)return W.error("用户未登录，请重新登录"),void n("/login");if(!He(r.role)&&S.company_id!==(null==(e=r.company)?void 0:e.id))return void W.error("您只能编辑自己公司的工序");if(!He(r.role)&&ae.company_id!==(null==(t=r.company)?void 0:t.id))return void W.error("您只能将工序分配给自己的公司");if(!ae.company_id)return void W.error("请选择公司");if(!ae.production_line.trim())return void W.error("请输入生产线");if(!ae.product_name.trim())return void W.error("请输入产品名称");if(o.find(e=>e.id!==S.id&&e.company_id===ae.company_id&&e.production_line.trim()===ae.production_line.trim()&&e.production_category===ae.work_time_type&&e.product_name.trim()===ae.product_name.trim()&&e.product_process.trim()===ae.product_process.trim()))W.error("该工序已存在，请检查输入信息！",{duration:4e3,style:{fontSize:"16px",fontWeight:"bold"}});else try{const{data:e,error:r}=await ve.from("processes").update({company_id:ae.company_id,production_line:ae.production_line,production_category:ae.work_time_type,product_name:ae.product_name,product_process:ae.product_process,unit_price:ae.unit_price?parseFloat(ae.unit_price):null,effective_date:ae.effective_date?`${ae.effective_date}-01`:null}).eq("id",S.id).select("\n          *,\n          companies!inner(\n            name\n          )\n        ").single();if(r)return void W.error("更新工序失败");const t={...e,company_name:(null==(s=e.companies)?void 0:s.name)||"未知公司"};l(o.map(e=>e.id===S.id?t:e)),oe({company_id:"",production_line:"",production_category:"",product_name:"",product_process:"",unit_price:"",effective_date:(new Date).toISOString().slice(0,7),work_time_type:"生产工时"}),T(!1),j(null),W.success("工序更新成功")}catch(i){W.error("更新工序失败")}},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"更新"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1247,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1227,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1132,columnNumber:11},void 0),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:u?pe.jsxDEV("div",{className:"p-8 text-center text-green-400/60",children:pe.jsxDEV("div",{className:"animate-pulse",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1262,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1261,columnNumber:13},void 0):0===Ce.length?pe.jsxDEV("div",{className:"p-8 text-center text-green-400/60",children:f?"未找到匹配的工序":"暂无工序数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1265,columnNumber:13},void 0):pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full",children:[pe.jsxDEV("thead",{className:"bg-green-900/30",children:pe.jsxDEV("tr",{children:[pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"公司"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1273,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1276,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"工时类型"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1279,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"产品名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1280,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"产品工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1283,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"单价"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1286,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"生效年月"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1289,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-sm font-mono font-medium text-green-400 uppercase tracking-wider",children:"操作"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1292,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1272,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1271,columnNumber:17},void 0),pe.jsxDEV("tbody",{className:"divide-y divide-green-800",children:Ce.map(e=>pe.jsxDEV("tr",{className:"hover:bg-green-900/10",children:[pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.company_name,children:e.company_name},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1301,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1300,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.production_line,children:e.production_line},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1306,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1305,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.production_category||"-",children:e.production_category||"-"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1311,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1310,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.product_name,children:e.product_name},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1316,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1315,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.product_process||"-",children:e.product_process||"-"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1321,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1320,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono "+(!e.unit_price||e.unit_price<=0?"text-red-400 font-bold":"text-green-300"),title:e.unit_price?`¥${e.unit_price.toFixed(2)}`:"未定价",children:e.unit_price&&e.unit_price>0?`¥${e.unit_price.toFixed(2)}`:"未定价"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1326,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1325,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("span",{className:"text-sm font-mono text-green-300",title:e.effective_date,children:e.effective_date?e.effective_date.substring(0,7):""},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1331,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1330,columnNumber:23},void 0),pe.jsxDEV("td",{className:"px-4 py-3 whitespace-nowrap",children:pe.jsxDEV("div",{className:"flex justify-center space-x-1",children:[pe.jsxDEV("button",{onClick:()=>(e=>{var r;j(e);let t="";t=e.effective_date?e.effective_date.includes("-")&&e.effective_date.length>=7?e.effective_date.substring(0,7):e.effective_date:(new Date).toISOString().slice(0,7),oe({company_id:e.company_id,production_line:e.production_line,production_category:e.production_category,product_name:e.product_name,product_process:e.product_process,unit_price:(null==(r=e.unit_price)?void 0:r.toString())||"",effective_date:t,work_time_type:e.production_category}),T(!0)})(e),className:"p-1 text-blue-400/60 hover:text-blue-400 hover:bg-blue-900/20 rounded transition-colors",title:"编辑工序",children:pe.jsxDEV(B,{className:"w-3 h-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1342,columnNumber:29},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1337,columnNumber:27},void 0),pe.jsxDEV("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),fe(e),ue(!0)},className:"p-1 text-red-400/60 hover:text-red-400 hover:bg-red-900/20 rounded transition-colors",title:"删除工序",children:pe.jsxDEV(F,{className:"w-3 h-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1354,columnNumber:29},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1344,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1336,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1335,columnNumber:23},void 0)]},e.id,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1299,columnNumber:21},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1297,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1270,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1269,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1258,columnNumber:9},void 0),pe.jsxDEV("div",{className:"mt-6 text-center text-green-400/60 text-sm",children:["共 ",Ce.length," 个工序",f&&` (从 ${o.length} 个工序中筛选)`,be&&pe.jsxDEV("span",{className:"ml-2 text-red-400 font-bold",children:"(显示未定价工序)"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1371,columnNumber:13},void 0),!be&&pe.jsxDEV("span",{className:"ml-2 text-orange-400",children:["(未定价: ",o.filter(e=>!e.unit_price||e.unit_price<=0).length," 个)"]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1376,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1367,columnNumber:9},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:782,columnNumber:7},void 0),pe.jsxDEV(Ss,{isOpen:me,title:"确认删除",message:de?`确定要删除工序"${de.product_name}"吗？\n\n此操作不可撤销！`:"",onConfirm:()=>{de&&((async e=>{var t;if(!r)return W.error("用户未登录，请重新登录"),void n("/login");const s=o.find(r=>r.id===e);if(s)if(He(r.role)||s.company_id===(null==(t=r.company)?void 0:t.id))try{const{error:r}=await ve.from("processes").update({is_active:!1}).eq("id",e);if(r)return void W.error(`删除工序失败: ${r.message}`);l(o.filter(r=>r.id!==e)),W.success("工序删除成功")}catch(i){W.error("删除工序失败")}else W.error("您只能删除自己公司的工序");else W.error("工序不存在")})(de.id),ue(!1),fe(null))},onCancel:()=>{ue(!1),fe(null)},confirmText:"删除",cancelText:"取消",type:"danger"},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1384,columnNumber:7},void 0),pe.jsxDEV(xg,{isOpen:he,onClose:()=>ge(!1),onImport:async e=>{var t,s;if(!r)return W.error("用户未登录，请重新登录"),void n("/login");let i=0,a=0;const o=[];try{for(let n=0;n<e.length;n++){const m=e[n];try{const e=null==(t=r.company)?void 0:t.id;if(!e){o.push(`第 ${n+1} 行: 无法获取用户公司信息`),a++;continue}if(!He(r.role)&&m.company_id!==e){o.push(`第 ${n+1} 行: 您只能导入自己公司的工序`),a++;continue}const{data:c,error:u}=await ve.from("processes").insert({company_id:e,production_line:m.production_line,production_category:m.production_category,product_name:m.product_name,product_process:m.product_process,unit_price:m.unit_price,effective_date:m.effective_date?m.effective_date.match(/^\d{4}-\d{2}$/)?`${m.effective_date}-01`:m.effective_date:null,is_active:!0}).select("\n              *,\n              companies!inner(\n                name\n              )\n            ").single();if(u)o.push(`第 ${n+1} 行: ${u.message}`),a++;else{const e={...c,company_name:(null==(s=c.companies)?void 0:s.name)||"未知公司"};l(r=>[e,...r]),i++}}catch(c){o.push(`第 ${n+1} 行: ${c.message||"未知错误"}`),a++}}i>0&&0===a?W.success(`批量导入成功！共导入 ${i} 条工序`):i>0&&a>0?W.warning(`部分导入成功！成功 ${i} 条，失败 ${a} 条`):W.error(`导入失败！共 ${a} 条数据导入失败`)}catch(m){W.error(`批量导入失败: ${m.message||"未知错误"}`)}},companies:c,currentUser:r,existingProcesses:o},void 0,!1,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:1405,columnNumber:7},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ProcessManagement.tsx",lineNumber:781,columnNumber:5},void 0)};function Eg({isOpen:e,onClose:r,onConfirm:t,record:s,items:n,productionLines:i,supervisors:a,sectionLeaders:o,workTypes:l,products:c,processes:m}){if(!e)return null;const u=e=>{var r;return(null==(r=l.find(r=>r.id===e))?void 0:r.name)||"未知工时类型"},d=e=>{var r;return(null==(r=c.find(r=>r.id===e))?void 0:r.name)||"未知产品"},f=e=>{var r;return(null==(r=m.find(r=>r.id===e))?void 0:r.product_process)||"未知工序"};return pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[pe.jsxDEV("h2",{className:"text-xl font-bold text-green-400",children:"确认提交工时记录"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:78,columnNumber:11},this),pe.jsxDEV("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors",children:pe.jsxDEV(N,{className:"w-6 h-6"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:83,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:79,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:77,columnNumber:9},this),pe.jsxDEV("div",{className:"space-y-6",children:[pe.jsxDEV("div",{className:"bg-gray-800 border border-green-400 rounded-lg p-4",children:[pe.jsxDEV("h3",{className:"text-lg font-semibold text-green-300 mb-4",children:"基本信息"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:90,columnNumber:13},this),pe.jsxDEV("div",{className:"space-y-2",children:[pe.jsxDEV("div",{className:"flex justify-between",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("span",{className:"text-green-300 font-medium",children:"记录日期："},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:95,columnNumber:19},this),pe.jsxDEV("span",{className:"text-white",children:s.record_date},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:96,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:94,columnNumber:17},this),pe.jsxDEV("div",{children:[pe.jsxDEV("span",{className:"text-green-300 font-medium",children:"生产线："},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:99,columnNumber:19},this),pe.jsxDEV("span",{className:"text-white",children:(h=s.production_line_id,h?(null==(p=i.find(e=>e.id===h))?void 0:p.name)||"未知生产线":"未选择")},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:100,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:98,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:93,columnNumber:15},this),pe.jsxDEV("div",{className:"flex justify-between",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("span",{className:"text-green-300 font-medium",children:"班长："},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:106,columnNumber:19},this),pe.jsxDEV("span",{className:"text-white",children:(e=>{var r;return e?(null==(r=a.find(r=>r.id.toString()===e))?void 0:r.name)||"未知班长":"未选择"})(s.supervisor_id)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:107,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:105,columnNumber:17},this),pe.jsxDEV("div",{children:[pe.jsxDEV("span",{className:"text-green-300 font-medium",children:"段长："},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:110,columnNumber:19},this),pe.jsxDEV("span",{className:"text-white",children:(e=>{var r;return e?(null==(r=o.find(r=>r.id.toString()===e))?void 0:r.name)||"未知段长":"未选择"})(s.section_chief_id)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:111,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:109,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:104,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:91,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:89,columnNumber:11},this),pe.jsxDEV("div",{className:"bg-gray-800 border border-green-400 rounded-lg p-4",children:[pe.jsxDEV("h3",{className:"text-lg font-semibold text-green-300 mb-4",children:["工时记录项 (",n.length,"项)"]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:119,columnNumber:13},this),pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full text-sm",children:[pe.jsxDEV("thead",{children:pe.jsxDEV("tr",{className:"border-b border-green-400",children:[pe.jsxDEV("th",{className:"text-left text-green-300 py-2 px-2",children:"序号"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:124,columnNumber:21},this),pe.jsxDEV("th",{className:"text-left text-green-300 py-2 px-2",children:"工时类型"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:125,columnNumber:21},this),pe.jsxDEV("th",{className:"text-left text-green-300 py-2 px-2",children:"产品名称"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:126,columnNumber:21},this),pe.jsxDEV("th",{className:"text-left text-green-300 py-2 px-2",children:"工序名称"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:127,columnNumber:21},this),pe.jsxDEV("th",{className:"text-left text-green-300 py-2 px-2",children:"数量"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:128,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:123,columnNumber:19},this)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:122,columnNumber:17},this),pe.jsxDEV("tbody",{children:n.map((e,r)=>pe.jsxDEV("tr",{className:"border-b border-gray-600",children:[pe.jsxDEV("td",{className:"py-2 px-2 text-white",children:r+1},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:134,columnNumber:23},this),pe.jsxDEV("td",{className:"py-2 px-2 text-white",children:u(e.work_type_id)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:135,columnNumber:23},this),pe.jsxDEV("td",{className:"py-2 px-2 text-white",children:d(e.product_id)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:136,columnNumber:23},this),pe.jsxDEV("td",{className:"py-2 px-2 text-white",children:f(e.process_id)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:137,columnNumber:23},this),pe.jsxDEV("td",{className:"py-2 px-2 text-white",children:e.quantity},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:138,columnNumber:23},this)]},r,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:133,columnNumber:21},this))},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:131,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:121,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:120,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:118,columnNumber:11},this),pe.jsxDEV("div",{className:"bg-yellow-900/30 border border-yellow-600 rounded-lg p-2 mb-4",children:pe.jsxDEV("p",{className:"text-yellow-300 text-xs",children:"⚠️ 数据提交后将不可修改，请仔细核对以上信息是否正确。数据确认提交后，需要等待班长和段长审核通过。"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:148,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:147,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:87,columnNumber:9},this),pe.jsxDEV("div",{className:"flex justify-end gap-4 mt-6",children:[pe.jsxDEV("button",{onClick:r,className:"px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:156,columnNumber:11},this),pe.jsxDEV("button",{onClick:t,className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors",children:"确认提交"},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:162,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:155,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:76,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/components/TimesheetConfirmDialog.tsx",lineNumber:75,columnNumber:5},this);var h,p}function wg(){const{user:e,isAuthenticated:r,refreshUser:s}=Ve(),n=i(),[o,l]=t.useState(!0),[c,m]=t.useState([]),[u,d]=t.useState([]),[f,h]=t.useState([]),[p,g]=t.useState([]),[b,v]=t.useState([]),[N,y]=t.useState([]),[E,w]=t.useState([]),[D,H]=t.useState(null),[T,S]=t.useState([]),[j,k]=t.useState([]),[V,C]=t.useState({user_id:(null==e?void 0:e.id)||"",record_date:(new Date).toISOString().split("T")[0],production_line_id:0,supervisor_id:null,section_chief_id:null,status:"draft",items:[]}),[R,A]=t.useState({work_type_id:0,product_id:0,process_id:"",quantity:0}),[I,P]=t.useState(""),L=()=>({work_type_id:u.length>0?u[0].id:1,product_id:0,process_id:"",quantity:0}),[F,U]=t.useState([L()]),[B,z]=t.useState({}),[$,G]=t.useState({}),[q,X]=t.useState(!1),Y=async()=>{if(e)try{const{data:r,error:t}=await ve.from("users").select("company_id").eq("id",e.id).single();if(t)throw t;H(r.company_id)}catch(r){W.error("获取用户公司信息失败")}};t.useEffect(()=>{e&&K()},[e]),t.useEffect(()=>{V.production_line_id?(C(e=>({...e,supervisor_id:null,section_chief_id:null})),te(V.production_line_id.toString()),se(V.production_line_id.toString())):(y([]),w([]),C(e=>({...e,supervisor_id:null,section_chief_id:null})))},[V.production_line_id,c]),t.useEffect(()=>{V.production_line_id?(A(e=>({...e,work_type_id:0,product_id:0,process_id:""})),P(""),Q(),Z(),ee()):(d([]),h([]),g([]),A(e=>({...e,work_type_id:0,product_id:0,process_id:""})),P(""))},[V.production_line_id,c]),t.useEffect(()=>{1===c.length&&0===V.production_line_id&&C(e=>({...e,production_line_id:c[0].id}))},[c,V.production_line_id]),t.useEffect(()=>{if(V.production_line_id&&!V.supervisor_id&&b.length>0&&D){const e=b.filter(e=>{var r;if("班长"!==(null==(r=e.role)?void 0:r.name))return!1;if(e.company_id!==D)return!1;if(V.production_line_id){const e=c.find(e=>e.id===V.production_line_id);if(e){return p.filter(r=>r.production_line===e.name).length>0}}return!0});1===e.length&&C(r=>({...r,supervisor_id:e[0].id}))}},[V.production_line_id,V.supervisor_id,b,D,c,p]),t.useEffect(()=>{if(V.production_line_id&&!V.section_chief_id&&b.length>0&&D){const e=b.filter(e=>{var r;if("段长"!==(null==(r=e.role)?void 0:r.name))return!1;if(e.company_id!==D)return!1;if(V.production_line_id){const e=c.find(e=>e.id===V.production_line_id);if(e){return p.filter(r=>r.production_line===e.name).length>0}}return!0});1===e.length&&C(r=>({...r,section_chief_id:e[0].id}))}},[V.production_line_id,V.section_chief_id,b,D,c,p]),t.useEffect(()=>{if(u.length>0&&V.production_line_id&&p.length>0){const e=u.find(e=>e.id===R.work_type_id);if(!e&&u.length>0)return void A(e=>({...e,work_type_id:u[0].id}));if(e){const e=R.work_type_id;ie(e)}}},[u,V.production_line_id,p,R.work_type_id]),t.useEffect(()=>{1===f.length&&0===R.product_id&&A(e=>({...e,product_id:f[0].id}))},[f,R.product_id]),t.useEffect(()=>{1===p.length&&""===R.process_id&&A(e=>({...e,process_id:p[0].id}))},[p,R.process_id]);const K=async()=>{if(e)try{l(!0),await Promise.all([Y(),J(),re()])}catch(r){W.error("加载数据失败")}finally{l(!1)}},J=async()=>{if(e)try{const r=He(e.role);let t=ve.from("processes").select("id, production_line, company_id, is_active").eq("is_active",!0).order("production_line");if(r);else{const{data:r,error:s}=await ve.from("users").select("company_id").eq("id",e.id).single();if(s)throw s;t=t.eq("company_id",r.company_id)}const{data:s,error:n}=await t;if(n)throw n;const i=(null==s?void 0:s.reduce((e,r)=>{if(!r.production_line)return e;return e.find(e=>e.name===r.production_line)||e.push({id:parseInt(r.id.slice(-8),16),name:r.production_line,is_active:r.is_active}),e},[]))||[];m(i)}catch(r){W.error("加载生产线信息失败")}},Q=async()=>{if(e)try{if(!V.production_line_id)return void d([]);const r=c.find(e=>e.id===V.production_line_id);if(!r)return void d([]);const{data:t,error:s}=await ve.from("users").select("company_id").eq("id",e.id).single();if(s)throw s;const{data:n,error:i}=await ve.from("processes").select("production_category").eq("company_id",t.company_id).eq("production_line",r.name).eq("is_active",!0).not("production_category","is",null);if(i)throw i;const a=[...new Set((null==n?void 0:n.map(e=>e.production_category))||[])].filter(e=>e&&isNaN(Number(e))).sort().map((e,r)=>({id:r+1,name:e,is_active:!0}));d(a)}catch(r){W.error("加载工时类型数据失败")}},Z=async()=>{if(e)try{if(!V.production_line_id)return void h([]);const r=c.find(e=>e.id===V.production_line_id);if(!r)return void h([]);const{data:t,error:s}=await ve.from("users").select("company_id").eq("id",e.id).single();if(s)throw s;const{data:n,error:i}=await ve.from("processes").select("id, product_name, production_line").eq("company_id",t.company_id).eq("production_line",r.name).eq("is_active",!0);if(i)throw i;const a=[...new Set((null==n?void 0:n.map(e=>e.product_name))||[])].filter(Boolean).sort().map((e,r)=>({id:r+1,name:e,code:"",is_active:!0}));h(a)}catch(r){W.error("加载产品数据失败")}},ee=async()=>{if(e)try{if(!V.production_line_id)return void g([]);const r=c.find(e=>e.id===V.production_line_id);if(!r)return void g([]);const{data:t,error:s}=await ve.from("users").select("company_id").eq("id",e.id).single();if(s)throw s;const{data:n,error:i}=await ve.from("processes").select("id, product_process, product_name, company_id, production_line, production_category, unit_price, is_active").eq("company_id",t.company_id).eq("production_line",r.name).eq("is_active",!0).order("product_process");if(i)throw i;const a=(null==n?void 0:n.map(e=>({id:e.id,name:e.product_process,product_name:e.product_name,company_id:e.company_id,production_line:e.production_line,production_category:e.production_category,product_process:e.product_process,unit_price:e.unit_price,is_active:e.is_active})))||[];g(a)}catch(r){W.error("加载工序数据失败")}},re=async()=>{const{data:e,error:r}=await ve.from("users").select("id, name, company_id, production_line, role:user_roles!inner(name)").eq("is_active",!0).order("name");if(r)throw r;v(e||[])},te=async e=>{if(e)try{const r=c.find(r=>r.id===parseInt(e));if(!r)return void y([]);const{data:t,error:s}=await ve.from("users").select("\n          id, \n          name, \n          production_line,\n          role:user_roles!inner(name)\n        ").eq("production_line",r.name).eq("user_roles.name","班长").eq("is_active",!0).order("name");if(s)throw s;y(t||[]),t&&1===t.length&&!V.supervisor_id&&C(e=>({...e,supervisor_id:t[0].id}))}catch(r){W.error("加载班长数据失败"),y([])}else y([])},se=async e=>{if(e)try{const r=c.find(r=>r.id===parseInt(e));if(!r)return void w([]);const{data:t,error:s}=await ve.from("users").select("\n          id, \n          name, \n          production_line,\n          role:user_roles!inner(name)\n        ").eq("production_line",r.name).eq("user_roles.name","段长").eq("is_active",!0).order("name");if(s)throw s;w(t||[]),t&&1===t.length&&!V.section_chief_id&&C(e=>({...e,section_chief_id:t[0].id}))}catch(r){W.error("加载段长数据失败"),w([])}else w([])},ne=(e,r)=>{C(t=>{let s=r;"production_line_id"===e?s=parseInt(r)||0:"supervisor_id"!==e&&"section_chief_id"!==e||(s=r||null);const n={...t,[e]:s};return"production_line_id"===e&&(n.supervisor_id=null,n.section_chief_id=null),n})},ie=e=>{if(A(r=>({...r,work_type_id:e,product_id:0,process_id:""})),P(""),0===e)return S([]),void k([]);const r=u.find(r=>r.id===e);if(!r)return S([]),void k([]);const t=ae();if(t){const e=p.filter(e=>{const s=e.production_line===t,n=e.production_category===r.name;return s&&n}).map(e=>e.product_name).filter((e,r,t)=>e&&t.indexOf(e)===r).filter(Boolean);S(e)}else S([]);k([])},ae=()=>{if(V.production_line_id){const e=c.find(e=>e.id===V.production_line_id);return null==e?void 0:e.name}return null},oe=(e,r,t)=>{U(s=>{const n=[...s];let i=t;return"work_type_id"===r||"product_id"===r?i=parseInt(t)||0:"process_id"===r?i=t||"":"quantity"===r&&(i=parseFloat(t)||0),n[e]={...n[e],[r]:i},"work_type_id"===r?(n[e].product_id=0,n[e].process_id="",z(r=>({...r,[e]:""}))):"product_id"===r&&(n[e].process_id=""),n})},le=e=>{if(!e||!V.production_line_id)return[];const r=u.find(r=>r.id===e),t=ae();if(!r||!t)return[];const s=p.filter(e=>e.production_line===t&&e.production_category===r.name&&e.is_active);return[...new Set(s.map(e=>e.product_name))].map((e,r)=>({id:r+1,name:e}))},ce=(e,r)=>{if(!e)return[];const t=ae();if(!t)return[];const s=(r?le(r):[]).find(r=>r.id===e);if(!s)return[];return p.filter(e=>e.production_line===t&&e.product_name===s.name&&e.is_active)},me=async()=>{const e=F.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0),r=[...V.items,...e.map(e=>({...e,total_amount:e.quantity}))];e.length>0&&W.success(`成功添加 ${e.length} 条工时记录`),await ue(r)},ue=async r=>{var t,s;let i;if(!e)return void W.error("❌ 用户未登录，请重新登录后再试",{duration:5e3,description:"登录状态已过期，请刷新页面重新登录"});if(!V.supervisor_id)return void W.error("❌ 请选择班长",{duration:4e3,description:"班长是必填项，请在基本信息中选择班长"});if(!V.section_chief_id)return void W.error("❌ 请选择段长",{duration:4e3,description:"段长是必填项，请在基本信息中选择段长"});const a=r||V.items;if(0!==a.length){W.loading("🔄 正在提交工时记录，请稍候...",{id:"submit-loading",description:`正在提交 ${a.length} 条工时记录到审核系统`});try{l(!0);try{const{data:e,error:r}=await ve.from("users").select("id").limit(1);if(r)throw new Error(`数据库连接失败: ${r.message}`)}catch(o){return void W.error("数据库连接失败，请检查网络连接")}if(!(null==e?void 0:e.id))return void W.error("用户信息无效，请重新登录");i={user_id:e.id,work_date:V.record_date,supervisor_id:V.supervisor_id,section_chief_id:V.section_chief_id,shift_type:"白班",status:"pending"};const{data:t,error:s}=await ve.from("timesheet_records").insert(i).select().single();if(s)throw s;const a=(r||V.items).map(e=>{const r=p.find(r=>r.id===e.process_id),s=r&&null!==r.unit_price?parseFloat(r.unit_price.toString()):0;return{timesheet_record_id:t.id,process_id:e.process_id,quantity:e.quantity,unit_price:s,amount:e.quantity*s}}),{error:c}=await ve.from("timesheet_record_items").insert(a);if(c)throw c;const m=N.find(e=>e.id===V.supervisor_id);null==m||m.name;W.dismiss("submit-loading"),W.success("数据提交成功返回首页",{duration:1500}),setTimeout(()=>{n("/dashboard")},1500),U([L()]),C({user_id:e.id,record_date:(new Date).toISOString().split("T")[0],production_line_id:0,supervisor_id:null,section_chief_id:null,status:"draft",items:[]})}catch(c){W.dismiss("submit-loading");let e="❌ 工时记录提交失败",r="请检查网络连接后重试，如问题持续请联系管理员";"42501"===(null==c?void 0:c.code)?(e="❌ 权限不足，提交失败",r="您没有权限创建工时记录，请联系管理员检查数据库权限配置。如果您是新员工，可能需要管理员为您分配相应权限。"):"23502"===(null==c?void 0:c.code)?(e="❌ 数据验证失败",r="提交的数据缺少必填字段，请检查所有必填项（生产线、班长、段长、工时记录项）是否已正确填写。"):"23503"===(null==c?void 0:c.code)?(e="❌ 数据关联错误",r="您选择的生产线、班长或段长可能已被删除或无效，请重新选择后再试。如问题持续，请联系管理员。"):"42703"===(null==c?void 0:c.code)?(e="❌ 数据格式错误",r="提交的数据格式不正确，这可能是系统版本问题，请联系技术支持。"):(null==(t=null==c?void 0:c.message)?void 0:t.includes("网络"))||(null==(s=null==c?void 0:c.message)?void 0:s.includes("连接"))?(e="❌ 网络连接失败",r="无法连接到服务器，请检查您的网络连接，稍后再试。如果问题持续，请联系IT支持。"):(null==c?void 0:c.message)&&(e="❌ 提交失败",r=`错误详情: ${c.message}。请截图此错误信息并联系管理员。`),W.error(e,{duration:8e3,description:r,action:{label:"重试",onClick:()=>{X(!0)}}})}finally{l(!1)}}else W.error("❌ 请至少添加一条工时记录",{duration:4e3,description:"工时记录不能为空，请添加至少一条有效的工时记录"})};return pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-400 font-mono",children:[pe.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[pe.jsxDEV("div",{className:"mb-4 sm:mb-8",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-2 sm:mb-4",children:[pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV(M,{className:"w-5 h-5 sm:w-8 sm:h-8 text-green-400 mr-2 sm:mr-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1490,columnNumber:15},this),pe.jsxDEV("h1",{className:"text-xl sm:text-4xl font-bold text-green-400 font-mono",children:"工时记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1491,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1489,columnNumber:13},this),pe.jsxDEV(a,{to:"/dashboard",className:"flex items-center space-x-1 sm:space-x-2 px-2 py-1 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-600 to-gray-800 hover:from-gray-500 hover:to-gray-700 text-green-300 border border-green-400 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 font-mono text-sm sm:text-base",children:[pe.jsxDEV(_,{className:"w-4 h-4 sm:w-5 sm:h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1497,columnNumber:15},this),pe.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1498,columnNumber:15},this),pe.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1499,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1493,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1488,columnNumber:11},this),pe.jsxDEV("div",{className:"h-0.5 sm:h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1502,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1487,columnNumber:9},this),pe.jsxDEV("div",{className:"space-y-3 sm:space-y-6",children:pe.jsxDEV("div",{className:"flex flex-col lg:flex-row gap-3 sm:gap-6",children:[pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-3 sm:p-6 flex-1",children:[pe.jsxDEV("h2",{className:"text-lg sm:text-xl font-bold text-green-400 mb-2 sm:mb-4 flex items-center gap-2",children:[pe.jsxDEV(x,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1510,columnNumber:17},this),"基本信息"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1509,columnNumber:15},this),pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:"记录日期"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1519,columnNumber:21},this),pe.jsxDEV("input",{type:"date",value:V.record_date,onChange:e=>ne("record_date",e.target.value),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1520,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1518,columnNumber:19},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["生产线 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1530,columnNumber:27},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1529,columnNumber:21},this),pe.jsxDEV("select",{value:V.production_line_id||0,onChange:e=>ne("production_line_id",parseInt(e.target.value)||0),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm",children:[pe.jsxDEV("option",{value:0,children:"请选择生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1537,columnNumber:23},this),c.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1539,columnNumber:25},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1532,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1528,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1517,columnNumber:17},this),pe.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["班长 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1549,columnNumber:26},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1548,columnNumber:21},this),pe.jsxDEV("select",{value:V.supervisor_id||"",onChange:e=>ne("supervisor_id",e.target.value||null),disabled:!V.production_line_id,className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm "+(V.production_line_id?"":"opacity-50 cursor-not-allowed"),children:[pe.jsxDEV("option",{value:"",children:(V.production_line_id,"请选择班长")},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1559,columnNumber:23},this),N.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1563,columnNumber:25},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1551,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1547,columnNumber:19},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["段长 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1570,columnNumber:26},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1569,columnNumber:21},this),pe.jsxDEV("select",{value:V.section_chief_id||"",onChange:e=>ne("section_chief_id",e.target.value||null),disabled:!V.production_line_id,className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm "+(V.production_line_id?"":"opacity-50 cursor-not-allowed"),children:[pe.jsxDEV("option",{value:"",children:(V.production_line_id,"请选择段长")},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1580,columnNumber:23},this),E.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1584,columnNumber:25},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1572,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1568,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1546,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1515,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1508,columnNumber:13},this),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-3 sm:p-6 flex-1",children:[pe.jsxDEV("h2",{className:"text-lg sm:text-xl font-bold text-green-400 mb-2 sm:mb-4 flex items-center gap-2",children:[pe.jsxDEV(O,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1595,columnNumber:17},this),"添加记录"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1594,columnNumber:15},this),pe.jsxDEV("div",{className:"space-y-3 sm:space-y-4",children:F.map((e,r)=>pe.jsxDEV("div",{className:"bg-gray-800/50 p-3 sm:p-4 rounded-lg border border-gray-700",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-3",children:[pe.jsxDEV("span",{className:"text-green-400 font-medium text-sm",children:["记录 ",r+1]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1606,columnNumber:23},this),pe.jsxDEV("button",{onClick:()=>(e=>{U(r=>{const t=r.filter((r,t)=>t!==e);return 0===t.length?[L()]:t}),z(r=>{const t={...r};delete t[e];const s={};return Object.keys(t).map(e=>parseInt(e)).filter(r=>r>e).forEach(e=>{s[e-1]=t[e]}),Object.keys(t).map(e=>parseInt(e)).filter(r=>r<e).forEach(e=>{s[e]=t[e]}),s}),G(r=>{const t={...r};delete t[e];const s={};return Object.keys(t).map(e=>parseInt(e)).filter(r=>r>e).forEach(e=>{s[e-1]=t[e]}),Object.keys(t).map(e=>parseInt(e)).filter(r=>r<e).forEach(e=>{s[e]=t[e]}),s})})(r),className:"px-3 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",title:"删除此行",children:"删除"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1607,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1605,columnNumber:21},this),pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["工时类型 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1622,columnNumber:34},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1621,columnNumber:27},this),pe.jsxDEV("select",{value:e.work_type_id||0,onChange:e=>oe(r,"work_type_id",parseInt(e.target.value)||0),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm",children:[pe.jsxDEV("option",{value:0,children:"请选择工时类型"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1629,columnNumber:29},this),u.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1631,columnNumber:31},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1624,columnNumber:27},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1620,columnNumber:25},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["产品名称 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1640,columnNumber:34},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1639,columnNumber:27},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV("input",{type:"text",value:B[r]||"",onChange:e=>{const t=e.target.value;z(e=>({...e,[r]:t})),t||oe(r,"product_id",0)},onBlur:t=>{setTimeout(()=>{G(e=>({...e,[r]:!1}))},200);const s=t.target.value,n=le(e.work_type_id).find(e=>e.name===s);n&&oe(r,"product_id",n.id)},onClick:t=>{e.work_type_id&&(t.currentTarget.focus(),G(e=>({...e,[r]:!0})))},onFocus:()=>{e.work_type_id&&G(e=>({...e,[r]:!0}))},className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm "+(e.work_type_id?"":"opacity-50 cursor-not-allowed"),placeholder:e.work_type_id?"请输入产品名称":"请先选择工时类型",disabled:!e.work_type_id},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1643,columnNumber:29},this),$[r]&&e.work_type_id&&pe.jsxDEV("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-green-400 rounded-md shadow-lg max-h-40 overflow-y-auto",children:le(e.work_type_id).filter(e=>e.name.toLowerCase().includes((B[r]||"").toLowerCase())).map(e=>pe.jsxDEV("div",{onClick:()=>{z(t=>({...t,[r]:e.name})),oe(r,"product_id",e.id),G(e=>({...e,[r]:!1}))},className:"px-2 py-1.5 sm:px-3 sm:py-2 text-green-300 hover:bg-gray-700 cursor-pointer border-b border-gray-600 last:border-b-0 text-xs sm:text-sm",children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1696,columnNumber:35},this))},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1690,columnNumber:31},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1642,columnNumber:27},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1638,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1619,columnNumber:23},this),pe.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["工序名称 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1718,columnNumber:34},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1717,columnNumber:27},this),pe.jsxDEV("select",{value:e.process_id||"",onChange:e=>oe(r,"process_id",e.target.value||""),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm "+(e.product_id?"":"opacity-50 cursor-not-allowed"),disabled:!e.product_id,children:[pe.jsxDEV("option",{value:"",children:e.product_id?"请选择工序名称":"请先选择产品"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1728,columnNumber:29},this),ce(e.product_id,e.work_type_id).map(e=>pe.jsxDEV("option",{value:e.id,children:e.product_process},e.id,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1732,columnNumber:31},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1720,columnNumber:27},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1716,columnNumber:25},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs font-medium mb-1",children:["数量 ",pe.jsxDEV("span",{className:"text-red-400",children:"*"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1741,columnNumber:32},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1740,columnNumber:27},this),pe.jsxDEV("input",{type:"number",value:e.quantity||"",onChange:e=>oe(r,"quantity",parseFloat(e.target.value)||0),onWheel:e=>e.currentTarget.blur(),className:"w-full px-2 py-1.5 sm:px-3 sm:py-2 bg-gray-800 border border-green-400 text-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-300 text-xs sm:text-sm [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",placeholder:"请输入数量",min:"0",step:"0.01"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1743,columnNumber:27},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1739,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1715,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1617,columnNumber:21},this)]},r,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1604,columnNumber:19},this))},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1602,columnNumber:15},this),pe.jsxDEV("div",{className:"mt-4 sm:mt-6 grid grid-cols-2 gap-2 sm:flex sm:justify-between sm:items-center",children:[pe.jsxDEV("button",{onClick:()=>{U(e=>[...e,L()]);const e=F.length;z(r=>({...r,[e]:""})),G(r=>({...r,[e]:!1}))},className:"px-2 py-2 sm:px-4 sm:py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors flex items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm",children:[pe.jsxDEV(O,{className:"w-3 h-3 sm:w-4 sm:h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1766,columnNumber:19},this),pe.jsxDEV("span",{className:"hidden sm:inline",children:"添加新记录项"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1767,columnNumber:19},this),pe.jsxDEV("span",{className:"sm:hidden",children:"添加记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1768,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1762,columnNumber:17},this),pe.jsxDEV("button",{onClick:()=>{if(!V.supervisor_id)return void W.error("❌ 请选择班长",{duration:4e3,description:"班长是必填项，请在基本信息中选择班长"});if(!V.section_chief_id)return void W.error("❌ 请选择段长",{duration:4e3,description:"段长是必填项，请在基本信息中选择段长"});const e=F.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0);for(let r=0;r<e.length;r++){const t=e[r],s=f.find(e=>e.id===t.product_id);if(!s||!s.name||""===s.name.trim())return void W.error("❌ 产品名称不完整",{duration:4e3,description:`第 ${F.indexOf(t)+1} 条记录的产品名称不完整，请重新选择产品`})}X(!0)},className:"px-2 py-2 sm:px-6 sm:py-2 rounded-md focus:outline-none focus:ring-2 transition-colors text-xs sm:text-sm font-medium "+(0!==F.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0).length&&V.supervisor_id&&V.section_chief_id?"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500":"bg-gray-500 text-gray-300 cursor-not-allowed"),disabled:0===F.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0).length||!V.supervisor_id||!V.section_chief_id,children:"提交审核"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1770,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1761,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1593,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1506,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1504,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1485,columnNumber:7},this),pe.jsxDEV(Eg,{isOpen:q,onClose:()=>X(!1),onConfirm:async()=>{X(!1),await me()},record:V,items:F.filter(e=>e.work_type_id&&e.process_id&&e.quantity>0),productionLines:c,supervisors:N,sectionLeaders:E,workTypes:u,products:f,processes:p},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1793,columnNumber:7},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetRecord.tsx",lineNumber:1484,columnNumber:5},this)}function Dg(){var e,r,s,n,i,a;const{user:o}=Ve(),[l,c]=t.useState(!0),[m,u]=t.useState(!1),[d,f]=t.useState([]),[h,p]=t.useState([]),[g,b]=t.useState([]),[N,x]=t.useState({startDate:new Date(Date.now()-2592e6).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0],status:"",productionLineId:"",workTypeId:"",productId:""}),[y,E]=t.useState([]),[w,D]=t.useState(null),[_,H]=t.useState(!1),[T,S]=t.useState(null),[j,k]=t.useState(!1),[V,C]=t.useState(!1),[R,A]=t.useState(1),[O,P]=t.useState(1),[L,U]=t.useState(0);t.useEffect(()=>{B()},[]),t.useEffect(()=>{K()},[R]);const B=async()=>{try{c(!0),await Promise.all([z(),$(),q()]),await K()}catch(e){W.error("加载数据失败")}finally{c(!1)}},z=async()=>{try{const{data:e,error:r}=await ve.from("processes").select("production_line");if(r)throw r;const t=(e?[...new Set(e.map(e=>e.production_line).filter(Boolean))]:[]).map((e,r)=>({id:r+1,name:e}));f(t)}catch(e){f([])}},$=async()=>{const{data:e,error:r}=await ve.from("work_types").select("id, name").eq("is_active",!0).order("name");if(r)throw r;p(e||[])},q=async()=>{const{data:e,error:r}=await ve.from("products").select("id, name, code").eq("is_active",!0).order("name");if(r)throw r;b(e||[])},K=async(e=!1)=>{if(o)try{u(!0),e&&A(1);const r=10*((e?1:R)-1);let t=ve.from("timesheet_records").select("*",{count:"exact"}).eq("user_id",o.id).gte("record_date",N.startDate).lte("record_date",N.endDate).order("record_date",{ascending:!1}).order("created_at",{ascending:!1}).range(r,r+10-1);N.status&&(t=t.eq("status",N.status)),N.productionLineId&&(t=t.eq("production_line_id",parseInt(N.productionLineId)));const{data:s,error:n,count:i}=await t;if(n)throw n;const a=(null==s?void 0:s.map(e=>e.id))||[];let l=[];if(a.length>0){const{data:e,error:r}=await ve.from("timesheet_record_items").select("*").in("timesheet_record_id",a);if(r)throw r;l=e||[]}const c=(null==s?void 0:s.map(e=>{const r=l.filter(r=>r.timesheet_record_id===e.id);return{...e,items:r,total_amount:r.reduce((e,r)=>e+r.quantity*r.unit_price,0)||0}}))||[];E(c),U(i||0),P(Math.ceil((i||0)/10))}catch(r){W.error("查询失败，请重试")}finally{u(!1)}},J=(e,r)=>{x(t=>({...t,[e]:r}))},Q=()=>{k(!1),S(null)},Z=e=>{switch(e){case"draft":return"草稿";case"submitted":return"已提交";case"approved":return"已审核";case"rejected":return"已拒绝";default:return e}},ee=e=>{switch(e){case"draft":default:return"bg-gray-600 text-gray-300";case"submitted":return"bg-yellow-600 text-yellow-100";case"approved":return"bg-green-600 text-green-100";case"rejected":return"bg-red-600 text-red-100"}};return l?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:346,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:345,columnNumber:7},this):pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-300",children:[pe.jsxDEV("header",{className:"bg-gray-900 border-b border-green-400 px-6 py-4",children:pe.jsxDEV("div",{className:"max-w-7xl mx-auto",children:[pe.jsxDEV("h1",{className:"text-2xl font-bold text-green-400 font-mono flex items-center gap-2",children:[pe.jsxDEV(M,{className:"w-8 h-8"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:359,columnNumber:13},this),"工时记录历史"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:358,columnNumber:11},this),pe.jsxDEV("p",{className:"text-green-600 text-sm font-mono mt-1",children:"TIMESHEET HISTORY MANAGEMENT"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:362,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:357,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:356,columnNumber:7},this),pe.jsxDEV("div",{className:"max-w-7xl mx-auto p-6",children:[pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-6 mb-6",children:[pe.jsxDEV("h2",{className:"text-xl font-bold text-green-400 font-mono mb-4 flex items-center gap-2",children:[pe.jsxDEV(X,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:372,columnNumber:13},this),"查询条件"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:371,columnNumber:11},this),pe.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"开始日期"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:378,columnNumber:15},this),pe.jsxDEV("input",{type:"date",value:N.startDate,onChange:e=>J("startDate",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:381,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:377,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"结束日期"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:390,columnNumber:15},this),pe.jsxDEV("input",{type:"date",value:N.endDate,onChange:e=>J("endDate",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:393,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:389,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:402,columnNumber:15},this),pe.jsxDEV("select",{value:N.status,onChange:e=>J("status",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:410,columnNumber:17},this),pe.jsxDEV("option",{value:"draft",children:"草稿"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:411,columnNumber:17},this),pe.jsxDEV("option",{value:"submitted",children:"已提交"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:412,columnNumber:17},this),pe.jsxDEV("option",{value:"approved",children:"已审核"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:413,columnNumber:17},this),pe.jsxDEV("option",{value:"rejected",children:"已拒绝"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:414,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:405,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:401,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:419,columnNumber:15},this),pe.jsxDEV("select",{value:N.productionLineId,onChange:e=>J("productionLineId",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:427,columnNumber:17},this),d.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:429,columnNumber:19},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:422,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:418,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"工时类型"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:435,columnNumber:15},this),pe.jsxDEV("select",{value:N.workTypeId,onChange:e=>J("workTypeId",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部类型"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:443,columnNumber:17},this),h.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:445,columnNumber:19},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:438,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:434,columnNumber:13},this),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 font-mono text-sm mb-2",children:"产品"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:451,columnNumber:15},this),pe.jsxDEV("select",{value:N.productId,onChange:e=>J("productId",e.target.value),className:"w-full px-3 py-2 bg-gray-800 border border-green-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部产品"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:459,columnNumber:17},this),g.map(e=>pe.jsxDEV("option",{value:e.id,children:[e.name," (",e.code,")"]},e.id,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:461,columnNumber:19},this))]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:454,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:450,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:376,columnNumber:11},this),pe.jsxDEV("div",{className:"flex gap-2",children:[pe.jsxDEV("button",{onClick:()=>{K(!0)},disabled:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-gray-600 text-white font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(I,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:473,columnNumber:15},this),m?"查询中...":"查询"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:468,columnNumber:13},this),pe.jsxDEV("button",{onClick:()=>{x({startDate:new Date(Date.now()-2592e6).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0],status:"",productionLineId:"",workTypeId:"",productId:""}),A(1)},className:"flex items-center gap-2 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(Y,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:481,columnNumber:15},this),"重置"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:477,columnNumber:13},this),pe.jsxDEV("button",{onClick:async()=>{try{W.info("导出功能开发中...")}catch(e){W.error("导出失败")}},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded transition-colors font-mono",children:[pe.jsxDEV(G,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:489,columnNumber:15},this),"导出"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:485,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:467,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:370,columnNumber:9},this),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-4 mb-6",children:pe.jsxDEV("div",{className:"flex justify-between items-center",children:[pe.jsxDEV("div",{className:"text-green-300 font-mono",children:["共找到 ",pe.jsxDEV("span",{className:"text-green-400 font-bold",children:L},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:499,columnNumber:19},this)," 条记录"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:498,columnNumber:13},this),pe.jsxDEV("div",{className:"text-green-300 font-mono",children:["总金额: ",pe.jsxDEV("span",{className:"text-green-400 font-bold",children:["￥",y.reduce((e,r)=>e+(r.total_amount||0),0).toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:502,columnNumber:20},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:501,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:497,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:496,columnNumber:9},this),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full",children:[pe.jsxDEV("thead",{className:"bg-gray-800 border-b border-green-600",children:pe.jsxDEV("tr",{children:[pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"记录日期"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:513,columnNumber:19},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:514,columnNumber:19},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"工时项数"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:515,columnNumber:19},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"总金额"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:516,columnNumber:19},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:517,columnNumber:19},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"创建时间"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:518,columnNumber:19},this),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"操作"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:519,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:512,columnNumber:17},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:511,columnNumber:15},this),pe.jsxDEV("tbody",{children:0===y.length?pe.jsxDEV("tr",{children:pe.jsxDEV("td",{colSpan:7,className:"px-4 py-8 text-center",children:[pe.jsxDEV(M,{className:"w-12 h-12 text-green-600 mx-auto mb-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:526,columnNumber:23},this),pe.jsxDEV("p",{className:"text-green-600 font-mono",children:"暂无工时记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:527,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:525,columnNumber:21},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:524,columnNumber:19},this):y.map(e=>{var r,t;return pe.jsxDEV("tr",{className:"border-b border-green-800 hover:bg-gray-800 transition-colors",children:[pe.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:e.record_date},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:533,columnNumber:23},this),pe.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:null==(r=e.production_line)?void 0:r.name},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:536,columnNumber:23},this),pe.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:(null==(t=e.items)?void 0:t.length)||0},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:539,columnNumber:23},this),pe.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:["￥",(e.total_amount||0).toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:542,columnNumber:23},this),pe.jsxDEV("td",{className:"px-4 py-3",children:pe.jsxDEV("span",{className:`px-2 py-1 rounded text-xs font-mono ${ee(e.status)}`,children:Z(e.status)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:546,columnNumber:25},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:545,columnNumber:23},this),pe.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:new Date(e.created_at).toLocaleString("zh-CN")},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:550,columnNumber:23},this),pe.jsxDEV("td",{className:"px-4 py-3",children:pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("button",{onClick:()=>(e=>{D(e),H(!0)})(e),className:"p-1 text-blue-400 hover:text-blue-300 transition-colors",title:"查看详情",children:pe.jsxDEV(v,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:560,columnNumber:29},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:555,columnNumber:27},this),"draft"===e.status&&pe.jsxDEV("button",{onClick:()=>(e=>{"draft"===e.status?(S(e),k(!0)):W.error("只有草稿状态的工时记录可以删除")})(e),className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"删除记录",children:pe.jsxDEV(F,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:568,columnNumber:31},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:563,columnNumber:29},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:554,columnNumber:25},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:553,columnNumber:23},this)]},e.id,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:532,columnNumber:21},this)})},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:522,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:510,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:509,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:508,columnNumber:9},this),O>1&&pe.jsxDEV("div",{className:"flex justify-center items-center gap-2 mt-6",children:[pe.jsxDEV("button",{onClick:()=>A(e=>Math.max(1,e-1)),disabled:1===R,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 text-green-300 font-mono rounded transition-colors",children:"上一页"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:584,columnNumber:13},this),pe.jsxDEV("span",{className:"text-green-300 font-mono",children:["第 ",R," 页，共 ",O," 页"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:592,columnNumber:13},this),pe.jsxDEV("button",{onClick:()=>A(e=>Math.min(O,e+1)),disabled:R===O,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 text-green-300 font-mono rounded transition-colors",children:"下一页"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:596,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:583,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:368,columnNumber:7},this),_&&w&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:pe.jsxDEV("div",{className:"p-6",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-6",children:[pe.jsxDEV("h2",{className:"text-xl font-bold text-green-400 font-mono",children:"工时记录详情"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:613,columnNumber:17},this),pe.jsxDEV("button",{onClick:()=>H(!1),className:"text-green-400 hover:text-green-300 transition-colors",children:"✕"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:616,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:612,columnNumber:15},this),pe.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[pe.jsxDEV("div",{className:"space-y-2",children:[pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[pe.jsxDEV("span",{className:"text-green-600",children:"记录日期:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:628,columnNumber:21},this)," ",w.record_date]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:627,columnNumber:19},this),pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[pe.jsxDEV("span",{className:"text-green-600",children:"生产线:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:631,columnNumber:21},this)," ",null==(e=w.production_line)?void 0:e.name]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:630,columnNumber:19},this),pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[pe.jsxDEV("span",{className:"text-green-600",children:"班长:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:634,columnNumber:21},this)," ",(null==(r=w.supervisor)?void 0:r.name)||"未指定"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:633,columnNumber:19},this),pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[pe.jsxDEV("span",{className:"text-green-600",children:"段长:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:637,columnNumber:21},this)," ",(null==(s=w.section_chief)?void 0:s.name)||"未指定"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:636,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:626,columnNumber:17},this),pe.jsxDEV("div",{className:"space-y-2",children:[pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[pe.jsxDEV("span",{className:"text-green-600",children:"状态:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:642,columnNumber:21},this),pe.jsxDEV("span",{className:`ml-2 px-2 py-1 rounded text-xs ${ee(w.status)}`,children:Z(w.status)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:643,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:641,columnNumber:19},this),pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[pe.jsxDEV("span",{className:"text-green-600",children:"创建时间:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:648,columnNumber:21},this)," ",new Date(w.created_at).toLocaleString("zh-CN")]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:647,columnNumber:19},this),pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[pe.jsxDEV("span",{className:"text-green-600",children:"更新时间:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:651,columnNumber:21},this)," ",new Date(w.updated_at).toLocaleString("zh-CN")]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:650,columnNumber:19},this),pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm",children:[pe.jsxDEV("span",{className:"text-green-600",children:"总金额:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:654,columnNumber:21},this)," ￥",(w.total_amount||0).toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:653,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:640,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:625,columnNumber:15},this),pe.jsxDEV("div",{children:[pe.jsxDEV("h3",{className:"text-lg font-bold text-green-400 font-mono mb-4",children:"工时明细"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:661,columnNumber:17},this),pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full",children:[pe.jsxDEV("thead",{className:"bg-gray-800 border-b border-green-600",children:pe.jsxDEV("tr",{children:[pe.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"工时类型"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:668,columnNumber:25},this),pe.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"产品"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:669,columnNumber:25},this),pe.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:670,columnNumber:25},this),pe.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"数量"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:671,columnNumber:25},this),pe.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"单位"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:672,columnNumber:25},this),pe.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"单价"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:673,columnNumber:25},this),pe.jsxDEV("th",{className:"px-4 py-2 text-left text-green-400 font-mono text-sm",children:"小计"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:674,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:667,columnNumber:23},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:666,columnNumber:21},this),pe.jsxDEV("tbody",{children:(null==(n=w.items)?void 0:n.map((e,r)=>{var t,s,n,i;return pe.jsxDEV("tr",{className:"border-b border-green-800",children:[pe.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:null==(t=e.work_type)?void 0:t.name},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:680,columnNumber:27},this),pe.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:[null==(s=e.product)?void 0:s.name," (",null==(n=e.product)?void 0:n.code,")"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:683,columnNumber:27},this),pe.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:null==(i=e.process)?void 0:i.name},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:686,columnNumber:27},this),pe.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:e.quantity},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:689,columnNumber:27},this),pe.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:e.unit},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:692,columnNumber:27},this),pe.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:["￥",e.unit_price.toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:695,columnNumber:27},this),pe.jsxDEV("td",{className:"px-4 py-2 text-green-300 font-mono text-sm",children:["￥",(e.quantity*e.unit_price).toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:698,columnNumber:27},this)]},e.id||r,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:679,columnNumber:25},this)}))||[]},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:677,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:665,columnNumber:19},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:664,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:660,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:611,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:610,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:609,columnNumber:9},this),j&&T&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-red-400 rounded-lg max-w-md w-full",children:pe.jsxDEV("div",{className:"p-6",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[pe.jsxDEV("h2",{className:"text-xl font-bold text-red-400 font-mono",children:"确认删除"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:718,columnNumber:17},this),pe.jsxDEV("button",{onClick:Q,className:"text-red-400 hover:text-red-300 transition-colors",disabled:V,children:"✕"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:721,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:717,columnNumber:15},this),pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("p",{className:"text-red-300 font-mono mb-2",children:"您确定要删除以下工时记录吗？"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:731,columnNumber:17},this),pe.jsxDEV("div",{className:"bg-gray-800 border border-red-600 rounded p-3",children:pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm space-y-1",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("span",{className:"text-red-400",children:"记录日期:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:736,columnNumber:26},this)," ",T.record_date]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:736,columnNumber:21},this),pe.jsxDEV("div",{children:[pe.jsxDEV("span",{className:"text-red-400",children:"生产线:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:737,columnNumber:26},this)," ",null==(i=T.production_line)?void 0:i.name]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:737,columnNumber:21},this),pe.jsxDEV("div",{children:[pe.jsxDEV("span",{className:"text-red-400",children:"工时项数:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:738,columnNumber:26},this)," ",(null==(a=T.items)?void 0:a.length)||0]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:738,columnNumber:21},this),pe.jsxDEV("div",{children:[pe.jsxDEV("span",{className:"text-red-400",children:"总金额:"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:739,columnNumber:26},this)," ￥",(T.total_amount||0).toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:739,columnNumber:21},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:735,columnNumber:19},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:734,columnNumber:17},this),pe.jsxDEV("p",{className:"text-red-400 font-mono text-sm mt-3",children:"⚠️ 此操作将同时删除所有相关的工时明细和审核历史，且无法恢复！"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:742,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:730,columnNumber:15},this),pe.jsxDEV("div",{className:"flex justify-end gap-3",children:[pe.jsxDEV("button",{onClick:Q,disabled:V,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 text-green-300 font-mono rounded transition-colors",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:748,columnNumber:17},this),pe.jsxDEV("button",{onClick:async()=>{if(T)try{C(!0);const{error:e}=await ve.from("timesheet_records").delete().eq("id",T.id).eq("user_id",null==o?void 0:o.id);if(e)throw e;W.success("工时记录删除成功"),await K(),k(!1),S(null)}catch(e){W.error("删除失败，请重试")}finally{C(!1)}},disabled:V,className:"px-4 py-2 bg-red-600 hover:bg-red-500 disabled:bg-red-800 text-white font-mono rounded transition-colors flex items-center gap-2",children:V?pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:762,columnNumber:23},this),"删除中..."]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:761,columnNumber:21},this):pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV(F,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:767,columnNumber:23},this),"确认删除"]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:766,columnNumber:21},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:755,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:747,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:716,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:715,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:714,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/TimesheetHistory.tsx",lineNumber:354,columnNumber:5},this)}const _g=e=>{if(!e)return"";return new Date(e).toISOString().split("T")[0]},Hg=()=>{const{user:e}=Ve(),r=i(),[s,n]=t.useState([]),[o,l]=t.useState([]),[c,m]=t.useState(!0),[u,d]=t.useState(null),[f,h]=t.useState(""),[p,g]=t.useState(!1),[b,v]=t.useState([]),[y,E]=t.useState(!1),[w,D]=t.useState(null),[H,T]=t.useState(0),[S,j]=t.useState(0),[k,C]=t.useState(!1),[R,A]=t.useState(null),[I,O]=t.useState(!1),[L,U]=t.useState(null),[B,z]=t.useState(null),[$,G]=t.useState(new Set),[q,X]=t.useState(!1);t.useEffect(()=>{ee()},[]);const Y=new Map,ee=async()=>{var r;if(e)try{m(!0);let t=ve.from("timesheet_records").select("\n          *,\n          supervisor:supervisor_id(id, name),\n          section_chief:section_chief_id(id, name),\n          user:user_id(id, name, phone),\n          timesheet_record_items(*)\n        ").eq("status","pending");"超级管理员"!==(null==(r=e.role)?void 0:r.name)&&(t=t.eq("supervisor_id",e.id));const{data:s,error:i}=await t.order("created_at",{ascending:!1});if(i)throw i;const a=(null==s?void 0:s.flatMap(e=>e.timesheet_record_items||[]))||[],o=[...new Set(a.map(e=>e.process_id).filter(Boolean))],c=o.filter(e=>!Y.has(e));if(c.length>0){const{data:e,error:r}=await ve.from("processes").select("id, product_process, product_name, production_category, production_line").in("id",c);r||(e||[]).forEach(e=>{Y.set(e.id,e)})}const u=o.map(e=>Y.get(e)).filter(Boolean),d=new Map(u.map(e=>[e.id,e])),f=((null==s?void 0:s.map(e=>{const r=e.timesheet_record_items||[],t=r.length>0?d.get(r[0].process_id):null,s=t?{name:t.production_line}:{name:"未知生产线"};return{...e,production_line:s,user:{name:e.user_name||(e.user?e.user.name:"未知用户"),phone:e.user?e.user.phone:""},supervisor:e.supervisor_name?{id:e.supervisor_id,name:e.supervisor_name}:e.supervisor||null,section_chief:e.section_chief_name?{id:e.section_chief_id,name:e.section_chief_name}:e.section_chief||null,items:r.map(e=>{const r=d.get(e.process_id);return{id:e.id,timesheet_record_id:e.timesheet_record_id,work_type:{name:(null==r?void 0:r.production_category)||"未知工时类型"},product:{name:(null==r?void 0:r.product_name)||"未知产品",code:""},process:{name:(null==r?void 0:r.product_process)||"未知工序"},quantity:e.quantity,unit:e.unit||"件"}})}}))||[]).filter(e=>e.items&&e.items.length>0);n(f);const h=(e=>{const r=new Map;e.forEach(e=>{if(e.items&&e.items.length>0){const t=`${e.user_id}_${e.work_date}`,s=r.get(t);s?s.push(e):r.set(t,[e])}});const t=[];return r.forEach((e,r)=>{const s=e[0];let n=[],i=new Date(s.updated_at).getTime();e.forEach(e=>{n=n.concat(e.items);const r=new Date(e.updated_at).getTime();r>i&&(i=r)}),t.push({groupKey:r,user_id:s.user_id,work_date:s.work_date,user:s.user,production_line:s.production_line,supervisor:s.supervisor,section_chief:s.section_chief,originalRecords:e,totalItems:n.length,allItems:n,status:s.status,created_at:s.created_at,updated_at:i.toString()})}),t.sort((e,r)=>{const t=new Date(e.created_at).getTime();return new Date(r.created_at).getTime()-t})})(f);l(h)}catch(t){W.error("获取待审核记录失败")}finally{m(!1)}},re=async(r,t)=>{try{g(!0);const s=r.originalRecords.map(e=>e.id),n=await(async(e,r)=>{try{const{error:t}=await ve.from("timesheet_records").update({status:r,updated_at:(new Date).toISOString()}).in("id",e);return!t||(W.error("更新记录状态失败"),!1)}catch(t){return W.error("更新记录状态失败"),!1}})(s,"approved");if(!n)return;const i=s.map(r=>({timesheet_record_id:r,approver_id:null==e?void 0:e.id,approver_type:"supervisor",action:"approved",comment:t||null,created_at:(new Date).toISOString()})),a=await(async e=>{try{const{error:r}=await ve.from("approval_history").insert(e);return!r||(W.error("插入审核历史失败"),!1)}catch(r){return W.error("插入审核历史失败"),!1}})(i);if(!a)return;window.location.href="/"}catch(s){W.error("审核操作失败，请重试")}finally{g(!1)}},te=()=>{D(null),T(0)},[se,ne]=t.useState(null);return c?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:723,columnNumber:9},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:722,columnNumber:7},void 0):pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-400 font-mono",children:[pe.jsxDEV("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[pe.jsxDEV("div",{className:"mb-8",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV(V,{className:"w-8 h-8 text-green-400 mr-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:737,columnNumber:15},void 0),pe.jsxDEV("h1",{className:"text-4xl font-bold text-green-400 font-mono",children:"班长审核"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:738,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:736,columnNumber:13},void 0),pe.jsxDEV(a,{to:"/dashboard",className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-green-300 hover:text-green-200 rounded-lg font-mono transition-all duration-200 shadow-md hover:shadow-lg border border-gray-600 hover:border-green-500/50",children:[pe.jsxDEV(_,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:744,columnNumber:15},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:745,columnNumber:15},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:746,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:740,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:735,columnNumber:11},void 0),pe.jsxDEV("div",{className:"h-1 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:749,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:734,columnNumber:9},void 0),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-3 mb-4",children:pe.jsxDEV("div",{className:"flex items-center gap-3",children:[pe.jsxDEV("span",{className:"text-green-300 font-mono text-sm bg-gray-800 px-2 py-1 rounded",children:[o.length," 条记录"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:755,columnNumber:13},void 0),$.size>0&&pe.jsxDEV("span",{className:"text-green-400 font-mono text-sm",children:["已选择 ",$.size," 条"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:759,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:754,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:753,columnNumber:9},void 0),0===o.length?pe.jsxDEV("div",{className:"text-center py-12",children:[pe.jsxDEV(M,{className:"w-16 h-16 text-green-600 mx-auto mb-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:768,columnNumber:15},void 0),pe.jsxDEV("h3",{className:"text-lg font-medium text-green-400 mb-2 font-mono",children:"暂无待审核记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:769,columnNumber:15},void 0),pe.jsxDEV("p",{className:"text-green-600 font-mono",children:"当前没有需要审核的工时记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:770,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:767,columnNumber:13},void 0):pe.jsxDEV("div",{className:"space-y-4",children:o.map(e=>pe.jsxDEV("div",{className:"border border-green-400 bg-gray-800 rounded-lg p-4 sm:p-6 hover:bg-gray-700 transition-all duration-200",children:[pe.jsxDEV("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:pe.jsxDEV("div",{className:"flex items-center gap-3",children:[pe.jsxDEV("input",{type:"checkbox",checked:$.has(e.groupKey),onChange:()=>(e=>{const r=new Set($);r.has(e)?r.delete(e):r.add(e),G(r)})(e.groupKey),className:"w-4 h-4 text-green-600 border-green-400 rounded focus:ring-green-500 bg-gray-700 flex-shrink-0"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:779,columnNumber:23},void 0),pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV(x,{className:"w-4 h-4 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:786,columnNumber:25},void 0),pe.jsxDEV("span",{className:"font-medium text-green-300 font-mono",children:e.user.name},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:787,columnNumber:25},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:785,columnNumber:23},void 0),pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV(K,{className:"w-4 h-4 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:790,columnNumber:25},void 0),pe.jsxDEV("span",{className:"text-green-300 font-mono text-sm",children:_g(e.work_date)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:791,columnNumber:25},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:789,columnNumber:23},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:778,columnNumber:21},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:777,columnNumber:19},void 0),pe.jsxDEV("div",{className:"grid grid-cols-1 gap-3 mb-4",children:pe.jsxDEV("div",{className:"flex items-center gap-2 text-sm",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"记录总数:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:801,columnNumber:23},void 0),pe.jsxDEV("span",{className:"text-green-300 font-medium",children:e.allItems.length},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:802,columnNumber:23},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:800,columnNumber:21},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:799,columnNumber:19},void 0),pe.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 mb-4",children:e.allItems.map(e=>{var r,t,s,n;return pe.jsxDEV("div",{className:"bg-gray-900 rounded-lg p-2 border border-gray-700",children:[pe.jsxDEV("div",{className:"mb-1",children:[pe.jsxDEV("div",{className:"text-green-200 font-mono text-xs font-medium leading-tight",children:`${(null==(r=e.work_type)?void 0:r.name)||"未知类型"} | ${(null==(t=e.product)?void 0:t.name)||"未知产品"} | ${(null==(s=e.process)?void 0:s.name)||"未知工序"}`},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:812,columnNumber:27},void 0),(null==(n=e.product)?void 0:n.code)&&pe.jsxDEV("div",{className:"text-green-500 font-mono text-xs mt-1",children:["产品编码: ",e.product.code]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:816,columnNumber:29},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:811,columnNumber:25},void 0),pe.jsxDEV("div",{className:"flex items-center justify-between gap-1",children:[pe.jsxDEV("div",{className:"flex items-center gap-1",children:[pe.jsxDEV("span",{className:"text-xs text-gray-400",children:"数量:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:823,columnNumber:29},void 0),w===e.id?pe.jsxDEV("div",{className:"flex items-center gap-1",children:[pe.jsxDEV("input",{type:"number",value:H,onChange:e=>T(Number(e.target.value)),onWheel:e=>e.preventDefault(),className:"w-14 px-1 py-0.5 bg-gray-600 border border-green-400 rounded text-green-300 font-mono text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",min:"1"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:826,columnNumber:33},void 0),pe.jsxDEV("span",{className:"text-green-300 text-xs",children:e.unit},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:834,columnNumber:33},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:825,columnNumber:31},void 0):pe.jsxDEV("span",{className:"text-yellow-300 font-medium text-xs",children:[e.quantity," ",e.unit]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:837,columnNumber:31},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:822,columnNumber:27},void 0),pe.jsxDEV("div",{className:"flex items-center gap-0.5",children:w===e.id?pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV("button",{onClick:()=>{const r=o.find(r=>r.allItems.some(r=>r.id===e.id));r&&((e,r)=>{var t,s,n,i;if(H<=0)return void W.error("数量必须大于0");const a=(null==(t=e.work_type)?void 0:t.name)||"",o=a.includes("生产");if(o&&!Number.isInteger(H))return void W.error("生产工时数量必须为整数");if(!o&&H<0)return void W.error("非生产工时数量不能为负数");const l=`${(null==(s=e.work_type)?void 0:s.name)||"未知类型"} | ${(null==(n=e.product)?void 0:n.name)||"未知产品"} | ${(null==(i=e.process)?void 0:i.name)||"未知工序"}`;A({itemId:e.id,itemName:l,userName:r.user.name,workDate:r.work_date,originalQuantity:S,newQuantity:H,unit:e.unit,workType:a}),C(!0)})(e,r)},className:"p-0.5 bg-green-600 hover:bg-green-700 text-white rounded text-xs transition-colors",title:"确认保存",children:pe.jsxDEV(P,{className:"w-2.5 h-2.5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:856,columnNumber:35},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:844,columnNumber:33},void 0),pe.jsxDEV("button",{onClick:te,className:"p-0.5 bg-gray-600 hover:bg-gray-700 text-white rounded text-xs transition-colors",title:"取消",children:pe.jsxDEV(N,{className:"w-2.5 h-2.5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:863,columnNumber:35},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:858,columnNumber:33},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:843,columnNumber:31},void 0):pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV("button",{onClick:()=>(e=>{D(e.id),T(e.quantity),j(e.quantity)})(e),className:"p-0.5 text-blue-400 hover:text-blue-300 transition-colors",title:"编辑数量",children:pe.jsxDEV(J,{className:"w-2.5 h-2.5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:873,columnNumber:35},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:868,columnNumber:33},void 0),pe.jsxDEV("button",{onClick:()=>{var r,t,s,n;const i=o.find(r=>r.allItems.some(r=>r.id===e.id)),a=`${(null==(r=e.work_type)?void 0:r.name)||"未知工时类型"} | ${(null==(t=e.product)?void 0:t.name)||"未知产品"} | ${(null==(s=e.process)?void 0:s.name)||"未知工序"}`;U(e.id),z({itemName:a,userName:(null==(n=null==i?void 0:i.user)?void 0:n.name)||"未知用户",workDate:(null==i?void 0:i.work_date)||"未知日期",recordId:e.timesheet_record_id}),O(!0)},className:"p-0.5 text-red-400 hover:text-red-300 transition-colors",title:"删除",children:pe.jsxDEV(F,{className:"w-2.5 h-2.5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:893,columnNumber:35},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:875,columnNumber:33},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:867,columnNumber:31},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:841,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:821,columnNumber:25},void 0)]},e.id,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:809,columnNumber:23},void 0)})},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:807,columnNumber:19},void 0)]},e.groupKey,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:775,columnNumber:17},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:773,columnNumber:13},void 0),$.size>0&&pe.jsxDEV("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-900 border-t border-green-400 p-4 z-40",children:pe.jsxDEV("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[pe.jsxDEV("span",{className:"text-green-400 font-mono text-sm",children:["已选择 ",$.size," 条记录"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:914,columnNumber:15},void 0),pe.jsxDEV("div",{className:"flex items-center gap-3",children:[pe.jsxDEV("button",{onClick:()=>G(new Set),className:"px-4 py-2 bg-gray-600 text-white font-medium rounded hover:bg-gray-700 font-mono",children:"取消选择"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:918,columnNumber:17},void 0),pe.jsxDEV("button",{onClick:async()=>{if(0!==$.size){g(!0);try{const e=o.filter(e=>$.has(e.groupKey));for(const r of e)await re(r,"");W.success(`成功审核通过 ${e.length} 条记录`),G(new Set),r("/")}catch(e){W.error("批量审核失败，请重试")}finally{g(!1)}}else W.error("请先选择要审核的记录")},disabled:p,className:"flex items-center gap-2 px-6 py-2 bg-green-600 text-white font-medium rounded hover:bg-green-700 disabled:opacity-50 font-mono",children:[pe.jsxDEV(V,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:929,columnNumber:19},void 0),p?"处理中...":"通过审核"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:924,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:917,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:913,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:912,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:732,columnNumber:7},void 0),y&&u&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[pe.jsxDEV("h3",{className:"text-lg font-semibold",children:"审核历史"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:945,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:pe.jsxDEV(Q,{className:"w-6 h-6"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:950,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:946,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:944,columnNumber:13},void 0),pe.jsxDEV("div",{className:"space-y-4",children:0===b.length?pe.jsxDEV("p",{className:"text-gray-500 text-center py-4",children:"暂无审核历史"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:955,columnNumber:17},void 0):b.map(e=>pe.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("span",{className:"font-medium",children:e.approver.name},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:961,columnNumber:25},void 0),pe.jsxDEV("span",{className:"text-sm text-gray-500",children:["(","supervisor"===e.approver_type?"班长":"段长",")"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:962,columnNumber:25},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:960,columnNumber:23},void 0),pe.jsxDEV("span",{className:"px-2 py-1 rounded text-sm bg-green-100 text-green-800",children:"通过"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:964,columnNumber:23},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:959,columnNumber:21},void 0),e.comments&&pe.jsxDEV("div",{className:"mb-2",children:[pe.jsxDEV("div",{className:"flex items-center gap-1 mb-1",children:[pe.jsxDEV(Z,{className:"w-4 h-4 text-gray-500"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:971,columnNumber:27},void 0),pe.jsxDEV("span",{className:"text-sm text-gray-700",children:"审核意见:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:972,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:970,columnNumber:25},void 0),pe.jsxDEV("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:e.comments},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:974,columnNumber:25},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:969,columnNumber:23},void 0),pe.jsxDEV("div",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleString()},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:977,columnNumber:21},void 0)]},e.id,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:958,columnNumber:19},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:953,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:943,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:942,columnNumber:9},void 0),k&&R&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-800 border border-green-400 rounded-lg p-6 w-full max-w-md",children:[pe.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[pe.jsxDEV("div",{className:"flex-shrink-0 w-10 h-10 bg-blue-900 rounded-full flex items-center justify-center",children:pe.jsxDEV("svg",{className:"w-6 h-6 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:995,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:994,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:993,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("h3",{className:"text-lg font-semibold text-gray-100",children:"确认修改数量"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:999,columnNumber:17},void 0),pe.jsxDEV("p",{className:"text-sm text-gray-400",children:"请确认数量变更"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1e3,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:998,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:992,columnNumber:13},void 0),pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("p",{className:"text-gray-300 mb-2",children:"您确定要修改以下工时记录的数量吗？"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1005,columnNumber:15},void 0),pe.jsxDEV("div",{className:"bg-gray-700 border border-gray-600 p-3 rounded-lg",children:pe.jsxDEV("div",{className:"text-sm",children:[pe.jsxDEV("div",{className:"flex justify-between mb-1",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"员工姓名:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1011,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-gray-200",children:R.userName},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1012,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1010,columnNumber:19},void 0),pe.jsxDEV("div",{className:"flex justify-between mb-1",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"工作日期:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1015,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-gray-200",children:R.workDate},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1016,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1014,columnNumber:19},void 0),pe.jsxDEV("div",{className:"flex justify-between mb-1",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"工时项目:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1019,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-gray-200",children:R.itemName},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1020,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1018,columnNumber:19},void 0),pe.jsxDEV("div",{className:"flex justify-between",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"数量变更:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1023,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-yellow-300",children:[R.originalQuantity," ",R.unit," → ",R.newQuantity," ",R.unit]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1024,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1022,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1009,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1008,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1004,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex justify-end gap-3",children:[pe.jsxDEV("button",{onClick:()=>{C(!1),A(null)},className:"px-4 py-2 text-gray-300 hover:text-gray-100 border border-gray-600 rounded-lg hover:bg-gray-700 transition-colors",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1034,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:async()=>{if(R)try{const{error:e}=await ve.from("timesheet_record_items").update({quantity:R.newQuantity,updated_at:(new Date).toISOString()}).eq("id",R.itemId);if(e)throw e;W.success("数量修改成功"),D(null),T(0),j(0),C(!1),A(null),ee()}catch(e){W.error("修改数量失败，请重试")}},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[pe.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1045,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1044,columnNumber:17},void 0),"确认修改"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1040,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1033,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:991,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:990,columnNumber:9},void 0),I&&B&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-800 border border-green-400 rounded-lg p-6 w-full max-w-md",children:[pe.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[pe.jsxDEV("div",{className:"flex-shrink-0 w-10 h-10 bg-red-900 rounded-full flex items-center justify-center",children:pe.jsxDEV("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1061,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1060,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1059,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("h3",{className:"text-lg font-semibold text-gray-100",children:"确认删除"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1065,columnNumber:17},void 0),pe.jsxDEV("p",{className:"text-sm text-gray-400",children:"此操作不可恢复"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1066,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1064,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1058,columnNumber:13},void 0),pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("p",{className:"text-gray-300 mb-2",children:"您确定要删除以下工时记录项吗？"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1071,columnNumber:15},void 0),pe.jsxDEV("div",{className:"bg-gray-700 border border-gray-600 p-3 rounded-lg",children:pe.jsxDEV("div",{className:"text-sm",children:[pe.jsxDEV("div",{className:"flex justify-between mb-1",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"员工姓名:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1077,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-gray-200",children:B.userName},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1078,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1076,columnNumber:19},void 0),pe.jsxDEV("div",{className:"flex justify-between mb-1",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"工作日期:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1081,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-gray-200",children:B.workDate},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1082,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1080,columnNumber:19},void 0),pe.jsxDEV("div",{className:"flex justify-between",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"工时项目:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1085,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-gray-200",children:B.itemName},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1086,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1084,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1075,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1074,columnNumber:15},void 0),pe.jsxDEV("p",{className:"text-red-400 text-sm mt-3 flex items-center gap-1",children:[pe.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1092,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1091,columnNumber:17},void 0),"删除后数据将无法恢复，请谨慎操作"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1090,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1070,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex justify-end gap-3",children:[pe.jsxDEV("button",{onClick:()=>{O(!1),U(null),z(null)},className:"px-4 py-2 text-gray-300 hover:text-gray-100 border border-gray-600 rounded-lg hover:bg-gray-700 transition-colors",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1099,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:async()=>{if(L&&B)try{const{data:e,error:r}=await ve.from("timesheet_record_items").select("id").eq("timesheet_record_id",B.recordId);if(r)throw r;const{error:t}=await ve.from("timesheet_record_items").delete().eq("id",L);if(t)return void W.error("删除失败，请重试");if(e&&1===e.length){const{error:e}=await ve.from("timesheet_records").delete().eq("id",B.recordId)}W.success("删除成功"),await ee()}catch(e){W.error("删除失败，请重试")}finally{O(!1),U(null),z(null)}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[pe.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1110,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1109,columnNumber:17},void 0),"确认删除"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1105,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1098,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1057,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:1056,columnNumber:9},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SupervisorApproval.tsx",lineNumber:731,columnNumber:5},void 0)},Tg=e=>{if(!e)return"";return new Date(e).toISOString().split("T")[0]},Sg=()=>{const{user:e}=Ve(),r=i(),[s,n]=t.useState([]),[o,l]=t.useState([]),[c,m]=t.useState(!0),[u,d]=t.useState(null),[f,h]=t.useState(""),[p,g]=t.useState(!1),[b,v]=t.useState([]),[y,E]=t.useState(!1),[w,D]=t.useState(null),[H,T]=t.useState(0),[S,j]=t.useState(0),[k,C]=t.useState(new Set),[R,A]=t.useState(!1),[I,O]=t.useState(null),[L,U]=t.useState(!1),[B,z]=t.useState(null),[$,G]=t.useState(!1);t.useEffect(()=>{X()},[]);const q=new Map,X=async()=>{var r;if(e)try{m(!0);let t=ve.from("timesheet_records").select("\n          *,\n          supervisor:supervisor_id(id, name),\n          section_chief:section_chief_id(id, name),\n          user:user_id(id, name, phone),\n          timesheet_record_items(*)\n        ").eq("status","approved");"超级管理员"!==(null==(r=e.role)?void 0:r.name)&&(t=t.eq("section_chief_id",e.id));const{data:s,error:i}=await t.order("created_at",{ascending:!1});if(i)throw i;const a=(null==s?void 0:s.flatMap(e=>e.timesheet_record_items||[]))||[],o=[...new Set(a.map(e=>e.process_id).filter(Boolean))],c=o.filter(e=>!q.has(e));if(c.length>0){const{data:e,error:r}=await ve.from("processes").select("id, product_process, product_name, production_category, production_line").in("id",c);r||(e||[]).forEach(e=>{q.set(e.id,e)})}const u=o.map(e=>q.get(e)).filter(Boolean),d=new Map(u.map(e=>[e.id,e])),f=((null==s?void 0:s.map(e=>{const r=e.timesheet_record_items||[],t=r.length>0?d.get(r[0].process_id):null,s=t?{name:t.production_line}:{name:"未知生产线"};return{...e,production_line:s,user:{name:e.user_name||(e.user?e.user.name:"未知用户"),phone:e.user?e.user.phone:""},supervisor:e.supervisor_name?{id:e.supervisor_id,name:e.supervisor_name}:e.supervisor||null,section_chief:e.section_chief_name?{id:e.section_chief_id,name:e.section_chief_name}:e.section_chief||null,items:r.map(e=>{const r=d.get(e.process_id);return{id:e.id,work_type:{name:(null==r?void 0:r.production_category)||"未知工时类型"},product:{name:(null==r?void 0:r.product_name)||"未知产品",code:""},process:{name:(null==r?void 0:r.product_process)||"未知工序"},quantity:e.quantity,unit:e.unit||"件"}})}}))||[]).filter(e=>e.items&&e.items.length>0);n(f);const h=(e=>{const r=new Map;e.forEach(e=>{const t=`${e.user_id}_${e.work_date}`,s=r.get(t);s?s.push(e):r.set(t,[e])});const t=[];return r.forEach((e,r)=>{const s=e[0];let n=[],i=new Date(s.updated_at).getTime();e.forEach(e=>{n=n.concat(e.items);const r=new Date(e.updated_at).getTime();r>i&&(i=r)}),n.length>0&&t.push({groupKey:r,user_id:s.user_id,work_date:s.work_date,user:s.user,production_line:s.production_line,supervisor:s.supervisor,section_chief:s.section_chief,originalRecords:e,totalItems:n.length,allItems:n,status:s.status,created_at:s.created_at,updated_at:i.toString()})}),t.sort((e,r)=>{const t=new Date(e.created_at).getTime();return new Date(r.created_at).getTime()-t})})(f);l(h)}catch(t){W.error("获取待审核记录失败")}finally{m(!1)}},Y=async(r,t)=>{try{g(!0);const s=r.originalRecords.map(e=>e.id),n=await(async(e,r)=>{try{const{error:t}=await ve.from("timesheet_records").update({status:r,updated_at:(new Date).toISOString()}).in("id",e);return!t||(W.error("更新记录状态失败"),!1)}catch(t){return W.error("更新记录状态失败"),!1}})(s,"section_chief_approved");if(!n)return;const i=s.map(r=>({timesheet_record_id:r,approver_id:null==e?void 0:e.id,approver_type:"section_chief",action:"approved",comment:t||null,created_at:(new Date).toISOString()})),a=await(async e=>{try{const{error:r}=await ve.from("approval_history").insert(e);return!r||(W.error("插入审核历史失败"),!1)}catch(r){return W.error("插入审核历史失败"),!1}})(i);if(!a)return;window.location.href="/"}catch(s){W.error("审核操作失败，请重试")}finally{g(!1)}},re=()=>{D(null),T(0)},[te,se]=t.useState(null),ne=e=>{switch(e){case"pending":return"text-yellow-600 bg-yellow-50";case"approved":case"section_chief_approved":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},ie=e=>{switch(e){case"pending":return"待审核";case"approved":return"班长已通过";case"section_chief_approved":return"段长已通过";default:return"草稿"}};return c?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:718,columnNumber:9},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:717,columnNumber:7},void 0):pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-400 font-mono",children:[pe.jsxDEV("div",{className:"max-w-6xl mx-auto px-3 py-4",children:[pe.jsxDEV("div",{className:"mb-4",children:[pe.jsxDEV("div",{className:"flex justify-between items-center mb-3",children:[pe.jsxDEV("div",{className:"flex items-center",children:[pe.jsxDEV(ee,{className:"w-6 h-6 text-green-400 mr-2"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:732,columnNumber:15},void 0),pe.jsxDEV("h1",{className:"text-2xl font-bold text-green-400 font-mono",children:"段长审核"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:733,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:731,columnNumber:13},void 0),pe.jsxDEV(a,{to:"/dashboard",className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-green-300 hover:text-green-200 rounded-lg font-mono transition-all duration-200 shadow-md hover:shadow-lg border border-gray-600 hover:border-green-500/50",children:[pe.jsxDEV(_,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:739,columnNumber:15},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:740,columnNumber:15},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:741,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:735,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:730,columnNumber:11},void 0),pe.jsxDEV("div",{className:"h-0.5 bg-gradient-to-r from-transparent via-green-400 to-transparent"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:744,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:729,columnNumber:9},void 0),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-3 mb-4",children:pe.jsxDEV("div",{className:"flex items-center gap-3",children:[pe.jsxDEV("span",{className:"text-green-300 font-mono text-sm bg-gray-800 px-2 py-1 rounded",children:[o.length," 条记录"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:750,columnNumber:13},void 0),k.size>0&&pe.jsxDEV("span",{className:"text-green-400 font-mono text-sm",children:["已选择 ",k.size," 条"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:754,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:749,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:748,columnNumber:9},void 0),0===o.length?pe.jsxDEV("div",{className:"text-center py-8",children:[pe.jsxDEV(M,{className:"w-12 h-12 text-green-600 mx-auto mb-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:763,columnNumber:13},void 0),pe.jsxDEV("h3",{className:"text-lg font-medium text-green-400 mb-2 font-mono",children:"暂无待审核记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:764,columnNumber:13},void 0),pe.jsxDEV("p",{className:"text-green-600 font-mono text-sm",children:"当前没有需要段长审核的工时记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:765,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:762,columnNumber:11},void 0):pe.jsxDEV("div",{className:"space-y-3",children:o.map(e=>pe.jsxDEV("div",{className:"border border-green-400 bg-gray-800 rounded-lg p-4 hover:bg-gray-700 transition-all duration-200",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-3",children:[pe.jsxDEV("div",{className:"flex items-center gap-3",children:[pe.jsxDEV("input",{type:"checkbox",checked:k.has(e.groupKey),onChange:()=>(e=>{const r=new Set(k);r.has(e)?r.delete(e):r.add(e),C(r)})(e.groupKey),className:"w-4 h-4 text-green-600 border-green-400 rounded focus:ring-green-500 bg-gray-700 flex-shrink-0"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:774,columnNumber:21},void 0),pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV(x,{className:"w-4 h-4 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:781,columnNumber:23},void 0),pe.jsxDEV("span",{className:"font-medium text-green-300 font-mono",children:e.user.name},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:782,columnNumber:23},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:780,columnNumber:21},void 0),pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV(K,{className:"w-4 h-4 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:785,columnNumber:23},void 0),pe.jsxDEV("span",{className:"text-green-300 font-mono text-sm",children:Tg(e.work_date)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:786,columnNumber:23},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:784,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:773,columnNumber:19},void 0),pe.jsxDEV("div",{className:"flex items-center gap-2",children:pe.jsxDEV("span",{className:`px-2 py-1 rounded text-xs font-medium font-mono ${ne(e.status)}`,children:ie(e.status)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:790,columnNumber:21},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:789,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:772,columnNumber:17},void 0),pe.jsxDEV("div",{className:"grid grid-cols-1 gap-2 mb-3 text-sm",children:pe.jsxDEV("div",{className:"flex items-center gap-1",children:pe.jsxDEV("span",{className:"text-green-400 font-mono text-xs",children:["共 ",e.totalItems," 项"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:799,columnNumber:21},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:798,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:797,columnNumber:17},void 0),pe.jsxDEV("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 mb-3",children:e.allItems.map(r=>{var t,s,n,i;return pe.jsxDEV("div",{className:"bg-gray-700 border border-green-500 rounded p-2 hover:bg-gray-600 transition-colors",children:[pe.jsxDEV("div",{className:"mb-1.5",children:[pe.jsxDEV("div",{className:"text-green-200 font-mono text-xs font-medium leading-tight",children:`${(null==(t=r.work_type)?void 0:t.name)||"未知类型"} | ${(null==(s=r.product)?void 0:s.name)||"未知产品"} | ${(null==(n=r.process)?void 0:n.name)||"未知工序"}`},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:809,columnNumber:25},void 0),(null==(i=r.product)?void 0:i.code)&&pe.jsxDEV("div",{className:"text-green-500 font-mono text-xs mt-0.5",children:["编码: ",r.product.code]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:813,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:808,columnNumber:23},void 0),pe.jsxDEV("div",{className:"flex items-center justify-between",children:[pe.jsxDEV("div",{className:"text-green-200 font-mono text-xs font-medium",children:w===r.id?pe.jsxDEV("div",{className:"flex items-center gap-1",children:[pe.jsxDEV("input",{type:"number",value:H,onChange:e=>T(Number(e.target.value)),onWheel:e=>e.preventDefault(),className:"w-14 px-1 py-0.5 bg-gray-600 border border-green-400 rounded text-green-300 font-mono text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",min:"1"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:822,columnNumber:31},void 0),pe.jsxDEV("span",{className:"text-green-300 text-xs",children:r.unit},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:830,columnNumber:31},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:821,columnNumber:29},void 0):`${r.quantity} ${r.unit}`},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:819,columnNumber:25},void 0),pe.jsxDEV("div",{className:"flex items-center gap-0.5",children:w===r.id?pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV("button",{onClick:()=>((e,r)=>{var t,s,n,i;if(H<=0)return void W.error("数量必须大于0");const a=(null==(t=e.work_type)?void 0:t.name)||"",o=a.includes("生产");if(o&&!Number.isInteger(H))return void W.error("生产工时数量必须为整数");if(!o&&H<0)return void W.error("非生产工时数量不能为负数");const l=`${(null==(s=e.work_type)?void 0:s.name)||"未知类型"} | ${(null==(n=e.product)?void 0:n.name)||"未知产品"} | ${(null==(i=e.process)?void 0:i.name)||"未知工序"}`;z({itemId:e.id,itemName:l,userName:r.user.name,workDate:r.work_date,originalQuantity:S,newQuantity:H,unit:e.unit,workType:a}),U(!0)})(r,e),className:"p-0.5 bg-green-600 hover:bg-green-700 text-white rounded text-xs transition-colors",title:"确认保存",children:pe.jsxDEV(P,{className:"w-2.5 h-2.5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:844,columnNumber:33},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:839,columnNumber:31},void 0),pe.jsxDEV("button",{onClick:re,className:"p-0.5 bg-gray-600 hover:bg-gray-700 text-white rounded text-xs transition-colors",title:"取消",children:pe.jsxDEV(N,{className:"w-2.5 h-2.5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:851,columnNumber:33},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:846,columnNumber:31},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:838,columnNumber:29},void 0):pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV("button",{onClick:()=>(e=>{D(e.id),T(e.quantity),j(e.quantity)})(r),className:"p-0.5 text-blue-400 hover:text-blue-300 transition-colors",title:"编辑数量",children:pe.jsxDEV(J,{className:"w-2.5 h-2.5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:861,columnNumber:33},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:856,columnNumber:31},void 0),pe.jsxDEV("button",{onClick:()=>{var t,s,n,i;const a=`${(null==(t=r.work_type)?void 0:t.name)||"未知工时类型"} | ${(null==(s=r.product)?void 0:s.name)||"未知产品"} | ${(null==(n=r.process)?void 0:n.name)||"未知工序"}`;((e,r,t,s)=>{O({itemId:e,itemName:r,userName:t,workDate:s}),A(!0)})(r.id,a,(null==(i=null==e?void 0:e.user)?void 0:i.name)||"未知用户",(null==e?void 0:e.work_date)||"未知日期")},className:"p-0.5 text-red-400 hover:text-red-300 transition-colors",title:"删除",children:pe.jsxDEV(F,{className:"w-2.5 h-2.5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:876,columnNumber:33},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:863,columnNumber:31},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:855,columnNumber:29},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:836,columnNumber:25},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:818,columnNumber:23},void 0)]},r.id,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:806,columnNumber:21},void 0)})},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:804,columnNumber:17},void 0)]},e.groupKey,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:770,columnNumber:15},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:768,columnNumber:11},void 0),k.size>0&&pe.jsxDEV("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-900 border-t border-green-400 p-4 z-40",children:pe.jsxDEV("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[pe.jsxDEV("span",{className:"text-green-400 font-mono text-sm",children:["已选择 ",k.size," 条记录"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:894,columnNumber:15},void 0),pe.jsxDEV("div",{className:"flex items-center gap-3",children:[pe.jsxDEV("button",{onClick:()=>C(new Set),className:"px-4 py-2 bg-gray-600 text-white font-medium rounded hover:bg-gray-700 font-mono",children:"取消选择"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:898,columnNumber:17},void 0),pe.jsxDEV("button",{onClick:async()=>{if(0!==k.size){g(!0);try{const e=o.filter(e=>k.has(e.groupKey));for(const r of e)await Y(r,"");W.success(`成功审核通过 ${e.length} 条记录`),C(new Set),r("/")}catch(e){W.error("批量审核失败，请重试")}finally{g(!1)}}else W.error("请先选择要审核的记录")},disabled:p,className:"flex items-center gap-2 px-6 py-2 bg-green-600 text-white font-medium rounded hover:bg-green-700 disabled:opacity-50 font-mono",children:[pe.jsxDEV(V,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:909,columnNumber:19},void 0),p?"处理中...":"通过审核"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:904,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:897,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:893,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:892,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:727,columnNumber:7},void 0),L&&B&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-800 border border-green-400 rounded-lg p-6 max-w-md w-full mx-4",children:[pe.jsxDEV("div",{className:"flex items-center mb-4",children:[pe.jsxDEV(J,{className:"w-6 h-6 text-blue-400 mr-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:925,columnNumber:15},void 0),pe.jsxDEV("h3",{className:"text-lg font-semibold text-green-400 font-mono",children:"确认修改数量"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:926,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:924,columnNumber:13},void 0),pe.jsxDEV("div",{className:"mb-4 text-green-300 font-mono text-sm",children:[pe.jsxDEV("p",{children:"您确定要修改以下工时记录的数量吗？"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:930,columnNumber:15},void 0),pe.jsxDEV("div",{className:"mt-3 p-3 bg-gray-700 rounded border border-green-500",children:[pe.jsxDEV("div",{className:"text-green-200",children:["员工姓名：",B.userName]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:932,columnNumber:17},void 0),pe.jsxDEV("div",{className:"text-green-200",children:["工作日期：",B.workDate]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:933,columnNumber:17},void 0),pe.jsxDEV("div",{className:"text-green-200",children:["工时项目：",B.itemName]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:934,columnNumber:17},void 0),pe.jsxDEV("div",{className:"text-yellow-300",children:["数量变更：",B.originalQuantity," ",B.unit," → ",B.newQuantity," ",B.unit]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:935,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:931,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:929,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex justify-end space-x-3",children:[pe.jsxDEV("button",{onClick:()=>{U(!1),z(null)},className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 text-green-300 rounded font-mono transition-colors",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:940,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:async()=>{if(B)try{const{error:e}=await ve.from("timesheet_record_items").update({quantity:B.newQuantity,updated_at:(new Date).toISOString()}).eq("id",B.itemId);if(e)throw e;W.success("数量修改成功"),D(null),T(0),j(0),U(!1),z(null),X()}catch(e){W.error("修改数量失败，请重试")}},className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded font-mono transition-colors",children:"✓ 确认修改"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:946,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:939,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:923,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:922,columnNumber:9},void 0),R&&I&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-800 border border-green-400 rounded-lg p-6 w-full max-w-md",children:[pe.jsxDEV("div",{className:"flex items-center gap-3 mb-4",children:[pe.jsxDEV("div",{className:"flex-shrink-0 w-10 h-10 bg-red-900 rounded-full flex items-center justify-center",children:pe.jsxDEV("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:964,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:963,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:962,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("h3",{className:"text-lg font-semibold text-gray-100",children:"确认删除"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:968,columnNumber:17},void 0),pe.jsxDEV("p",{className:"text-sm text-gray-400",children:"此操作不可恢复"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:969,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:967,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:961,columnNumber:13},void 0),pe.jsxDEV("div",{className:"mb-6",children:[pe.jsxDEV("p",{className:"text-gray-300 mb-2",children:"您确定要删除以下工时记录项吗？"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:974,columnNumber:15},void 0),pe.jsxDEV("div",{className:"bg-gray-700 border border-gray-600 p-3 rounded-lg",children:pe.jsxDEV("div",{className:"text-sm",children:[pe.jsxDEV("div",{className:"flex justify-between mb-1",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"员工姓名:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:980,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-gray-200",children:I.userName},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:981,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:979,columnNumber:19},void 0),pe.jsxDEV("div",{className:"flex justify-between mb-1",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"工作日期:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:984,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-gray-200",children:Tg(I.workDate)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:985,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:983,columnNumber:19},void 0),pe.jsxDEV("div",{className:"flex justify-between",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"工时项目:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:988,columnNumber:21},void 0),pe.jsxDEV("span",{className:"font-medium text-gray-200",children:I.itemName},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:989,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:987,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:978,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:977,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:973,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex justify-end gap-3",children:[pe.jsxDEV("button",{onClick:()=>{A(!1),O(null)},className:"px-4 py-2 text-gray-300 hover:text-gray-100 border border-gray-600 rounded-lg hover:bg-gray-700 transition-colors",children:"取消"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:997,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:async()=>{if(I)try{const{data:e,error:r}=await ve.from("timesheet_record_items").select("timesheet_record_id").eq("id",I.itemId).single();if(r)throw r;const{error:t}=await ve.from("timesheet_record_items").delete().eq("id",I.itemId);if(t)throw t;const{data:s,error:n}=await ve.from("timesheet_record_items").select("id").eq("timesheet_record_id",e.timesheet_record_id);if(n)throw n;if(0===s.length){const{error:r}=await ve.from("timesheet_records").delete().eq("id",e.timesheet_record_id);if(r)throw r}W.success("记录项删除成功"),A(!1),O(null),X()}catch(e){W.error("删除记录项失败，请重试")}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[pe.jsxDEV("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:pe.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1008,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1007,columnNumber:17},void 0),"确认删除"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1003,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:996,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:960,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:959,columnNumber:9},void 0),y&&u&&pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[pe.jsxDEV("h3",{className:"text-lg font-semibold",children:"审核历史"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1022,columnNumber:15},void 0),pe.jsxDEV("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:pe.jsxDEV(Q,{className:"w-6 h-6"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1027,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1023,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1021,columnNumber:13},void 0),pe.jsxDEV("div",{className:"space-y-4",children:0===b.length?pe.jsxDEV("p",{className:"text-gray-500 text-center py-4",children:"暂无审核历史"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1032,columnNumber:17},void 0):b.map(e=>pe.jsxDEV("div",{className:"border border-gray-200 rounded-lg p-4",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("span",{className:"font-medium",children:e.approver.name},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1038,columnNumber:25},void 0),pe.jsxDEV("span",{className:"text-sm text-gray-500",children:["(","supervisor"===e.approver_type?"班长":"段长",")"]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1039,columnNumber:25},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1037,columnNumber:23},void 0),pe.jsxDEV("span",{className:"px-2 py-1 rounded text-sm bg-green-100 text-green-800",children:"通过"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1041,columnNumber:23},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1036,columnNumber:21},void 0),e.comments&&pe.jsxDEV("div",{className:"mb-2",children:[pe.jsxDEV("div",{className:"flex items-center gap-1 mb-1",children:[pe.jsxDEV(Z,{className:"w-4 h-4 text-gray-500"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1048,columnNumber:27},void 0),pe.jsxDEV("span",{className:"text-sm text-gray-700",children:"审核意见:"},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1049,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1047,columnNumber:25},void 0),pe.jsxDEV("p",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:e.comments},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1051,columnNumber:25},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1046,columnNumber:23},void 0),pe.jsxDEV("div",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleString()},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1054,columnNumber:21},void 0)]},e.id,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1035,columnNumber:19},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1030,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1020,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:1019,columnNumber:9},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/SectionChiefApproval.tsx",lineNumber:726,columnNumber:5},void 0)},jg=({isOpen:e,title:r="确认删除",message:t="您确定要删除以下工时记录吗？",employeeName:s,workDate:n,workProject:i,onConfirm:a,onCancel:o,confirmText:l="确认删除",cancelText:c="取消"})=>e?pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 border border-gray-600",children:[pe.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-600",children:[pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center",children:pe.jsxDEV(L,{className:"w-5 h-5 text-white"},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:38,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:37,columnNumber:13},void 0),pe.jsxDEV("h3",{className:"text-lg font-semibold text-white",children:r},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:40,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:36,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:o,className:"text-gray-400 hover:text-gray-300 transition-colors",children:pe.jsxDEV(N,{size:20},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:46,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:42,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:35,columnNumber:9},void 0),pe.jsxDEV("div",{className:"p-4",children:[pe.jsxDEV("p",{className:"text-gray-300 mb-4",children:t},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:52,columnNumber:11},void 0),(s||n||i)&&pe.jsxDEV("div",{className:"bg-gray-700 rounded-lg p-3 mb-4 space-y-2",children:[s&&pe.jsxDEV("div",{className:"flex justify-between",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"员工姓名："},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:59,columnNumber:19},void 0),pe.jsxDEV("span",{className:"text-white",children:s},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:60,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:58,columnNumber:17},void 0),n&&pe.jsxDEV("div",{className:"flex justify-between",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"工作日期："},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:65,columnNumber:19},void 0),pe.jsxDEV("span",{className:"text-white",children:n},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:66,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:64,columnNumber:17},void 0),i&&pe.jsxDEV("div",{className:"flex justify-between",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"工时项目："},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:71,columnNumber:19},void 0),pe.jsxDEV("span",{className:"text-white",children:i},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:72,columnNumber:19},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:70,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:56,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex items-center gap-2 p-3 bg-red-900 bg-opacity-20 border border-red-600 rounded-lg",children:[pe.jsxDEV(L,{className:"w-4 h-4 text-red-400 flex-shrink-0"},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:80,columnNumber:13},void 0),pe.jsxDEV("span",{className:"text-red-400 text-sm",children:"删除后数据将无法恢复，请谨慎操作"},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:81,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:79,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:51,columnNumber:9},void 0),pe.jsxDEV("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-600",children:[pe.jsxDEV("button",{onClick:o,className:"px-4 py-2 text-gray-300 bg-gray-600 border border-gray-500 rounded-md hover:bg-gray-500 transition-colors",children:c},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:87,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:a,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors flex items-center gap-2",children:[pe.jsxDEV(L,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:97,columnNumber:13},void 0),l]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:93,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:86,columnNumber:9},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:33,columnNumber:7},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/DeleteConfirmDialog.tsx",lineNumber:32,columnNumber:5},void 0):null,kg=({isOpen:e,title:r="确认修改数量",message:t="您确定要修改数量吗？",currentQuantity:s,newQuantity:n,onConfirm:i,onCancel:a,confirmText:o="确认修改",cancelText:l="取消"})=>e?pe.jsxDEV("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:pe.jsxDEV("div",{className:"bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 border border-gray-600",children:[pe.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-gray-600",children:[pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:pe.jsxDEV(B,{className:"w-5 h-5 text-white"},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:36,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:35,columnNumber:13},void 0),pe.jsxDEV("h3",{className:"text-lg font-semibold text-white",children:r},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:38,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:34,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:a,className:"text-gray-400 hover:text-gray-300 transition-colors",children:pe.jsxDEV(N,{size:20},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:44,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:40,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:33,columnNumber:9},void 0),pe.jsxDEV("div",{className:"p-4",children:[pe.jsxDEV("p",{className:"text-gray-300 mb-4",children:t},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:50,columnNumber:11},void 0),void 0!==s&&void 0!==n&&pe.jsxDEV("div",{className:"bg-gray-700 rounded-lg p-3 mb-4",children:[pe.jsxDEV("div",{className:"flex justify-between items-center",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"当前数量："},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:56,columnNumber:17},void 0),pe.jsxDEV("span",{className:"text-white font-mono",children:s},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:57,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:55,columnNumber:15},void 0),pe.jsxDEV("div",{className:"flex justify-between items-center mt-2",children:[pe.jsxDEV("span",{className:"text-gray-400",children:"修改为："},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:60,columnNumber:17},void 0),pe.jsxDEV("span",{className:"text-blue-400 font-mono font-bold",children:n},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:61,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:59,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:54,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:49,columnNumber:9},void 0),pe.jsxDEV("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-gray-600",children:[pe.jsxDEV("button",{onClick:a,className:"px-4 py-2 text-gray-300 bg-gray-600 border border-gray-500 rounded-md hover:bg-gray-500 transition-colors",children:l},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:69,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:i,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors flex items-center gap-2",children:[pe.jsxDEV(B,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:79,columnNumber:13},void 0),o]},void 0,!0,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:75,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:68,columnNumber:9},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:31,columnNumber:7},void 0)},void 0,!1,{fileName:"H:/工时管理/src/components/EditConfirmDialog.tsx",lineNumber:30,columnNumber:5},void 0):null,Vg=()=>{var e,r,s;const{user:n,loading:l}=Ve(),c=i(),[m,u]=t.useState([]),[d,f]=t.useState([]),[p,g]=t.useState(!0),[b,v]=t.useState(!1),[y,E]=t.useState({totalRecords:0,totalAmount:0,pendingCount:0,approvedCount:0,rejectedCount:0,supervisorApprovedCount:0,sectionChiefApprovedCount:0}),[w,D]=t.useState({dailyStats:[],monthlyStats:[],userStats:[],workTypeStats:{production:[],nonProduction:[],productionTotal:0,nonProductionTotal:0},duplicateRecords:[],priceIssues:[],workDayStats:[]}),[H,T]=t.useState({key:"",direction:"asc"}),[S,j]=t.useState(new Set),[k,V]=t.useState(!0),[C,M]=t.useState(null),[I,O]=t.useState(0),[P,L]=t.useState(!1),[U,B]=t.useState(!1),[z,$]=t.useState(null),[q,Q]=t.useState(null),[Z,ee]=t.useState({startDate:"",endDate:"",userId:"",status:"",productionLine:"",workType:"",productName:"",productProcess:"",yearMonth:""}),[ie,ae]=t.useState([]),[oe,le]=t.useState([]),[ce,me]=t.useState([]),[ue,de]=t.useState([]),[fe,he]=t.useState([]);t.useEffect(()=>{if(!l&&!n)return W.error("请先登录"),void c("/login");n&&ge()},[n,l,c]),t.useEffect(()=>{Ee()},[m,Z]);const ge=async()=>{n&&(be(),Ne())},be=async()=>{var e;try{if(g(!0),!n)return void W.error("用户信息不存在");let r;if(He(n.role)){const{data:e,error:t}=await ve.from("timesheet_records").select("\n            *,\n            user_name,\n            supervisor_name,\n            section_chief_name,\n            user:user_id(id, name, company_id),\n            supervisor:supervisor_id(id, name),\n            section_chief:section_chief_id(id, name)\n          ").neq("status","draft").order("created_at",{ascending:!1});if(t)throw t;r=e}else{if(!(null==(e=n.company)?void 0:e.id))return void W.error("用户没有关联的公司，请联系管理员");const{data:t,error:s}=await ve.from("users").select("id").eq("company_id",n.company.id);if(s)throw s;const i=(null==t?void 0:t.map(e=>e.id))||[];if(0===i.length)return u([]),void xe([]);const{data:a,error:o}=await ve.from("timesheet_records").select("\n            *,\n            user_name,\n            supervisor_name,\n            section_chief_name,\n            user:user_id(id, name, company_id),\n            supervisor:supervisor_id(id, name),\n            section_chief:section_chief_id(id, name)\n          ").in("user_id",i).neq("status","draft").order("created_at",{ascending:!1});if(o)throw o;r=a}const t=(null==r?void 0:r.map(e=>e.id))||[],{data:s,error:i}=await ve.from("timesheet_record_items").select("\n          *,\n          processes:process_id(\n            product_process,\n            product_name,\n            production_category,\n            production_line,\n            unit_price\n          )\n        ").in("timesheet_record_id",t);if(i)throw i;const{data:a,error:o}=await ve.from("approval_history").select("\n          *,\n          approver_name,\n          approver:approver_id(name)\n        ").in("timesheet_record_id",t);if(o)throw o;const l=(null==r?void 0:r.map(e=>{const r=(null==s?void 0:s.filter(r=>r.timesheet_record_id===e.id))||[],t=(null==a?void 0:a.filter(r=>r.timesheet_record_id===e.id))||[],n=r.reduce((e,r)=>e+r.quantity*r.unit_price,0);return{...e,items:r,approval_history:t,total_amount:n}}))||[];u(l),xe(l),ye(l)}catch(r){W.error("获取报表数据失败")}finally{g(!1)}},Ne=async()=>{var e;try{if(!n)return void W.error("用户信息不存在");let r=ve.from("users").select("id, name, company_id").eq("is_active",!0);if(!He(n.role)){if(!(null==(e=n.company)?void 0:e.id))return void W.error("用户没有关联的公司，请联系管理员");r=r.eq("company_id",n.company.id)}const{data:t}=await r.order("name");t&&ae(t);let s=ve.from("processes").select("production_line, production_category, product_name, product_process").eq("is_active",!0);He(n.role)||(s=s.eq("company_id",n.company.id));const{data:i}=await s;if(i){const e=[...new Set(i.map(e=>e.production_line).filter(Boolean))];le(e);const r=[...new Set(i.map(e=>e.production_category).filter(Boolean))];me(r);const t=[...new Set(i.map(e=>e.product_name).filter(Boolean))];de(t);const s=[...new Set(i.map(e=>e.product_process).filter(Boolean))];he(s)}}catch(r){}},xe=e=>{const r=e.reduce((e,r)=>e+r.items.reduce((e,r)=>e+r.quantity*r.unit_price,0),0),t={totalRecords:e.length,totalAmount:r,pendingCount:e.filter(e=>"pending"===e.status).length,approvedCount:e.filter(e=>"approved"===e.status).length,rejectedCount:e.filter(e=>"rejected"===e.status).length,supervisorApprovedCount:e.filter(e=>e.supervisor_approved_at).length,sectionChiefApprovedCount:e.filter(e=>e.section_chief_approved_at).length};E(t),ye(e)},ye=e=>{const r=Se(e),t=Ce(e),s=ke(e),n=Re(e),i=Ae(e),a=Me(e).filter(e=>e.records.some((r,t)=>e.records.slice(t+1).some(e=>r.work_date===e.work_date&&r.user_id===e.user_id&&r.items.some(r=>e.items.some(e=>{var t,s;return(null==(t=r.processes)?void 0:t.product_process)===(null==(s=e.processes)?void 0:s.product_process)}))))),o=Ie(e);D({dailyStats:r,monthlyStats:t,workDayStats:s,userStats:n,workTypeStats:i,duplicateRecords:a,priceIssues:o})},Ee=()=>{let e=[...m];Z.startDate&&(e=e.filter(e=>e.work_date>=Z.startDate)),Z.endDate&&(e=e.filter(e=>e.work_date<=Z.endDate)),Z.userId&&(e=e.filter(e=>e.user_id===Z.userId)),Z.status&&(e=e.filter(e=>e.status===Z.status)),Z.productionLine&&(e=e.filter(e=>e.items.some(e=>{var r;return(null==(r=e.processes)?void 0:r.production_line)===Z.productionLine}))),Z.workType&&(e=e.filter(e=>e.items.some(e=>{var r;return(null==(r=e.processes)?void 0:r.production_category)===Z.workType}))),Z.productName&&(e=e.filter(e=>e.items.some(e=>{var r;return(null==(r=e.processes)?void 0:r.product_name)===Z.productName}))),Z.productProcess&&(e=e.filter(e=>e.items.some(e=>{var r;return(null==(r=e.processes)?void 0:r.product_process)===Z.productProcess}))),Z.yearMonth&&(e=e.filter(e=>{const r=new Date(e.work_date);return`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`===Z.yearMonth})),f(e),xe(e),ye(e)},we=e=>new Date(e).toLocaleDateString("zh-CN"),De=e=>{switch(e){case"pending":return"待班长审核";case"approved":return"待段长审核";case"section_chief_approved":return"已通过";default:return"未知"}},_e=e=>{const r=(e=>{switch(e){case"pending":return{text:"待班长审核",icon:"⚠",color:"text-yellow-400"};case"approved":return{text:"待段长审核",icon:"⚠",color:"text-blue-400"};case"section_chief_approved":return{text:"已通过",icon:"✓",color:"text-green-400"};default:return{text:"未知",icon:"⚠",color:"text-gray-400"}}})(e);return pe.jsxDEV("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-bold ${r.color}`,children:[pe.jsxDEV("span",{className:"w-3 h-3 text-center",children:r.icon},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:730,columnNumber:9},void 0),r.text]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:729,columnNumber:7},void 0)},Te=e=>{var r,t,s;return`${(null==(r=e.processes)?void 0:r.production_category)||"未知工时类型"} - ${(null==(t=e.processes)?void 0:t.product_name)||"未知产品"} - ${(null==(s=e.processes)?void 0:s.product_process)||"未知工序"}`},Se=e=>{const r=new Map;return e.forEach(e=>{var t,s,n;const i=`${null==(t=e.user)?void 0:t.id}-${e.work_date}`,a=r.get(i),o=e.items.reduce((e,r)=>e+r.quantity*r.unit_price,0);a?(a.totalAmount+=o,a.recordCount+=1):r.set(i,{userId:null==(s=e.user)?void 0:s.id,userName:null==(n=e.user)?void 0:n.name,workDate:e.work_date,totalAmount:o,recordCount:1,items:e.items})}),Array.from(r.values()).sort((e,r)=>new Date(r.workDate).getTime()-new Date(e.workDate).getTime())},je=e=>{const r=e.getDay();if(0===r||6===r)return!1;e.getFullYear();const t=e.getMonth()+1,s=e.getDate();return(1!==t||1!==s)&&(!(1===t&&s>=21&&s<=27)&&(!(2===t&&s>=10&&s<=16)&&((4!==t||4!==s&&5!==s)&&(!(5===t&&s>=1&&s<=3)&&(!(6===t&&s>=20&&s<=22)&&(!(9===t&&s>=15&&s<=17)&&!(10===t&&s>=1&&s<=7)))))))},ke=e=>{const r=new Map;return e.forEach(e=>{var t,s,n;const i=new Date(e.work_date),a=null==(t=e.user)?void 0:t.id,o=r.get(a),l=je(i),c=e.items.reduce((e,r)=>e+r.quantity*r.unit_price,0);o?(o.totalAmount+=c,o.workDates.add(e.work_date),l?(o.workingAmount+=c,o.workingDates.add(e.work_date)):(o.holidayAmount+=c,o.holidayDates.add(e.work_date))):r.set(a,{userId:null==(s=e.user)?void 0:s.id,userName:null==(n=e.user)?void 0:n.name,totalAmount:c,workingAmount:l?c:0,holidayAmount:l?0:c,workDates:new Set([e.work_date]),workingDates:new Set(l?[e.work_date]:[]),holidayDates:new Set(l?[]:[e.work_date])})}),Array.from(r.values()).map(e=>({...e,actualWorkDays:e.workingDates.size,actualWorkingDays:e.workingDates.size,actualHolidayDays:e.holidayDates.size,avgDailyAmount:e.totalAmount/e.workDates.size,avgWorkingDayAmount:e.workingDates.size>0?e.workingAmount/e.workingDates.size:0,avgHolidayDayAmount:e.holidayDates.size>0?e.holidayAmount/e.holidayDates.size:0})).sort((e,r)=>r.totalAmount-e.totalAmount)},Ce=e=>{const r=new Map;return e.forEach(e=>{var t,s,n;const i=new Date(e.work_date),a=`${null==(t=e.user)?void 0:t.id}-${i.getFullYear()}-${i.getMonth()+1}`,o=r.get(a),l=je(i),c=e.items.reduce((e,r)=>e+r.quantity*r.unit_price,0);o?(o.totalAmount+=c,o.totalDays+=1,l?(o.workDays+=1,o.workAmount+=c):(o.holidayDays+=1,o.holidayAmount+=c)):r.set(a,{userId:null==(s=e.user)?void 0:s.id,userName:null==(n=e.user)?void 0:n.name,year:i.getFullYear(),month:i.getMonth()+1,totalDays:1,workDays:l?1:0,holidayDays:l?0:1,totalAmount:c,workAmount:l?c:0,holidayAmount:l?0:c})}),Array.from(r.values()).map(e=>({...e,avgDailyAmount:e.totalAmount/e.totalDays})).sort((e,r)=>r.year-e.year||r.month-e.month)},Re=e=>{const r=new Map;e.forEach(e=>{var t,s,n,i;if(!e.items||0===e.items.length)return;const a=r.get(null==(t=e.user)?void 0:t.id),o=e.items.reduce((e,r)=>e+r.quantity*r.unit_price,0),l=e.items.reduce((e,r)=>e+r.quantity,0);if(a)a.totalAmount+=o,a.totalQuantity+=l,a.recordCount+=1,a.dates.add(e.work_date);else{const t={userId:null==(s=e.user)?void 0:s.id,userName:null==(n=e.user)?void 0:n.name,totalAmount:o,totalQuantity:l,recordCount:1,dates:new Set([e.work_date])};r.set(null==(i=e.user)?void 0:i.id,t)}});return Array.from(r.values()).map(e=>({...e,workDays:e.dates.size,avgDailyAmount:e.totalAmount/e.dates.size,avgDailyQuantity:e.totalQuantity/e.dates.size})).sort((e,r)=>r.totalAmount-e.totalAmount)},Ae=e=>{const r=new Map,t=new Map;e.forEach(e=>{e.items.forEach(e=>{var s;const n=(null==(s=e.processes)?void 0:s.production_category)||"未知类型",i=n.includes("生产")||n.includes("加工"),a=i?r:t,o=a.get(n),l=e.quantity*e.unit_price;o?(o.totalAmount+=l,o.quantity+=e.quantity,o.recordCount+=1):a.set(n,{category:n,totalAmount:l,quantity:e.quantity,recordCount:1,isProduction:i})})});const s=Array.from(r.values()),n=Array.from(t.values());return{production:s.sort((e,r)=>r.totalAmount-e.totalAmount),nonProduction:n.sort((e,r)=>r.totalAmount-e.totalAmount),productionTotal:s.reduce((e,r)=>e+r.totalAmount,0),nonProductionTotal:n.reduce((e,r)=>e+r.totalAmount,0)}},Me=e=>{const r=[],t=new Map;return e.forEach(e=>{e.items.forEach(s=>{var n,i,a;const o=`${null==(n=e.user)?void 0:n.id}-${e.work_date}-${s.process_id}`,l=t.get(o);l?r.push({userId:null==(i=e.user)?void 0:i.id,userName:null==(a=e.user)?void 0:a.name,workDate:e.work_date,processId:s.process_id,processName:Te(s),records:[l.record,e],items:[l.item,s]}):t.set(o,{record:e,item:s})})}),r},Ie=e=>{const r=[];return e.forEach(e=>{e.items.forEach(t=>{var s,n,i,a;(null==t.unit_price||t.unit_price<=0)&&r.push({recordId:e.id,userId:null==(s=e.user)?void 0:s.id,userName:null==(n=e.user)?void 0:n.name,workDate:e.work_date,processId:t.process_id,processName:Te(t),issue:"单价为空或无效",unitPrice:t.unit_price}),t.processes||r.push({recordId:e.id,userId:null==(i=e.user)?void 0:i.id,userName:null==(a=e.user)?void 0:a.name,workDate:e.work_date,processId:t.process_id,processName:"工序信息缺失",issue:"工序引用缺失",unitPrice:t.unit_price})})}),r},Oe=e=>{let r="asc";H.key===e&&"asc"===H.direction&&(r="desc"),T({...H,key:e,direction:r})},Pe=()=>{let e=w.userStats.filter(e=>e.totalQuantity>0||e.totalAmount>0);if(!H.key)return e;return[...e].sort((e,r)=>{const t=Le(e,H.key),s=Le(r,H.key);return"asc"===H.direction?t>s?1:-1:t<s?1:-1})},Le=(e,r)=>{const t=d.filter(r=>{var t;return(null==(t=r.user)?void 0:t.id)===e.userId}),s=Ae(t),n=w.workDayStats.find(r=>r.userId===e.userId),i=w.duplicateRecords.filter(r=>r.userId===e.userId),a=w.priceIssues.filter(r=>r.userId===e.userId);switch(r){case"userName":return e.userName;case"totalQuantity":return e.totalQuantity;case"totalAmount":return e.totalAmount;case"workDays":return e.workDays;case"avgDailyQuantity":return e.avgDailyQuantity;case"workingDays":return(null==n?void 0:n.actualWorkingDays)||0;case"holidayDays":return(null==n?void 0:n.actualHolidayDays)||0;case"workingAmount":return(null==n?void 0:n.workingAmount)||0;case"holidayAmount":return(null==n?void 0:n.holidayAmount)||0;case"avgDailyAmount":return e.avgDailyAmount;case"productionTotal":return s.productionTotal||0;case"nonProductionTotal":return s.nonProductionTotal||0;case"duplicateCount":return i.length;case"priceIssueCount":return a.length;case"totalIssues":return i.length+a.length;default:return 0}},Fe=(e,r)=>{var t,s;const n=null==(t=e.approval_history)?void 0:t.find(e=>e.approver_type===r);return n?{name:(null==(s=n.approver)?void 0:s.name)||"未知",date:we(n.created_at)}:null};return p?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1153,columnNumber:9},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1152,columnNumber:7},void 0):pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-300",children:[pe.jsxDEV("header",{className:"bg-gray-900 border-b border-green-400 px-6 py-4",children:pe.jsxDEV("div",{className:"max-w-7xl mx-auto",children:pe.jsxDEV("div",{className:"flex items-center justify-between",children:[pe.jsxDEV("div",{className:"flex items-center gap-4",children:pe.jsxDEV("h1",{className:"text-2xl font-bold text-green-400 font-mono flex items-center gap-2",children:[pe.jsxDEV(A,{className:"w-8 h-8"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1168,columnNumber:17},void 0),"查看报表"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1167,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1166,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex items-center gap-4",children:pe.jsxDEV(a,{to:"/dashboard",className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-gray-600 to-gray-800 hover:from-gray-500 hover:to-gray-700 text-green-300 border border-green-400 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 font-mono",children:[pe.jsxDEV(_,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1177,columnNumber:17},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1178,columnNumber:17},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1179,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1173,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1172,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1165,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1164,columnNumber:9},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1163,columnNumber:7},void 0),pe.jsxDEV("div",{className:"max-w-7xl mx-auto p-6",children:[pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-4 mb-6",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:[pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV(X,{className:"w-5 h-5 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1193,columnNumber:15},void 0),pe.jsxDEV("h2",{className:"text-lg font-bold text-green-400 font-mono",children:"数据筛选"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1194,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1192,columnNumber:13},void 0),pe.jsxDEV("button",{onClick:()=>{ee({startDate:"",endDate:"",userId:"",status:"",productionLine:"",workType:"",productName:"",productProcess:"",yearMonth:""})},className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-gray-600 to-gray-800 hover:from-gray-500 hover:to-gray-700 text-green-300 border border-green-400 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 font-mono text-sm",children:[pe.jsxDEV(Y,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1200,columnNumber:15},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"重置筛选"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1201,columnNumber:15},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"重置"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1202,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1196,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1191,columnNumber:11},void 0),pe.jsxDEV("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-medium mb-2 font-mono",children:"年月"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1208,columnNumber:15},void 0),pe.jsxDEV("input",{type:"month",value:Z.yearMonth,onChange:e=>ee({...Z,yearMonth:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1211,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1207,columnNumber:13},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-medium mb-2 font-mono",children:"开始日期"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1220,columnNumber:15},void 0),pe.jsxDEV("input",{type:"date",value:Z.startDate,onChange:e=>ee({...Z,startDate:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1223,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1219,columnNumber:13},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-medium mb-2 font-mono",children:"结束日期"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1232,columnNumber:15},void 0),pe.jsxDEV("input",{type:"date",value:Z.endDate,onChange:e=>ee({...Z,endDate:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1235,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1231,columnNumber:13},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-medium mb-2 font-mono",children:"员工"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1244,columnNumber:15},void 0),pe.jsxDEV("select",{value:Z.userId,onChange:e=>ee({...Z,userId:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部员工"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1252,columnNumber:17},void 0),ie.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1254,columnNumber:19},void 0))]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1247,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1243,columnNumber:13},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-medium mb-2 font-mono",children:"状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1260,columnNumber:15},void 0),pe.jsxDEV("select",{value:Z.status,onChange:e=>ee({...Z,status:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1268,columnNumber:17},void 0),pe.jsxDEV("option",{value:"pending",children:"待班长审核"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1269,columnNumber:17},void 0),pe.jsxDEV("option",{value:"approved",children:"待段长审核"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1270,columnNumber:17},void 0),pe.jsxDEV("option",{value:"section_chief_approved",children:"已通过"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1271,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1263,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1259,columnNumber:13},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-medium mb-2 font-mono",children:"生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1276,columnNumber:15},void 0),pe.jsxDEV("select",{value:Z.productionLine,onChange:e=>ee({...Z,productionLine:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1284,columnNumber:17},void 0),oe.map(e=>pe.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1286,columnNumber:19},void 0))]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1279,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1275,columnNumber:13},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-medium mb-2 font-mono",children:"工时类型"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1292,columnNumber:15},void 0),pe.jsxDEV("select",{value:Z.workType,onChange:e=>ee({...Z,workType:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部工时类型"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1300,columnNumber:17},void 0),ce.map(e=>pe.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1302,columnNumber:19},void 0))]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1295,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1291,columnNumber:13},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-medium mb-2 font-mono",children:"产品名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1308,columnNumber:15},void 0),pe.jsxDEV("select",{value:Z.productName,onChange:e=>ee({...Z,productName:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部产品"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1316,columnNumber:17},void 0),ue.map(e=>pe.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1318,columnNumber:19},void 0))]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1311,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1307,columnNumber:13},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-medium mb-2 font-mono",children:"产品工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1324,columnNumber:15},void 0),pe.jsxDEV("select",{value:Z.productProcess,onChange:e=>ee({...Z,productProcess:e.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1332,columnNumber:17},void 0),fe.map(e=>pe.jsxDEV("option",{value:e,children:e},e,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1334,columnNumber:19},void 0))]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1327,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1323,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1206,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1190,columnNumber:9},void 0),pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:[pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg overflow-hidden",children:[pe.jsxDEV("div",{className:"bg-gray-800 border-b border-green-600 p-4",children:pe.jsxDEV("div",{className:"flex items-center justify-between",children:[pe.jsxDEV("h3",{className:"text-lg font-bold text-green-400 font-mono flex items-center gap-2",children:[pe.jsxDEV(re,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1353,columnNumber:19},void 0),"工时统计分析"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1352,columnNumber:17},void 0),pe.jsxDEV("div",{className:"flex items-center gap-4",children:pe.jsxDEV("button",{onClick:async()=>{const e=await h(()=>Promise.resolve().then(()=>Ng),void 0),r=Pe().map(e=>{var r,t;const s=d.filter(r=>{var t;return(null==(t=r.user)?void 0:t.id)===e.userId}),n=Ae(s),i=w.workDayStats.find(r=>r.userId===e.userId),a=w.duplicateRecords.filter(r=>r.userId===e.userId),o=w.priceIssues.filter(r=>r.userId===e.userId);return{"姓名":e.userName,"总额":e.totalAmount.toFixed(2),"天数":(null==i?void 0:i.actualWorkDays)||e.workDays,"日平均":e.avgDailyAmount.toFixed(2),"生产工时金额":(null==(r=n.productionTotal)?void 0:r.toFixed(2))||"0.00","非生产工时金额":(null==(t=n.nonProductionTotal)?void 0:t.toFixed(2))||"0.00","重复记录数":a.length,"单价问题数":o.length,"异常总数":a.length+o.length}}),t=d.flatMap(e=>e.items.map(r=>{var t,s,n,i,a,o,l;const c=Fe(e,"supervisor"),m=Fe(e,"section_chief");return{"工作日期":we(e.work_date),"员工姓名":(null==(t=e.user)?void 0:t.name)||"未知","产品名称":(null==(s=r.processes)?void 0:s.product_name)||"未知","工序名称":(null==(n=r.processes)?void 0:n.product_process)||"未知","生产线":(null==(i=r.processes)?void 0:i.production_line)||"未知","生产类别":(null==(a=r.processes)?void 0:a.production_category)||"未知","数量":r.quantity,"单价":null!=r.unit_price&&r.unit_price>0?r.unit_price.toFixed(2):"未定义","金额":r.amount.toFixed(2),"状态":De(e.status),"班长":c?c.name:(null==(o=e.supervisor)?void 0:o.name)||"未分配","段长":m?m.name:(null==(l=e.section_chief)?void 0:l.name)||"未分配","创建时间":(u=e.created_at,new Date(u).toLocaleString("zh-CN"))};var u})),s=[];Pe().forEach(e=>{const r=d.filter(r=>{var t;return(null==(t=r.user)?void 0:t.id)===e.userId}).flatMap(e=>e.items.map(r=>({...r,workDate:e.work_date}))),t=new Map;r.forEach(e=>{var r,s,n,i,a,o,l,c;const m=`${(null==(r=e.processes)?void 0:r.production_category)||"未知"}-${(null==(s=e.processes)?void 0:s.production_line)||"未知"}-${(null==(n=e.processes)?void 0:n.product_name)||"未知"}-${(null==(i=e.processes)?void 0:i.product_process)||"未知"}`;t.has(m)||t.set(m,{productionCategory:(null==(a=e.processes)?void 0:a.production_category)||"未知",productionLine:(null==(o=e.processes)?void 0:o.production_line)||"未知",productName:(null==(l=e.processes)?void 0:l.product_name)||"未知",productProcess:(null==(c=e.processes)?void 0:c.product_process)||"未知",totalQuantity:0,recordCount:0});const u=t.get(m);u.totalQuantity+=e.quantity,u.recordCount+=1});Array.from(t.values()).forEach(r=>{s.push({"员工姓名":e.userName,"生产类别":r.productionCategory,"生产线":r.productionLine,"产品名称":r.productName,"工序名称":r.productProcess,"数量总计":r.totalQuantity.toFixed(1),"记录条数":r.recordCount})})});const n=e.utils.book_new(),i=e.utils.json_to_sheet(r);i["!cols"]=[{wch:12},{wch:10},{wch:8},{wch:10},{wch:15},{wch:15},{wch:12},{wch:12},{wch:10}];const a=e.utils.decode_range(i["!ref"]||"A1");for(let d=a.s.c;d<=a.e.c;d++){const r=e.utils.encode_cell({r:0,c:d});i[r]&&(i[r].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"4A5568"}},alignment:{horizontal:"center"}})}e.utils.book_append_sheet(n,i,"工时统计分析");const o=e.utils.json_to_sheet(t);o["!cols"]=[{wch:12},{wch:12},{wch:15},{wch:15},{wch:10},{wch:12},{wch:8},{wch:10},{wch:10},{wch:12},{wch:15},{wch:15},{wch:18}];const l=e.utils.decode_range(o["!ref"]||"A1");for(let d=l.s.c;d<=l.e.c;d++){const r=e.utils.encode_cell({r:0,c:d});o[r]&&(o[r].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"2D3748"}},alignment:{horizontal:"center"}})}o["!autofilter"]={ref:o["!ref"]},e.utils.book_append_sheet(n,o,"详细工时记录");const c=e.utils.json_to_sheet(s);c["!cols"]=[{wch:12},{wch:12},{wch:10},{wch:15},{wch:15},{wch:10},{wch:10}];const m=e.utils.decode_range(c["!ref"]||"A1");for(let d=m.s.c;d<=m.e.c;d++){const r=e.utils.encode_cell({r:0,c:d});c[r]&&(c[r].s={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"1A202C"}},alignment:{horizontal:"center"}})}c["!autofilter"]={ref:c["!ref"]},e.utils.book_append_sheet(n,c,"数量统计汇总");const u=`工时报告_${(new Date).toISOString().split("T")[0]}.xlsx`;e.writeFile(n,u),W.success("报告导出成功！")},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded transition-colors font-mono text-sm",children:[pe.jsxDEV(G,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1568,columnNumber:21},void 0),"导出报告"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1359,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1356,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1351,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1350,columnNumber:13},void 0),pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full",children:[pe.jsxDEV("thead",{className:"bg-gray-800 border-b border-green-600",children:pe.jsxDEV("tr",{children:[pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:pe.jsxDEV("button",{onClick:()=>Oe("userName"),className:"flex items-center gap-1 hover:text-green-300 transition-colors",children:"员工姓名"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1581,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1580,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:pe.jsxDEV("button",{onClick:()=>Oe("totalAmount"),className:"flex items-center gap-1 hover:text-green-300 transition-colors",children:"总额"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1590,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1589,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:pe.jsxDEV("button",{onClick:()=>Oe("workDays"),className:"flex items-center gap-1 hover:text-green-300 transition-colors",children:"天数"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1598,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1597,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:pe.jsxDEV("button",{onClick:()=>Oe("avgDailyAmount"),className:"flex items-center gap-1 hover:text-green-300 transition-colors",children:"日平均"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1608,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1607,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:pe.jsxDEV("button",{onClick:()=>Oe("productionTotal"),className:"flex items-center gap-1 hover:text-green-300 transition-colors",children:"生产工时金额"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1616,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1615,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:pe.jsxDEV("button",{onClick:()=>Oe("nonProductionTotal"),className:"flex items-center gap-1 hover:text-green-300 transition-colors",children:"非生产工时金额"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1624,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1623,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:pe.jsxDEV("button",{onClick:()=>Oe("duplicateCount"),className:"flex items-center gap-1 hover:text-green-300 transition-colors",children:["重复记录(",w.duplicateRecords.length,")"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1632,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1631,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:pe.jsxDEV("button",{onClick:()=>Oe("priceIssueCount"),className:"flex items-center gap-1 hover:text-green-300 transition-colors",children:["单价问题(",w.priceIssues.length,")"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1640,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1639,columnNumber:21},void 0),pe.jsxDEV("th",{className:"px-4 py-3 text-left text-green-400 font-mono text-sm",children:"操作"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1647,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1579,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1578,columnNumber:17},void 0),pe.jsxDEV("tbody",{children:Pe().map((e,r)=>{var t,s;w.dailyStats.filter(r=>r.userId===e.userId),w.monthlyStats.filter(r=>r.userId===e.userId),w.workDayStats.find(r=>r.userId===e.userId);const n=w.duplicateRecords.filter(r=>r.userId===e.userId),i=w.priceIssues.filter(r=>r.userId===e.userId),a=d.filter(r=>{var t;return(null==(t=r.user)?void 0:t.id)===e.userId}),l=Ae(a),c=n.length>0||i.length>0;return pe.jsxDEV(o.Fragment,{children:[pe.jsxDEV("tr",{className:"border-b transition-colors "+(c?"border-red-500 bg-red-900 bg-opacity-20 hover:bg-red-900 hover:bg-opacity-30":"border-gray-700 hover:bg-gray-800"),children:[pe.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm font-medium",children:e.userName},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1675,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm font-bold",children:["¥",e.totalAmount.toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1679,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-4 py-3 text-green-300 font-mono text-sm",children:e.workDays},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1682,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-4 py-3 text-purple-300 font-mono text-sm",children:["¥",e.avgDailyAmount.toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1687,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-4 py-3 text-blue-300 font-mono text-sm",children:["¥",(null==(t=l.productionTotal)?void 0:t.toFixed(2))||"0.00"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1690,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-4 py-3 text-red-300 font-mono text-sm",children:["¥",(null==(s=l.nonProductionTotal)?void 0:s.toFixed(2))||"0.00"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1693,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-4 py-3 font-mono text-sm",children:n.length>0?pe.jsxDEV("span",{className:"text-yellow-400 font-bold",children:n.length},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1698,columnNumber:31},void 0):pe.jsxDEV("span",{className:"text-green-400",children:"0"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1700,columnNumber:31},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1696,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-4 py-3 font-mono text-sm",children:i.length>0?pe.jsxDEV("span",{className:"text-red-400 font-bold",children:i.length},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1705,columnNumber:31},void 0):pe.jsxDEV("span",{className:"text-green-400",children:"0"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1707,columnNumber:31},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1703,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-4 py-3",children:pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("button",{onClick:()=>{const r=new Set(S);S.has(e.userId)?r.delete(e.userId):r.add(e.userId),j(r)},className:"text-blue-400 hover:text-blue-300 transition-colors",title:S.has(e.userId)?"收起详细记录":"展开详细记录",children:S.has(e.userId)?pe.jsxDEV(te,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1726,columnNumber:35},void 0):pe.jsxDEV(se,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1728,columnNumber:35},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1712,columnNumber:31},void 0),c&&pe.jsxDEV("span",{className:"text-red-400",title:"存在异常数据",children:"⚠"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1732,columnNumber:33},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1711,columnNumber:29},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1710,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1668,columnNumber:25},void 0),S.has(e.userId)&&(()=>{const r=d.filter(r=>{var t;return(null==(t=r.user)?void 0:t.id)===e.userId});return 0===r.length||r.every(e=>0===e.items.length)?null:pe.jsxDEV("tr",{className:"bg-gray-800 border-b border-gray-600",children:pe.jsxDEV("td",{colSpan:11,className:"px-4 py-4",children:pe.jsxDEV("div",{className:"bg-gray-700 rounded-lg p-4",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:pe.jsxDEV("h4",{className:"text-lg font-bold text-green-400 font-mono flex items-center gap-2",children:[pe.jsxDEV(x,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1754,columnNumber:37},void 0),e.userName," - 详细工时记录"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1753,columnNumber:35},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1752,columnNumber:33},void 0),pe.jsxDEV("div",{className:"bg-gray-600 rounded-lg overflow-hidden",children:pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full",children:[pe.jsxDEV("thead",{className:"bg-gray-700",children:pe.jsxDEV("tr",{children:[pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"工作日期"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1765,columnNumber:43},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"日工时金额"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1766,columnNumber:43},void 0),k&&pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"生产类别"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1769,columnNumber:47},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"产品名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1770,columnNumber:47},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"工序名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1771,columnNumber:47},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1772,columnNumber:47},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1768,columnNumber:45},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"数量"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1775,columnNumber:43},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"单价"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1776,columnNumber:43},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"金额"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1777,columnNumber:43},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1778,columnNumber:43},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"班长"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1779,columnNumber:43},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"段长"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1780,columnNumber:43},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"操作"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1781,columnNumber:43},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1764,columnNumber:41},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1763,columnNumber:39},void 0),pe.jsxDEV("tbody",{children:(()=>{const e=r.reduce((e,r)=>{const t=r.work_date;return e[t]||(e[t]=[]),e[t].push(r),e},{});return Object.keys(e).sort((e,r)=>new Date(r).getTime()-new Date(e).getTime()).flatMap(r=>{const t=e[r],s=t.reduce((e,r)=>e+r.items.reduce((e,r)=>e+r.amount,0),0),a=t.flatMap(e=>e.items.map(r=>({...r,record:e})));return a.map((e,t)=>{var o,l,c,u,d;const f=n.some(r=>r.workDate===e.record.work_date&&r.processId===e.process_id),h=i.some(r=>r.workDate===e.record.work_date&&r.processId===e.process_id),p=f||h;return pe.jsxDEV("tr",{className:"border-b border-gray-600 hover:bg-gray-600 transition-colors "+(p?"bg-red-900 bg-opacity-20":""),children:[0===t?pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV("td",{className:"px-3 py-2 text-yellow-400 font-mono text-xs font-bold border-r border-gray-500",rowSpan:a.length,children:pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV(K,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1839,columnNumber:57},void 0),we(r)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1838,columnNumber:55},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1834,columnNumber:53},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-400 font-mono text-xs font-bold border-r border-gray-500",rowSpan:a.length,children:["¥",s.toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1843,columnNumber:53},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1833,columnNumber:51},void 0):null,k&&pe.jsxDEV(pe.Fragment,{children:[pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:pe.jsxDEV("span",{className:"px-2 py-1 rounded text-xs font-bold "+("生产工时"===(null==(o=e.processes)?void 0:o.production_category)?"bg-blue-900 text-blue-300":"bg-red-900 text-red-300"),children:(null==(l=e.processes)?void 0:l.production_category)||"未知"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1856,columnNumber:55},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1855,columnNumber:53},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:(null==(c=e.processes)?void 0:c.product_name)||"未知"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1864,columnNumber:53},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:(null==(u=e.processes)?void 0:u.product_process)||"未知"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1867,columnNumber:53},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:(null==(d=e.processes)?void 0:d.production_line)||"未知"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1870,columnNumber:53},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1854,columnNumber:51},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs font-bold",children:(null==C?void 0:C.recordId)===e.record.id&&(null==C?void 0:C.itemId)===e.id?pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("input",{type:"number",value:I,onChange:e=>{e.stopPropagation(),O(Number(e.target.value))},onClick:e=>e.stopPropagation(),onWheel:e=>e.preventDefault(),className:"w-16 px-2 py-1 bg-gray-700 border border-gray-600 rounded text-green-300 font-mono text-xs [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",min:"0",step:"0.1"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1878,columnNumber:55},void 0),pe.jsxDEV("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),(()=>{if(!C)return void W.error("请先选择要编辑的项目");if(I<0)return void W.error("数量不能为负数");const e={recordId:C.recordId,itemId:C.itemId,newQuantity:I};$(e),L(!0)})()},className:"p-1 text-green-400 hover:text-green-300 transition-colors",title:"确认修改",children:pe.jsxDEV(ne,{className:"w-3 h-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1900,columnNumber:57},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1891,columnNumber:55},void 0),pe.jsxDEV("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),M(null),O(0)},className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"取消修改",children:pe.jsxDEV(N,{className:"w-3 h-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1911,columnNumber:57},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1902,columnNumber:55},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1877,columnNumber:53},void 0):pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("span",{children:e.quantity},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1916,columnNumber:55},void 0),pe.jsxDEV("button",{onClick:r=>{var t,s,n;r.preventDefault(),r.stopPropagation(),t=e.record.id,s=e.id,n=e.quantity,M({recordId:t,itemId:s}),O(n)},className:"p-1 text-blue-400 hover:text-blue-300 transition-colors",title:"编辑数量",children:pe.jsxDEV(J,{className:"w-3 h-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1926,columnNumber:57},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1917,columnNumber:55},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1915,columnNumber:53},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1875,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:[null!=e.unit_price&&e.unit_price>0?`¥${e.unit_price.toFixed(2)}`:"未定义",h&&pe.jsxDEV("span",{className:"ml-1 text-red-400",title:"单价异常",children:"⚠"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1934,columnNumber:53},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1931,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs font-bold",children:["¥",e.amount.toFixed(2)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1939,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:pe.jsxDEV("div",{className:"flex items-center gap-1",children:[_e(e.record.status),f&&pe.jsxDEV("span",{className:"text-yellow-400",title:"重复记录",children:"⚠"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1946,columnNumber:55},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1943,columnNumber:51},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1942,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:(()=>{var r;const t=Fe(e.record,"supervisor"),s=(null==(r=e.record.supervisor)?void 0:r.name)||"未分配";return t?pe.jsxDEV("div",{className:"flex flex-col",children:[pe.jsxDEV("div",{children:t.name},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1959,columnNumber:59},void 0),pe.jsxDEV("div",{className:"text-xs text-gray-400",children:t.date},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1960,columnNumber:59},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1958,columnNumber:57},void 0):s})()},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1952,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:(()=>{var r;const t=Fe(e.record,"section_chief"),s=(null==(r=e.record.section_chief)?void 0:r.name)||"未分配";return t?pe.jsxDEV("div",{className:"flex flex-col",children:[pe.jsxDEV("div",{children:t.name},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1974,columnNumber:59},void 0),pe.jsxDEV("div",{className:"text-xs text-gray-400",children:t.date},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1975,columnNumber:59},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1973,columnNumber:57},void 0):s})()},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1967,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:pe.jsxDEV("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),((e,r)=>{var t,s;const n=m.find(r=>r.id===e),i=null==(t=null==n?void 0:n.items)?void 0:t.find(e=>e.id===r),a=(null==(s=null==n?void 0:n.user)?void 0:s.name)||"未知员工",o=(null==n?void 0:n.work_date)?we(n.work_date):"未知日期",l=i?Te(i):"未知项目";Q({recordId:e,itemId:r,employeeName:a,workDate:o,workProject:l}),B(!0)})(e.record.id,e.id)},className:"p-1 text-red-400 hover:text-red-300 transition-colors",title:"删除工时项目",children:pe.jsxDEV(F,{className:"w-3 h-3"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1992,columnNumber:53},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1983,columnNumber:51},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1982,columnNumber:49},void 0)]},`${r}-${e.record.id}-${t}`,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1825,columnNumber:47},void 0)})})})()},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1784,columnNumber:39},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1762,columnNumber:37},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1761,columnNumber:35},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1760,columnNumber:33},void 0),pe.jsxDEV("div",{className:"mt-6 bg-gray-600 rounded-lg p-4",children:[pe.jsxDEV("h5",{className:"text-md font-bold text-green-400 font-mono mb-4 flex items-center gap-2",children:[pe.jsxDEV(A,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2008,columnNumber:37},void 0),e.userName," - 数量统计汇总"]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2007,columnNumber:35},void 0),(()=>{const e=r.flatMap(e=>e.items.map(r=>({...r,workDate:e.work_date}))),t=new Map;e.forEach(e=>{var r,s,n,i,a,o,l,c;const m=`${(null==(r=e.processes)?void 0:r.production_category)||"未知"}-${(null==(s=e.processes)?void 0:s.production_line)||"未知"}-${(null==(n=e.processes)?void 0:n.product_name)||"未知"}-${(null==(i=e.processes)?void 0:i.product_process)||"未知"}`;t.has(m)||t.set(m,{productionCategory:(null==(a=e.processes)?void 0:a.production_category)||"未知",productionLine:(null==(o=e.processes)?void 0:o.production_line)||"未知",productName:(null==(l=e.processes)?void 0:l.product_name)||"未知",productProcess:(null==(c=e.processes)?void 0:c.product_process)||"未知",totalQuantity:0,recordCount:0});const u=t.get(m);u.totalQuantity+=e.quantity,u.recordCount+=1});const s=Array.from(t.values()).sort((e,r)=>e.productionCategory!==r.productionCategory?e.productionCategory.localeCompare(r.productionCategory):r.totalQuantity-e.totalQuantity);return 0===s.length?pe.jsxDEV("div",{className:"text-center py-4 text-gray-400 font-mono text-sm",children:"暂无统计数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2053,columnNumber:41},void 0):pe.jsxDEV("div",{className:"overflow-x-auto",children:pe.jsxDEV("table",{className:"w-full",children:[pe.jsxDEV("thead",{className:"bg-gray-700",children:pe.jsxDEV("tr",{children:[pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"生产类别"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2064,columnNumber:47},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"生产线"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2065,columnNumber:47},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"产品名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2066,columnNumber:47},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"工序名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2067,columnNumber:47},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"数量总计"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2068,columnNumber:47},void 0),pe.jsxDEV("th",{className:"px-3 py-2 text-left text-green-400 font-mono text-xs",children:"记录条数"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2069,columnNumber:47},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2063,columnNumber:45},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2062,columnNumber:43},void 0),pe.jsxDEV("tbody",{children:s.map((e,r)=>pe.jsxDEV("tr",{className:"border-b border-gray-600 hover:bg-gray-600 transition-colors",children:[pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:pe.jsxDEV("span",{className:"px-2 py-1 rounded text-xs font-bold "+("生产工时"===e.productionCategory?"bg-blue-900 text-blue-300":"bg-red-900 text-red-300"),children:e.productionCategory},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2076,columnNumber:51},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2075,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:e.productionLine},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2084,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:e.productName},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2087,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-green-300 font-mono text-xs",children:e.productProcess},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2090,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-yellow-400 font-mono text-xs font-bold",children:e.totalQuantity.toFixed(1)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2093,columnNumber:49},void 0),pe.jsxDEV("td",{className:"px-3 py-2 text-blue-400 font-mono text-xs",children:e.recordCount},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2096,columnNumber:49},void 0)]},r,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2074,columnNumber:47},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2072,columnNumber:43},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2061,columnNumber:41},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2060,columnNumber:39},void 0)})()]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2006,columnNumber:33},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1751,columnNumber:33},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1750,columnNumber:31},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1749,columnNumber:29},void 0)})()]},r,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1667,columnNumber:23},void 0)})},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1650,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1577,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1576,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1348,columnNumber:11},void 0),0===w.userStats.length&&pe.jsxDEV("div",{className:"text-center py-12",children:[pe.jsxDEV("div",{className:"text-blue-600 mb-4",children:pe.jsxDEV(R,{className:"h-16 w-16 mx-auto"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2127,columnNumber:17},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2126,columnNumber:15},void 0),pe.jsxDEV("h3",{className:"text-lg font-medium text-blue-400 mb-2 font-mono",children:"暂无统计数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2129,columnNumber:15},void 0),pe.jsxDEV("p",{className:"text-blue-600 font-mono",children:"请调整筛选条件或刷新数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2130,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2125,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1346,columnNumber:9},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1186,columnNumber:7},void 0),pe.jsxDEV(kg,{isOpen:P,currentQuantity:C?null==(s=null==(r=null==(e=m.find(e=>e.id===C.recordId))?void 0:e.items)?void 0:r.find(e=>e.id===C.itemId))?void 0:s.quantity:void 0,newQuantity:null==z?void 0:z.newQuantity,onConfirm:async()=>{if(z)try{const e=m.find(e=>e.id===z.recordId),r=null==e?void 0:e.items.find(e=>e.id===z.itemId),t=(null==r?void 0:r.unit_price)||0,s=z.newQuantity*t,{error:n}=await ve.from("timesheet_record_items").update({quantity:z.newQuantity,amount:s}).eq("id",z.itemId);if(n)throw n;W.success("数量修改成功"),await be(),M(null),O(0),$(null),L(!1)}catch(e){W.error("修改数量失败")}},onCancel:()=>{L(!1),$(null)}},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2137,columnNumber:7},void 0),pe.jsxDEV(jg,{isOpen:U,employeeName:null==q?void 0:q.employeeName,workDate:null==q?void 0:q.workDate,workProject:null==q?void 0:q.workProject,onConfirm:async()=>{if(q)try{const{data:e,error:r}=await ve.from("timesheet_record_items").select("id").eq("timesheet_record_id",q.recordId);if(r)throw r;const{error:t}=await ve.from("timesheet_record_items").delete().eq("id",q.itemId);if(t)throw t;if(e&&1===e.length){const{error:e}=await ve.from("timesheet_records").delete().eq("id",q.recordId)}W.success("工时项目删除成功"),await be(),Q(null),B(!1)}catch(e){W.error("删除工时项目失败")}},onCancel:()=>{B(!1),Q(null)}},void 0,!1,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:2149,columnNumber:7},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/Reports.tsx",lineNumber:1161,columnNumber:5},void 0)},Cg=()=>pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-400 p-8",children:pe.jsxDEV("div",{className:"max-w-4xl mx-auto",children:[pe.jsxDEV("h1",{className:"text-2xl font-bold mb-8",children:"Toast 功能测试"},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:31,columnNumber:9},void 0),pe.jsxDEV("div",{className:"grid grid-cols-2 gap-4",children:[pe.jsxDEV("button",{onClick:()=>{W.error("测试错误提示：没有找到合适的接收人",{description:"请确保目标生产线有相同角色的用户",duration:5e3})},className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:"测试错误提示"},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:34,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:()=>{W.success("测试成功提示")},className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded transition-colors",children:"测试成功提示"},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:41,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:()=>{W.warning("测试警告提示")},className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-500 text-white rounded transition-colors",children:"测试警告提示"},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:48,columnNumber:11},void 0),pe.jsxDEV("button",{onClick:()=>{W.info("测试信息提示")},className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded transition-colors",children:"测试信息提示"},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:55,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:33,columnNumber:9},void 0),pe.jsxDEV("div",{className:"mt-8 p-4 border border-green-400/30 rounded",children:[pe.jsxDEV("h2",{className:"text-lg font-bold mb-4",children:"使用说明："},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:64,columnNumber:11},void 0),pe.jsxDEV("ul",{className:"list-disc list-inside space-y-2",children:[pe.jsxDEV("li",{children:"点击按钮测试不同类型的toast提示"},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:66,columnNumber:13},void 0),pe.jsxDEV("li",{children:"toast应该出现在页面右上角"},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:67,columnNumber:13},void 0),pe.jsxDEV("li",{children:"如果没有看到提示，请检查浏览器控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:68,columnNumber:13},void 0),pe.jsxDEV("li",{children:"确保Toaster组件已正确配置在App.tsx中"},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:69,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:65,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:63,columnNumber:9},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:30,columnNumber:7},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/ToastTest.tsx",lineNumber:29,columnNumber:5},void 0);function Rg(){const{id:e}=c(),[r,s]=t.useState(null),[n,o]=t.useState({name:"",permissions:[]}),[l,m]=t.useState(!0),[u,d]=t.useState(!1),[f,h]=t.useState(""),{user:p,loading:g}=Ve(),b=i();if(t.useEffect(()=>{var e;if(g||p)return p&&(null==(e=p.role)?void 0:e.permissions)&&!Te(p,xe.ROLE_MANAGE)?(h("您没有权限访问角色管理功能"),void m(!1)):void 0;b("/login")},[p,g,b]),g)return pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("div",{className:"text-green-400 text-2xl font-mono mb-4",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:54,columnNumber:11},this),pe.jsxDEV("div",{className:"text-green-600 font-mono",children:"正在验证用户身份"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:55,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:53,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:52,columnNumber:7},this);t.useEffect(()=>{var r;p&&(null==(r=p.role)?void 0:r.permissions)&&Te(p,xe.ROLE_MANAGE)&&e&&v()},[p,e]);const v=async()=>{if(e)try{const{data:r,error:t}=await ve.from("user_roles").select("*").eq("id",e).single();if(t)throw t;if(!r)throw new Error("角色不存在");s(r),o({name:r.name,permissions:r.permissions||[]})}catch(r){h(r.message||"获取角色信息失败")}finally{m(!1)}};return l?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:158,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:157,columnNumber:7},this):f?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV(L,{className:"w-16 h-16 text-red-400 mx-auto mb-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:169,columnNumber:11},this),pe.jsxDEV("div",{className:"text-red-400 text-xl font-mono mb-4",children:f},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:170,columnNumber:11},this),pe.jsxDEV(a,{to:"/role-permissions",className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono",children:"返回角色列表"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:171,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:168,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:167,columnNumber:7},this):r?pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-300 p-4 sm:p-6",children:pe.jsxDEV("div",{className:"max-w-4xl mx-auto",children:[pe.jsxDEV("div",{className:"mb-6",children:pe.jsxDEV("div",{className:"flex items-center justify-between mb-3",children:[pe.jsxDEV("h1",{className:"text-xl sm:text-2xl font-bold text-green-400 font-mono truncate",children:["编辑角色 - ",r.name]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:203,columnNumber:13},this),pe.jsxDEV(a,{to:"/role-permissions",className:"flex items-center text-green-400 hover:text-green-300 transition-colors flex-shrink-0 font-mono",children:[pe.jsxDEV(_,{className:"h-5 w-5 mr-2"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:210,columnNumber:15},this),"返回"]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:206,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:202,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:201,columnNumber:9},this),f&&pe.jsxDEV("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-400/60 rounded text-red-200 text-sm font-mono",children:f},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:217,columnNumber:11},this),pe.jsxDEV("form",{onSubmit:async r=>{r.preventDefault(),d(!0),h("");try{if(!e)throw new Error("角色ID不存在");const{data:r}=await ve.from("user_roles").select("id").eq("name",n.name).neq("id",e).single();if(r)throw new Error("角色名称已存在");const{data:t,error:s}=await ve.from("user_roles").update({name:n.name,permissions:n.permissions,updated_at:(new Date).toISOString()}).eq("id",e).select("*");if(s)throw s;if(!t||0===t.length)throw new Error("更新失败：无法获取更新后的数据，请检查权限设置");b("/role-permissions")}catch(t){h(t.message||"保存失败")}finally{d(!1)}},className:"space-y-4 sm:space-y-6",children:[pe.jsxDEV("div",{className:"bg-gray-900/50 border border-green-400/50 rounded p-4 sm:p-6",children:[pe.jsxDEV("h2",{className:"text-lg font-bold text-green-400 font-mono mb-3 sm:mb-4",children:"基本信息"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:225,columnNumber:13},this),pe.jsxDEV("div",{className:"space-y-4",children:pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"角色名称 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:229,columnNumber:17},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400/70 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:233,columnNumber:19},this),pe.jsxDEV("input",{type:"text",value:n.name,onChange:e=>o(r=>({...r,name:e.target.value})),required:!0,className:"w-full pl-10 pr-4 py-2 sm:py-3 bg-black border border-green-400/30 rounded text-green-200 placeholder-green-700 focus:outline-none focus:border-green-400 focus:bg-gray-900/30 font-mono text-sm transition-all",placeholder:"请输入角色名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:234,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:232,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:228,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:227,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:224,columnNumber:11},this),r&&r.name!==ye&&pe.jsxDEV("div",{className:"bg-gray-900/50 border border-green-400/50 rounded p-4 sm:p-6",children:[pe.jsxDEV("h2",{className:"text-lg font-bold text-green-400 font-mono mb-3 sm:mb-4",children:"权限设置"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:252,columnNumber:15},this),pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm mb-4",children:"选择该角色可以访问的Dashboard模块："},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:255,columnNumber:17},this),pe.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Ee.map(e=>pe.jsxDEV("label",{className:"flex flex-col items-start gap-2 p-3 border border-green-400/20 rounded transition-colors cursor-pointer hover:bg-gray-800/30",children:[pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("input",{type:"checkbox",checked:n.permissions.includes(e.permission),onChange:()=>{return r=e.permission,void o(e=>({...e,permissions:e.permissions.includes(r)?e.permissions.filter(e=>e!==r):[...e.permissions,r]}));var r},className:"w-4 h-4 text-green-600 bg-black border-green-400 rounded focus:ring-green-500 focus:ring-2"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:263,columnNumber:25},this),pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm font-medium",children:e.name},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:269,columnNumber:25},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:262,columnNumber:23},this),pe.jsxDEV("div",{className:"text-green-600 font-mono text-xs ml-6",children:e.description},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:273,columnNumber:23},this)]},e.id,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:261,columnNumber:21},this))},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:259,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:254,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:251,columnNumber:13},this),r&&r.name===ye&&pe.jsxDEV("div",{className:"bg-gray-900/50 border border-green-400/50 rounded p-4 sm:p-6",children:[pe.jsxDEV("h2",{className:"text-lg font-bold text-green-400 font-mono mb-3 sm:mb-4",children:"权限设置"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:286,columnNumber:15},this),pe.jsxDEV("div",{className:"p-4 bg-yellow-900/30 border border-yellow-400/60 rounded",children:[pe.jsxDEV("div",{className:"flex items-center gap-2 mb-2",children:[pe.jsxDEV(T,{className:"w-5 h-5 text-yellow-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:289,columnNumber:19},this),pe.jsxDEV("span",{className:"text-yellow-400 font-mono font-bold",children:"超级管理员"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:290,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:288,columnNumber:17},this),pe.jsxDEV("p",{className:"text-yellow-300 font-mono text-sm",children:"超级管理员自动拥有系统所有权限，可以访问所有Dashboard模块，无需手动设置。"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:292,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:287,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:285,columnNumber:13},this),pe.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[pe.jsxDEV("button",{type:"submit",disabled:u,className:"flex items-center justify-center gap-2 px-4 py-2 sm:py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 disabled:opacity-50 text-black font-medium rounded transition-all font-mono text-sm",children:[pe.jsxDEV(P,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:308,columnNumber:15},this),u?"保存中...":"保存"]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:303,columnNumber:13},this),pe.jsxDEV(a,{to:"/role-permissions",className:"flex items-center justify-center gap-2 px-4 py-2 sm:py-3 border border-gray-500 hover:border-gray-400 hover:bg-gray-800/30 text-gray-300 font-medium rounded transition-all font-mono text-sm",children:[pe.jsxDEV(N,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:315,columnNumber:15},this),"取消"]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:311,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:302,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:222,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:199,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:198,columnNumber:5},this):pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV(L,{className:"w-16 h-16 text-red-400 mx-auto mb-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:184,columnNumber:11},this),pe.jsxDEV("div",{className:"text-red-400 text-xl font-mono mb-4",children:"角色不存在"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:185,columnNumber:11},this),pe.jsxDEV(a,{to:"/role-permissions",className:"px-4 py-2 bg-green-600 hover:bg-green-500 text-black font-bold rounded transition-colors font-mono",children:"返回角色列表"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:186,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:183,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleEdit.tsx",lineNumber:182,columnNumber:7},this)}function Ag(){const e=i(),{user:r}=Ve(),[s,n]=t.useState({name:"",permissions:[]}),[a,o]=t.useState(!1),[l,c]=t.useState(null),[m,u]=t.useState(!1);if(m)return pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:49,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:48,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:47,columnNumber:7},this);if(!r)return pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 p-8 rounded-lg max-w-md w-full text-center",children:[pe.jsxDEV("h2",{className:"text-xl font-semibold text-green-400 mb-2 font-mono",children:"未登录"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:61,columnNumber:11},this),pe.jsxDEV("p",{className:"text-green-300 mb-6 font-mono",children:"请先登录后再访问此页面"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:62,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:60,columnNumber:9},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:59,columnNumber:7},this);return pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-300 p-4 sm:p-6",children:pe.jsxDEV("div",{className:"max-w-4xl mx-auto",children:[pe.jsxDEV("div",{className:"mb-6",children:pe.jsxDEV("div",{className:"flex items-center justify-between mb-3",children:[pe.jsxDEV("h1",{className:"text-xl sm:text-2xl font-bold text-green-400 font-mono truncate",children:"创建角色"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:130,columnNumber:13},this),pe.jsxDEV("button",{onClick:()=>e("/role-permissions"),className:"flex items-center text-green-400 hover:text-green-300 transition-colors flex-shrink-0 font-mono",children:[pe.jsxDEV(_,{className:"h-5 w-5 mr-2"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:137,columnNumber:15},this),"返回"]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:133,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:129,columnNumber:11},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:128,columnNumber:9},this),l&&pe.jsxDEV("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-400/60 rounded text-red-200 text-sm font-mono",children:l},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:144,columnNumber:11},this),pe.jsxDEV("form",{onSubmit:async r=>{if(r.preventDefault(),s.name.trim()){o(!0),c(null);try{const{data:r}=await ve.from("user_roles").select("id").eq("name",s.name.trim()).single();if(r)return c("角色名称已存在，请使用其他名称"),void o(!1);if(s.name.trim()===ye)return c("超级管理员角色已存在，无法重复创建"),void o(!1);const{error:t}=await ve.from("user_roles").insert({name:s.name.trim(),permissions:s.permissions});if(t)return void c("创建角色失败，请重试");c(""),e("/roles")}catch(t){c("创建角色时发生错误，请重试")}finally{o(!1)}}else c("角色名称不能为空")},className:"space-y-4 sm:space-y-6",children:[pe.jsxDEV("div",{className:"bg-gray-900/50 border border-green-400/50 rounded p-4 sm:p-6",children:[pe.jsxDEV("h2",{className:"text-lg font-bold text-green-400 font-mono mb-3 sm:mb-4",children:"基本信息"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:152,columnNumber:13},this),pe.jsxDEV("div",{className:"space-y-4",children:pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-sm font-mono mb-2",children:"角色名称 *"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:156,columnNumber:17},this),pe.jsxDEV("div",{className:"relative",children:[pe.jsxDEV(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-green-400/70 w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:160,columnNumber:19},this),pe.jsxDEV("input",{type:"text",value:s.name,onChange:e=>n(r=>({...r,name:e.target.value})),required:!0,className:"w-full pl-10 pr-4 py-2 sm:py-3 bg-black border border-green-400/30 rounded text-green-200 placeholder-green-700 focus:outline-none focus:border-green-400 focus:bg-gray-900/30 font-mono text-sm transition-all",placeholder:"请输入角色名称"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:161,columnNumber:19},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:159,columnNumber:17},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:155,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:154,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:151,columnNumber:11},this),pe.jsxDEV("div",{className:"bg-gray-900/50 border border-green-400/50 rounded p-4 sm:p-6",children:[pe.jsxDEV("h2",{className:"text-lg font-bold text-green-400 font-mono mb-3 sm:mb-4",children:"权限设置"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:178,columnNumber:13},this),pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm mb-4",children:"选择该角色可以访问的Dashboard模块："},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:181,columnNumber:15},this),pe.jsxDEV("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Ee.map(e=>pe.jsxDEV("label",{className:"flex flex-col items-start gap-2 p-3 border border-green-400/20 rounded transition-colors cursor-pointer hover:bg-gray-800/30",children:[pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV("input",{type:"checkbox",checked:s.permissions.includes(e.permission),onChange:()=>{return r=e.permission,void n(e=>({...e,permissions:e.permissions.includes(r)?e.permissions.filter(e=>e!==r):[...e.permissions,r]}));var r},className:"w-4 h-4 text-green-600 bg-black border-green-400 rounded focus:ring-green-500 focus:ring-2"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:189,columnNumber:23},this),pe.jsxDEV("div",{className:"text-green-300 font-mono text-sm font-medium",children:e.name},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:195,columnNumber:23},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:188,columnNumber:21},this),pe.jsxDEV("div",{className:"text-green-600 font-mono text-xs ml-6",children:e.description},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:199,columnNumber:21},this)]},e.id,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:187,columnNumber:19},this))},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:185,columnNumber:15},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:180,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:177,columnNumber:11},this),pe.jsxDEV("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[pe.jsxDEV("button",{type:"submit",disabled:a||!s.name.trim(),className:"flex items-center justify-center gap-2 px-4 py-2 sm:py-3 bg-green-600 hover:bg-green-500 disabled:bg-green-800 disabled:opacity-50 text-black font-medium rounded transition-all font-mono text-sm",children:[pe.jsxDEV(P,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:215,columnNumber:15},this),a?"创建中...":"创建角色"]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:210,columnNumber:13},this),pe.jsxDEV("button",{type:"button",onClick:()=>e("/role-permissions"),className:"flex items-center justify-center gap-2 px-4 py-2 sm:py-3 border border-gray-500 hover:border-gray-400 hover:bg-gray-800/30 text-gray-300 font-medium rounded transition-all font-mono text-sm",children:[pe.jsxDEV(N,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:223,columnNumber:15},this),"取消"]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:218,columnNumber:13},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:209,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:149,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:126,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/pages/RoleCreate.tsx",lineNumber:125,columnNumber:5},this)}const Mg=()=>{const{user:e}=Ve(),[r,s]=t.useState([]),[n,i]=t.useState([]),[o,l]=t.useState(!0),[c,m]=t.useState(!1),[u,d]=t.useState({key:"work_date",direction:"desc"}),[f,h]=t.useState({yearMonth:"",startDate:"",endDate:"",userId:""}),[p,g]=t.useState([]),[b,v]=t.useState([]),[N,x]=t.useState(new Set);t.useEffect(()=>{e&&(E(),y())},[e]),t.useEffect(()=>{w()},[r,f]);const y=async()=>{if(e)try{const{data:r,error:t}=await ve.from("timesheet_records").select("user_id, user:users!timesheet_records_user_id_fkey(id, name)").or(`supervisor_id.eq.${e.id},section_chief_id.eq.${e.id}`).neq("status","draft");if(t)return;const s=(null==r?void 0:r.filter(e=>e.user).reduce((e,r)=>{const t=r.user.id;return e.find(e=>e.id===t)||e.push({id:t,name:r.user.name}),e},[]))||[];v(s)}catch(r){}},E=async()=>{if(e)try{l(!0);const{data:r,error:t}=await ve.from("timesheet_records").select("\n          *,\n          user:users!timesheet_records_user_id_fkey(id, name),\n          supervisor:users!timesheet_records_supervisor_id_fkey(id, name),\n          section_chief:users!timesheet_records_section_chief_id_fkey(id, name),\n          items:timesheet_record_items(\n            id,\n            process_id,\n            quantity,\n            unit_price,\n            amount,\n            processes:processes!timesheet_record_items_process_id_fkey(\n              product_process,\n              product_name,\n              production_category,\n              production_line,\n              unit_price\n            )\n          ),\n          approval_history(\n            approver_type,\n            approver_name,\n            created_at,\n            approver:approver_id(name)\n          )\n        ").or(`user_id.eq.${e.id},supervisor_id.eq.${e.id},section_chief_id.eq.${e.id}`).neq("status","draft").order("work_date",{ascending:!1}),n=r?r.filter((e,r,t)=>r===t.findIndex(r=>r.id===e.id)):[];if(t)return void W.error("获取历史记录失败");s(n)}catch(r){W.error("获取历史记录失败")}finally{l(!1)}},w=()=>{let e=[...r];if(f.yearMonth){const[r,t]=f.yearMonth.split("-");e=e.filter(e=>{const s=new Date(e.work_date),n=s.getFullYear(),i=s.getMonth()+1;return n===parseInt(r)&&i===parseInt(t)})}f.startDate&&(e=e.filter(e=>e.work_date>=f.startDate)),f.endDate&&(e=e.filter(e=>e.work_date<=f.endDate)),f.userId&&(e=e.filter(e=>e.user_id===f.userId)),u.key&&e.sort((e,r)=>{let t,s;switch(u.key){case"work_date":t=new Date(e.work_date),s=new Date(r.work_date);break;case"status":t=e.status,s=r.status;break;case"created_at":t=new Date(e.created_at),s=new Date(r.created_at);break;default:t=e[u.key],s=r[u.key]}return t<s?"asc"===u.direction?-1:1:t>s?"asc"===u.direction?1:-1:0}),i(e)},D=e=>{const r=new Set(N);r.has(e)?r.delete(e):r.add(e),x(r)},H=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}),T=e=>{const r=(e=>{switch(e){case"pending":return{text:"待班长审核",icon:"⚠",color:"text-yellow-400"};case"approved":return{text:"待段长审核",icon:"⚠",color:"text-blue-400"};case"section_chief_approved":return{text:"已通过",icon:"✓",color:"text-green-400"};default:return{text:"未知",icon:"⚠",color:"text-gray-400"}}})(e);return pe.jsxDEV("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-bold ${r.color}`,children:[pe.jsxDEV("span",{className:"w-3 h-3 text-center",children:r.icon},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:384,columnNumber:9},void 0),r.text]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:383,columnNumber:7},void 0)},S=(e,r)=>{var t,s;const n=null==(t=e.approval_history)?void 0:t.find(e=>e.approver_type===r);return n?{name:n.approver_name||(null==(s=n.approver)?void 0:s.name)||"未知",date:H(n.created_at)}:null};return n.length,n.filter(e=>"pending"===e.status).length,n.filter(e=>"approved"===e.status).length,n.filter(e=>"section_chief_approved"===e.status).length,(()=>{const e=new Map;return n.forEach(r=>{var t;const s=r.user_id,n=r.work_date,i=(e=>{const r=e.getDay();if(0===r||6===r)return!1;e.getFullYear();const t=e.getMonth()+1,s=e.getDate();return!(1===t&&1===s||2===t&&s>=10&&s<=17||4===t&&s>=4&&s<=6||5===t&&s>=1&&s<=3||6===t&&s>=22&&s<=24||9===t&&s>=15&&s<=17||10===t&&s>=1&&s<=7)})(new Date(n));e.has(s)||e.set(s,{userId:s,userName:(null==(t=r.user)?void 0:t.name)||"未知",workDates:new Set,workingDates:new Set,holidayDates:new Set});const a=e.get(s);a.workDates.add(n),i?a.workingDates.add(n):a.holidayDates.add(n)}),Array.from(e.values()).map(e=>({...e,totalWorkDays:e.workDates.size,actualWorkDays:e.workingDates.size,holidayDays:e.holidayDates.size}))})().reduce((e,r)=>e+r.actualWorkDays,0),o?pe.jsxDEV("div",{className:"min-h-screen bg-black flex items-center justify-center",children:pe.jsxDEV("div",{className:"text-green-400 text-xl animate-pulse font-mono",children:"加载中..."},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:490,columnNumber:9},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:489,columnNumber:7},void 0):pe.jsxDEV("div",{className:"min-h-screen bg-black text-green-300",children:[pe.jsxDEV("header",{className:"bg-gray-900 border-b border-green-400 px-6 py-4",children:pe.jsxDEV("div",{className:"max-w-7xl mx-auto",children:pe.jsxDEV("div",{className:"flex items-center justify-between",children:[pe.jsxDEV("h1",{className:"text-2xl font-bold text-green-400 font-mono flex items-center gap-2",children:[pe.jsxDEV(ie,{className:"w-6 h-6"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:504,columnNumber:15},void 0),"历史记录"]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:503,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex items-center gap-3",children:pe.jsxDEV(a,{to:"/dashboard",className:"flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2 bg-gradient-to-r from-gray-700 to-gray-800 hover:from-gray-600 hover:to-gray-700 text-green-300 hover:text-green-200 rounded-lg font-mono transition-all duration-200 shadow-md hover:shadow-lg border border-gray-600 hover:border-green-500/50",children:[pe.jsxDEV(_,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:512,columnNumber:17},void 0),pe.jsxDEV("span",{className:"hidden sm:inline",children:"返回控制台"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:513,columnNumber:17},void 0),pe.jsxDEV("span",{className:"sm:hidden",children:"返回"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:514,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:508,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:507,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:502,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:501,columnNumber:9},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:500,columnNumber:7},void 0),pe.jsxDEV("div",{className:"max-w-7xl mx-auto p-6",children:[pe.jsxDEV("div",{className:"bg-gray-900 border border-green-400 rounded-lg p-4 mb-6",children:[pe.jsxDEV("div",{className:"flex items-center justify-between mb-4",children:pe.jsxDEV("div",{className:"flex items-center gap-2",children:[pe.jsxDEV(X,{className:"w-5 h-5 text-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:526,columnNumber:15},void 0),pe.jsxDEV("h2",{className:"text-lg font-bold text-green-400 font-mono",children:"数据筛选"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:527,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:525,columnNumber:13},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:524,columnNumber:11},void 0),pe.jsxDEV("div",{className:"space-y-4",children:[pe.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs sm:text-sm font-medium mb-1 sm:mb-2 font-mono",children:"年月"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:535,columnNumber:17},void 0),pe.jsxDEV("input",{type:"month",value:f.yearMonth,onChange:e=>h({...f,yearMonth:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono text-xs sm:text-sm focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:538,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:534,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs sm:text-sm font-medium mb-1 sm:mb-2 font-mono",children:"员工"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:547,columnNumber:17},void 0),pe.jsxDEV("select",{value:f.userId,onChange:e=>h({...f,userId:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono text-xs sm:text-sm focus:outline-none focus:border-green-400",children:[pe.jsxDEV("option",{value:"",children:"全部员工"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:555,columnNumber:19},void 0),b.map(e=>pe.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:557,columnNumber:21},void 0))]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:550,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:546,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:533,columnNumber:13},void 0),pe.jsxDEV("div",{className:"grid grid-cols-2 gap-2 sm:gap-4",children:[pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs sm:text-sm font-medium mb-1 sm:mb-2 font-mono",children:"开始日期"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:566,columnNumber:17},void 0),pe.jsxDEV("input",{type:"date",value:f.startDate,onChange:e=>h({...f,startDate:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono text-xs sm:text-sm focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:569,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:565,columnNumber:15},void 0),pe.jsxDEV("div",{children:[pe.jsxDEV("label",{className:"block text-green-300 text-xs sm:text-sm font-medium mb-1 sm:mb-2 font-mono",children:"结束日期"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:578,columnNumber:17},void 0),pe.jsxDEV("input",{type:"date",value:f.endDate,onChange:e=>h({...f,endDate:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 bg-gray-800 border border-gray-600 rounded text-green-300 font-mono text-xs sm:text-sm focus:outline-none focus:border-green-400"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:581,columnNumber:17},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:577,columnNumber:15},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:564,columnNumber:13},void 0),pe.jsxDEV("div",{className:"flex justify-start",children:pe.jsxDEV("button",{onClick:()=>{h({yearMonth:"",startDate:"",endDate:"",userId:""}),d({key:"work_date",direction:"desc"}),W.success("筛选条件已重置")},className:"px-3 sm:px-4 py-1.5 sm:py-2 bg-gray-700 hover:bg-gray-600 text-green-300 rounded font-mono transition-colors flex items-center gap-2 text-xs sm:text-sm",children:[pe.jsxDEV(Y,{className:"w-3 h-3 sm:w-4 sm:h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:596,columnNumber:17},void 0),"重置筛选"]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:592,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:591,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:531,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:523,columnNumber:9},void 0),pe.jsxDEV("div",{className:"mb-4",children:pe.jsxDEV("h2",{className:"text-xl font-bold text-green-400 font-mono flex items-center gap-2",children:[pe.jsxDEV(ie,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:608,columnNumber:13},void 0),"详细工时记录"]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:607,columnNumber:11},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:606,columnNumber:9},void 0),0===n.length?pe.jsxDEV("div",{className:"bg-gray-900 rounded-lg border border-gray-700 p-8 text-center",children:[pe.jsxDEV("div",{className:"text-green-600 mb-4",children:pe.jsxDEV(ie,{className:"h-16 w-16 mx-auto"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:617,columnNumber:15},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:616,columnNumber:13},void 0),pe.jsxDEV("h3",{className:"text-lg font-medium text-green-400 mb-2 font-mono",children:"暂无历史记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:619,columnNumber:13},void 0),pe.jsxDEV("p",{className:"text-green-600 font-mono",children:"请调整筛选条件或添加新的工时记录"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:620,columnNumber:13},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:615,columnNumber:11},void 0):pe.jsxDEV("div",{className:"space-y-6",children:(()=>{const e=new Map;n.forEach(r=>{var t;const s=r.user_id;e.has(s)||e.set(s,{userName:(null==(t=r.user)?void 0:t.name)||"未知用户",records:[]}),e.get(s).records.push(r)});return Array.from(e.values()).sort((e,r)=>e.userName.localeCompare(r.userName)).map((e,r)=>{const t=new Map;e.records.forEach(e=>{const r=e.work_date;t.has(r)||t.set(r,[]),t.get(r).push(e)});const s=Array.from(t.keys()).sort((e,r)=>new Date(r).getTime()-new Date(e).getTime()),n=e.records.filter(e=>"pending"===e.status),i=e.records.filter(e=>"approved"===e.status),a=[...new Set(n.map(e=>e.work_date))],o=[...new Set(i.map(e=>e.work_date))],l={supervisorPending:a.length,sectionChiefPending:o.length,totalWorkDays:s.length};return pe.jsxDEV("div",{className:"bg-gray-900 rounded-lg border border-gray-700 overflow-hidden",children:[pe.jsxDEV("div",{className:"bg-gray-800 px-4 py-3 border-b border-gray-600 cursor-pointer hover:bg-gray-700 transition-colors",onClick:()=>D(e.userName),children:pe.jsxDEV("div",{className:"flex items-center justify-between",children:pe.jsxDEV("div",{className:"flex items-center gap-4",children:[pe.jsxDEV("h3",{className:"text-lg font-bold text-green-400 font-mono flex items-center gap-2",children:[e.userName,N.has(e.userName)?pe.jsxDEV(ae,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:692,columnNumber:31},void 0):pe.jsxDEV(oe,{className:"w-5 h-5"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:694,columnNumber:31},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:689,columnNumber:27},void 0),pe.jsxDEV("div",{className:"flex items-center gap-4 text-xs",children:[pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("div",{className:"text-yellow-400 font-mono font-bold",children:l.supervisorPending},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:701,columnNumber:31},void 0),pe.jsxDEV("div",{className:"text-gray-400 font-mono",children:"班长待审核"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:702,columnNumber:31},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:700,columnNumber:29},void 0),pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("div",{className:"text-orange-400 font-mono font-bold",children:l.sectionChiefPending},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:705,columnNumber:31},void 0),pe.jsxDEV("div",{className:"text-gray-400 font-mono",children:"段长待审核"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:706,columnNumber:31},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:704,columnNumber:29},void 0),pe.jsxDEV("div",{className:"text-center",children:[pe.jsxDEV("div",{className:"text-blue-400 font-mono font-bold",children:l.totalWorkDays},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:709,columnNumber:31},void 0),pe.jsxDEV("div",{className:"text-gray-400 font-mono",children:"工作天数"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:710,columnNumber:31},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:708,columnNumber:29},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:699,columnNumber:27},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:688,columnNumber:25},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:687,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:683,columnNumber:21},void 0),!N.has(e.userName)&&pe.jsxDEV("div",{className:"p-4 space-y-4",children:s.map(r=>{const s=t.get(r),n=`${e.userName}-${r}`,i=N.has(n);return pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"flex items-center gap-2 mb-3 cursor-pointer",onClick:()=>D(n),children:[pe.jsxDEV("div",{className:"w-2 h-2 bg-green-400 rounded-full"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:732,columnNumber:33},void 0),pe.jsxDEV("h4",{className:"text-md font-semibold text-green-300 font-mono flex items-center gap-2",children:[H(r),i?pe.jsxDEV(ae,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:736,columnNumber:37},void 0):pe.jsxDEV(oe,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:738,columnNumber:37},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:733,columnNumber:33},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:728,columnNumber:31},void 0),!i&&pe.jsxDEV("div",{className:"space-y-2",children:s.map(e=>e.items.map((r,t)=>{var s,n,i;return pe.jsxDEV("div",{className:"bg-gray-800 rounded-lg p-3 border border-gray-600 hover:border-gray-500 transition-colors",children:pe.jsxDEV("div",{className:"space-y-3",children:[pe.jsxDEV("div",{className:"flex justify-between items-start gap-3",children:[pe.jsxDEV("div",{className:"flex-1",children:[pe.jsxDEV("div",{className:"text-xs text-gray-400 font-mono mb-1",children:"产品工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:753,columnNumber:47},void 0),pe.jsxDEV("div",{className:"text-sm text-green-300 font-mono break-words",children:`${(null==(s=r.processes)?void 0:s.production_line)||"未知"} - ${(null==(n=r.processes)?void 0:n.product_name)||"未知"} - ${(null==(i=r.processes)?void 0:i.product_process)||"未知"}`},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:754,columnNumber:47},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:752,columnNumber:45},void 0),pe.jsxDEV("div",{className:"text-right",children:[pe.jsxDEV("div",{className:"text-xs text-gray-400 font-mono mb-1",children:"数量"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:759,columnNumber:47},void 0),pe.jsxDEV("div",{className:"text-sm text-yellow-400 font-mono font-semibold",children:r.quantity},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:760,columnNumber:47},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:758,columnNumber:45},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:751,columnNumber:43},void 0),pe.jsxDEV("div",{className:"flex justify-between items-start gap-2 text-xs",children:[pe.jsxDEV("div",{className:"flex gap-4 flex-1",children:[pe.jsxDEV("div",{className:"flex-1",children:[pe.jsxDEV("div",{className:"text-gray-400 font-mono mb-1",children:"班长"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:770,columnNumber:49},void 0),pe.jsxDEV("div",{className:"text-green-300 font-mono",children:(()=>{var r;const t=S(e,"supervisor"),s=(null==(r=e.supervisor)?void 0:r.name)||"未分配";return t?pe.jsxDEV("div",{className:"flex flex-col",children:[pe.jsxDEV("div",{className:"truncate",children:t.name},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:778,columnNumber:59},void 0),pe.jsxDEV("div",{className:"text-xs text-gray-400",children:t.date},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:779,columnNumber:59},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:777,columnNumber:57},void 0):pe.jsxDEV("div",{className:"truncate",children:s},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:783,columnNumber:60},void 0)})()},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:771,columnNumber:49},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:769,columnNumber:47},void 0),pe.jsxDEV("div",{className:"flex-1",children:[pe.jsxDEV("div",{className:"text-gray-400 font-mono mb-1",children:"段长"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:788,columnNumber:49},void 0),pe.jsxDEV("div",{className:"text-green-300 font-mono",children:(()=>{var r;const t=S(e,"section_chief"),s=(null==(r=e.section_chief)?void 0:r.name)||"未分配";return t?pe.jsxDEV("div",{className:"flex flex-col",children:[pe.jsxDEV("div",{className:"truncate",children:t.name},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:796,columnNumber:59},void 0),pe.jsxDEV("div",{className:"text-xs text-gray-400",children:t.date},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:797,columnNumber:59},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:795,columnNumber:57},void 0):pe.jsxDEV("div",{className:"truncate",children:s},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:801,columnNumber:60},void 0)})()},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:789,columnNumber:49},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:787,columnNumber:47},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:768,columnNumber:45},void 0),pe.jsxDEV("div",{className:"text-right",children:[pe.jsxDEV("div",{className:"text-gray-400 font-mono mb-1",children:"状态"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:807,columnNumber:47},void 0),pe.jsxDEV("div",{className:"flex items-center justify-end",children:T(e.status)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:808,columnNumber:47},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:806,columnNumber:45},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:767,columnNumber:43},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:749,columnNumber:41},void 0)},`${e.id}-${t}`,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:748,columnNumber:39},void 0)}))},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:745,columnNumber:33},void 0)]},r,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:726,columnNumber:29},void 0)})},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:719,columnNumber:23},void 0)]},r,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:681,columnNumber:19},void 0)})})()},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:623,columnNumber:11},void 0),n.length>0&&pe.jsxDEV("div",{className:"mt-6 bg-black rounded-lg p-4 border border-gray-700",children:[pe.jsxDEV("h5",{className:"text-md font-bold text-green-400 font-mono mb-4 flex items-center gap-2",children:[pe.jsxDEV(A,{className:"w-4 h-4"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:835,columnNumber:15},void 0),"数量统计汇总"]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:834,columnNumber:13},void 0),(()=>{const e=n.flatMap(e=>e.items.map(r=>({...r,workDate:e.work_date}))),r=new Map;e.forEach(e=>{var t,s,n,i,a,o,l;const c=`${(null==(t=e.processes)?void 0:t.production_line)||"未知"}-${(null==(s=e.processes)?void 0:s.product_name)||"未知"}-${(null==(n=e.processes)?void 0:n.product_process)||"未知"}`;r.has(c)||r.set(c,{productionLine:(null==(i=e.processes)?void 0:i.production_line)||"未知",productName:(null==(a=e.processes)?void 0:a.product_name)||"未知",productProcess:(null==(o=e.processes)?void 0:o.product_process)||"未知",productionCategory:(null==(l=e.processes)?void 0:l.production_category)||"未知",totalQuantity:0,recordCount:0});const m=r.get(c);m.totalQuantity+=e.quantity,m.recordCount+=1});const t=Array.from(r.values()).sort((e,r)=>r.totalQuantity-e.totalQuantity);return 0===t.length?pe.jsxDEV("div",{className:"text-center py-4 text-gray-400 font-mono text-sm",children:"暂无统计数据"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:877,columnNumber:19},void 0):pe.jsxDEV("div",{className:"w-full",children:pe.jsxDEV("table",{className:"w-full table-fixed",children:[pe.jsxDEV("thead",{className:"bg-gray-800",children:pe.jsxDEV("tr",{children:[pe.jsxDEV("th",{className:"px-1 py-2 text-left text-green-400 font-mono text-xs w-[50%] sm:w-[60%]",children:"产品工序"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:888,columnNumber:25},void 0),pe.jsxDEV("th",{className:"px-1 py-2 text-left text-green-400 font-mono text-xs w-[25%] sm:w-[20%]",children:"数量总计"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:889,columnNumber:25},void 0),pe.jsxDEV("th",{className:"px-1 py-2 text-left text-green-400 font-mono text-xs w-[25%] sm:w-[20%]",children:"记录条数"},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:890,columnNumber:25},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:887,columnNumber:23},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:886,columnNumber:21},void 0),pe.jsxDEV("tbody",{children:t.map((e,r)=>pe.jsxDEV("tr",{className:"border-b border-gray-700 hover:bg-gray-800 transition-colors",children:[pe.jsxDEV("td",{className:"px-1 py-2 text-green-300 font-mono text-xs",children:pe.jsxDEV("div",{className:"break-words text-xs leading-tight",children:`${e.productionLine} - ${e.productName} - ${e.productProcess}`},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:897,columnNumber:29},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:896,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-1 py-2 text-yellow-400 font-mono text-xs font-bold",children:e.totalQuantity.toFixed(1)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:901,columnNumber:27},void 0),pe.jsxDEV("td",{className:"px-1 py-2 text-blue-400 font-mono text-xs",children:e.recordCount},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:904,columnNumber:27},void 0)]},r,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:895,columnNumber:25},void 0))},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:893,columnNumber:21},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:885,columnNumber:19},void 0)},void 0,!1,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:884,columnNumber:17},void 0)})()]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:833,columnNumber:11},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:521,columnNumber:7},void 0)]},void 0,!0,{fileName:"H:/工时管理/src/pages/History.tsx",lineNumber:498,columnNumber:5},void 0)};function Ig(){return pe.jsxDEV(ke,{children:pe.jsxDEV(m,{children:[pe.jsxDEV(le,{position:"top-right",richColors:!0},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:31,columnNumber:9},this),pe.jsxDEV(u,{children:[pe.jsxDEV(d,{path:"/login",element:pe.jsxDEV(Ae,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:34,columnNumber:41},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:34,columnNumber:11},this),pe.jsxDEV(d,{path:"/register",element:pe.jsxDEV(Me,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:35,columnNumber:44},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:35,columnNumber:11},this),pe.jsxDEV(d,{path:"/reset-password",element:pe.jsxDEV(Ie,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:36,columnNumber:50},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:36,columnNumber:11},this),pe.jsxDEV(d,{path:"/",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(n,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:41,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:40,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:39,columnNumber:11},this),pe.jsxDEV(d,{path:"/dashboard",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(ws,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:46,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:45,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:44,columnNumber:11},this),pe.jsxDEV(d,{path:"/company-management",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(_s,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:51,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:50,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:49,columnNumber:11},this),pe.jsxDEV(d,{path:"/user-management",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(Hs,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:56,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:55,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:54,columnNumber:11},this),pe.jsxDEV(d,{path:"/role-permissions",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(Ts,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:61,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:60,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:59,columnNumber:11},this),pe.jsxDEV(d,{path:"/role-permissions/edit/:id",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(Rg,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:67,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:66,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:65,columnNumber:11},this),pe.jsxDEV(d,{path:"/role-permissions/create",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(Ag,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:72,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:71,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:70,columnNumber:11},this),pe.jsxDEV(d,{path:"/process-management",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(yg,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:77,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:76,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:75,columnNumber:11},this),pe.jsxDEV(d,{path:"/timesheet-record",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(wg,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:82,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:81,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:80,columnNumber:11},this),pe.jsxDEV(d,{path:"/timesheet-history",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(Dg,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:87,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:86,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:85,columnNumber:11},this),pe.jsxDEV(d,{path:"/supervisor-approval",element:pe.jsxDEV(Re,{allowedRoles:["班长","supervisor","超级管理员","super_admin"],children:pe.jsxDEV(Hg,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:92,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:91,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:90,columnNumber:11},this),pe.jsxDEV(d,{path:"/section-chief-approval",element:pe.jsxDEV(Re,{allowedRoles:["段长","section_chief","超级管理员","super_admin"],children:pe.jsxDEV(Sg,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:97,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:96,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:95,columnNumber:11},this),pe.jsxDEV(d,{path:"/reports",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(Vg,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:102,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:101,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:100,columnNumber:11},this),pe.jsxDEV(d,{path:"/history",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(Mg,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:107,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:106,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:105,columnNumber:11},this),pe.jsxDEV(d,{path:"/toast-test",element:pe.jsxDEV(Ce,{children:pe.jsxDEV(Cg,{},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:112,columnNumber:15},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:111,columnNumber:13},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:110,columnNumber:11},this),pe.jsxDEV(d,{path:"*",element:pe.jsxDEV(n,{to:"/dashboard",replace:!0},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:118,columnNumber:36},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:118,columnNumber:11},this)]},void 0,!0,{fileName:"H:/工时管理/src/App.tsx",lineNumber:32,columnNumber:9},this)]},void 0,!0,{fileName:"H:/工时管理/src/App.tsx",lineNumber:30,columnNumber:7},this)},void 0,!1,{fileName:"H:/工时管理/src/App.tsx",lineNumber:29,columnNumber:5},this)}function Og(){return navigator.userAgent.toLowerCase().includes("miniprogram")||"miniprogram"===window.__wxjs_environment}function Pg(){const e=navigator.userAgent.toLowerCase();return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)}new class{constructor(){this.isInMiniProgram=Og(),this.messageHandlers=new Map,this.init()}init(){this.isInMiniProgram&&(window.addEventListener("message",this.handleMessage.bind(this)),this.postMessage({type:"pageLoaded",url:window.location.href,timestamp:Date.now()}))}postMessage(e){this.isInMiniProgram&&window.wx&&window.wx.miniProgram&&window.wx.miniProgram.postMessage({data:e})}handleMessage(e){const{type:r,data:t}=e.data||{};if(r&&this.messageHandlers.has(r)){this.messageHandlers.get(r)(t)}}onMessage(e,r){this.messageHandlers.set(e,r)}offMessage(e){this.messageHandlers.delete(e)}getUserInfo(){return new Promise((e,r)=>{if(this.isInMiniProgram){this.postMessage({type:"getUserInfo"});const t=r=>{this.offMessage("userInfo"),e(r)};this.onMessage("userInfo",t),setTimeout(()=>{this.offMessage("userInfo"),r(new Error("获取用户信息超时"))},5e3)}else r(new Error("不在小程序环境中"))})}navigateBack(){this.isInMiniProgram?this.postMessage({type:"navigateBack"}):window.history.back()}showToast(e,r="success",t=2e3){this.isInMiniProgram&&this.postMessage({type:"showToast",message:e,icon:r,duration:t})}showModal(e,r,t=!0){return new Promise(s=>{if(this.isInMiniProgram){this.postMessage({type:"showModal",title:e,content:r,showCancel:t});const n=e=>{this.offMessage("modalResult"),s(e.confirm)};this.onMessage("modalResult",n)}else{const n=t?confirm(`${e}\n${r}`):(alert(`${e}\n${r}`),!0);s(n)}})}setNavigationBarTitle(e){this.isInMiniProgram?this.postMessage({type:"setNavigationBarTitle",title:e}):document.title=e}share(e){this.isInMiniProgram&&this.postMessage({type:"share",...e})}},function(){const e=document.body;navigator.userAgent.toLowerCase().includes("micromessenger")&&e.classList.add("wechat-browser"),Og()&&e.classList.add("miniprogram-webview"),Pg()&&e.classList.add("mobile-device"),e.classList.add(`device-${function(){const e=navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/i.test(e)?"ios":/android/i.test(e)?"android":"desktop"}()}`),document.addEventListener("touchstart",function(e){e.touches.length>1&&e.preventDefault()});let r=0;document.addEventListener("touchend",function(e){const t=Date.now();t-r<=300&&e.preventDefault(),r=t},!1),document.addEventListener("contextmenu",function(e){Pg()&&e.preventDefault()})}(),be.createRoot(document.getElementById("root")).render(pe.jsxDEV(t.StrictMode,{children:pe.jsxDEV(Ig,{},void 0,!1,{fileName:"H:/工时管理/src/main.tsx",lineNumber:13,columnNumber:5},void 0)},void 0,!1,{fileName:"H:/工时管理/src/main.tsx",lineNumber:12,columnNumber:3},void 0));
